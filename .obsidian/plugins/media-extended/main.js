/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source visit the plugins github repository
*/

"use strict";var ns=Object.create;var xr=Object.defineProperty,as=Object.defineProperties,is=Object.getOwnPropertyDescriptor,ss=Object.getOwnPropertyDescriptors,os=Object.getOwnPropertyNames,Vn=Object.getOwnPropertySymbols,zn=Object.getPrototypeOf,Xn=Object.prototype.hasOwnProperty,ls=Object.prototype.propertyIsEnumerable,us=Reflect.get;var Yn=(ne,he,re)=>he in ne?xr(ne,he,{enumerable:!0,configurable:!0,writable:!0,value:re}):ne[he]=re,Jt=(ne,he)=>{for(var re in he||={})Xn.call(he,re)&&Yn(ne,re,he[re]);if(Vn)for(var re of Vn(he))ls.call(he,re)&&Yn(ne,re,he[re]);return ne},Kr=(ne,he)=>as(ne,ss(he));var rr=(ne,he)=>()=>(he||ne((he={exports:{}}).exports,he),he.exports),fs=(ne,he)=>{for(var re in he)xr(ne,re,{get:he[re],enumerable:!0})},Qn=(ne,he,re,ce)=>{if(he&&typeof he=="object"||typeof he=="function")for(let V of os(he))!Xn.call(ne,V)&&V!==re&&xr(ne,V,{get:()=>he[V],enumerable:!(ce=is(he,V))||ce.enumerable});return ne};var ir=(ne,he,re)=>(re=ne!=null?ns(zn(ne)):{},Qn(he||!ne||!ne.__esModule?xr(re,"default",{value:ne,enumerable:!0}):re,ne)),cs=ne=>Qn(xr({},"__esModule",{value:!0}),ne);var yn=(ne,he,re)=>us(zn(ne),re,he);var wt=(ne,he,re)=>new Promise((ce,V)=>{var v=l=>{try{p(re.next(l))}catch(o){V(o)}},e=l=>{try{p(re.throw(l))}catch(o){V(o)}},p=l=>l.done?ce(l.value):Promise.resolve(l.value).then(v,e);p((re=re.apply(ne,he)).next())});var jr=rr($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});function $n(ne,he){if(he)return ne;throw new Error("Unhandled discriminated union member: "+JSON.stringify(ne))}$r.assertNever=$n;$r.default=$n});var la=rr((Po,oa)=>{"use strict";oa.exports=ne=>encodeURIComponent(ne).replace(/[!'()*]/g,he=>`%${he.charCodeAt(0).toString(16).toUpperCase()}`)});var ma=rr((Do,da)=>{"use strict";var ca="%[a-f0-9]{2}",ua=new RegExp("("+ca+")|([^%]+?)","gi"),fa=new RegExp("("+ca+")+","gi");function Tn(ne,he){try{return[decodeURIComponent(ne.join(""))]}catch{}if(ne.length===1)return ne;he=he||1;var re=ne.slice(0,he),ce=ne.slice(he);return Array.prototype.concat.call([],Tn(re),Tn(ce))}function hs(ne){try{return decodeURIComponent(ne)}catch{for(var he=ne.match(ua)||[],re=1;re<he.length;re++)ne=Tn(he,re).join(""),he=ne.match(ua)||[];return ne}}function gs(ne){for(var he={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},re=fa.exec(ne);re;){try{he[re[0]]=decodeURIComponent(re[0])}catch{var ce=hs(re[0]);ce!==re[0]&&(he[re[0]]=ce)}re=fa.exec(ne)}he["%C2"]="\uFFFD";for(var V=Object.keys(he),v=0;v<V.length;v++){var e=V[v];ne=ne.replace(new RegExp(e,"g"),he[e])}return ne}da.exports=function(ne){if(typeof ne!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof ne+"`");try{return ne=ne.replace(/\+/g," "),decodeURIComponent(ne)}catch{return gs(ne)}}});var ga=rr((Io,ha)=>{"use strict";ha.exports=(ne,he)=>{if(!(typeof ne=="string"&&typeof he=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(he==="")return[ne];let re=ne.indexOf(he);return re===-1?[ne]:[ne.slice(0,re),ne.slice(re+he.length)]}});var _a=rr((Oo,Ea)=>{"use strict";Ea.exports=function(ne,he){for(var re={},ce=Object.keys(ne),V=Array.isArray(he),v=0;v<ce.length;v++){var e=ce[v],p=ne[e];(V?he.indexOf(e)!==-1:he(e,p,ne))&&(re[e]=p)}return re}});var qr=rr(nr=>{"use strict";var Es=la(),_s=ma(),pa=ga(),vs=_a(),ps=ne=>ne==null,An=Symbol("encodeFragmentIdentifier");function ys(ne){switch(ne.arrayFormat){case"index":return he=>(re,ce)=>{let V=re.length;return ce===void 0||ne.skipNull&&ce===null||ne.skipEmptyString&&ce===""?re:ce===null?[...re,[Gt(he,ne),"[",V,"]"].join("")]:[...re,[Gt(he,ne),"[",Gt(V,ne),"]=",Gt(ce,ne)].join("")]};case"bracket":return he=>(re,ce)=>ce===void 0||ne.skipNull&&ce===null||ne.skipEmptyString&&ce===""?re:ce===null?[...re,[Gt(he,ne),"[]"].join("")]:[...re,[Gt(he,ne),"[]=",Gt(ce,ne)].join("")];case"colon-list-separator":return he=>(re,ce)=>ce===void 0||ne.skipNull&&ce===null||ne.skipEmptyString&&ce===""?re:ce===null?[...re,[Gt(he,ne),":list="].join("")]:[...re,[Gt(he,ne),":list=",Gt(ce,ne)].join("")];case"comma":case"separator":case"bracket-separator":{let he=ne.arrayFormat==="bracket-separator"?"[]=":"=";return re=>(ce,V)=>V===void 0||ne.skipNull&&V===null||ne.skipEmptyString&&V===""?ce:(V=V===null?"":V,ce.length===0?[[Gt(re,ne),he,Gt(V,ne)].join("")]:[[ce,Gt(V,ne)].join(ne.arrayFormatSeparator)])}default:return he=>(re,ce)=>ce===void 0||ne.skipNull&&ce===null||ne.skipEmptyString&&ce===""?re:ce===null?[...re,Gt(he,ne)]:[...re,[Gt(he,ne),"=",Gt(ce,ne)].join("")]}}function Ts(ne){let he;switch(ne.arrayFormat){case"index":return(re,ce,V)=>{if(he=/\[(\d*)\]$/.exec(re),re=re.replace(/\[\d*\]$/,""),!he){V[re]=ce;return}V[re]===void 0&&(V[re]={}),V[re][he[1]]=ce};case"bracket":return(re,ce,V)=>{if(he=/(\[\])$/.exec(re),re=re.replace(/\[\]$/,""),!he){V[re]=ce;return}if(V[re]===void 0){V[re]=[ce];return}V[re]=[].concat(V[re],ce)};case"colon-list-separator":return(re,ce,V)=>{if(he=/(:list)$/.exec(re),re=re.replace(/:list$/,""),!he){V[re]=ce;return}if(V[re]===void 0){V[re]=[ce];return}V[re]=[].concat(V[re],ce)};case"comma":case"separator":return(re,ce,V)=>{let v=typeof ce=="string"&&ce.includes(ne.arrayFormatSeparator),e=typeof ce=="string"&&!v&&Er(ce,ne).includes(ne.arrayFormatSeparator);ce=e?Er(ce,ne):ce;let p=v||e?ce.split(ne.arrayFormatSeparator).map(l=>Er(l,ne)):ce===null?ce:Er(ce,ne);V[re]=p};case"bracket-separator":return(re,ce,V)=>{let v=/(\[\])$/.test(re);if(re=re.replace(/\[\]$/,""),!v){V[re]=ce&&Er(ce,ne);return}let e=ce===null?[]:ce.split(ne.arrayFormatSeparator).map(p=>Er(p,ne));if(V[re]===void 0){V[re]=e;return}V[re]=[].concat(V[re],e)};default:return(re,ce,V)=>{if(V[re]===void 0){V[re]=ce;return}V[re]=[].concat(V[re],ce)}}}function ya(ne){if(typeof ne!="string"||ne.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function Gt(ne,he){return he.encode?he.strict?Es(ne):encodeURIComponent(ne):ne}function Er(ne,he){return he.decode?_s(ne):ne}function Ta(ne){return Array.isArray(ne)?ne.sort():typeof ne=="object"?Ta(Object.keys(ne)).sort((he,re)=>Number(he)-Number(re)).map(he=>ne[he]):ne}function Aa(ne){let he=ne.indexOf("#");return he!==-1&&(ne=ne.slice(0,he)),ne}function As(ne){let he="",re=ne.indexOf("#");return re!==-1&&(he=ne.slice(re)),he}function Sa(ne){ne=Aa(ne);let he=ne.indexOf("?");return he===-1?"":ne.slice(he+1)}function va(ne,he){return he.parseNumbers&&!Number.isNaN(Number(ne))&&typeof ne=="string"&&ne.trim()!==""?ne=Number(ne):he.parseBooleans&&ne!==null&&(ne.toLowerCase()==="true"||ne.toLowerCase()==="false")&&(ne=ne.toLowerCase()==="true"),ne}function Ra(ne,he){he=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},he),ya(he.arrayFormatSeparator);let re=Ts(he),ce=Object.create(null);if(typeof ne!="string"||(ne=ne.trim().replace(/^[?#&]/,""),!ne))return ce;for(let V of ne.split("&")){if(V==="")continue;let[v,e]=pa(he.decode?V.replace(/\+/g," "):V,"=");e=e===void 0?null:["comma","separator","bracket-separator"].includes(he.arrayFormat)?e:Er(e,he),re(Er(v,he),e,ce)}for(let V of Object.keys(ce)){let v=ce[V];if(typeof v=="object"&&v!==null)for(let e of Object.keys(v))v[e]=va(v[e],he);else ce[V]=va(v,he)}return he.sort===!1?ce:(he.sort===!0?Object.keys(ce).sort():Object.keys(ce).sort(he.sort)).reduce((V,v)=>{let e=ce[v];return Boolean(e)&&typeof e=="object"&&!Array.isArray(e)?V[v]=Ta(e):V[v]=e,V},Object.create(null))}nr.extract=Sa;nr.parse=Ra;nr.stringify=(ne,he)=>{if(!ne)return"";he=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},he),ya(he.arrayFormatSeparator);let re=e=>he.skipNull&&ps(ne[e])||he.skipEmptyString&&ne[e]==="",ce=ys(he),V={};for(let e of Object.keys(ne))re(e)||(V[e]=ne[e]);let v=Object.keys(V);return he.sort!==!1&&v.sort(he.sort),v.map(e=>{let p=ne[e];return p===void 0?"":p===null?Gt(e,he):Array.isArray(p)?p.length===0&&he.arrayFormat==="bracket-separator"?Gt(e,he)+"[]":p.reduce(ce(e),[]).join("&"):Gt(e,he)+"="+Gt(p,he)}).filter(e=>e.length>0).join("&")};nr.parseUrl=(ne,he)=>{he=Object.assign({decode:!0},he);let[re,ce]=pa(ne,"#");return Object.assign({url:re.split("?")[0]||"",query:Ra(Sa(ne),he)},he&&he.parseFragmentIdentifier&&ce?{fragmentIdentifier:Er(ce,he)}:{})};nr.stringifyUrl=(ne,he)=>{he=Object.assign({encode:!0,strict:!0,[An]:!0},he);let re=Aa(ne.url).split("?")[0]||"",ce=nr.extract(ne.url),V=nr.parse(ce,{sort:!1}),v=Object.assign(V,ne.query),e=nr.stringify(v,he);e&&(e=`?${e}`);let p=As(ne.url);return ne.fragmentIdentifier&&(p=`#${he[An]?Gt(ne.fragmentIdentifier,he):ne.fragmentIdentifier}`),`${re}${e}${p}`};nr.pick=(ne,he,re)=>{re=Object.assign({parseFragmentIdentifier:!0,[An]:!1},re);let{url:ce,query:V,fragmentIdentifier:v}=nr.parseUrl(ne,re);return nr.stringifyUrl({url:ce,query:vs(V,he),fragmentIdentifier:v},re)};nr.exclude=(ne,he,re)=>{let ce=Array.isArray(he)?V=>!he.includes(V):(V,v)=>!he(V,v);return nr.pick(ne,ce,re)}});var Ma=rr((Lo,Ca)=>{"use strict";Ca.exports=function(he,re){if(re=re.split(":")[0],he=+he,!he)return!1;switch(re){case"http":case"ws":return he!==80;case"https":case"wss":return he!==443;case"ftp":return he!==21;case"gopher":return he!==70;case"file":return!1}return he!==0}});var Ia=rr(Sn=>{"use strict";var Ss=Object.prototype.hasOwnProperty,Rs;function Pa(ne){try{return decodeURIComponent(ne.replace(/\+/g," "))}catch{return null}}function Da(ne){try{return encodeURIComponent(ne)}catch{return null}}function Cs(ne){for(var he=/([^=?#&]+)=?([^&]*)/g,re={},ce;ce=he.exec(ne);){var V=Pa(ce[1]),v=Pa(ce[2]);V===null||v===null||V in re||(re[V]=v)}return re}function Ms(ne,he){he=he||"";var re=[],ce,V;typeof he!="string"&&(he="?");for(V in ne)if(Ss.call(ne,V)){if(ce=ne[V],!ce&&(ce===null||ce===Rs||isNaN(ce))&&(ce=""),V=Da(V),ce=Da(ce),V===null||ce===null)continue;re.push(V+"="+ce)}return re.length?he+re.join("&"):""}Sn.stringify=Ms;Sn.parse=Cs});var Ua=rr((wo,Ba)=>{"use strict";var ba=Ma(),en=Ia(),Ps=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,La=/[\n\r\t]/g,Ds=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Na=/:\d+$/,Is=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Os=/^[a-zA-Z]:/;function Cn(ne){return(ne||"").toString().replace(Ps,"")}var Rn=[["#","hash"],["?","query"],function(he,re){return cr(re.protocol)?he.replace(/\\/g,"/"):he},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Oa={hash:1,query:1};function wa(ne){var he;typeof window<"u"?he=window:typeof global<"u"?he=global:typeof self<"u"?he=self:he={};var re=he.location||{};ne=ne||re;var ce={},V=typeof ne,v;if(ne.protocol==="blob:")ce=new dr(unescape(ne.pathname),{});else if(V==="string"){ce=new dr(ne,{});for(v in Oa)delete ce[v]}else if(V==="object"){for(v in ne)v in Oa||(ce[v]=ne[v]);ce.slashes===void 0&&(ce.slashes=Ds.test(ne.href))}return ce}function cr(ne){return ne==="file:"||ne==="ftp:"||ne==="http:"||ne==="https:"||ne==="ws:"||ne==="wss:"}function Fa(ne,he){ne=Cn(ne),ne=ne.replace(La,""),he=he||{};var re=Is.exec(ne),ce=re[1]?re[1].toLowerCase():"",V=!!re[2],v=!!re[3],e=0,p;return V?v?(p=re[2]+re[3]+re[4],e=re[2].length+re[3].length):(p=re[2]+re[4],e=re[2].length):v?(p=re[3]+re[4],e=re[3].length):p=re[4],ce==="file:"?e>=2&&(p=p.slice(2)):cr(ce)?p=re[4]:ce?V&&(p=p.slice(2)):e>=2&&cr(he.protocol)&&(p=re[4]),{protocol:ce,slashes:V||cr(ce),slashesCount:e,rest:p}}function bs(ne,he){if(ne==="")return he;for(var re=(he||"/").split("/").slice(0,-1).concat(ne.split("/")),ce=re.length,V=re[ce-1],v=!1,e=0;ce--;)re[ce]==="."?re.splice(ce,1):re[ce]===".."?(re.splice(ce,1),e++):e&&(ce===0&&(v=!0),re.splice(ce,1),e--);return v&&re.unshift(""),(V==="."||V==="..")&&re.push(""),re.join("/")}function dr(ne,he,re){if(ne=Cn(ne),ne=ne.replace(La,""),!(this instanceof dr))return new dr(ne,he,re);var ce,V,v,e,p,l,o=Rn.slice(),i=typeof he,E=this,h=0;for(i!=="object"&&i!=="string"&&(re=he,he=null),re&&typeof re!="function"&&(re=en.parse),he=wa(he),V=Fa(ne||"",he),ce=!V.protocol&&!V.slashes,E.slashes=V.slashes||ce&&he.slashes,E.protocol=V.protocol||he.protocol||"",ne=V.rest,(V.protocol==="file:"&&(V.slashesCount!==2||Os.test(ne))||!V.slashes&&(V.protocol||V.slashesCount<2||!cr(E.protocol)))&&(o[3]=[/(.*)/,"pathname"]);h<o.length;h++){if(e=o[h],typeof e=="function"){ne=e(ne,E);continue}v=e[0],l=e[1],v!==v?E[l]=ne:typeof v=="string"?(p=v==="@"?ne.lastIndexOf(v):ne.indexOf(v),~p&&(typeof e[2]=="number"?(E[l]=ne.slice(0,p),ne=ne.slice(p+e[2])):(E[l]=ne.slice(p),ne=ne.slice(0,p)))):(p=v.exec(ne))&&(E[l]=p[1],ne=ne.slice(0,p.index)),E[l]=E[l]||ce&&e[3]&&he[l]||"",e[4]&&(E[l]=E[l].toLowerCase())}re&&(E.query=re(E.query)),ce&&he.slashes&&E.pathname.charAt(0)!=="/"&&(E.pathname!==""||he.pathname!=="")&&(E.pathname=bs(E.pathname,he.pathname)),E.pathname.charAt(0)!=="/"&&cr(E.protocol)&&(E.pathname="/"+E.pathname),ba(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(p=E.auth.indexOf(":"),~p?(E.username=E.auth.slice(0,p),E.username=encodeURIComponent(decodeURIComponent(E.username)),E.password=E.auth.slice(p+1),E.password=encodeURIComponent(decodeURIComponent(E.password))):E.username=encodeURIComponent(decodeURIComponent(E.auth)),E.auth=E.password?E.username+":"+E.password:E.username),E.origin=E.protocol!=="file:"&&cr(E.protocol)&&E.host?E.protocol+"//"+E.host:"null",E.href=E.toString()}function Ls(ne,he,re){var ce=this;switch(ne){case"query":typeof he=="string"&&he.length&&(he=(re||en.parse)(he)),ce[ne]=he;break;case"port":ce[ne]=he,ba(he,ce.protocol)?he&&(ce.host=ce.hostname+":"+he):(ce.host=ce.hostname,ce[ne]="");break;case"hostname":ce[ne]=he,ce.port&&(he+=":"+ce.port),ce.host=he;break;case"host":ce[ne]=he,Na.test(he)?(he=he.split(":"),ce.port=he.pop(),ce.hostname=he.join(":")):(ce.hostname=he,ce.port="");break;case"protocol":ce.protocol=he.toLowerCase(),ce.slashes=!re;break;case"pathname":case"hash":if(he){var V=ne==="pathname"?"/":"#";ce[ne]=he.charAt(0)!==V?V+he:he}else ce[ne]=he;break;case"username":case"password":ce[ne]=encodeURIComponent(he);break;case"auth":var v=he.indexOf(":");~v?(ce.username=he.slice(0,v),ce.username=encodeURIComponent(decodeURIComponent(ce.username)),ce.password=he.slice(v+1),ce.password=encodeURIComponent(decodeURIComponent(ce.password))):ce.username=encodeURIComponent(decodeURIComponent(he))}for(var e=0;e<Rn.length;e++){var p=Rn[e];p[4]&&(ce[p[1]]=ce[p[1]].toLowerCase())}return ce.auth=ce.password?ce.username+":"+ce.password:ce.username,ce.origin=ce.protocol!=="file:"&&cr(ce.protocol)&&ce.host?ce.protocol+"//"+ce.host:"null",ce.href=ce.toString(),ce}function Ns(ne){(!ne||typeof ne!="function")&&(ne=en.stringify);var he,re=this,ce=re.host,V=re.protocol;V&&V.charAt(V.length-1)!==":"&&(V+=":");var v=V+(re.protocol&&re.slashes||cr(re.protocol)?"//":"");return re.username?(v+=re.username,re.password&&(v+=":"+re.password),v+="@"):re.password?(v+=":"+re.password,v+="@"):re.protocol!=="file:"&&cr(re.protocol)&&!ce&&re.pathname!=="/"&&(v+="@"),(ce[ce.length-1]===":"||Na.test(re.hostname)&&!re.port)&&(ce+=":"),v+=ce+re.pathname,he=typeof re.query=="object"?ne(re.query):re.query,he&&(v+=he.charAt(0)!=="?"?"?"+he:he),re.hash&&(v+=re.hash),v}dr.prototype={set:Ls,toString:Ns};dr.extractProtocol=Fa;dr.location=wa;dr.trimLeft=Cn;dr.qs=en;Ba.exports=dr});var ja=rr(sr=>{"use strict";var Fs=sr&&sr.__awaiter||function(ne,he,re,ce){function V(v){return v instanceof re?v:new re(function(e){e(v)})}return new(re||(re=Promise))(function(v,e){function p(i){try{o(ce.next(i))}catch(E){e(E)}}function l(i){try{o(ce.throw(i))}catch(E){e(E)}}function o(i){i.done?v(i.value):V(i.value).then(p,l)}o((ce=ce.apply(ne,he||[])).next())})},Bs=sr&&sr.__generator||function(ne,he){var re={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},ce,V,v,e;return e={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e;function p(o){return function(i){return l([o,i])}}function l(o){if(ce)throw new TypeError("Generator is already executing.");for(;re;)try{if(ce=1,V&&(v=o[0]&2?V.return:o[0]?V.throw||((v=V.return)&&v.call(V),0):V.next)&&!(v=v.call(V,o[1])).done)return v;switch(V=0,v&&(o=[o[0]&2,v.value]),o[0]){case 0:case 1:v=o;break;case 4:return re.label++,{value:o[1],done:!1};case 5:re.label++,V=o[1],o=[0];continue;case 7:o=re.ops.pop(),re.trys.pop();continue;default:if(v=re.trys,!(v=v.length>0&&v[v.length-1])&&(o[0]===6||o[0]===2)){re=0;continue}if(o[0]===3&&(!v||o[1]>v[0]&&o[1]<v[3])){re.label=o[1];break}if(o[0]===6&&re.label<v[1]){re.label=v[1],v=o;break}if(v&&re.label<v[2]){re.label=v[2],re.ops.push(o);break}v[2]&&re.ops.pop(),re.trys.pop();continue}o=he.call(ne,re)}catch(i){o=[6,i],V=0}finally{ce=v=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(sr,"__esModule",{value:!0});sr.moduleName=void 0;sr.moduleName="toWebVTT";var xa=function(ne,he){return new Promise(function(re,ce){var V=new FileReader,v=function(p){var l=p.target.result;V.removeEventListener("loadend",v),re(he!=="string"?new Uint8Array(l):l)},e=function(){V.removeEventListener("error",e),ce(new Error(sr.moduleName+": Error while reading the Blob object"))};V.addEventListener("loadend",v),V.addEventListener("error",e),he!=="string"?V.readAsArrayBuffer(ne):V.readAsText(ne)})},Us=function(ne){return URL.createObjectURL(new Blob([ne],{type:"text/vtt"}))},Ka=function(ne){return ne.replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").concat(`\r
\r
`)},xs=function(ne){return Fs(void 0,void 0,void 0,function(){var he,re,V,ce,V,v;return Bs(this,function(e){switch(e.label){case 0:if(!FileReader)throw new Error(sr.moduleName+": No FileReader constructor found");if(!TextDecoder)throw new Error(sr.moduleName+": No TextDecoder constructor found");if(!(ne instanceof Blob))throw new Error(sr.moduleName+": Expecting resource to be a Blob but something else found.");re=`WEBVTT FILE\r
\r
`,e.label=1;case 1:return e.trys.push([1,3,,5]),[4,xa(ne,"string")];case 2:return V=e.sent(),he=re.concat(Ka(V)),[3,5];case 3:return ce=e.sent(),[4,xa(ne,"buffer")];case 4:return V=e.sent(),v=new TextDecoder("utf-8").decode(V),he=re.concat(Ka(v)),[3,5];case 5:return[2,Promise.resolve(Us(he))]}})})};sr.default=xs});var za=rr((an,On)=>{(function(he,re){typeof an=="object"&&typeof On=="object"?On.exports=re():typeof define=="function"&&define.amd?define([],re):typeof an=="object"?an.dashjs=re():he.dashjs=re()})(self,()=>(()=>{var ne={"./externals/base64.js":(V,v)=>{var e={};e.encode=function(l){for(var o=[],i=0;i<l.length;++i){var E=l.charCodeAt(i);E<128?o.push(E):E<2048?(o.push(192|E>>6),o.push(128|63&E)):E<65536?(o.push(224|E>>12),o.push(128|63&E>>6),o.push(128|63&E)):(o.push(240|E>>18),o.push(128|63&E>>12),o.push(128|63&E>>6),o.push(128|63&E))}return o},e.decode=function(l){for(var o=[],i=0;i<l.length;){var E=l[i++];E<128||(E<224?(E=(31&E)<<6,E|=63&l[i++]):E<240?(E=(15&E)<<12,E|=(63&l[i++])<<6,E|=63&l[i++]):(E=(7&E)<<18,E|=(63&l[i++])<<12,E|=(63&l[i++])<<6,E|=63&l[i++])),o.push(String.fromCharCode(E))}return o.join("")};var p={};(function(l){var o=function(g){for(var C=0,T=[],P=0|g.length/3;0<P--;){var R=(g[C]<<16)+(g[C+1]<<8)+g[C+2];C+=3,T.push(l.charAt(63&R>>18)),T.push(l.charAt(63&R>>12)),T.push(l.charAt(63&R>>6)),T.push(l.charAt(63&R))}if(g.length-C==2){var R=(g[C]<<16)+(g[C+1]<<8);T.push(l.charAt(63&R>>18)),T.push(l.charAt(63&R>>12)),T.push(l.charAt(63&R>>6)),T.push("=")}else if(g.length-C==1){var R=g[C]<<16;T.push(l.charAt(63&R>>18)),T.push(l.charAt(63&R>>12)),T.push("==")}return T.join("")},i=function(){for(var t=[],g=0;g<l.length;++g)t[l.charCodeAt(g)]=g;return t["=".charCodeAt(0)]=0,t}(),E=function(g){for(var C=0,T=[],P=0|g.length/4;0<P--;){var R=(i[g.charCodeAt(C)]<<18)+(i[g.charCodeAt(C+1)]<<12)+(i[g.charCodeAt(C+2)]<<6)+i[g.charCodeAt(C+3)];T.push(255&R>>16),T.push(255&R>>8),T.push(255&R),C+=4}return T&&(g.charAt(C-2)=="="?(T.pop(),T.pop()):g.charAt(C-1)=="="&&T.pop()),T},h={};h.encode=function(t){for(var g=[],C=0;C<t.length;++C)g.push(t.charCodeAt(C));return g},h.decode=function(t){for(var g=0;g<s.length;++g)a[g]=String.fromCharCode(a[g]);return a.join("")},p.decodeArray=function(t){var g=E(t);return new Uint8Array(g)},p.encodeASCII=function(t){var g=h.encode(t);return o(g)},p.decodeASCII=function(t){var g=E(t);return h.decode(g)},p.encode=function(t){var g=e.encode(t);return o(g)},p.decode=function(t){var g=E(t);return e.decode(g)}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),v.decode=p.decode,v.decodeArray=p.decodeArray,v.encode=p.encode,v.encodeASCII=p.encodeASCII},"./externals/cea608-parser.js":(V,v)=>{(function(e){"use strict";var p={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},l=function(u){var A=u;return p.hasOwnProperty(u)&&(A=p[u]),String.fromCharCode(A)},o=15,i=32,E={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},h={17:2,18:4,21:6,22:8,23:10,19:13,20:15},t={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},g={25:2,26:4,29:6,30:8,31:10,27:13,28:15},C=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],T={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(u){this.time=u},log:function(u,A){var D=this.verboseFilter[u];this.verboseLevel>=D&&console.log(this.time+" ["+u+"] "+A)}},P=function(u){for(var A=[],D=0;D<u.length;D++)A.push(u[D].toString(16));return A},R=function(u,A,D,j,$){this.foreground=u||"white",this.underline=A||!1,this.italics=D||!1,this.background=j||"black",this.flash=$||!1};R.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(u){for(var A=["foreground","underline","italics","background","flash"],D=0;D<A.length;D++){var j=A[D];u.hasOwnProperty(j)&&(this[j]=u[j])}},isDefault:function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},equals:function(u){return this.foreground===u.foreground&&this.underline===u.underline&&this.italics===u.italics&&this.background===u.background&&this.flash===u.flash},copy:function(u){this.foreground=u.foreground,this.underline=u.underline,this.italics=u.italics,this.background=u.background,this.flash=u.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var m=function(u,A,D,j,$,z){this.uchar=u||" ",this.penState=new R(A,D,j,$,z)};m.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(u,A){this.uchar=u,this.penState.copy(A)},setPenState:function(u){this.penState.copy(u)},equals:function(u){return this.uchar===u.uchar&&this.penState.equals(u.penState)},copy:function(u){this.uchar=u.uchar,this.penState.copy(u.penState)},isEmpty:function(){return this.uchar===" "&&this.penState.isDefault()}};var f=function(){this.chars=[];for(var u=0;u<i;u++)this.chars.push(new m);this.pos=0,this.currPenState=new R};f.prototype={equals:function(u){for(var A=!0,D=0;D<i;D++)if(!this.chars[D].equals(u.chars[D])){A=!1;break}return A},copy:function(u){for(var A=0;A<i;A++)this.chars[A].copy(u.chars[A])},isEmpty:function(){for(var u=!0,A=0;A<i;A++)if(!this.chars[A].isEmpty()){u=!1;break}return u},setCursor:function(u){this.pos!==u&&(this.pos=u),this.pos<0?(T.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(T.log("ERROR","Too large cursor position "+this.pos),this.pos=i)},moveCursor:function(u){var A=this.pos+u;if(u>1)for(var D=this.pos+1;D<A+1;D++)this.chars[D].setPenState(this.currPenState);this.setCursor(A)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(u){u>=144&&this.backSpace();var A=l(u);if(this.pos>=i){T.log("ERROR","Cannot insert "+u.toString(16)+" ("+A+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(A,this.currPenState),this.moveCursor(1)},clearFromPos:function(u){var A;for(A=u;A<i;A++)this.chars[A].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var u=[],A=!0,D=0;D<i;D++){var j=this.chars[D].uchar;j!==" "&&(A=!1),u.push(j)}return A?"":u.join("")},setPenStyles:function(u){this.currPenState.setStyles(u);var A=this.chars[this.pos];A.setPenState(this.currPenState)}};var r=function(){this.rows=[];for(var u=0;u<o;u++)this.rows.push(new f);this.currRow=o-1,this.nrRollUpRows=null,this.reset()};r.prototype={reset:function(){for(var u=0;u<o;u++)this.rows[u].clear();this.currRow=o-1},equals:function(u){for(var A=!0,D=0;D<o;D++)if(!this.rows[D].equals(u.rows[D])){A=!1;break}return A},copy:function(u){for(var A=0;A<o;A++)this.rows[A].copy(u.rows[A])},isEmpty:function(){for(var u=!0,A=0;A<o;A++)if(!this.rows[A].isEmpty()){u=!1;break}return u},backSpace:function(){var u=this.rows[this.currRow];u.backSpace()},clearToEndOfRow:function(){var u=this.rows[this.currRow];u.clearToEndOfRow()},insertChar:function(u){var A=this.rows[this.currRow];A.insertChar(u)},setPen:function(u){var A=this.rows[this.currRow];A.setPenStyles(u)},moveCursor:function(u){var A=this.rows[this.currRow];A.moveCursor(u)},setCursor:function(u){T.log("INFO","setCursor: "+u);var A=this.rows[this.currRow];A.setCursor(u)},setPAC:function(u){T.log("INFO","pacData = "+JSON.stringify(u));var A=u.row-1;this.nrRollUpRows&&A<this.nrRollUpRows-1&&(A=this.nrRollUpRows-1),this.currRow=A;var D=this.rows[this.currRow];if(u.indent!==null){var j=u.indent,$=Math.max(j-1,0);D.setCursor(u.indent),u.color=D.chars[$].penState.foreground}var z={foreground:u.color,underline:u.underline,italics:u.italics,background:"black",flash:!1};this.setPen(z)},setBkgData:function(u){T.log("INFO","bkgData = "+JSON.stringify(u)),this.backSpace(),this.setPen(u),this.insertChar(32)},setRollUpRows:function(u){this.nrRollUpRows=u},rollUp:function(){if(this.nrRollUpRows===null){T.log("DEBUG","roll_up but nrRollUpRows not set yet");return}T.log("TEXT",this.getDisplayText());var u=this.currRow+1-this.nrRollUpRows,A=this.rows.splice(u,1)[0];A.clear(),this.rows.splice(this.currRow,0,A),T.log("INFO","Rolling up")},getDisplayText:function(u){u=u||!1;for(var A=[],D="",j=-1,$=0;$<o;$++){var z=this.rows[$].getTextString();z&&(j=$+1,u?A.push("Row "+j+': "'+z+'"'):A.push(z.trim()))}return A.length>0&&(u?D="["+A.join(" | ")+"]":D=A.join(`
`)),D},getTextAndFormat:function(){return this.rows}};var d=function(u,A){this.chNr=u,this.outputFilter=A,this.mode=null,this.verbose=0,this.displayedMemory=new r,this.nonDisplayedMemory=new r,this.lastOutputScreen=new r,this.currRollUpRow=this.displayedMemory.rows[o-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};d.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[o-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(u){this.outputFilter=u},setPAC:function(u){this.writeScreen.setPAC(u)},setBkgData:function(u){this.writeScreen.setBkgData(u)},setMode:function(u){u!==this.mode&&(this.mode=u,T.log("INFO","MODE="+u),this.mode=="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=u)},insertChars:function(u){for(var A=0;A<u.length;A++)this.writeScreen.insertChar(u[A]);var D=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";T.log("INFO",D+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(T.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){T.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){T.log("INFO","BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){T.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(u){T.log("INFO","RU("+u+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(u)},cc_FON:function(){T.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){T.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){T.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){T.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){T.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){T.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){T.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(T.log("INFO","EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var u=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=u,this.writeScreen=this.nonDisplayedMemory,T.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(u){T.log("INFO","TO("+u+") - Tab Offset"),this.writeScreen.moveCursor(u)},cc_MIDROW:function(u){var A={flash:!1};if(A.underline=u%2===1,A.italics=u>=46,A.italics)A.foreground="white";else{var D=Math.floor(u/2)-16,j=["white","green","blue","cyan","red","yellow","magenta"];A.foreground=j[D]}T.log("INFO","MIDROW: "+JSON.stringify(A)),this.writeScreen.setPen(A)},outputDataUpdate:function(){var u=T.time;u!==null&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(u,this.displayedMemory),this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=u:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,u,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:u),this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(u){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,u,this.displayedMemory),this.cueStartTime=u))}};var c=function(u,A,D){this.field=u||1,this.outputs=[A,D],this.channels=[new d(1,A),new d(2,D)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};c.prototype={getHandler:function(u){return this.channels[u].getHandler()},setHandler:function(u,A){this.channels[u].setHandler(A)},addData:function(u,A){var D,j,$,z=!1;this.lastTime=u,T.setTime(u);for(var ee=0;ee<A.length;ee+=2){if(j=A[ee]&127,$=A[ee+1]&127,j>=16&&j<=31&&j===this.lastCmdA&&$===this.lastCmdB){this.lastCmdA=null,this.lastCmdB=null,T.log("DEBUG","Repeated command ("+P([j,$])+") is dropped");continue}if(j===0&&$===0){this.dataCounters.padding+=2;continue}else T.log("DATA","["+P([A[ee],A[ee+1]])+"] -> ("+P([j,$])+")");if(D=this.parseCmd(j,$),D||(D=this.parseMidrow(j,$)),D||(D=this.parsePAC(j,$)),D||(D=this.parseBackgroundAttributes(j,$)),!D&&(z=this.parseChars(j,$),z))if(this.currChNr&&this.currChNr>=0){var k=this.channels[this.currChNr-1];k.insertChars(z)}else T.log("WARNING","No channel found yet. TEXT-MODE?");D?this.dataCounters.cmd+=2:z?this.dataCounters.char+=2:(this.dataCounters.other+=2,T.log("WARNING","Couldn't parse cleaned data "+P([j,$])+" orig: "+P([A[ee],A[ee+1]])))}},parseCmd:function(u,A){var D=null,j=(u===20||u===21||u===28||u===29)&&32<=A&&A<=47,$=(u===23||u===31)&&33<=A&&A<=35;if(!(j||$))return!1;u===20||u===21||u===23?D=1:D=2;var z=this.channels[D-1];return u===20||u===21||u===28||u===29?A===32?z.cc_RCL():A===33?z.cc_BS():A===34?z.cc_AOF():A===35?z.cc_AON():A===36?z.cc_DER():A===37?z.cc_RU(2):A===38?z.cc_RU(3):A===39?z.cc_RU(4):A===40?z.cc_FON():A===41?z.cc_RDC():A===42?z.cc_TR():A===43?z.cc_RTD():A===44?z.cc_EDM():A===45?z.cc_CR():A===46?z.cc_ENM():A===47&&z.cc_EOC():z.cc_TO(A-32),this.lastCmdA=u,this.lastCmdB=A,this.currChNr=D,!0},parseMidrow:function(u,A){var D=null;if((u===17||u===25)&&32<=A&&A<=47){if(u===17?D=1:D=2,D!==this.currChNr)return T.log("ERROR","Mismatch channel in midrow parsing"),!1;var j=this.channels[D-1];return j.insertChars([32]),j.cc_MIDROW(A),T.log("DEBUG","MIDROW ("+P([u,A])+")"),this.lastCmdA=u,this.lastCmdB=A,!0}return!1},parsePAC:function(u,A){var D=null,j=null,$=(17<=u&&u<=23||25<=u&&u<=31)&&64<=A&&A<=127,z=(u===16||u===24)&&64<=A&&A<=95;if(!($||z))return!1;D=u<=23?1:2,64<=A&&A<=95?j=D===1?E[u]:t[u]:j=D===1?h[u]:g[u];var ee=this.interpretPAC(j,A),k=this.channels[D-1];return k.setPAC(ee),this.lastCmdA=u,this.lastCmdB=A,this.currChNr=D,!0},interpretPAC:function(u,A){var D=A,j={color:null,italics:!1,indent:null,underline:!1,row:u};return A>95?D=A-96:D=A-64,j.underline=(D&1)===1,D<=13?j.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(D/2)]:D<=15?(j.italics=!0,j.color="white"):j.indent=Math.floor((D-16)/2)*4,j},parseChars:function(u,A){var D=null,j=null,$=null,z=null;if(u>=25?(D=2,$=u-8):(D=1,$=u),17<=$&&$<=19){var ee=A;$===17?ee=A+80:$===18?ee=A+112:ee=A+144,T.log("INFO","Special char '"+l(ee)+"' in channel "+D),j=[ee],this.lastCmdA=u,this.lastCmdB=A}else 32<=u&&u<=127&&(j=A===0?[u]:[u,A],this.lastCmdA=null,this.lastCmdB=null);if(j){var k=P(j);T.log("DEBUG","Char codes =  "+k.join(","))}return j},parseBackgroundAttributes:function(u,A){var D,j,$,z,ee=(u===16||u===24)&&32<=A&&A<=47,k=(u===23||u===31)&&45<=A&&A<=47;return ee||k?(D={},u===16||u===24?(j=Math.floor((A-32)/2),D.background=C[j],A%2===1&&(D.background=D.background+"_semi")):A===45?D.background="transparent":(D.foreground="black",A===47&&(D.underline=!0)),$=u<24?1:2,z=this.channels[$-1],z.setBkgData(D),this.lastCmdA=u,this.lastCmdB=A,!0):!1},reset:function(){for(var u=0;u<this.channels.length;u++)this.channels[u]&&this.channels[u].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(u){for(var A=0;A<this.channels.length;A++)this.channels[A]&&this.channels[A].cueSplitAtTime(u)}};var M=function(u,A,D){for(var j=0,$=A,z=0,ee=[],k=function(X,te,fe,J){if(X!==4||te<8)return null;var ue=fe.getUint8(J),pe=fe.getUint16(J+1),Ce=fe.getUint32(J+3),ve=fe.getUint8(J+7);return ue==181&&pe==49&&Ce==1195456820&&ve==3};$<A+D;){if(j=u.getUint32($),z=u.getUint8($+4)&31,z===6)for(var w=$+5,N=-1;w<$+4+j-1;){N=0;for(var H=255;H===255;)H=u.getUint8(w),N+=H,w++;var W=0;for(H=255;H===255;)H=u.getUint8(w),W+=H,w++;k(N,W,u,w)&&ee.push([w,W]),w+=W}$+=j+4}return ee},n=function(u,A){var D=A[0],j=[[],[]];D+=8;var $=u.getUint8(D)&31;D+=2;for(var z=0;z<$;z++){var ee=u.getUint8(D),k=ee&4,w=ee&3;D++;var N=u.getUint8(D);D++;var H=u.getUint8(D);D++,k&&(N&127)+(H&127)!==0&&(w===0?(j[0].push(N),j[0].push(H)):w===1&&(j[1].push(N),j[1].push(H)))}return j};e.logger=T,e.PenState=R,e.CaptionScreen=r,e.Cea608Parser=c,e.findCea608Nalus=M,e.extractCea608DataFromRange=n})(v)},"./externals/xml2json.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>l});function p(o){"use strict";var i="1.2.0";o=o||{},E();function E(){o.escapeMode===void 0&&(o.escapeMode=!0),o.attributePrefix===void 0&&(o.attributePrefix="_"),o.arrayAccessForm=o.arrayAccessForm||"none",o.emptyNodeForm=o.emptyNodeForm||"text",o.enableToStringFunc===void 0&&(o.enableToStringFunc=!0),o.arrayAccessFormPaths=o.arrayAccessFormPaths||[],o.skipEmptyTextNodesForObj===void 0&&(o.skipEmptyTextNodesForObj=!0),o.stripWhitespaces===void 0&&(o.stripWhitespaces=!0),o.datetimeAccessFormPaths=o.datetimeAccessFormPaths||[],o.useDoubleQuotes===void 0&&(o.useDoubleQuotes=!1),o.xmlElementsFilter=o.xmlElementsFilter||[],o.jsonPropertiesFilter=o.jsonPropertiesFilter||[],o.keepCData===void 0&&(o.keepCData=!1),o.ignoreRoot===void 0&&(o.ignoreRoot=!1)}var h={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function t(){}function g(N){var H=N.localName;return H==null&&(H=N.baseName),(H==null||H=="")&&(H=N.nodeName),H}function C(N){return N.prefix}function T(N){return typeof N=="string"?N.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):N}function P(N){return N.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}function R(N,H,W,Z){for(var X=0;X<N.length;X++){var te=N[X];if(typeof te=="string"){if(te==Z)break}else if(te instanceof RegExp){if(te.test(Z))break}else if(typeof te=="function"&&te(H,W,Z))break}return X!=N.length}function m(N,H,W){switch(o.arrayAccessForm){case"property":N[H]instanceof Array?N[H+"_asArray"]=N[H]:N[H+"_asArray"]=[N[H]];break}!(N[H]instanceof Array)&&o.arrayAccessFormPaths.length>0&&R(o.arrayAccessFormPaths,N,H,W)&&(N[H]=[N[H]])}function f(N){var H=N.split(/[-T:+Z]/g),W=new Date(H[0],H[1]-1,H[2]),Z=H[5].split(".");if(W.setHours(H[3],H[4],Z[0]),Z.length>1&&W.setMilliseconds(Z[1]),H[6]&&H[7]){var X=H[6]*60+Number(H[7]),te=/\d\d-\d\d:\d\d$/.test(N)?"-":"+";X=0+(te=="-"?-1*X:X),W.setMinutes(W.getMinutes()-X-W.getTimezoneOffset())}else N.indexOf("Z",N.length-1)!==-1&&(W=new Date(Date.UTC(W.getFullYear(),W.getMonth(),W.getDate(),W.getHours(),W.getMinutes(),W.getSeconds(),W.getMilliseconds())));return W}function r(N,H,W){if(o.datetimeAccessFormPaths.length>0){var Z=W.split(".#")[0];return R(o.datetimeAccessFormPaths,N,H,Z)?f(N):N}else return N}function d(N,H,W,Z){return H==h.ELEMENT_NODE&&o.xmlElementsFilter.length>0?R(o.xmlElementsFilter,N,W,Z):!0}function c(N,H){if(N.nodeType==h.DOCUMENT_NODE){for(var W=new Object,Z=N.childNodes,X=0;X<Z.length;X++){var te=Z[X];if(te.nodeType==h.ELEMENT_NODE)if(o.ignoreRoot)W=c(te);else{W={};var fe=g(te);W[fe]=c(te)}}return W}else if(N.nodeType==h.ELEMENT_NODE){var W=new Object;W.__cnt=0;for(var J=[],Z=N.childNodes,X=0;X<Z.length;X++){var te=Z[X],fe=g(te);if(te.nodeType!=h.COMMENT_NODE){var ue=H+"."+fe;if(d(W,te.nodeType,fe,ue))if(W.__cnt++,W[fe]==null){var pe=c(te,ue);if(fe!="#text"||/[^\s]/.test(pe)){var Ce={};Ce[fe]=pe,J.push(Ce)}W[fe]=pe,m(W,fe,ue)}else{W[fe]!=null&&(W[fe]instanceof Array||(W[fe]=[W[fe]],m(W,fe,ue)));var pe=c(te,ue);if(fe!="#text"||/[^\s]/.test(pe)){var Ce={};Ce[fe]=pe,J.push(Ce)}W[fe][W[fe].length]=pe}}}W.__children=J;for(var ve=g(N),Ee=0;Ee<N.attributes.length;Ee++){var ge=N.attributes[Ee];W.__cnt++;for(var Q=ge.value,le=0,Y=o.matchers.length;le<Y;le++){var I=o.matchers[le];I.test(ge,ve)&&(Q=I.converter(ge.value))}W[o.attributePrefix+ge.name]=Q}var L=C(N);return L!=null&&L!=""&&(W.__cnt++,W.__prefix=L),W["#text"]!=null&&(W.__text=W["#text"],W.__text instanceof Array&&(W.__text=W.__text.join(`
`)),o.stripWhitespaces&&(W.__text=W.__text.trim()),delete W["#text"],o.arrayAccessForm=="property"&&delete W["#text_asArray"],W.__text=r(W.__text,fe,H+"."+fe)),W["#cdata-section"]!=null&&(W.__cdata=W["#cdata-section"],delete W["#cdata-section"],o.arrayAccessForm=="property"&&delete W["#cdata-section_asArray"]),W.__cnt==0&&o.emptyNodeForm=="text"?W="":W.__cnt==1&&W.__text!=null?W=W.__text:W.__cnt==1&&W.__cdata!=null&&!o.keepCData?W=W.__cdata:W.__cnt>1&&W.__text!=null&&o.skipEmptyTextNodesForObj&&(o.stripWhitespaces&&W.__text==""||W.__text.trim()=="")&&delete W.__text,delete W.__cnt,o.enableToStringFunc&&(W.__text!=null||W.__cdata!=null)&&(W.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),W}else if(N.nodeType==h.TEXT_NODE||N.nodeType==h.CDATA_SECTION_NODE)return N.nodeValue}function M(N,H,W,Z){var X="<"+(N!=null&&N.__prefix!=null?N.__prefix+":":"")+H;if(W!=null)for(var te=0;te<W.length;te++){var fe=W[te],J=N[fe];o.escapeMode&&(J=T(J)),X+=" "+fe.substr(o.attributePrefix.length)+"=",o.useDoubleQuotes?X+='"'+J+'"':X+="'"+J+"'"}return Z?X+="/>":X+=">",X}function n(N,H){return"</"+(N.__prefix!=null?N.__prefix+":":"")+H+">"}function _(N,H){return N.indexOf(H,N.length-H.length)!==-1}function u(N,H){return!!(o.arrayAccessForm=="property"&&_(H.toString(),"_asArray")||H.toString().indexOf(o.attributePrefix)==0||H.toString().indexOf("__")==0||N[H]instanceof Function)}function A(N){var H=0;if(N instanceof Object)for(var W in N)u(N,W)||H++;return H}function D(N,H,W){return o.jsonPropertiesFilter.length==0||W==""||R(o.jsonPropertiesFilter,N,H,W)}function j(N){var H=[];if(N instanceof Object)for(var W in N)W.toString().indexOf("__")==-1&&W.toString().indexOf(o.attributePrefix)==0&&H.push(W);return H}function $(N){var H="";return N.__cdata!=null&&(H+="<![CDATA["+N.__cdata+"]]>"),N.__text!=null&&(o.escapeMode?H+=T(N.__text):H+=N.__text),H}function z(N){var H="";return N instanceof Object?H+=$(N):N!=null&&(o.escapeMode?H+=T(N):H+=N),H}function ee(N,H){return N===""?H:N+"."+H}function k(N,H,W,Z){var X="";if(N.length==0)X+=M(N,H,W,!0);else for(var te=0;te<N.length;te++)X+=M(N[te],H,j(N[te]),!1),X+=w(N[te],ee(Z,H)),X+=n(N[te],H);return X}function w(N,H){var W="",Z=A(N);if(Z>0){for(var X in N)if(!(u(N,X)||H!=""&&!D(N,X,ee(H,X)))){var te=N[X],fe=j(te);if(te==null||te==null)W+=M(te,X,fe,!0);else if(te instanceof Object)if(te instanceof Array)W+=k(te,X,fe,H);else if(te instanceof Date)W+=M(te,X,fe,!1),W+=te.toISOString(),W+=n(te,X);else{var J=A(te);J>0||te.__text!=null||te.__cdata!=null?(W+=M(te,X,fe,!1),W+=w(te,ee(H,X)),W+=n(te,X)):W+=M(te,X,fe,!0)}else W+=M(te,X,fe,!1),W+=z(te),W+=n(te,X)}}return W+=z(N),W}this.parseXmlString=function(N){var H=window.ActiveXObject||"ActiveXObject"in window;if(N===void 0)return null;var W;if(window.DOMParser){var Z=new window.DOMParser,X=null;try{W=Z.parseFromString(N,"text/xml"),W.getElementsByTagNameNS("*","parsererror").length>0&&(W=null)}catch{W=null}}else N.indexOf("<?")==0&&(N=N.substr(N.indexOf("?>")+2)),W=new ActiveXObject("Microsoft.XMLDOM"),W.async="false",W.loadXML(N);return W},this.asArray=function(N){return N===void 0||N==null?[]:N instanceof Array?N:[N]},this.toXmlDateTime=function(N){return N instanceof Date?N.toISOString():typeof N=="number"?new Date(N).toISOString():null},this.asDateTime=function(N){return typeof N=="string"?f(N):N},this.xml2json=function(N){return c(N)},this.xml_str2json=function(N){var H=this.parseXmlString(N);return H!=null?this.xml2json(H):null},this.json2xml_str=function(N){return w(N,"")},this.json2xml=function(N){var H=this.json2xml_str(N);return this.parseXmlString(H)},this.getVersion=function(){return i}}let l=p},"./index_mediaplayerOnly.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{Debug:()=>o.default,FactoryMaker:()=>l.default,MediaPlayer:()=>p.default,default:()=>C});var p=e("./src/streaming/MediaPlayer.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/core/Debug.js"),i=e("./src/core/Version.js"),E=e("./node_modules/es6-promise/auto.js"),h=e.n(E),t=typeof window<"u"&&window||e.g,g=t.dashjs;g||(g=t.dashjs={}),g.MediaPlayer=p.default,g.FactoryMaker=l.default,g.Debug=o.default,g.Version=(0,i.getVersionString)();let C=g},"./src/core/Debug.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/core/EventBus.js"),l=e("./src/core/events/Events.js"),o=e("./src/core/FactoryMaker.js"),i=0,E=1,h=2,t=3,g=4,C=5;function T(m){m=m||{};var f=this.context,r=(0,p.default)(f).getInstance(),d=m.settings,c=[],M,n,_,u;function A(){n=!0,_=!0,u=new Date().getTime(),typeof window<"u"&&window.console&&(c[E]=D(window.console.error),c[h]=D(window.console.error),c[t]=D(window.console.warn),c[g]=D(window.console.info),c[C]=D(window.console.debug))}function D(Z){return Z&&Z.bind?Z.bind(window.console):window.console.log.bind(window.console)}function j(Z){return{fatal:ee.bind(Z),error:k.bind(Z),warn:w.bind(Z),info:N.bind(Z),debug:H.bind(Z)}}function $(Z){n=Z}function z(Z){_=Z}function ee(){for(var Z=arguments.length,X=new Array(Z),te=0;te<Z;te++)X[te]=arguments[te];W.apply(void 0,[E,this].concat(X))}function k(){for(var Z=arguments.length,X=new Array(Z),te=0;te<Z;te++)X[te]=arguments[te];W.apply(void 0,[h,this].concat(X))}function w(){for(var Z=arguments.length,X=new Array(Z),te=0;te<Z;te++)X[te]=arguments[te];W.apply(void 0,[t,this].concat(X))}function N(){for(var Z=arguments.length,X=new Array(Z),te=0;te<Z;te++)X[te]=arguments[te];W.apply(void 0,[g,this].concat(X))}function H(){for(var Z=arguments.length,X=new Array(Z),te=0;te<Z;te++)X[te]=arguments[te];W.apply(void 0,[C,this].concat(X))}function W(Z,X){var te="",fe=null;n&&(fe=new Date().getTime(),te+="["+(fe-u)+"]"),_&&X&&X.getClassName&&(te+="["+X.getClassName()+"]",X.getType&&(te+="["+X.getType()+"]")),te.length>0&&(te+=" ");for(var J=arguments.length,ue=new Array(J>2?J-2:0),pe=2;pe<J;pe++)ue[pe-2]=arguments[pe];Array.apply(null,ue).forEach(function(Ce){te+=Ce+" "}),c[Z]&&d&&d.get().debug.logLevel>=Z&&c[Z](te),d&&d.get().debug.dispatchEvent&&r.trigger(l.default.LOG,{message:te,level:Z})}return M={getLogger:j,setLogTimestampVisible:$,setCalleeNameVisible:z},A(),M}T.__dashjs_factory_name="Debug";var P=o.default.getSingletonFactory(T);P.LOG_LEVEL_NONE=i,P.LOG_LEVEL_FATAL=E,P.LOG_LEVEL_ERROR=h,P.LOG_LEVEL_WARNING=t,P.LOG_LEVEL_INFO=g,P.LOG_LEVEL_DEBUG=C,o.default.updateSingletonFactory(T.__dashjs_factory_name,P);let R=P},"./src/core/EventBus.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/MediaPlayerEvents.js"),o=0,i=5e3;function E(){var g={};function C(r,d,c){var M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(!r)throw new Error("event type cannot be null or undefined");if(!d||typeof d!="function")throw new Error("listener must be a function: "+d);var n=M.priority||o;if(!(R(r,d,c)>=0)){g[r]=g[r]||[];var _={callback:d,scope:c,priority:n};c&&c.getStreamId&&(_.streamId=c.getStreamId()),c&&c.getType&&(_.mediaType=c.getType()),M&&M.mode&&(_.mode=M.mode);var u=g[r].some(function(A,D){if(A&&n>A.priority)return g[r].splice(D,0,_),!0});u||g[r].push(_)}}function T(r,d,c){if(!(!r||!d||!g[r])){var M=R(r,d,c);M<0||(g[r][M]=null)}}function P(r){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!r||!g[r])){if(d=d||{},d.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");d.type=r,c.streamId&&(d.streamId=c.streamId),c.mediaType&&(d.mediaType=c.mediaType),g[r].filter(function(M){return!(!M||c.streamId&&M.streamId&&M.streamId!==c.streamId||c.mediaType&&M.mediaType&&M.mediaType!==c.mediaType||c.mode&&M.mode&&M.mode!==c.mode||!M.mode&&c.mode&&c.mode===l.default.EVENT_MODE_ON_RECEIVE)}).forEach(function(M){return M&&M.callback.call(M.scope,d)})}}function R(r,d,c){var M=-1;return g[r]&&g[r].some(function(n,_){if(n&&n.callback===d&&(!c||c===n.scope))return M=_,!0}),M}function m(){g={}}var f={on:C,off:T,trigger:P,reset:m};return f}E.__dashjs_factory_name="EventBus";var h=p.default.getSingletonFactory(E);h.EVENT_PRIORITY_LOW=o,h.EVENT_PRIORITY_HIGH=i,p.default.updateSingletonFactory(E.__dashjs_factory_name,h);let t=h},"./src/core/FactoryMaker.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>l});var p=function(){var o,i=[],E={},h={};function t(_,u,A,D){!D[_]&&u&&(D[_]={instance:u,override:A})}function g(_,u){for(var A in i){var D=i[A];if(D.context===_&&D.name===u)return D.instance}return null}function C(_,u,A){for(var D in i){var j=i[D];if(j.context===_&&j.name===u){i[D].instance=A;return}}i.push({name:u,context:_,instance:A})}function T(_){i=i.filter(function(u){return u.context!==_})}function P(_,u){return u[_]}function R(_,u,A){_ in A&&(A[_]=u)}function m(_,u){R(_,u,h)}function f(_){return P(_,h)}function r(_){var u=P(_.__dashjs_factory_name,h);return u||(u=function(D){return D===void 0&&(D={}),{create:function(){return n(_,D,arguments)}}},h[_.__dashjs_factory_name]=u),u}function d(_,u){R(_,u,E)}function c(_){return P(_,E)}function M(_){var u=P(_.__dashjs_factory_name,E);return u||(u=function(D){var j;return D===void 0&&(D={}),{getInstance:function(){return j||(j=g(D,_.__dashjs_factory_name)),j||(j=n(_,D,arguments),i.push({name:_.__dashjs_factory_name,context:D,instance:j})),j}}},E[_.__dashjs_factory_name]=u),u}function n(_,u,A){var D,j=_.__dashjs_factory_name,$=u[j];if($){var z=$.instance;if($.override){D=_.apply({context:u},A),z=z.apply({context:u,factory:o,parent:D},A);for(var ee in z)D.hasOwnProperty(ee)&&(D[ee]=z[ee])}else return z.apply({context:u,factory:o},A)}else D=_.apply({context:u},A);return D.getClassName=function(){return j},D}return o={extend:t,getSingletonInstance:g,setSingletonInstance:C,deleteSingletonInstances:T,getSingletonFactory:M,getSingletonFactoryByName:c,updateSingletonFactory:d,getClassFactory:r,getClassFactoryByName:f,updateClassFactory:m},o}();let l=p},"./src/core/Settings.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Utils.js"),o=e("./src/core/Debug.js"),i=e("./src/streaming/constants/Constants.js"),E=e("./src/streaming/vo/metrics/HTTPRequest.js"),h=e("./src/core/EventBus.js"),t=e("./src/core/events/Events.js");function g(m){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(r){return typeof r}:g=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},g(m)}function C(m,f,r){return f in m?Object.defineProperty(m,f,{value:r,enumerable:!0,configurable:!0,writable:!0}):m[f]=r,m}function T(){var m,f,r,d=this.context,c=(0,h.default)(d).getInstance(),M={"streaming.delay.liveDelay":t.default.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":t.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":t.default.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":t.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":t.default.SETTING_UPDATED_PLAYBACK_RATE_MAX},n={debug:{logLevel:o.default.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,parseInbandPrft:!1,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,extendSegmentedCues:!0,webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:i.default.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:i.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:i.default.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:i.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,fragmentRequestProgressTimeout:-1,manifestRequestTimeout:1e4,retryIntervals:(m={},C(m,E.HTTPRequest.MPD_TYPE,500),C(m,E.HTTPRequest.XLINK_EXPANSION_TYPE,500),C(m,E.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),C(m,E.HTTPRequest.INIT_SEGMENT_TYPE,1e3),C(m,E.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),C(m,E.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),C(m,E.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),C(m,E.HTTPRequest.LICENSE,1e3),C(m,E.HTTPRequest.OTHER_TYPE,1e3),C(m,"lowLatencyReductionFactor",10),m),retryAttempts:(f={},C(f,E.HTTPRequest.MPD_TYPE,3),C(f,E.HTTPRequest.XLINK_EXPANSION_TYPE,1),C(f,E.HTTPRequest.MEDIA_SEGMENT_TYPE,3),C(f,E.HTTPRequest.INIT_SEGMENT_TYPE,3),C(f,E.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),C(f,E.HTTPRequest.INDEX_SEGMENT_TYPE,3),C(f,E.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),C(f,E.HTTPRequest.LICENSE,3),C(f,E.HTTPRequest.OTHER_TYPE,3),C(f,"lowLatencyMultiplyFactor",5),f),abr:{movingAverageMethod:i.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:i.default.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:i.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:i.default.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},_=l.default.clone(n);function u($,z,ee){for(var k in $)$.hasOwnProperty(k)&&(z.hasOwnProperty(k)?g($[k])==="object"&&!($[k]instanceof Array)&&$[k]!==null?u($[k],z[k],ee.slice()+k+"."):(z[k]=l.default.clone($[k]),M[ee+k]&&c.trigger(M[ee+k])):console.error("Settings parameter "+ee+k+" is not supported"))}function A(){return _}function D($){g($)==="object"&&u($,_,"")}function j(){_=l.default.clone(n)}return r={get:A,update:D,reset:j},r}T.__dashjs_factory_name="Settings";var P=p.default.getSingletonFactory(T);let R=P},"./src/core/Utils.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./node_modules/path-browserify/index.js"),l=e.n(p),o=e("./node_modules/ua-parser-js/src/ua-parser.js"),i=e.n(o);function E(P){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?E=function(m){return typeof m}:E=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},E(P)}function h(P,R){if(!(P instanceof R))throw new TypeError("Cannot call a class as a function")}function t(P,R){for(var m=0;m<R.length;m++){var f=R[m];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(P,f.key,f)}}function g(P,R,m){return R&&t(P.prototype,R),m&&t(P,m),P}var C=function(){function P(){h(this,P)}return g(P,null,[{key:"mixin",value:function(m,f,r){var d,c={};if(m)for(var M in f)f.hasOwnProperty(M)&&(d=f[M],(!(M in m)||m[M]!==d&&(!(M in c)||c[M]!==d))&&(E(m[M])==="object"&&m[M]!==null?m[M]=P.mixin(m[M],d,r):m[M]=r(d)));return m}},{key:"clone",value:function(m){if(!m||E(m)!=="object")return m;var f;if(m instanceof Array){f=[];for(var r=0,d=m.length;r<d;++r)r in m&&f.push(P.clone(m[r]))}else f={};return P.mixin(f,m,P.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(m,f){try{if(!f||f.length===0)return m;var r=new URL(m);return f.forEach(function(d){d.key&&d.value&&r.searchParams.set(d.key,d.value)}),r.href}catch{return m}}},{key:"parseHttpHeaders",value:function(m){var f={};if(!m)return f;for(var r=m.trim().split(`\r
`),d=0,c=r.length;d<c;d++){var M=r[d],n=M.indexOf(": ");n>0&&(f[M.substring(0,n)]=M.substring(n+2))}return f}},{key:"generateUuid",value:function(){var m=new Date().getTime(),f="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var d=(m+Math.random()*16)%16|0;return m=Math.floor(m/16),(r=="x"?d:d&3|8).toString(16)});return f}},{key:"generateHashCode",value:function(m){var f=0;if(m.length===0)return f;for(var r=0;r<m.length;r++){var d=m.charCodeAt(r);f=(f<<5)-f+d,f|=0}return f}},{key:"getRelativeUrl",value:function(m,f){try{var r=new URL(m),d=new URL(f);if(r.protocol=d.protocol,r.origin!==d.origin)return f;var c=l().relative(r.pathname.substr(0,r.pathname.lastIndexOf("/")),d.pathname.substr(0,d.pathname.lastIndexOf("/"))),M=c.length===0?1:0;return c+=d.pathname.substr(d.pathname.lastIndexOf("/")+M,d.pathname.length-1),d.pathname.length<c.length?d.pathname:c}catch{return f}}},{key:"parseUserAgent",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var f=m===null&&typeof navigator<"u"?navigator.userAgent.toLowerCase():"";return(0,o.UAParser)(f)}catch{return{}}}},{key:"stringHasProtocol",value:function(m){return/(http(s?)):\/\//i.test(m)}}]),P}();let T=C},"./src/core/Version.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{getVersionString:()=>l});var p="4.7.1";function l(){return p}},"./src/core/errors/Errors.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/core/errors/ErrorsBase.js");function l(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(d){return typeof d}:l=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},l(f)}function o(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function i(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&E(f,r)}function E(f,r){return E=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},E(f,r)}function h(f){var r=C();return function(){var c=T(f),M;if(r){var n=T(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return t(this,M)}}function t(f,r){return r&&(l(r)==="object"||typeof r=="function")?r:g(f)}function g(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(f){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},T(f)}var P=function(f){i(d,f);var r=h(d);function d(){var c;return o(this,d),c=r.call(this),c.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,c.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,c.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,c.SEGMENT_BASE_LOADER_ERROR_CODE=15,c.TIME_SYNC_FAILED_ERROR_CODE=16,c.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,c.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,c.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,c.APPEND_ERROR_CODE=20,c.REMOVE_ERROR_CODE=21,c.DATA_UPDATE_FAILED_ERROR_CODE=22,c.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,c.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,c.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,c.DOWNLOAD_ERROR_ID_SIDX_CODE=26,c.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,c.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,c.DOWNLOAD_ERROR_ID_XLINK_CODE=29,c.MANIFEST_ERROR_ID_PARSE_CODE=31,c.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,c.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,c.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,c.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,c.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",c.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",c.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",c.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",c.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",c.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",c.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",c.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",c.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",c.APPEND_ERROR_MESSAGE="chunk is not defined",c.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",c.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",c.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",c.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",c.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",c.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",c}return d}(p.default),R=new P;let m=R},"./src/core/errors/ErrorsBase.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(){p(this,h)}return o(h,[{key:"extend",value:function(g,C){if(g){var T=C?C.override:!1,P=C?C.publicOnly:!1;for(var R in g)!g.hasOwnProperty(R)||this[R]&&!T||P&&g[R].indexOf("public_")===-1||(this[R]=g[R])}}}]),h}();let E=i},"./src/core/events/CoreEvents.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/core/events/EventsBase.js");function l(m){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(r){return typeof r}:l=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},l(m)}function o(m,f){if(!(m instanceof f))throw new TypeError("Cannot call a class as a function")}function i(m,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(f&&f.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),f&&E(m,f)}function E(m,f){return E=Object.setPrototypeOf||function(d,c){return d.__proto__=c,d},E(m,f)}function h(m){var f=C();return function(){var d=T(m),c;if(f){var M=T(this).constructor;c=Reflect.construct(d,arguments,M)}else c=d.apply(this,arguments);return t(this,c)}}function t(m,f){return f&&(l(f)==="object"||typeof f=="function")?f:g(m)}function g(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(m){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},T(m)}var P=function(m){i(r,m);var f=h(r);function r(){var d;return o(this,r),d=f.call(this),d.ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",d.BUFFERING_COMPLETED="bufferingCompleted",d.BUFFER_CLEARED="bufferCleared",d.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",d.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",d.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",d.CMSD_STATIC_HEADER="cmsdStaticHeader",d.CURRENT_TRACK_CHANGED="currentTrackChanged",d.DATA_UPDATE_COMPLETED="dataUpdateCompleted",d.INBAND_EVENTS="inbandEvents",d.INITIAL_STREAM_SWITCH="initialStreamSwitch",d.INIT_FRAGMENT_LOADED="initFragmentLoaded",d.INIT_FRAGMENT_NEEDED="initFragmentNeeded",d.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",d.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",d.LOADING_COMPLETED="loadingCompleted",d.LOADING_PROGRESS="loadingProgress",d.LOADING_DATA_PROGRESS="loadingDataProgress",d.LOADING_ABANDONED="loadingAborted",d.MANIFEST_UPDATED="manifestUpdated",d.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",d.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",d.QUOTA_EXCEEDED="quotaExceeded",d.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",d.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",d.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD="serviceLocationBlacklistAdd",d.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",d.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD="serviceLocationLocationBlacklistAdd",d.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED="serviceLocationLocationBlacklistChanged",d.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",d.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",d.SOURCE_BUFFER_ERROR="sourceBufferError",d.STREAMS_COMPOSED="streamsComposed",d.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",d.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",d.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",d.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",d.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",d.URL_RESOLUTION_FAILED="urlResolutionFailed",d.VIDEO_CHUNK_RECEIVED="videoChunkReceived",d.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",d.XLINK_ELEMENT_LOADED="xlinkElementLoaded",d.XLINK_READY="xlinkReady",d.SEEK_TARGET="seekTarget",d.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",d.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",d.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",d.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",d.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",d}return r}(p.default);let R=P},"./src/core/events/Events.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/core/events/CoreEvents.js");function l(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(d){return typeof d}:l=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},l(f)}function o(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function i(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&E(f,r)}function E(f,r){return E=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},E(f,r)}function h(f){var r=C();return function(){var c=T(f),M;if(r){var n=T(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return t(this,M)}}function t(f,r){return r&&(l(r)==="object"||typeof r=="function")?r:g(f)}function g(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(f){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},T(f)}var P=function(f){i(d,f);var r=h(d);function d(){return o(this,d),r.apply(this,arguments)}return d}(p.default),R=new P;let m=R},"./src/core/events/EventsBase.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(){p(this,h)}return o(h,[{key:"extend",value:function(g,C){if(g){var T=C?C.override:!1,P=C?C.publicOnly:!1;for(var R in g)!g.hasOwnProperty(R)||this[R]&&!T||P&&g[R].indexOf("public_")===-1||(this[R]=g[R])}}}]),h}();let E=i},"./src/dash/DashAdapter.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/dash/constants/DashConstants.js"),l=e("./src/dash/vo/RepresentationInfo.js"),o=e("./src/dash/vo/MediaInfo.js"),i=e("./src/dash/vo/StreamInfo.js"),E=e("./src/dash/vo/ManifestInfo.js"),h=e("./src/dash/vo/Event.js"),t=e("./src/core/FactoryMaker.js"),g=e("./src/dash/models/DashManifestModel.js"),C=e("./src/dash/models/PatchManifestModel.js"),T=e("./node_modules/bcp-47-normalize/index.js"),P=e.n(T);function R(){var f,r,d,c,M,n,_,u=this.context,A="urn:dvb:dash:profile:dvb-dash:2014";function D(){r=(0,g.default)(u).getInstance(),d=(0,C.default)(u).getInstance(),ze()}function j(Re){Re&&(Re.constants&&(n=Re.constants),Re.cea608parser&&(_=Re.cea608parser),Re.errHandler&&r.setConfig({errHandler:Re.errHandler}),Re.BASE64&&r.setConfig({BASE64:Re.BASE64}))}function $(Re){if(Re){var ye=new l.default,be=Re.adaptation.period.mpd.manifest.Period_asArray[Re.adaptation.period.index].AdaptationSet_asArray[Re.adaptation.index],We=r.getRepresentationFor(Re.index,be);return ye.id=Re.id,ye.quality=Re.index,ye.bandwidth=r.getBandwidth(We),ye.fragmentDuration=Re.segmentDuration||(Re.segments&&Re.segments.length>0?Re.segments[0].duration:NaN),ye.MSETimeOffset=Re.MSETimeOffset,ye.mediaInfo=at(Re.adaptation),ye}else return null}function z(Re,ye){if(c.length===0||!Re)return null;var be=st(Re,c);if(!be)return null;var We=r.getAdaptationsForPeriod(be),Qe=k(Re.index,ye,Re);if(!Qe)return null;var Ve=r.getIndexForAdaptation(Qe,c[0].mpd.manifest,Re.index);return at(We[Ve])}function ee(Re){return r.getRolesForAdaptation(Re).filter(function(ye){return ye.value===p.default.MAIN})[0]}function k(Re,ye,be){var We=r.getAdaptationsForType(c[0].mpd.manifest,Re,ye);if(!We||We.length===0)return null;if(We.length>1&&be){var Qe=H(be,ye);if(M[be.id]&&M[be.id][ye]){for(var Ve=0,rt=We.length;Ve<rt;Ve++)if(w(M[be.id][ye],Qe[Ve]))return We[Ve]}for(var ft=0,Je=We.length;ft<Je;ft++)if(ee(We[ft]))return We[ft]}return We[0]}function w(Re,ye){if(!Re||!ye)return!1;var be=Re.id===ye.id,We=Re.codec===ye.codec,Qe=Re.viewpoint===ye.viewpoint,Ve=JSON.stringify(Re.viewpointsWithSchemeIdUri)===JSON.stringify(ye.viewpointsWithSchemeIdUri),rt=Re.lang===ye.lang,ft=Re.roles.toString()===ye.roles.toString(),Je=JSON.stringify(Re.rolesWithSchemeIdUri)===JSON.stringify(ye.rolesWithSchemeIdUri),yt=Re.accessibility.toString()===ye.accessibility.toString(),At=JSON.stringify(Re.accessibilitiesWithSchemeIdUri)===JSON.stringify(ye.accessibilitiesWithSchemeIdUri),Le=Re.audioChannelConfiguration.toString()===ye.audioChannelConfiguration.toString(),Ue=JSON.stringify(Re.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(ye.audioChannelConfigurationsWithSchemeIdUri);return be&&We&&Qe&&Ve&&rt&&ft&&Je&&yt&&At&&Le&&Ue}function N(Re,ye,be,We,Qe,Ve){var rt=[],ft,Je,yt,At,Le,Ue;if(!We||We.length===0)return[];var Ze=r.getAdaptationsForPeriod(ye);for(At=0,Ue=We.length;At<Ue;At++)if(ft=We[At],yt=r.getIndexForAdaptation(ft,Re,be.index),Je=at(Ze[yt]),Ve){var dt=Je.accessibility.length;for(Le=0;Le<dt;Le++)if(Je){var vt=Je.accessibility[Le];if(vt.indexOf("cea-608:")===0){var mt=vt.substring(8),Pt=mt.split(";");if(Pt[0].substring(0,2)==="CC")for(Le=0;Le<Pt.length;Le++)Je||(Je=at.call(this,Ze[yt])),ht(Je,Pt[Le].substring(0,3),Pt[Le].substring(4)),rt.push(Je),Je=null;else for(Le=0;Le<Pt.length;Le++)Je||(Je=at.call(this,Ze[yt])),ht(Je,"CC"+(Le+1),Pt[Le]),rt.push(Je),Je=null}else vt.indexOf("cea-608")===0&&(ht(Je,n.CC1,"eng"),rt.push(Je),Je=null)}}else Qe===n.IMAGE?(Tt(Je),rt.push(Je),Je=null):Je&&rt.push(Je);return rt}function H(Re,ye,be){var We=c,Qe=be,Ve=[];if(Qe)$e(),We=L(Qe);else if(c.length>0)Qe=c[0].mpd.manifest;else return Ve;var rt=st(Re,We),ft=r.getAdaptationsForType(Qe,Re?Re.index:null,ye);return Ve=N(Qe,rt,Re,ft,ye),ye===n.TEXT&&(ft=r.getAdaptationsForType(Qe,Re?Re.index:null,n.VIDEO),Ve=Ve.concat(N(Qe,rt,Re,ft,ye,!0))),Ve}function W(Re){if(!Re)return null;$e(),c=L(Re)}function Z(Re,ye){var be=[],We=c;if(Re&&($e(),We=L(Re)),We.length>0){(!ye||ye>We.length)&&(ye=We.length);for(var Qe=0;Qe<ye;Qe++)be.push(xe(We[Qe]))}return be}function X(Re,ye){var be,We,Qe=st(Re,c);return be=ye?ye.id:null,c.length>0&&Qe&&(We=be?r.getAdaptationForId(be,c[0].mpd.manifest,Qe.index):r.getAdaptationForIndex(ye?ye.index:null,c[0].mpd.manifest,Qe.index)),We}function te(Re,ye){var be,We,Qe=st(Re,c);return be=ye?ye.id:null,c.length>0&&Qe&&(We=be?r.getAdaptationForId(be,c[0].mpd.manifest,Qe.index):r.getAdaptationForIndex(ye?ye.index:null,c[0].mpd.manifest,Qe.index)),We?r.getProducerReferenceTimesForAdaptation(We):[]}function fe(Re){try{return r.getEssentialPropertiesForRepresentation(Re)}catch{return[]}}function J(Re){return r.getRealPeriodForIndex(Re,c[0].mpd.manifest)}function ue(Re){var ye,be=ot(Re);return ye=r.getRepresentationsForAdaptation(be),ye}function pe(Re,ye,be,We){try{if(!Re||!ye||isNaN(be)||!We)return null;var Qe=Re.scheme_id_uri,Ve=Re.value;if(!ye[Qe+"/"+Ve])return null;var rt=new h.default,ft=Re.timescale||1,Je=We.adaptation.period.start,yt=ye[Qe+"/"+Ve],At=isNaN(We.presentationTimeOffset)?isNaN(yt.presentationTimeOffset)?0:yt.presentationTimeOffset:We.presentationTimeOffset,Le=Re.presentation_time_delta/ft,Ue;Re.version===0?Ue=Je+be-At+Le:Ue=Je-At+Le;var Ze=Re.event_duration/ft,dt=Re.id,vt=Re.message_data;return rt.eventStream=yt,rt.eventStream.value=Ve,rt.eventStream.timescale=ft,rt.duration=Ze,rt.id=dt,rt.calculatedPresentationTime=Ue,rt.messageData=vt,rt.presentationTimeDelta=Le,rt}catch{return null}}function Ce(Re,ye,be){var We=[];if(c.length>0){var Qe=c[0].mpd.manifest;if(Re instanceof i.default){var Ve=st(Re,c);We=r.getEventsForPeriod(Ve)}else if(Re instanceof o.default){var rt=st(be,c);We=r.getEventStreamForAdaptationSet(Qe,ot(Re),rt)}else if(Re instanceof l.default){var ft=st(be,c);We=r.getEventStreamForRepresentation(Qe,ye,ft)}}return We}function ve(Re,ye,be){M[Re]=M[Re]||{},M[Re][ye]=M[Re][ye]||{},M[Re][ye]=be}function Ee(Re){return r.getIsText(Re)}function ge(){var Re=Fe();return r.getUTCTimingSources(Re)}function Q(){var Re=c.length>0?c[0].mpd:null;return r.getSuggestedPresentationDelay(Re)}function le(Re){var ye=K(Re);return r.getAvailabilityStartTime(ye)}function Y(Re){var ye=Fe(Re);return r.getIsDynamic(ye)}function I(Re){var ye=Fe(Re);return r.getDuration(ye)}function L(Re){var ye=K(Re);return r.getRegularPeriods(ye)}function K(Re){var ye=Fe(Re);return r.getMpd(ye)}function U(Re){return r.getContentSteering(Re)}function x(Re){return r.getLocation(Re)}function y(Re){var ye=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return r.getManifestUpdatePeriod(Re,ye)}function S(Re){return r.getPublishTime(Re)}function b(Re){var ye=r.getPatchLocation(Re),be=r.getPublishTime(Re);return!ye||ye.length===0||!be?[]:ye.filter(function(We){return isNaN(We.ttl)||be.getTime()+We.ttl>new Date().getTime()})}function F(Re){return r.hasProfile(Re,A)}function oe(Re){return d.getIsPatch(Re)}function ie(Re){return r.getBaseURLsFromElement(Re)}function q(){return r.getRepresentationSortFunction()}function Ae(Re,ye,be){return r.getCodec(Re,ye,be)}function de(Re,ye){var be,We=et(ye);return be=_t(We,Re),be?be.bandwidth:null}function Me(Re,ye){var be=et(ye);return qe(be,Re)}function Ie(Re,ye){var be=et(ye);return Xe(be,Re)}function He(Re){if(!Re||c.length===0)return null;var ye=c.filter(function(be){return be.id===Re});return ye&&ye.length>0?ye[0]:null}function Be(Re,ye){return r.getIsTypeOf(Re,ye)}function ze(){c=[],M={}}function Ye(Re,ye){var be=r.getId(Re),We=d.getMpdId(ye),Qe=r.getPublishTime(Re),Ve=d.getPublishTime(ye),rt=d.getOriginalPublishTime(ye);return!!(be&&We&&be==We&&Qe&&rt&&Qe.getTime()==rt.getTime()&&Ve&&Qe.getTime()<Ve.getTime())}function Te(Re,ye){d.getPatchOperations(ye).forEach(function(be){var We=be.getMpdTarget(Re);if(We!==null){var Qe=We.name,Ve=We.target,rt=We.leaf;if(be.xpath.findsAttribute()){switch(be.action){case"add":case"replace":Ve[Qe]=be.value;break;case"remove":delete Ve[Qe];break}return}var ft=(Ve[Qe+"_asArray"]||[]).indexOf(rt),Je=be.position==="prepend"||be.position==="before";if((be.action==="remove"||be.action==="replace")&&(delete Ve[Qe],ft!=-1)){var yt=Ve[Qe+"_asArray"];yt.splice(ft,1),yt.length>1?Ve[Qe]=yt:yt.length==1?Ve[Qe]=yt[0]:delete Ve[Qe+"_asArray"]}(be.action==="add"||be.action==="replace")&&Object.keys(be.value).forEach(function(At){var Le=be.value[At],Ue=Ve[At+"_asArray"]||[];if(Ue.length===0&&Ve[At]&&Ue.push(Ve[At]),Ue.length===0)Ue=Le;else{var Ze=Ue.length;At==Qe&&ft!=-1?Ze=ft+(Je?0:1)+(be.action=="replace"?-1:0):Ze=Je?0:Ue.length,Ue.splice.apply(Ue,[Ze,0].concat(Le))}Ve[At+"_asArray"]=Ue,Ve[At]=Ue.length==1?Ue[0]:Ue})}})}function Fe(Re){return Re||(c.length>0?c[0].mpd.manifest:null)}function ot(Re){try{var ye=st(Re.streamInfo,c),be=r.getAdaptationsForPeriod(ye);return!Re||!Re.streamInfo||Re.streamInfo.id===void 0||!be?null:be[Re.index]}catch{return null}}function st(Re,ye){for(var be=ye.length,We=0;We<be;We++){var Qe=ye[We];if(Re&&Re.id===Qe.id)return Qe}return null}function at(Re){if(!Re)return null;var ye=new o.default,be=Re.period.mpd.manifest.Period_asArray[Re.period.index].AdaptationSet_asArray[Re.index],We,Qe,Ve,rt,ft;if(ye.id=Re.id,ye.index=Re.index,ye.type=Re.type,ye.streamInfo=xe(Re.period),ye.representationCount=r.getRepresentationCount(be),ye.labels=r.getLabelsForAdaptation(be),ye.lang=r.getLanguageForAdaptation(be),ye.segmentAlignment=r.getSegmentAlignment(be),ye.subSegmentAlignment=r.getSubSegmentAlignment(be),We=r.getViewpointForAdaptation(be),ye.viewpoint=We.length?We[0].value:void 0,ye.viewpointsWithSchemeIdUri=We,ft=r.getAccessibilityForAdaptation(be),ye.accessibility=ft.map(function(Ue){var Ze=Ue.value,dt=Ze;return Ue.schemeIdUri&&Ue.schemeIdUri.search("cea-608")>=0&&typeof _<"u"&&(Ze?dt="cea-608:"+Ze:dt="cea-608",ye.embeddedCaptions=!0),dt}),ye.accessibilitiesWithSchemeIdUri=ft,Qe=r.getAudioChannelConfigurationForAdaptation(be),ye.audioChannelConfiguration=Qe.map(function(Ue){return Ue.value}),ye.audioChannelConfigurationsWithSchemeIdUri=Qe,ye.audioChannelConfiguration.length===0&&Array.isArray(be.Representation_asArray)&&be.Representation_asArray.length>0&&(Ve=r.getAudioChannelConfigurationForRepresentation(be.Representation_asArray[0]),ye.audioChannelConfiguration=Ve.map(function(Ue){return Ue.value}),ye.audioChannelConfigurationsWithSchemeIdUri=Ve),rt=r.getRolesForAdaptation(be),ye.roles=rt.map(function(Ue){return Ue.value}),ye.rolesWithSchemeIdUri=rt,ye.codec=r.getCodec(be),ye.mimeType=r.getMimeType(be),ye.contentProtection=r.getContentProtectionData(be),ye.bitrateList=r.getBitrateListForAdaptation(be),ye.selectionPriority=r.getSelectionPriority(be),ye.contentProtection){var Je=ye.contentProtection.map(function(Ue){return r.getKID(Ue)}).filter(function(Ue){return Ue!==null});if(Je.length){var yt=Je[0];ye.contentProtection.forEach(function(Ue){Ue.keyId=yt})}}if(ye.isText=r.getIsText(be),ye.supplementalProperties=r.getSupplementalPropertiesForAdaptation(be),(!ye.supplementalProperties||Object.keys(ye.supplementalProperties).length===0)&&Array.isArray(be.Representation_asArray)&&be.Representation_asArray.length>0){var At=be.Representation_asArray.map(function(Ue){return r.getSupplementalPropertiesForRepresentation(Ue)});At.every(function(Ue){return JSON.stringify(Ue)===JSON.stringify(At[0])})&&(ye.supplementalProperties=At[0])}if(ye.supplementalPropertiesAsArray=r.getSupplementalPropertiesAsArrayForAdaptation(be),(!ye.supplementalPropertiesAsArray||ye.supplementalPropertiesAsArray.length===0)&&Array.isArray(be.Representation_asArray)&&be.Representation_asArray.length>0){var Le=be.Representation_asArray.map(function(Ue){return r.getSupplementalPropertiesAsArrayForRepresentation(Ue)});Le.every(function(Ue){return JSON.stringify(Ue)===JSON.stringify(Le[0])})&&(ye.supplementalPropertiesAsArray=Le[0])}return ye.isFragmented=r.getIsFragmented(be),ye.isEmbedded=!1,ye}function ht(Re,ye,be){Re.id=ye,Re.index=100+parseInt(ye.substring(2,3)),Re.type=n.TEXT,Re.codec="cea-608-in-SEI",Re.isEmbedded=!0,Re.isFragmented=!1,Re.lang=P()(be),Re.roles=["caption"],Re.rolesWithSchemeIdUri=[{schemeIdUri:"urn:mpeg:dash:role:2011",value:"caption"}]}function Tt(Re){Re.type=n.IMAGE}function xe(Re){var ye=new i.default,be=1;return ye.id=Re.id,ye.index=Re.index,ye.start=Re.start,ye.duration=Re.duration,ye.manifestInfo=we(Re.mpd),ye.isLast=Re.mpd.manifest.Period_asArray.length===1||Math.abs(ye.start+ye.duration-ye.manifestInfo.duration)<be,ye}function we(Re){var ye=new E.default;return ye.dvrWindowSize=Re.timeShiftBufferDepth,ye.loadedTime=Re.manifest.loadedTime,ye.availableFrom=Re.availabilityStartTime,ye.minBufferTime=Re.manifest.minBufferTime,ye.maxFragmentDuration=Re.maxSegmentDuration,ye.duration=r.getDuration(Re.manifest),ye.isDynamic=r.getIsDynamic(Re.manifest),ye.serviceDescriptions=r.getServiceDescriptions(Re.manifest),ye.protocol=Re.manifest.protocol,ye}function $e(){if(!n)throw new Error("setConfig function has to be called previously")}function et(Re){return c.length>0?c[0].mpd.manifest.Period_asArray[Re]:null}function qe(Re,ye){var be=_t(Re,ye,!0);return be!==null?be:-1}function _t(Re,ye,be){var We,Qe,Ve,rt,ft,Je;if(Re){for(Qe=Re.AdaptationSet_asArray,ft=0;ft<Qe.length;ft=ft+1)for(We=Qe[ft],rt=We.Representation_asArray,Je=0;Je<rt.length;Je=Je+1)if(Ve=rt[Je],ye===Ve.id)return be?Je:Ve}return null}function Xe(Re,ye){var be,We,Qe,Ve;if(!Re||!ye)return-1;for(We=Re.AdaptationSet_asArray,Ve=0;Ve<We.length;Ve=Ve+1)if(be=We[Ve],Qe=be.Representation_asArray,r.getIsTypeOf(be,ye))return Qe.length;return-1}return f={getBandwidthForRepresentation:de,getIndexForRepresentation:Me,getMaxIndexForBufferType:Ie,convertRepresentationToRepresentationInfo:$,getStreamsInfo:Z,getMediaInfoForType:z,getAllMediaInfoForType:H,getAdaptationForType:k,getRealAdaptation:X,getProducerReferenceTimes:te,getRealPeriodByIndex:J,getEssentialPropertiesForRepresentation:fe,getVoRepresentations:ue,getEventsFor:Ce,getEvent:pe,getMpd:K,setConfig:j,updatePeriods:W,getIsTextTrack:Ee,getUTCTimingSources:ge,getSuggestedPresentationDelay:Q,getAvailabilityStartTime:le,getIsTypeOf:Be,getIsDynamic:Y,getDuration:I,getRegularPeriods:L,getContentSteering:U,getLocation:x,getPatchLocation:b,getManifestUpdatePeriod:y,getPublishTime:S,getIsDVB:F,getIsPatch:oe,getBaseURLsFromElement:ie,getRepresentationSortFunction:q,getCodec:Ae,getPeriodById:He,setCurrentMediaInfo:ve,isPatchValid:Ye,applyPatchToManifest:Te,areMediaInfosEqual:w,reset:ze},D(),f}R.__dashjs_factory_name="DashAdapter";let m=t.default.getSingletonFactory(R)},"./src/dash/DashHandler.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/streaming/vo/FragmentRequest.js"),l=e("./src/streaming/vo/metrics/HTTPRequest.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/streaming/MediaPlayerEvents.js"),E=e("./src/dash/utils/SegmentsUtils.js"),h=e("./src/dash/constants/DashConstants.js"),t=.5,g=.001;function C(P){P=P||{};var R=P.eventBus,m=P.debug,f=P.urlUtils,r=P.type,d=P.streamInfo,c=P.segmentsController,M=P.timelineConverter,n=P.baseURLController,_,u,A,D,j;function $(){u=m.getLogger(_),N(),R.on(i.default.DYNAMIC_TO_STATIC,Ee,_)}function z(ge){D=ge,j=!1,c.initialize(ge)}function ee(){return d.id}function k(){return r}function w(){return d}function N(){A=null}function H(){N(),R.off(i.default.DYNAMIC_TO_STATIC,Ee,_)}function W(ge,Q,le){var Y=n.resolve(le.path),I,L,K={};return!Y||Q===Y.url||!f.isRelative(Q)?I=Q:(I=Y.url,L=Y.serviceLocation,K=Y.queryParams,Q&&(I=f.resolve(Q,I))),f.isRelative(I)?!1:(ge.url=I,ge.serviceLocation=L,ge.queryParams=K,!0)}function Z(ge,Q){return Q?X(ge,Q,k()):null}function X(ge,Q,le){var Y=new p.default,I=Q.adaptation.period,L=I.start;if(Y.mediaType=le,Y.type=l.HTTPRequest.INIT_SEGMENT_TYPE,Y.range=Q.range,Y.availabilityStartTime=M.calcAvailabilityStartTimeFromPresentationTime(L,Q,D),Y.availabilityEndTime=M.calcAvailabilityEndTimeFromPresentationTime(L+I.duration,Q,D),Y.quality=Q.index,Y.mediaInfo=ge,Y.representationId=Q.id,W(Y,Q.initialization,Q))return Y.url=(0,E.replaceTokenForTemplate)(Y.url,"Bandwidth",Q.bandwidth),Y}function te(ge,Q){if(Q==null)return null;var le=new p.default,Y=Q.representation,I=Y.adaptation.period.mpd.manifest.Period_asArray[Y.adaptation.period.index].AdaptationSet_asArray[Y.adaptation.index].Representation_asArray[Y.index].bandwidth,L=Q.media;if(L=(0,E.replaceTokenForTemplate)(L,"Number",Q.replacementNumber),L=(0,E.replaceTokenForTemplate)(L,"Time",Q.replacementTime),L=(0,E.replaceTokenForTemplate)(L,"Bandwidth",I),L=(0,E.replaceIDForTemplate)(L,Y.id),L=(0,E.unescapeDollarsInTemplate)(L),le.mediaType=k(),le.type=l.HTTPRequest.MEDIA_SEGMENT_TYPE,le.range=Q.mediaRange,le.startTime=Q.presentationStartTime,le.mediaStartTime=Q.mediaStartTime,le.duration=Q.duration,le.timescale=Y.timescale,le.availabilityStartTime=Q.availabilityStartTime,le.availabilityEndTime=Q.availabilityEndTime,le.availabilityTimeComplete=Y.availabilityTimeComplete,le.wallStartTime=Q.wallStartTime,le.quality=Y.index,le.index=Q.index,le.mediaInfo=ge,le.adaptationIndex=Y.adaptation.index,le.representationId=Y.id,W(le,L,Y))return le}function fe(ge,Q){if(!ge||!A)return!1;if(j)return!0;if(!isFinite(ge.adaptation.period.duration)||A.presentationStartTime+A.duration>Q)return!1;if(ge.mediaFinishedInformation&&!isNaN(ge.mediaFinishedInformation.numberOfSegments)&&!isNaN(A.index)&&A.index>=ge.mediaFinishedInformation.numberOfSegments-1){if(!D||ge.segmentInfoType===h.default.SEGMENT_TEMPLATE)return!0;if(D&&ge.segmentInfoType===h.default.SEGMENT_LIST&&ge.adaptation.period.nextPeriodId)return!0}return!!(D&&ge.adaptation.period.nextPeriodId&&ge.segmentInfoType===h.default.SEGMENT_TIMELINE&&ge.mediaFinishedInformation&&!isNaN(ge.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&A&&!isNaN(A.mediaStartTime)&&!isNaN(A.duration)&&A.mediaStartTime+A.duration>=ge.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)}function J(ge,Q,le){var Y=null;if(!Q||!Q.segmentInfoType)return Y;var I=c.getSegmentByTime(Q,le);return I&&(A=I,u.debug("Index for time "+le+" is "+I.index),Y=te(ge,I)),Y}function ue(ge,Q){var le=null,Y=A?A.index+1:0,I=c.getSegmentByIndex(Q,Y,A?A.mediaStartTime:-1);return I?(le=te(ge,I),le):null}function pe(ge,Q){var le=null;if(!Q||!Q.segmentInfoType)return null;var Y=A?A.index+1:0,I=c.getSegmentByIndex(Q,Y,A?A.mediaStartTime:-1);if(I)le=te(ge,I),A=I;else{if(D&&!j)return u.debug(k()+" No segment found at index: "+Y+". Wait for next loop"),null;j=!0}return le}function Ce(ge,Q,le,Y){try{if(isNaN(ge)||!Q||!le)return NaN;if(ge<0&&(ge=0),isNaN(Y)&&(Y=t),J(Q,le,ge))return ge;if(le.adaptation.period.start+le.adaptation.period.duration<ge)return NaN;for(var I=isFinite(le.adaptation.period.duration)?le.adaptation.period.start+le.adaptation.period.duration:ge+30,L=Math.min(ge+Y,I),K=NaN,U=null;L<=I;){var x=null;if(L<=I&&(x=J(Q,le,L)),x){K=L,U=x;break}L+=Y}if(U){var y=U.startTime+U.duration;return ge>U.startTime&&y-ge>Y?ge:!isNaN(U.startTime)&&ge<U.startTime&&K>U.startTime?U.startTime+g:Math.min(y-Y,K)}return K}catch{return NaN}}function ve(){return A?A.index:-1}function Ee(){u.debug("Dynamic stream complete"),j=!0}return _={initialize:z,getStreamId:ee,getType:k,getStreamInfo:w,getInitRequest:Z,getSegmentRequestForTime:J,getCurrentIndex:ve,getNextSegmentRequest:pe,isLastSegmentRequested:fe,reset:H,getNextSegmentRequestIdempotent:ue,getValidTimeAheadOfTargetTime:Ce},$(),_}C.__dashjs_factory_name="DashHandler";let T=o.default.getClassFactory(C)},"./src/dash/DashMetrics.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/vo/metrics/HTTPRequest.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/streaming/constants/MetricsConstants.js"),E=e("./src/dash/utils/Round10.js"),h=e("./src/streaming/models/MetricsModel.js"),t=e("./src/core/Utils.js"),g=e("./src/streaming/vo/metrics/PlayList.js");function C(P){P=P||{};var R=this.context,m,f,r,d,c=P.metricsModel;function M(){c=c||(0,h.default)(R).getInstance({settings:P.settings}),n()}function n(){f=!0,r=null,d=null}function _(x){var y=c.getMetricsFor(x,!0);return N(y,i.default.TRACK_SWITCH)}function u(x,y,S,b,F){c.addRepresentationSwitch(x,y,S,b,F)}function A(x){var y=c.getMetricsFor(x,!0);return N(y,i.default.BUFFER_STATE)}function D(x){var y=c.getMetricsFor(x,!0),S=N(y,i.default.BUFFER_LEVEL);return S?E.default.round10(S.level/1e3,-3):0}function j(x,y,S){c.addBufferLevel(x,y,S)}function $(x,y,S){c.addBufferState(x,y,S)}function z(){c.clearAllCurrentMetrics()}function ee(x){var y=c.getMetricsFor(x,!0);if(!y)return null;var S=y.HttpList,b=null,F;if(!S||S.length<=0)return null;for(F=S.length-1;F>=0;){if(S[F].responsecode){b=S[F];break}F--}return b}function k(x){var y=c.getMetricsFor(x,!0);return y?y.HttpList?y.HttpList:[]:[]}function w(x,y,S){c.addRequestsQueue(x,y,S)}function N(x,y){if(!x)return null;var S=x[y];return!S||S.length===0?null:S[S.length-1]}function H(){var x=c.getMetricsFor(p.default.VIDEO,!0);return N(x,i.default.DROPPED_FRAMES)}function W(x){c.addDroppedFrames(p.default.VIDEO,x)}function Z(x){var y=c.getMetricsFor(x,!0);return N(y,i.default.SCHEDULING_INFO)}function X(x,y){c.addSchedulingInfo(x.mediaType,new Date,x.type,x.startTime,x.availabilityStartTime,x.duration,x.quality,x.range,y)}function te(){var x=c.getMetricsFor(p.default.STREAM);return N(x,i.default.MANIFEST_UPDATE)}function fe(x){var y=this.getCurrentManifestUpdate();c.updateManifestUpdateInfo(y,x)}function J(x){if(x){var y=this.getCurrentManifestUpdate();c.addManifestUpdateStreamInfo(y,x.id,x.index,x.start,x.duration)}}function ue(x){c.addManifestUpdate(p.default.STREAM,x.type,x.requestStartDate,x.requestEndDate)}function pe(x,y,S,b,F,oe){c.addHttpRequest(x.mediaType,null,x.type,x.url,x.quality,y,x.serviceLocation||null,x.range||null,x.requestStartDate,x.firstByteDate,x.requestEndDate,S,x.duration,b,F,x.fileLoaderType,oe)}function Ce(x,y){if(x){var S=this.getCurrentManifestUpdate();c.addManifestUpdateRepresentationInfo(S,x.id,x.index,x.streamIndex,y,x.presentationTimeOffset,x.startNumber,x.fragmentInfoType)}}function ve(x){var y=x?c.getMetricsFor(x,!0):c.getMetricsFor(p.default.VIDEO,!0)||c.getMetricsFor(p.default.AUDIO,!0);return N(y,i.default.DVR_INFO)}function Ee(x,y,S,b){c.addDVRInfo(x,y,S,b)}function ge(x){if(!x)return null;var y={},S,b,F;for(S=k(p.default.STREAM),F=S.length-1;F>=0;F--)if(b=S[F],b.type===l.HTTPRequest.MPD_TYPE){y=t.default.parseHttpHeaders(b._responseHeaders);break}var oe=y[x.toLowerCase()];return oe===void 0?null:oe}function Q(x,y){if(!y)return null;var S={},b=ee(x);b&&(S=t.default.parseHttpHeaders(b._responseHeaders));var F=S[y.toLowerCase()];return F===void 0?null:F}function le(){d&&(c.addPlayList(d),d=null)}function Y(x,y){d=new g.PlayList,d.start=new Date,d.mstart=x,d.starttype=y}function I(x,y,S){f===!0&&(f=!1,r=new g.PlayListTrace,r.representationid=x,r.start=new Date,r.mstart=y,r.playbackspeed=S!==null?S.toString():null)}function L(x){if(r)for(var y in r)r[y]=x[y]}function K(x,y){if(f===!1&&d&&r&&r.start){var S=r.start,b=x.getTime()-S.getTime();r.duration=b,r.stopreason=y,d.trace.push(r),f=!0}}function U(x){c.addDVBErrors(x)}return m={getCurrentRepresentationSwitch:_,getCurrentBufferState:A,getCurrentBufferLevel:D,getCurrentHttpRequest:ee,getHttpRequests:k,getCurrentDroppedFrames:H,getCurrentSchedulingInfo:Z,getCurrentDVRInfo:ve,getCurrentManifestUpdate:te,getLatestFragmentRequestHeaderValueByID:Q,getLatestMPDRequestHeaderValueByID:ge,addRepresentationSwitch:u,addDVRInfo:Ee,updateManifestUpdateInfo:fe,addManifestUpdateStreamInfo:J,addManifestUpdateRepresentationInfo:Ce,addManifestUpdate:ue,addHttpRequest:pe,addSchedulingInfo:X,addRequestsQueue:w,addBufferLevel:j,addBufferState:$,addDroppedFrames:W,addPlayList:le,addDVBErrors:U,createPlaylistMetrics:Y,createPlaylistTraceMetrics:I,updatePlayListTraceMetrics:L,pushPlayListTraceMetrics:K,clearAllCurrentMetrics:z},M(),m}C.__dashjs_factory_name="DashMetrics";let T=o.default.getSingletonFactory(C)},"./src/dash/SegmentBaseLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/dash/vo/Segment.js"),l=e("./src/streaming/vo/DashJSError.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/streaming/vo/FragmentRequest.js"),E=e("./src/streaming/net/URLLoader.js");function h(){var g=this.context,C,T,P,R,m,f,r,d,c,M,n,_,u;function A(){}function D(){d=(0,E.default)(g).create({errHandler:P,dashMetrics:f,mediaPlayerModel:r,requestModifier:m,boxParser:R,errors:c,urlUtils:_,constants:M,dashConstants:n})}function j(Z){Z.baseURLController&&(u=Z.baseURLController),Z.dashMetrics&&(f=Z.dashMetrics),Z.mediaPlayerModel&&(r=Z.mediaPlayerModel),Z.errHandler&&(P=Z.errHandler),Z.boxParser&&(R=Z.boxParser),Z.debug&&(T=Z.debug.getLogger(C)),Z.requestModifier&&(m=Z.requestModifier),Z.errors&&(c=Z.errors),Z.urlUtils&&(_=Z.urlUtils),Z.constants&&(M=Z.constants),Z.dashConstants&&(n=Z.dashConstants)}function $(Z,X){return new Promise(function(te){z(Z,X,te)})}function z(Z,X,te,fe){var J=null,ue=Z?u.resolve(Z.path):null,pe=fe||{init:!0,url:ue?ue.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:X};T.debug("Start searching for initialization.");var Ce=W(pe),ve=function(Q){if(pe.bytesLoaded=pe.range.end,J=R.findInitRange(Q),J)Z.range=J,te(Z);else return pe.range.end=pe.bytesLoaded+pe.bytesToLoad,z(Z,X,te,pe)},Ee=function(){te(Z)};d.load({request:Ce,success:ve,error:Ee}),T.debug("Perform init search: "+pe.url)}function ee(Z,X,te){return new Promise(function(fe){k(Z,X,te,fe)})}function k(Z,X,te,fe,J,ue){if(te&&(te.start===void 0||te.end===void 0)){var pe=te?te.toString().split("-"):null;te=pe?{start:parseFloat(pe[0]),end:parseFloat(pe[1])}:null}J=J||w;var Ce=null,ve=null,Ee=!!te,ge=Z?u.resolve(Z.path):null,Q={init:!1,url:ge?ge.url:void 0,range:Ee?te:{start:0,end:1500},searching:!Ee,bytesLoaded:ue?ue.bytesLoaded:0,bytesToLoad:1500,mediaType:X},le=W(Q),Y=function(K){var U=Q.bytesToLoad,x=K.byteLength;if(Q.bytesLoaded=Q.range.end-Q.range.start,Ce=R.parse(K),ve=Ce.getBox("sidx"),!ve||!ve.isComplete){if(ve)Q.range.start=ve.offset||Q.range.start,Q.range.end=Q.range.start+(ve.size||U);else if(x<Q.bytesLoaded){J(null,Z,fe);return}else{var y=Ce.getLastBox();y&&y.size?(Q.range.start=y.offset+y.size,Q.range.end=Q.range.start+U):Q.range.end+=U}k(Z,X,Q.range,fe,null,Q)}else{var S=ve.references,b,F;if(S!=null&&S.length>0&&(b=S[0].reference_type===1),b){T.debug("Initiate multiple SIDX load."),Q.range.end=Q.range.start+ve.size;var oe,ie,q,Ae,de,Me=[],Ie=0,He=(ve.offset||Q.range.start)+ve.size,Be=function(Ye){Ye?(Me=Me.concat(Ye),Ie++,Ie>=ie&&(Me.sort(function(Te,Fe){return Te.startTime-Fe.startTime<0?-1:0}),J(Me,Z,fe))):J(null,Z,fe)};for(oe=0,ie=S.length;oe<ie;oe++)q=He,Ae=He+S[oe].referenced_size-1,He=He+S[oe].referenced_size,de={start:q,end:Ae},k(Z,X,de,fe,Be,Q)}else T.debug("Parsing segments from SIDX. representation "+X+" - id: "+Z.id+" for range : "+Q.range.start+" - "+Q.range.end),F=H(ve,Q),J(F,Z,fe)}},I=function(){J(null,Z,fe)};d.load({request:le,success:Y,error:I}),T.debug("Perform SIDX load for type ".concat(X," : ").concat(Q.url," with range ").concat(Q.range.start," - ").concat(Q.range.end))}function w(Z,X,te){te({segments:Z,representation:X,error:Z?void 0:new l.default(c.SEGMENT_BASE_LOADER_ERROR_CODE,c.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function N(){d&&(d.abort(),d=null)}function H(Z,X){for(var te=Z.references,fe=te.length,J=Z.timescale,ue=Z.earliest_presentation_time,pe=X.range.start+Z.offset+Z.first_offset+Z.size,Ce=[],ve,Ee,ge,Q,le=0;le<fe;le++)ge=te[le].subsegment_duration,Q=te[le].referenced_size,ve=new p.default,ve.duration=ge,ve.startTime=ue,ve.timescale=J,Ee=pe+Q-1,ve.mediaRange=pe+"-"+Ee,Ce.push(ve),ue+=ge,pe+=Q;return Ce}function W(Z){if(Z.url){var X=new i.default;return X.setInfo(Z),X}}return C={setConfig:j,initialize:D,loadInitialization:$,loadSegments:ee,reset:N},C}h.__dashjs_factory_name="SegmentBaseLoader";let t=o.default.getSingletonFactory(h)},"./src/dash/WebmSegmentBaseLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>C});var p=e("./src/streaming/utils/EBMLParser.js"),l=e("./src/streaming/constants/Constants.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/dash/vo/Segment.js"),E=e("./src/streaming/vo/FragmentRequest.js"),h=e("./src/streaming/net/URLLoader.js"),t=e("./src/streaming/vo/DashJSError.js");function g(){var T=this.context,P,R,m,f,r,d,c,M,n,_;function u(){m={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}}}function A(){M=(0,h.default)(T).create({errHandler:f,dashMetrics:d,mediaPlayerModel:c,requestModifier:r,errors:n})}function D(H){if(!H.baseURLController||!H.dashMetrics||!H.mediaPlayerModel||!H.errHandler)throw new Error(l.default.MISSING_CONFIG_ERROR);_=H.baseURLController,d=H.dashMetrics,c=H.mediaPlayerModel,f=H.errHandler,n=H.errors,R=H.debug.getLogger(P),r=H.requestModifier}function j(H){var W=[],Z=(0,p.default)(T).create({data:H}),X,te;for(Z.consumeTagAndSize(m.Segment.Cues);Z.moreData()&&Z.consumeTagAndSize(m.Segment.Cues.CuePoint,!0);){for(X={},X.CueTime=Z.parseTag(m.Segment.Cues.CuePoint.CueTime),X.CueTracks=[];Z.moreData()&&Z.consumeTag(m.Segment.Cues.CuePoint.CueTrackPositions,!0);){var fe=Z.getMatroskaCodedNum(),J=Z.getPos();if(te={},te.Track=Z.parseTag(m.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),te.Track===0)throw new Error("Cue track cannot be 0");te.ClusterPosition=Z.parseTag(m.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),X.CueTracks.push(te),Z.setPos(J+fe)}if(X.CueTracks.length===0)throw new Error("Mandatory cuetrack not found");W.push(X)}if(W.length===0)throw new Error("mandatory cuepoint not found");return W}function $(H,W,Z,X){var te,fe,J,ue,pe,Ce,ve,Ee;for(fe=j(H),J=[],pe=0,Ce=fe.length;pe<Ce;pe+=1)ue=new i.default,te=0,pe<fe.length-1?te=fe[pe+1].CueTime-fe[pe].CueTime:te=X-fe[pe].CueTime,ue.duration=te,ue.startTime=fe[pe].CueTime,ue.timescale=1e3,ve=fe[pe].CueTracks[0].ClusterPosition+W,pe<fe.length-1?Ee=fe[pe+1].CueTracks[0].ClusterPosition+W-1:Ee=Z-1,ue.mediaRange=ve+"-"+Ee,J.push(ue);return R.debug("Parsed cues: "+J.length+" cues."),J}function z(H,W,Z,X){if(!H||H.byteLength===0){X(null);return}var te=(0,p.default)(T).create({data:H}),fe,J,ue,pe,Ce=Z?Z.split("-"):null,ve=null,Ee={url:W,range:{start:Ce?parseFloat(Ce[0]):null,end:Ce?parseFloat(Ce[1]):null},request:ve};for(R.debug("Parse EBML header: "+Ee.url),te.skipOverElement(m.EBML),te.consumeTag(m.Segment),ue=te.getMatroskaCodedNum(),ue+=te.getPos(),pe=te.getPos();te.moreData()&&!te.consumeTagAndSize(m.Segment.Info,!0);)if(!(te.skipOverElement(m.Segment.SeekHead,!0)||te.skipOverElement(m.Segment.Tracks,!0)||te.skipOverElement(m.Segment.Cues,!0)||te.skipOverElement(m.Void,!0)))throw new Error("no valid top level element found");for(;fe===void 0;){var ge=te.getMatroskaCodedNum(!0),Q=te.getMatroskaCodedNum();switch(ge){case m.Segment.Info.Duration.tag:fe=te[m.Segment.Info.Duration.parse](Q);break;default:te.setPos(te.getPos()+Q);break}}ve=w(Ee);var le=function(L){J=$(L,pe,ue,fe),X(J)},Y=function(){R.error("Download Error: Cues "+Ee.url),X(null)};M.load({request:ve,success:le,error:Y}),R.debug("Perform cues load: "+Ee.url+" bytes="+Ee.range.start+"-"+Ee.range.end)}function ee(H,W){return new Promise(function(Z){var X=null,te=H?_.resolve(H.path):null,fe=H?H.range.split("-"):null,J={range:{start:fe?parseFloat(fe[0]):null,end:fe?parseFloat(fe[1]):null},request:X,url:te?te.url:void 0,init:!0,mediaType:W};R.info("Start loading initialization."),X=w(J);var ue=function(){Z(H)},pe=function(){Z(H)};M.load({request:X,success:ue,error:pe}),R.debug("Perform init load: "+J.url)})}function k(H,W,Z){return new Promise(function(X){var te=null,fe=H?_.resolve(H.path):null,J=fe?fe.url:void 0,ue=8192,pe={bytesLoaded:0,bytesToLoad:ue,range:{start:0,end:ue},request:te,url:J,init:!1,mediaType:W};te=w(pe),R.debug("Parsing ebml header");var Ce=function(ge){z(ge,J,Z,function(Q){X({segments:Q,representation:H,error:Q?void 0:new t.default(n.SEGMENT_BASE_LOADER_ERROR_CODE,n.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})})},ve=function(){X({representation:H,error:new t.default(n.SEGMENT_BASE_LOADER_ERROR_CODE,n.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})};M.load({request:te,success:Ce,error:ve})})}function w(H){var W=new E.default;return W.setInfo(H),W}function N(){M&&(M.abort(),M=null)}return P={setConfig:D,initialize:A,loadInitialization:ee,loadSegments:k,reset:N},u(),P}g.__dashjs_factory_name="WebmSegmentBaseLoader";let C=o.default.getSingletonFactory(g)},"./src/dash/constants/DashConstants.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});function p(t,g){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}function l(t,g){for(var C=0;C<g.length;C++){var T=g[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(t,T.key,T)}}function o(t,g,C){return g&&l(t.prototype,g),C&&l(t,C),t}var i=function(){function t(){p(this,t),this.init()}return o(t,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.SUPPLEMENTAL_PROPERTY_ASARRAY="SupplementalProperty_asArray",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.INBAND="inband",this.TYPE="type",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.VIEWPOINT_ASARRAY="Viewpoint_asArray",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PATCH_LOCATION_AS_ARRAY="PatchLocation_asArray",this.LOCATION="Location",this.LOCATION_AS_ARRAY="Location_asArray",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.CLIENT_REQUIREMENT="clientRequirement",this.TTL="ttl",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",PATHWAY_PRIORITY:"PATHWAY-PRIORITY",PATHWAY_CLONES:"PATHWAY-CLONES",BASE_ID:"BASE-ID",ID:"ID",URI_REPLACEMENT:"URI-REPLACEMENT",HOST:"HOST",PARAMS:"PARAMS"},this.PRODUCER_REFERENCE_TIME_TYPE={ENCODER:"encoder",CAPTURED:"captured",APPLICATION:"application"},this.SEGMENT_ALIGNMENT="segmentAlignment",this.SUB_SEGMENT_ALIGNMENT="subsegmentAlignment"}}]),t}(),E=new i;let h=E},"./src/dash/controllers/ContentSteeringController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>d});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/streaming/net/URLLoader.js"),i=e("./src/core/errors/Errors.js"),E=e("./src/dash/vo/ContentSteeringRequest.js"),h=e("./src/dash/vo/ContentSteeringResponse.js"),t=e("./src/dash/constants/DashConstants.js"),g=e("./src/streaming/MediaPlayerEvents.js"),C=e("./src/streaming/utils/URLUtils.js"),T=e("./src/dash/vo/BaseURL.js"),P=e("./src/dash/vo/MpdLocation.js"),R=e("./src/core/Utils.js"),m={THROUGHPUT:"_DASH_throughput",PATHWAY:"_DASH_pathway",URL:"url"},f=4;function r(){var c=this.context,M=(0,C.default)(c).getInstance(),n,_,u,A,D,j,$,z,ee,k,w,N,H,W,Z;function X(){_=(0,l.default)(c).getInstance().getLogger(n),Ae()}function te(de){de&&(de.adapter&&(Z=de.adapter),de.errHandler&&(z=de.errHandler),de.dashMetrics&&(ee=de.dashMetrics),de.mediaPlayerModel&&(k=de.mediaPlayerModel),de.requestModifier&&(N=de.requestModifier),de.manifestModel&&(w=de.manifestModel),de.serviceDescriptionController&&(H=de.serviceDescriptionController),de.eventBus&&(W=de.eventBus))}function fe(){$=(0,o.default)(c).create({errHandler:z,dashMetrics:ee,mediaPlayerModel:k,requestModifier:N,errors:i.default}),W.on(g.default.FRAGMENT_LOADING_STARTED,J,n),W.on(g.default.MANIFEST_LOADING_STARTED,ue,n),W.on(g.default.MANIFEST_LOADING_FINISHED,pe,n),W.on(g.default.THROUGHPUT_MEASUREMENT_STORED,Ce,n)}function J(de){Ee(de,"baseUrl")}function ue(de){Ee(de,"location")}function pe(de){if(!(!de||!de.request||!de.request.serviceLocation||!de.request.requestStartDate||!de.request.requestEndDate||isNaN(de.request.bytesTotal))){var Me=de.request.serviceLocation,Ie=de.request.requestEndDate.getTime()-de.request.requestStartDate.getTime(),He=parseInt(de.request.bytesTotal*8/Ie*1e3);ve(Me,He)}}function Ce(de){if(!(!de||!de.httpRequest||!de.httpRequest._serviceLocation||isNaN(de.throughput))){var Me=de.httpRequest._serviceLocation,Ie=de.throughput*1e3;ve(Me,Ie)}}function ve(de,Me){D[de]||(D[de]=[]),D[de].push(Me),D[de].length>f&&D[de].shift()}function Ee(de,Me){if(de&&de.request&&de.request.serviceLocation){var Ie=de.request.serviceLocation;A[Me].all.indexOf(Ie)===-1&&A[Me].all.push(Ie),A[Me].current=Ie}}function ge(){var de=w.getValue(),Me=Z.getContentSteering(de);return Me||(Me=H.getServiceDescriptionSettings().contentSteering),Me}function Q(){var de=ge();return!!de&&de.queryBeforeStart}function le(){return new Promise(function(de){try{var Me=ge();if(!Me||!Me.serverUrl){de();return}var Ie=I(Me),He=new E.default(Ie);$.load({request:He,success:function(ze){K(ze),W.trigger(g.default.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:u,url:Ie}),de()},error:function(ze,Ye,Te,Fe){oe(ze,Fe),de(ze)},complete:function(){A.baseUrl.all=Y(A.baseUrl),A.location.all=Y(A.location)}})}catch(Be){de(Be)}})}function Y(de){return!de.all||de.all.length===0||!de.current?[]:de.all.filter(function(Me){return Me===de.current})}function I(de){var Me=de.serverUrl;u&&u.reloadUri&&(M.isRelative(u.reloadUri)?Me=M.resolve(u.reloadUri,de.serverUrl):Me=u.reloadUri);var Ie=[],He=A.baseUrl.all.concat(A.location.all);if(He.length>0){var Be=He.map(function(Te){var Fe=L(Te);return{serviceLocation:Te,throughput:Fe}});Be.sort(function(Te,Fe){return Fe.throughput-Te.throughput});var ze="",Ye="";Be.forEach(function(Te,Fe){Fe!==0&&(ze="".concat(ze,","),Te.throughput>-1&&(Ye="".concat(Ye,","))),ze="".concat(ze).concat(Te.serviceLocation),Te.throughput>-1&&(Ye="".concat(Ye).concat(Te.throughput))}),Ie.push({key:m.PATHWAY,value:'"'.concat(ze,'"')}),Ie.push({key:m.THROUGHPUT,value:Ye})}return Me=R.default.addAditionalQueryParameterToUrl(Me,Ie),Me}function L(de){if(!de||!D[de]||D[de].length===0)return-1;var Me=D[de].reduce(function(Ie,He){return Ie+He})/D[de].length;return parseInt(Me)}function K(de){!de||!de[t.default.CONTENT_STEERING_RESPONSE.VERSION]||parseInt(de[t.default.CONTENT_STEERING_RESPONSE.VERSION])!==1||(u=new h.default,u.version=de[t.default.CONTENT_STEERING_RESPONSE.VERSION],de[t.default.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN(de[t.default.CONTENT_STEERING_RESPONSE.TTL])&&(u.ttl=de[t.default.CONTENT_STEERING_RESPONSE.TTL]),de[t.default.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(u.reloadUri=de[t.default.CONTENT_STEERING_RESPONSE.RELOAD_URI]),de[t.default.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]&&(u.pathwayPriority=de[t.default.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]),de[t.default.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES]&&(u.pathwayClones=de[t.default.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES],u.pathwayClones=u.pathwayClones.filter(function(Me){return U(Me)})),b())}function U(de){return de[t.default.CONTENT_STEERING_RESPONSE.BASE_ID]&&de[t.default.CONTENT_STEERING_RESPONSE.ID]&&de[t.default.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT]&&de[t.default.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][t.default.CONTENT_STEERING_RESPONSE.HOST]}function x(de){try{var Me=S(de);return Me.map(function(Ie){var He=new T.default(Ie.synthesizedUrl,Ie.serviceLocation);return He.queryParams=Ie.queryParams,He.dvb_priority=Ie.reference.dvb_priority,He.dvb_weight=Ie.reference.dvb_weight,He.availabilityTimeOffset=Ie.reference.availabilityTimeOffset,He.availabilityTimeComplete=Ie.reference.availabilityTimeComplete,He})}catch(Ie){return _.error(Ie),[]}}function y(de){try{var Me=S(de);return Me.map(function(Ie){var He=new P.default(Ie.synthesizedUrl,Ie.serviceLocation);return He.queryParams=Ie.queryParams,He})}catch(Ie){return _.error(Ie),[]}}function S(de){try{var Me=[];return!de||de.length===0||!u||!u.pathwayClones||u.pathwayClones.length===0||u.pathwayClones.forEach(function(Ie){var He=de.filter(function(Fe){return Ie[t.default.CONTENT_STEERING_RESPONSE.BASE_ID]===Fe.serviceLocation}),Be=null;if(He&&He.length>0&&(Be=He[0]),Be){var ze=new URL(Be.url),Ye=Ie[t.default.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][t.default.CONTENT_STEERING_RESPONSE.HOST];Ye=R.default.stringHasProtocol(Ye)?Ye:"".concat(ze.protocol,"//").concat(Ye);var Te={synthesizedUrl:"".concat(Ye).concat(ze.pathname),serviceLocation:Ie[t.default.CONTENT_STEERING_RESPONSE.ID],queryParams:Ie[t.default.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][t.default.CONTENT_STEERING_RESPONSE.PARAMS],reference:Be};Me.push(Te)}}),Me}catch(Ie){return _.error(Ie),[]}}function b(){u&&u.ttl&&!isNaN(u.ttl)&&(j&&clearTimeout(j),j=setTimeout(function(){le()},u.ttl*1e3))}function F(){j&&clearTimeout(j),j=null}function oe(de,Me){try{_.warn("Error fetching data from content steering server",de);var Ie=Me.status;switch(Ie){case 410:break;case 429:var He=Me&&Me.getResponseHeader?Me.getResponseHeader("retry-after"):null;He!==null&&(u||(u={}),u.ttl=parseInt(He)),b();break;default:b();break}}catch(Be){_.error(Be)}}function ie(){return u}function q(){Ae(),W.off(g.default.FRAGMENT_LOADING_STARTED,J,n),W.off(g.default.MANIFEST_LOADING_STARTED,ue,n),W.off(g.default.MANIFEST_LOADING_FINISHED,pe,n),W.off(g.default.THROUGHPUT_MEASUREMENT_STORED,Ce,n)}function Ae(){u=null,D={},A={baseUrl:{current:null,all:[]},location:{current:null,all:[]}},F()}return n={reset:q,setConfig:te,loadSteeringData:le,getCurrentSteeringResponseData:ie,shouldQueryBeforeStart:Q,getSteeringDataFromManifest:ge,stopSteeringRequestTimer:F,getSynthesizedBaseUrlElements:x,getSynthesizedLocationElements:y,initialize:fe},X(),n}r.__dashjs_factory_name="ContentSteeringController";let d=p.default.getSingletonFactory(r)},"./src/dash/controllers/RepresentationController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/streaming/MediaPlayerEvents.js"),i=e("./src/dash/utils/SegmentsUtils.js");function E(t){t=t||{};var g=t.eventBus,C=t.events,T=t.abrController,P=t.dashMetrics,R=t.playbackController,m=t.timelineConverter,f=t.type,r=t.streamInfo,d=t.dashConstants,c=t.segmentsController,M=t.isDynamic,n=t.adapter,_,u,A,D,j,$;function z(){X(),g.on(o.default.MANIFEST_VALIDITY_CHANGED,K,_)}function ee(){return r.id}function k(){return f}function w(){if(!T||!P||!R||!m)throw new Error(p.default.MISSING_CONFIG_ERROR)}function N(){return u}function H(){return A}function W(){return $}function Z(){return j}function X(){u=null,A=!0,D=[],j=null}function te(){g.off(o.default.MANIFEST_VALIDITY_CHANGED,K,_),X()}function fe(U,x,y,S,b){return new Promise(function(F,oe){A=!0,D=x,u=U;var ie=Ee(b);if(L(ie),y!==p.default.VIDEO&&y!==p.default.AUDIO&&(y!==p.default.TEXT||!S)){le(),F();return}for(var q=[],Ae=0,de=D.length;Ae<de;Ae++){var Me=D[Ae];q.push(J(Me))}Promise.all(q).then(function(){var Ie=Ee(b);L(Ie),F()}).catch(function(Ie){oe(Ie)})})}function J(U){return new Promise(function(x,y){var S=U.hasInitialization(),b=U.hasSegments(),F=[];F.push(c.updateInitData(U,S)),F.push(c.updateSegmentData(U,b)),Promise.all(F).then(function(oe){oe[0]&&!oe[0].error&&(U=pe(U,oe[0])),oe[1]&&!oe[1].error&&(U=Ce(U,oe[1])),ue(U),Y(U),x()}).catch(function(oe){y(oe)})})}function ue(U){U.mediaFinishedInformation=c.getMediaFinishedInformation(U)}function pe(U,x){return!x||x.error||!x.representation?U:x.representation}function Ce(U,x){if(!(!x||x.error)){var y=x.segments,S=[],b=0,F,oe,ie,q;for(F=0,oe=y?y.length:0;F<oe;F++)ie=y[F],q=(0,i.getTimeBasedSegment)(m,M,U,ie.startTime,ie.duration,ie.timescale,ie.media,ie.mediaRange,b),q&&(S.push(q),q=null,b++);return S.length>0&&(U.segments=S),U}}function ve(){w();var U=new Date,x=W(),y=R.getTime()*1e3;x&&P.addRepresentationSwitch(x.adaptation.type,U,y,x.id),g.trigger(o.default.REPRESENTATION_SWITCH,{mediaType:f,streamId:r.id,currentRepresentation:x,numberOfRepresentations:D.length},{streamId:r.id,mediaType:f})}function Ee(U){return U==null||U>=D.length?null:D[U]}function ge(U){return D.indexOf(U)}function Q(){for(var U=0,x=D.length;U<x;U++){var y=D[U].segmentInfoType;if(!D[U].hasInitialization()||(y===d.SEGMENT_BASE||y===d.BASE_URL)&&!D[U].segments)return!1}return!0}function le(U){A=!1,g.trigger(C.DATA_UPDATE_COMPLETED,{data:u,currentRepresentation:$,error:U},{streamId:r.id,mediaType:f})}function Y(U){if(H()){var x=P.getCurrentManifestUpdate(),y=!1,S,b;if(x){for(var F=0;F<x.representationInfo.length;F++)if(S=x.representationInfo[F],S.index===U.index&&S.mediaType===k()){y=!0;break}y||P.addManifestUpdateRepresentationInfo(U,k())}if(Q()){T.setPlaybackQuality(f,r,ge($));var oe=P.getCurrentDVRInfo(f);oe&&P.updateManifestUpdateInfo({latency:oe.range.end-R.getTime()}),b=P.getCurrentRepresentationSwitch(W().adaptation.type),b||ve(),le()}}}function I(U){var x=Ee(U);L(x),ve()}function L(U){$=U,j=n.convertRepresentationToRepresentationInfo($)}function K(U){if(U.newDuration){var x=W();if(x&&x.adaptation.period){var y=x.adaptation.period;y.duration=U.newDuration}}}return _={getStreamId:ee,getType:k,getData:N,isUpdating:H,updateData:fe,getCurrentRepresentation:W,getCurrentRepresentationInfo:Z,getRepresentationForQuality:Ee,prepareQualityChange:I,reset:te},z(),_}E.__dashjs_factory_name="RepresentationController";let h=l.default.getClassFactory(E)},"./src/dash/controllers/SegmentBaseController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/core/FactoryMaker.js"),l=e("./src/dash/SegmentBaseLoader.js"),o=e("./src/dash/WebmSegmentBaseLoader.js");function i(t){t=t||{};var g=this.context,C=t.eventBus,T=t.events,P=t.dashMetrics,R=t.mediaPlayerModel,m=t.errHandler,f=t.baseURLController,r=t.debug,d=t.boxParser,c=t.requestModifier,M=t.errors,n,_,u;function A(){_=(0,l.default)(g).getInstance(),u=(0,o.default)(g).getInstance(),_.setConfig({baseURLController:f,dashMetrics:P,mediaPlayerModel:R,errHandler:m,eventBus:C,events:T,errors:M,debug:r,boxParser:d,requestModifier:c}),u.setConfig({baseURLController:f,dashMetrics:P,mediaPlayerModel:R,errHandler:m,eventBus:C,events:T,errors:M,debug:r,requestModifier:c})}function D(k){var w=k?k.split("/")[1]:"";return w.toLowerCase()==="webm"}function j(){_.initialize(),u.initialize()}function $(k){return D(k.representation.mimeType)?u.loadInitialization(k.representation,k.mediaType):_.loadInitialization(k.representation,k.mediaType)}function z(k){return D(k.mimeType)?u.loadSegments(k.representation,k.mediaType,k.representation?k.representation.indexRange:null):_.loadSegments(k.representation,k.mediaType,k.representation?k.representation.indexRange:null)}function ee(){_.reset(),u.reset()}return n={initialize:j,getSegmentBaseInitSegment:$,getSegmentList:z,reset:ee},A(),n}i.__dashjs_factory_name="SegmentBaseController";var E=p.default.getSingletonFactory(i);let h=E},"./src/dash/controllers/SegmentsController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>g});var p=e("./src/core/FactoryMaker.js"),l=e("./src/dash/utils/TimelineSegmentsGetter.js"),o=e("./src/dash/utils/TemplateSegmentsGetter.js"),i=e("./src/dash/utils/ListSegmentsGetter.js"),E=e("./src/dash/utils/SegmentBaseGetter.js");function h(C){C=C||{};var T=this.context,P=C.dashConstants,R=C.type,m=C.segmentBaseController,f,r;function d(){r={}}function c(j){r[P.SEGMENT_TIMELINE]=(0,l.default)(T).create(C,j),r[P.SEGMENT_TEMPLATE]=(0,o.default)(T).create(C,j),r[P.SEGMENT_LIST]=(0,i.default)(T).create(C,j),r[P.SEGMENT_BASE]=(0,E.default)(T).create(C,j)}function M(j,$){return $?Promise.resolve():m.getSegmentBaseInitSegment({representation:j,mediaType:R})}function n(j,$){return $?Promise.resolve():m.getSegmentList({mimeType:j.mimeType,representation:j,mediaType:R})}function _(j){return j?j.segments?r[P.SEGMENT_BASE]:r[j.segmentInfoType]:null}function u(j,$,z){var ee=_(j);return ee?ee.getSegmentByIndex(j,$,z):null}function A(j,$){var z=_(j);return z?z.getSegmentByTime(j,$):null}function D(j){var $=_(j);return $?$.getMediaFinishedInformation(j):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}return f={initialize:c,updateInitData:M,updateSegmentData:n,getSegmentByIndex:u,getSegmentByTime:A,getMediaFinishedInformation:D},d(),f}h.__dashjs_factory_name="SegmentsController";var t=p.default.getClassFactory(h);let g=t},"./src/dash/controllers/ServiceDescriptionController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>g});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/streaming/constants/Constants.js"),i=e("./src/dash/constants/DashConstants.js"),E=[o.default.SERVICE_DESCRIPTION_DVB_LL_SCHEME],h={VIDEO:"video",AUDIO:"audio",ANY:"any",ALL:"all"};function t(){var C=this.context,T,P,R,m,f;function r(){m=(0,l.default)(C).getInstance().getLogger(T),M()}function d(W){W&&W.adapter&&(f=W.adapter)}function c(){M()}function M(){P={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{},contentSteering:null},R=[]}function n(){return P}function _(W){if(!(!W||!W.serviceDescriptions)){var Z=W.serviceDescriptions.filter(function(fe){return E.includes(fe.schemeIdUri)}),X=W.serviceDescriptions.filter(function(fe){return fe.schemeIdUri==null}),te=Z.length>0?Z[Z.length-1]:X[X.length-1];te&&(te.latency&&te.latency.target>0&&u(te),te.playbackRate&&j(te),te.operatingQuality&&void 0,te.operatingBandwidth&&z(te),te.contentSteering&&k(te))}}function u(W){var Z;if(W.schemeIdUri===o.default.SERVICE_DESCRIPTION_DVB_LL_SCHEME?Z=D(W):Z=A(W),R.length>0){var X=H(Z),te=X.to,fe=X.id;P.liveDelay=Z.liveDelay-te,P.liveCatchup.maxDrift=Z.maxDrift,m.debug(`
                Found latency properties coming from service description. Applied time offset of `.concat(te," from ProducerReferenceTime element with id ").concat(fe,`.
                Live Delay: `).concat(Z.liveDelay-te,", Live catchup max drift: ").concat(Z.maxDrift,`
            `))}else P.liveDelay=Z.liveDelay,P.liveCatchup.maxDrift=Z.maxDrift,m.debug("Found latency properties coming from service description: Live Delay: ".concat(Z.liveDelay,", Live catchup max drift: ").concat(Z.maxDrift))}function A(W){var Z=W.latency.target/1e3,X=!isNaN(W.latency.max)&&W.latency.max>W.latency.target?(W.latency.max-W.latency.target+500)/1e3:NaN,te=W.latency.referenceId||NaN;return{liveDelay:Z,maxDrift:X,referenceId:te}}function D(W){var Z=W.latency.target/1e3,X=!isNaN(W.latency.max)&&W.latency.max>W.latency.target?(W.latency.max-W.latency.target+500)/1e3:NaN,te=W.latency.referenceId||NaN;return{liveDelay:Z,maxDrift:X,referenceId:te}}function j(W){var Z=W.playbackRate.min?Math.round((W.playbackRate.min-1)*1e3)/1e3:NaN,X=W.playbackRate.max?Math.round((W.playbackRate.max-1)*1e3)/1e3:NaN;P.liveCatchup.playbackRate.min=Z,P.liveCatchup.playbackRate.max=X,m.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(Z)),m.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(X))}function $(){}function z(W){if(!(!W||!W.operatingBandwidth||!W.operatingBandwidth.mediaType||W.operatingBandwidth.mediaType===h.ALL)){var Z={};Z.minBandwidth=W.operatingBandwidth.min,Z.maxBandwidth=W.operatingBandwidth.max,Z.targetBandwidth=W.operatingBandwidth.target;var X=[];W.operatingBandwidth.mediaType===h.VIDEO||W.operatingBandwidth.mediaType===h.AUDIO?X.push(W.operatingBandwidth.mediaType):W.operatingBandwidth.mediaType===h.ANY&&(X.push(h.AUDIO),X.push(h.VIDEO)),X.forEach(function(te){isNaN(Z.minBandwidth)||ee("minBitrate",te,Z.minBandwidth),isNaN(Z.maxBandwidth)||ee("maxBitrate",te,Z.maxBandwidth),isNaN(Z.targetBandwidth)||ee("initialBitrate",te,Z.targetBandwidth)})}}function ee(W,Z,X){try{P[W][Z]=X/1e3}catch(te){m.error(te)}}function k(W){P.contentSteering=W.contentSteering}function w(){return R}function N(W){try{var Z=[];if(W&&W.length>0){var X=[o.default.VIDEO,o.default.AUDIO,o.default.TEXT],te=f.getAvailabilityStartTime()/1e3;W.forEach(function(fe){var J=X.reduce(function(ue,pe){return ue=ue.concat(f.getAllMediaInfoForType(fe,pe)),ue},[]).reduce(function(ue,pe){var Ce=f.getProducerReferenceTimes(fe,pe);return Ce.forEach(function(ve){var Ee=f.getVoRepresentations(pe);if(Ee&&Ee.length>0&&Ee[0].adaptation&&Ee[0].segmentInfoType===i.default.SEGMENT_TEMPLATE){var ge=Ee[0],Q=new Date(ve[i.default.WALL_CLOCK_TIME]),le=Q.getTime()/1e3,Y=le-(ve[i.default.PRESENTATION_TIME]/ge[i.default.TIMESCALE]-ge[i.default.PRESENTATION_TIME_OFFSET]+fe.start),I=te-Y;ue.push({id:ve[i.default.ID],to:I})}}),ue},[]);Z=Z.concat(J)})}R=Z}catch(fe){m.error(fe),R=[]}}function H(W){var Z=0,X,te=R.filter(function(fe){return fe.id===W.referenceId});return te.length===0?(Z=R.length>0?R[0].to:0,X=R[0].id||NaN):(Z=te[0].to||0,X=te[0].id||NaN),{to:Z,id:X}}return T={getServiceDescriptionSettings:n,getProducerReferenceTimeOffsets:w,calculateProducerReferenceTimeOffsets:N,applyServiceDescription:_,reset:c,setConfig:d},r(),T}t.__dashjs_factory_name="ServiceDescriptionController";let g=p.default.getSingletonFactory(t)},"./src/dash/models/DashManifestModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>H});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/dash/constants/DashConstants.js"),o=e("./src/dash/vo/Representation.js"),i=e("./src/dash/vo/AdaptationSet.js"),E=e("./src/dash/vo/Period.js"),h=e("./src/dash/vo/Mpd.js"),t=e("./src/dash/vo/UTCTiming.js"),g=e("./src/dash/vo/Event.js"),C=e("./src/dash/vo/BaseURL.js"),T=e("./src/dash/vo/EventStream.js"),P=e("./src/dash/vo/ProducerReferenceTime.js"),R=e("./src/dash/vo/ContentSteering.js"),m=e("./src/dash/vo/DescriptorType.js"),f=e("./src/streaming/utils/ObjectUtils.js"),r=e("./src/streaming/utils/URLUtils.js"),d=e("./src/core/FactoryMaker.js"),c=e("./src/core/Debug.js"),M=e("./src/streaming/vo/DashJSError.js"),n=e("./src/core/errors/Errors.js"),_=e("./src/streaming/thumbnail/ThumbnailTracks.js"),u=e("./src/dash/vo/MpdLocation.js"),A=e("./src/dash/vo/PatchLocation.js");function D(W,Z){var X;if(typeof Symbol>"u"||W[Symbol.iterator]==null){if(Array.isArray(W)||(X=z(W))||Z&&W&&typeof W.length=="number"){X&&(W=X);var te=0,fe=function(){};return{s:fe,n:function(){return te>=W.length?{done:!0}:{done:!1,value:W[te++]}},e:function(ve){throw ve},f:fe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var J=!0,ue=!1,pe;return{s:function(){X=W[Symbol.iterator]()},n:function(){var ve=X.next();return J=ve.done,ve},e:function(ve){ue=!0,pe=ve},f:function(){try{!J&&X.return!=null&&X.return()}finally{if(ue)throw pe}}}}function j(W){return k(W)||ee(W)||z(W)||$()}function $(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z(W,Z){if(W){if(typeof W=="string")return w(W,Z);var X=Object.prototype.toString.call(W).slice(8,-1);if(X==="Object"&&W.constructor&&(X=W.constructor.name),X==="Map"||X==="Set")return Array.from(W);if(X==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(X))return w(W,Z)}}function ee(W){if(typeof Symbol<"u"&&Symbol.iterator in Object(W))return Array.from(W)}function k(W){if(Array.isArray(W))return w(W)}function w(W,Z){(Z==null||Z>W.length)&&(Z=W.length);for(var X=0,te=new Array(Z);X<Z;X++)te[X]=W[X];return te}function N(){var W,Z,X,te,fe=this.context,J=(0,r.default)(fe).getInstance(),ue=Number.isInteger||function(B){return typeof B=="number"&&isFinite(B)&&Math.floor(B)===B};function pe(){Z=(0,c.default)(fe).getInstance().getLogger(W)}function Ce(B,se){if(!B)throw new Error("adaptation is not defined");if(!se)throw new Error("type is not defined");if(B.Representation_asArray&&B.Representation_asArray.length){var _e=Xe(B.Representation_asArray[0]);if(_e&&_e.length>0&&_.THUMBNAILS_SCHEME_ID_URIS.indexOf(_e[0].schemeIdUri)>=0)return se===p.default.IMAGE}if(B.ContentComponent_asArray&&B.ContentComponent_asArray.length>0){if(B.ContentComponent_asArray.length>1)return se===p.default.MUXED;if(B.ContentComponent_asArray[0].contentType===se)return!0}var me=se===p.default.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(se);if(B.Representation_asArray&&B.Representation_asArray.length){var Se=B.Representation_asArray[0].codecs;if(me.test(Se))return!0}if(B.hasOwnProperty(l.default.MIME_TYPE))return me.test(B.mimeType);if(B.Representation_asArray){for(var Pe,ke=0;ke<B.Representation_asArray.length;ke++)if(Pe=B.Representation_asArray[ke],Pe.hasOwnProperty(l.default.MIME_TYPE))return me.test(Pe.mimeType)}return!1}function ve(B){if(!B)throw new Error("adaptation is not defined");if(B.hasOwnProperty(l.default.SEGMENT_TEMPLATE)||B.hasOwnProperty(l.default.SEGMENT_TIMELINE)||B.hasOwnProperty(l.default.SEGMENT_LIST)||B.hasOwnProperty(l.default.SEGMENT_BASE))return!0;if(B.Representation_asArray&&B.Representation_asArray.length>0){var se=B.Representation_asArray[0];if(se.hasOwnProperty(l.default.SEGMENT_TEMPLATE)||se.hasOwnProperty(l.default.SEGMENT_TIMELINE)||se.hasOwnProperty(l.default.SEGMENT_LIST)||se.hasOwnProperty(l.default.SEGMENT_BASE))return!0}return!1}function Ee(B){return Ce(B,p.default.AUDIO)}function ge(B){return Ce(B,p.default.VIDEO)}function Q(B){return Ce(B,p.default.TEXT)}function le(B){return Ce(B,p.default.MUXED)}function Y(B){return Ce(B,p.default.IMAGE)}function I(B){var se=B&&B.hasOwnProperty(l.default.PRODUCERREFERENCETIME_ASARRAY)?B[l.default.PRODUCERREFERENCETIME_ASARRAY]:[],_e=B&&B.hasOwnProperty(l.default.REPRESENTATION_ASARRAY)?B[l.default.REPRESENTATION_ASARRAY]:[];_e.forEach(function(Se){Se.hasOwnProperty(l.default.PRODUCERREFERENCETIME_ASARRAY)&&se.push.apply(se,j(Se[l.default.PRODUCERREFERENCETIME_ASARRAY]))});var me=[];return se.forEach(function(Se){var Pe=new P.default;if(Se.hasOwnProperty(l.default.ID))Pe[l.default.ID]=Se[l.default.ID];else return;if(Se.hasOwnProperty(l.default.WALL_CLOCK_TIME))Pe[l.default.WALL_CLOCK_TIME]=Se[l.default.WALL_CLOCK_TIME];else return;if(Se.hasOwnProperty(l.default.PRESENTATION_TIME))Pe[l.default.PRESENTATION_TIME]=Se[l.default.PRESENTATION_TIME];else return;Se.hasOwnProperty(l.default.INBAND)&&(Pe[l.default.INBAND]=Se[l.default.INBAND]!=="false"),Se.hasOwnProperty(l.default.TYPE)&&(Pe[l.default.TYPE]=Se[l.default.TYPE]),me.push(Pe)}),me}function L(B){var se="";return B&&B.hasOwnProperty(l.default.LANG)&&(se=B.lang),se}function K(B){return!B||!B.hasOwnProperty(l.default.VIEWPOINT_ASARRAY)||!B[l.default.VIEWPOINT_ASARRAY].length?[]:B[l.default.VIEWPOINT_ASARRAY].map(function(se){var _e=new m.default;return _e.init(se)})}function U(B){return!B||!B.hasOwnProperty(l.default.ROLE_ASARRAY)||!B[l.default.ROLE_ASARRAY].length?[]:B[l.default.ROLE_ASARRAY].map(function(se){var _e=new m.default;return _e.init(se)})}function x(B){return!B||!B.hasOwnProperty(l.default.ACCESSIBILITY_ASARRAY)||!B[l.default.ACCESSIBILITY_ASARRAY].length?[]:B[l.default.ACCESSIBILITY_ASARRAY].map(function(se){var _e=new m.default;return _e.init(se)})}function y(B){return!B||!B.hasOwnProperty(l.default.AUDIOCHANNELCONFIGURATION_ASARRAY)||!B[l.default.AUDIOCHANNELCONFIGURATION_ASARRAY].length?[]:B[l.default.AUDIOCHANNELCONFIGURATION_ASARRAY].map(function(se){var _e=new m.default;return _e.init(se)})}function S(B){return!B||!B.hasOwnProperty(l.default.AUDIOCHANNELCONFIGURATION_ASARRAY)||!B[l.default.AUDIOCHANNELCONFIGURATION_ASARRAY].length?[]:B[l.default.AUDIOCHANNELCONFIGURATION_ASARRAY].map(function(se){var _e=new m.default;return _e.init(se)})}function b(){return function(B,se){return B.bandwidth-se.bandwidth}}function F(B){return B&&Array.isArray(B.Representation_asArray)&&B.Representation_asArray.sort(b()),B}function oe(B,se){return B&&B.Period_asArray&&ue(se)?B.Period_asArray[se]?B.Period_asArray[se].AdaptationSet_asArray:[]:[]}function ie(B){return B&&B.Period_asArray?B.Period_asArray:[]}function q(B,se){var _e=ie(se);return _e.length>0&&ue(B)?_e[B]:null}function Ae(B,se,_e){var me=oe(se,_e),Se,Pe;for(Se=0,Pe=me.length;Se<Pe;Se++)if(me[Se].hasOwnProperty(l.default.ID)&&me[Se].id===B)return me[Se];return null}function de(B,se,_e){var me=oe(se,_e);return me.length>0&&ue(B)?me[B]:null}function Me(B,se,_e){if(!B)return-1;for(var me=oe(se,_e),Se=0;Se<me.length;Se++){var Pe=(0,f.default)(fe).getInstance();if(Pe.areEqual(me[Se],B))return Se}return-1}function Ie(B,se,_e){var me=oe(B,se),Se,Pe,ke=[];for(Se=0,Pe=me.length;Se<Pe;Se++)Ce(me[Se],_e)&&ke.push(F(me[Se]));return ke}function He(B,se,_e){var me=null;if(B&&B.Representation_asArray&&B.Representation_asArray.length>0){var Se=ue(se)&&se>=0&&se<B.Representation_asArray.length?B.Representation_asArray[se]:B.Representation_asArray[0];Se&&(me=Se.mimeType+';codecs="'+Se.codecs+'"',_e&&Se.width!==void 0&&(me+=';width="'+Se.width+'";height="'+Se.height+'"'))}return me&&(me=me.replace(/\sprofiles=[^;]*/g,"")),me}function Be(B){return B&&B.Representation_asArray&&B.Representation_asArray.length>0?B.Representation_asArray[0].mimeType:null}function ze(B){return B&&B.hasOwnProperty(l.default.SEGMENT_ALIGNMENT)?B[l.default.SEGMENT_ALIGNMENT]==="true":!1}function Ye(B){return B&&B.hasOwnProperty(l.default.SUB_SEGMENT_ALIGNMENT)?B[l.default.SUB_SEGMENT_ALIGNMENT]==="true":!1}function Te(B){return!B||!B.hasOwnProperty(l.default.CENC_DEFAULT_KID)?null:B[l.default.CENC_DEFAULT_KID]}function Fe(B){if(!B||!Array.isArray(B.Label_asArray))return[];for(var se=[],_e=0;_e<B.Label_asArray.length;_e++)se.push({lang:B.Label_asArray[_e].lang,text:B.Label_asArray[_e].__text||B.Label_asArray[_e]});return se}function ot(B){return!B||!B.hasOwnProperty(l.default.CONTENTPROTECTION_ASARRAY)||B.ContentProtection_asArray.length===0?null:B.ContentProtection_asArray}function st(B){var se=!1;return B&&B.hasOwnProperty("type")&&(se=B.type===l.default.DYNAMIC),se}function at(B){return B&&B[l.default.ID]||null}function ht(B,se){var _e=!1;return B&&B.profiles&&B.profiles.length>0&&(_e=B.profiles.indexOf(se)!==-1),_e}function Tt(B){var se;return B&&B.hasOwnProperty(l.default.MEDIA_PRESENTATION_DURATION)?se=B.mediaPresentationDuration:B&&B.type=="dynamic"?se=Number.POSITIVE_INFINITY:se=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,se}function xe(B){return B&&B.bandwidth?B.bandwidth:NaN}function we(B){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_e=NaN;return B&&B.hasOwnProperty(l.default.MINIMUM_UPDATE_PERIOD)&&(_e=B.minimumUpdatePeriod),isNaN(_e)?_e:Math.max(_e-se,1)}function $e(B){return B&&B.hasOwnProperty(l.default.PUBLISH_TIME)?new Date(B[l.default.PUBLISH_TIME]):null}function et(B){return B&&Array.isArray(B.Representation_asArray)?B.Representation_asArray.length:0}function qe(B){var se=F(B),_e=se&&Array.isArray(se.Representation_asArray)?se.Representation_asArray:[];return _e.map(function(me){return{bandwidth:me.bandwidth,width:me.width||0,height:me.height||0,scanType:me.scanType||null,id:me.id||null}})}function _t(B){try{var se=B&&typeof B.selectionPriority<"u"?parseInt(B.selectionPriority):1;return isNaN(se)?1:se}catch{return 1}}function Xe(B){return!B||!B.EssentialProperty_asArray||!B.EssentialProperty_asArray.length?null:B.EssentialProperty_asArray.map(function(se){return{schemeIdUri:se.schemeIdUri,value:se.value}})}function Re(B,se){return se&&se.Representation_asArray&&se.Representation_asArray.length>0&&ue(B)?se.Representation_asArray[B]:null}function ye(B){if(B&&B.period&&ue(B.period.index)){var se=B.period.mpd.manifest.Period_asArray[B.period.index];if(se&&se.AdaptationSet_asArray&&ue(B.index))return F(se.AdaptationSet_asArray[B.index])}}function be(B){var se=[],_e=ye(B),me,Se;if(_e&&_e.Representation_asArray){if(B&&B.period&&ue(B.period.index)){var Pe=mt(B.period.mpd.manifest);Pe&&(Se=Pe[0])}for(var ke=0,De=_e.Representation_asArray.length;ke<De;++ke){var Oe=_e.Representation_asArray[ke],Ne=new o.default;if(Ne.index=ke,Ne.adaptation=B,Oe.hasOwnProperty(l.default.ID)&&(Ne.id=Oe.id),Oe.hasOwnProperty(l.default.CODECS)&&(Ne.codecs=Oe.codecs),Oe.hasOwnProperty(l.default.MIME_TYPE)&&(Ne.mimeType=Oe[l.default.MIME_TYPE]),Oe.hasOwnProperty(l.default.CODEC_PRIVATE_DATA)&&(Ne.codecPrivateData=Oe.codecPrivateData),Oe.hasOwnProperty(l.default.BANDWITH)&&(Ne.bandwidth=Oe.bandwidth),Oe.hasOwnProperty(l.default.WIDTH)&&(Ne.width=Oe.width),Oe.hasOwnProperty(l.default.HEIGHT)&&(Ne.height=Oe.height),Oe.hasOwnProperty(l.default.SCAN_TYPE)&&(Ne.scanType=Oe.scanType),Oe.hasOwnProperty(l.default.MAX_PLAYOUT_RATE)&&(Ne.maxPlayoutRate=Oe.maxPlayoutRate),Oe.hasOwnProperty(l.default.SEGMENT_BASE)?(me=Oe.SegmentBase,Ne.segmentInfoType=l.default.SEGMENT_BASE):Oe.hasOwnProperty(l.default.SEGMENT_LIST)?(me=Oe.SegmentList,me.hasOwnProperty(l.default.SEGMENT_TIMELINE)?Ne.segmentInfoType=l.default.SEGMENT_TIMELINE:Ne.segmentInfoType=l.default.SEGMENT_LIST):Oe.hasOwnProperty(l.default.SEGMENT_TEMPLATE)?(me=Oe.SegmentTemplate,me.hasOwnProperty(l.default.SEGMENT_TIMELINE)?Ne.segmentInfoType=l.default.SEGMENT_TIMELINE:Ne.segmentInfoType=l.default.SEGMENT_TEMPLATE,me.hasOwnProperty(l.default.INITIALIZATION_MINUS)&&(Ne.initialization=me.initialization.split("$Bandwidth$").join(Oe.bandwidth).split("$RepresentationID$").join(Oe.id))):Ne.segmentInfoType=l.default.BASE_URL,Ne.essentialProperties=Xe(Oe),me){if(me.hasOwnProperty(l.default.INITIALIZATION)){var tt=me.Initialization;tt.hasOwnProperty(l.default.SOURCE_URL)&&(Ne.initialization=tt.sourceURL),tt.hasOwnProperty(l.default.RANGE)&&(Ne.range=tt.range)}else Q(_e)&&ve(_e)&&_e.mimeType&&_e.mimeType.indexOf("application/mp4")===-1&&(Ne.range=0);me.hasOwnProperty(l.default.TIMESCALE)&&(Ne.timescale=me.timescale),me.hasOwnProperty(l.default.DURATION)?Ne.segmentDuration=me.duration/Ne.timescale:Oe.hasOwnProperty(l.default.SEGMENT_TEMPLATE)&&(me=Oe.SegmentTemplate,me.hasOwnProperty(l.default.SEGMENT_TIMELINE)&&(Ne.segmentDuration=We(me.SegmentTimeline)/Ne.timescale)),me.hasOwnProperty(l.default.MEDIA)&&(Ne.media=me.media),me.hasOwnProperty(l.default.START_NUMBER)&&(Ne.startNumber=me.startNumber),me.hasOwnProperty(l.default.INDEX_RANGE)&&(Ne.indexRange=me.indexRange),me.hasOwnProperty(l.default.PRESENTATION_TIME_OFFSET)&&(Ne.presentationTimeOffset=me.presentationTimeOffset/Ne.timescale),me.hasOwnProperty(l.default.AVAILABILITY_TIME_OFFSET)?Ne.availabilityTimeOffset=me.availabilityTimeOffset:Se&&Se.availabilityTimeOffset!==void 0&&(Ne.availabilityTimeOffset=Se.availabilityTimeOffset),me.hasOwnProperty(l.default.AVAILABILITY_TIME_COMPLETE)?Ne.availabilityTimeComplete=me.availabilityTimeComplete!=="false":Se&&Se.availabilityTimeComplete!==void 0&&(Ne.availabilityTimeComplete=Se.availabilityTimeComplete)}Ne.MSETimeOffset=Qe(Ne),Ne.path=[B.period.index,B.index,ke],se.push(Ne)}}return se}function We(B){if(!B||!B.S_asArray)return NaN;var se=B.S_asArray[0],_e=B.S_asArray[1];return se.hasOwnProperty("d")?se.d:_e.t-se.t}function Qe(B){var se=B.presentationTimeOffset,_e=B.adaptation.period.start;return _e-se}function Ve(B){var se=B&&ue(B.index)?B.mpd.manifest.Period_asArray[B.index]:null,_e=[],me,Se,Pe;if(se&&se.AdaptationSet_asArray)for(Pe=0;Pe<se.AdaptationSet_asArray.length;Pe++)Se=se.AdaptationSet_asArray[Pe],me=new i.default,Se.hasOwnProperty(l.default.ID)&&(me.id=Se.id),me.index=Pe,me.period=B,le(Se)?me.type=p.default.MUXED:Ee(Se)?me.type=p.default.AUDIO:ge(Se)?me.type=p.default.VIDEO:Q(Se)?me.type=p.default.TEXT:Y(Se)?me.type=p.default.IMAGE:Z.warn("Unknown Adaptation stream type"),_e.push(me);return _e}function rt(B){var se=B?st(B.manifest):!1,_e=[],me=null,Se=null,Pe=null,ke=null,De,Oe;for(Oe=0,De=B&&B.manifest&&B.manifest.Period_asArray?B.manifest.Period_asArray.length:0;Oe<De;Oe++)Se=B.manifest.Period_asArray[Oe],Se.hasOwnProperty(l.default.START)?(ke=new E.default,ke.start=Se.start):me!==null&&me.hasOwnProperty(l.default.DURATION)&&Pe!==null?(ke=new E.default,ke.start=parseFloat((Pe.start+Pe.duration).toFixed(5))):Oe===0&&!se&&(ke=new E.default,ke.start=0),Pe!==null&&isNaN(Pe.duration)&&(ke!==null?Pe.duration=parseFloat((ke.start-Pe.start).toFixed(5)):Z.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),ke!==null&&(ke.id=ft(Se,Oe),ke.index=Oe,ke.mpd=B,Se.hasOwnProperty(l.default.DURATION)&&(ke.duration=Se.duration),Pe&&(Pe.nextPeriodId=ke.id),_e.push(ke),me=Se,Pe=ke),Se=null,ke=null;return _e.length===0||Pe!==null&&isNaN(Pe.duration)&&(Pe.duration=parseFloat((At(Pe)-Pe.start).toFixed(5))),_e}function ft(B,se){if(!B)throw new Error("Period cannot be null or undefined");var _e=E.default.DEFAULT_ID+"_"+se;return B.hasOwnProperty(l.default.ID)&&B.id.length>0&&B.id!=="__proto__"&&(_e=B.id),_e}function Je(B){var se=new h.default;return B&&(se.manifest=B,B.hasOwnProperty(l.default.AVAILABILITY_START_TIME)?se.availabilityStartTime=new Date(B.availabilityStartTime.getTime()):B.loadedTime&&(se.availabilityStartTime=new Date(B.loadedTime.getTime())),B.hasOwnProperty(l.default.AVAILABILITY_END_TIME)&&(se.availabilityEndTime=new Date(B.availabilityEndTime.getTime())),B.hasOwnProperty(l.default.MINIMUM_UPDATE_PERIOD)&&(se.minimumUpdatePeriod=B.minimumUpdatePeriod),B.hasOwnProperty(l.default.MEDIA_PRESENTATION_DURATION)&&(se.mediaPresentationDuration=B.mediaPresentationDuration),B.hasOwnProperty(l.default.SUGGESTED_PRESENTATION_DELAY)&&(se.suggestedPresentationDelay=B.suggestedPresentationDelay),B.hasOwnProperty(l.default.TIMESHIFT_BUFFER_DEPTH)&&(se.timeShiftBufferDepth=B.timeShiftBufferDepth),B.hasOwnProperty(l.default.MAX_SEGMENT_DURATION)&&(se.maxSegmentDuration=B.maxSegmentDuration),B.hasOwnProperty(l.default.PUBLISH_TIME)&&(se.publishTime=new Date(B.publishTime))),se}function yt(){if(!X||!X.hasOwnProperty("error"))throw new Error(p.default.MISSING_CONFIG_ERROR)}function At(B){yt();var se=st(B.mpd.manifest),_e;return B.mpd.manifest.mediaPresentationDuration?_e=B.mpd.manifest.mediaPresentationDuration:B.duration?_e=B.duration:se?_e=Number.POSITIVE_INFINITY:X.error(new M.default(n.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",B)),_e}function Le(B){var se=B&&B.mpd&&B.mpd.manifest?B.mpd.manifest:null,_e=se?se.Period_asArray:null,me=_e&&B&&ue(B.index)?_e[B.index].EventStream_asArray:null,Se=[],Pe,ke;if(me)for(Pe=0;Pe<me.length;Pe++){var De=new T.default;if(De.period=B,De.timescale=1,me[Pe].hasOwnProperty(p.default.SCHEME_ID_URI))De.schemeIdUri=me[Pe][p.default.SCHEME_ID_URI];else throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(me[Pe].hasOwnProperty(l.default.TIMESCALE)&&(De.timescale=me[Pe][l.default.TIMESCALE]),me[Pe].hasOwnProperty(l.default.VALUE)&&(De.value=me[Pe][l.default.VALUE]),me[Pe].hasOwnProperty(l.default.PRESENTATION_TIME_OFFSET)&&(De.presentationTimeOffset=me[Pe][l.default.PRESENTATION_TIME_OFFSET]),ke=0;me[Pe].Event_asArray&&ke<me[Pe].Event_asArray.length;ke++){var Oe=me[Pe].Event_asArray[ke],Ne=new g.default;Ne.presentationTime=0,Ne.eventStream=De,Oe.hasOwnProperty(l.default.PRESENTATION_TIME)&&(Ne.presentationTime=Oe.presentationTime);var tt=De.presentationTimeOffset?De.presentationTimeOffset/De.timescale:0;Ne.calculatedPresentationTime=Ne.presentationTime/De.timescale+B.start-tt,Oe.hasOwnProperty(l.default.DURATION)&&(Ne.duration=Oe.duration/De.timescale),Oe.hasOwnProperty(l.default.ID)?Ne.id=Oe.id:Ne.id=null,Oe.Signal&&Oe.Signal.Binary?Ne.messageData=te.decodeArray(Oe.Signal.Binary.toString()):Ne.messageData=Oe.messageData||Oe.__cdata||Oe.__text,Se.push(Ne)}}return Se}function Ue(B,se,_e){var me=[],Se;if(!B)return me;for(Se=0;Se<B.length;Se++){var Pe=new T.default;if(Pe.timescale=1,Pe.representation=se,B[Se].hasOwnProperty(p.default.SCHEME_ID_URI))Pe.schemeIdUri=B[Se].schemeIdUri;else throw new Error("Invalid EventStream. SchemeIdUri has to be set");B[Se].hasOwnProperty(l.default.TIMESCALE)&&(Pe.timescale=B[Se].timescale),B[Se].hasOwnProperty(l.default.VALUE)&&(Pe.value=B[Se].value),me.push(Pe),Pe.period=_e}return me}function Ze(B,se,_e){var me,Se,Pe;return B&&B.Period_asArray&&se&&se.period&&ue(se.period.index)&&(Se=B.Period_asArray[se.period.index],Se&&Se.AdaptationSet_asArray&&ue(se.index)&&(Pe=Se.AdaptationSet_asArray[se.index],Pe&&(me=Pe.InbandEventStream_asArray))),Ue(me,null,_e)}function dt(B,se,_e){var me,Se,Pe,ke;return B&&B.Period_asArray&&se&&se.adaptation&&se.adaptation.period&&ue(se.adaptation.period.index)&&(Se=B.Period_asArray[se.adaptation.period.index],Se&&Se.AdaptationSet_asArray&&ue(se.adaptation.index)&&(Pe=Se.AdaptationSet_asArray[se.adaptation.index],Pe&&Pe.Representation_asArray&&ue(se.index)&&(ke=Pe.Representation_asArray[se.index],ke&&(me=ke.InbandEventStream_asArray)))),Ue(me,se,_e)}function vt(B){var se=st(B),_e=B?B.hasOwnProperty(l.default.AVAILABILITY_START_TIME):!1,me=B?B.UTCTiming_asArray:null,Se=[];return(se||_e)&&me&&me.forEach(function(Pe){var ke=new t.default;if(Pe.hasOwnProperty(p.default.SCHEME_ID_URI))ke.schemeIdUri=Pe.schemeIdUri;else return;if(Pe.hasOwnProperty(l.default.VALUE))ke.value=Pe.value.toString();else return;Se.push(ke)}),Se}function mt(B){var se=[],_e=B.BaseURL_asArray||[B.baseUri],me=!1;return _e.some(function(Se){if(Se){var Pe=new C.default,ke=Se.__text||Se;return J.isRelative(ke)&&(me=!0,B.baseUri&&(ke=J.resolve(ke,B.baseUri))),Pe.url=ke,Se.hasOwnProperty(l.default.SERVICE_LOCATION)&&Se.serviceLocation.length?Pe.serviceLocation=Se.serviceLocation:Pe.serviceLocation=ke,Se.hasOwnProperty(l.default.DVB_PRIORITY)&&(Pe.dvb_priority=Se[l.default.DVB_PRIORITY]),Se.hasOwnProperty(l.default.DVB_WEIGHT)&&(Pe.dvb_weight=Se[l.default.DVB_WEIGHT]),Se.hasOwnProperty(l.default.AVAILABILITY_TIME_OFFSET)&&(Pe.availabilityTimeOffset=Se[l.default.AVAILABILITY_TIME_OFFSET]),Se.hasOwnProperty(l.default.AVAILABILITY_TIME_COMPLETE)&&(Pe.availabilityTimeComplete=Se[l.default.AVAILABILITY_TIME_COMPLETE]!=="false"),se.push(Pe),me}}),se}function Pt(B){if(B&&B.hasOwnProperty(l.default.CONTENT_STEERING_AS_ARRAY)){var se=B[l.default.CONTENT_STEERING_AS_ARRAY][0];return Ft(se)}}function Ft(B){var se=new R.default;return se.serverUrl=B.__text,B.hasOwnProperty(l.default.DEFAULT_SERVICE_LOCATION)&&(se.defaultServiceLocation=B[l.default.DEFAULT_SERVICE_LOCATION],se.defaultServiceLocationArray=se.defaultServiceLocation.split(" ")),B.hasOwnProperty(l.default.QUERY_BEFORE_START)&&(se.queryBeforeStart=B[l.default.QUERY_BEFORE_START].toLowerCase()==="true"),B.hasOwnProperty(l.default.CLIENT_REQUIREMENT)&&(se.clientRequirement=B[l.default.CLIENT_REQUIREMENT].toLowerCase()!=="false"),se}function bt(B){return B&&B.hasOwnProperty(l.default.LOCATION_AS_ARRAY)?B[l.default.LOCATION_AS_ARRAY].map(function(se){var _e=se.__text||se,me=se.hasOwnProperty(l.default.SERVICE_LOCATION)?se[l.default.SERVICE_LOCATION]:null;return new u.default(_e,me)}):[]}function kt(B){return B&&B.hasOwnProperty(l.default.PATCH_LOCATION_AS_ARRAY)?B[l.default.PATCH_LOCATION_AS_ARRAY].map(function(se){var _e=se.__text||se,me=se.hasOwnProperty(l.default.SERVICE_LOCATION)?se[l.default.SERVICE_LOCATION]:null,Se=se.hasOwnProperty(l.default.TTL)?parseFloat(se[l.default.TTL])*1e3:NaN;return new A.default(_e,me,Se)}):[]}function Wt(B){return B&&B.hasOwnProperty(l.default.SUGGESTED_PRESENTATION_DELAY)?B.suggestedPresentationDelay:null}function Vt(B){return B&&B.hasOwnProperty(l.default.AVAILABILITY_START_TIME)&&B.availabilityStartTime!==null?B.availabilityStartTime.getTime():null}function lt(B){var se=[];if(B&&B.hasOwnProperty(l.default.SERVICE_DESCRIPTION)){var _e=D(B.ServiceDescription_asArray),me;try{for(_e.s();!(me=_e.n()).done;){var Se=me.value,Pe=null,ke=null,De=null,Oe=null,Ne=null,tt=null,gt=null;for(var ct in Se)Se.hasOwnProperty(ct)&&(ct===l.default.ID?Pe=Se[ct]:ct===l.default.SERVICE_DESCRIPTION_SCOPE?ke=Se[ct].schemeIdUri:ct===l.default.SERVICE_DESCRIPTION_LATENCY?De={target:parseInt(Se[ct].target),max:parseInt(Se[ct].max),min:parseInt(Se[ct].min),referenceId:parseInt(Se[ct].referenceId)}:ct===l.default.SERVICE_DESCRIPTION_PLAYBACK_RATE?Oe={max:parseFloat(Se[ct].max),min:parseFloat(Se[ct].min)}:ct===l.default.SERVICE_DESCRIPTION_OPERATING_QUALITY?Ne={mediaType:Se[ct].mediaType,max:parseInt(Se[ct].max),min:parseInt(Se[ct].min),target:parseInt(Se[ct].target),type:Se[ct].type,maxQualityDifference:parseInt(Se[ct].maxQualityDifference)}:ct===l.default.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH?tt={mediaType:Se[ct].mediaType,max:parseInt(Se[ct].max),min:parseInt(Se[ct].min),target:parseInt(Se[ct].target)}:ct===l.default.CONTENT_STEERING&&(gt=Ft(Se[ct])));se.push({id:Pe,schemeIdUri:ke,latency:De,playbackRate:Oe,operatingQuality:Ne,operatingBandwidth:tt,contentSteering:gt})}}catch(Ct){_e.e(Ct)}finally{_e.f()}}return se}function St(B){var se={};if(B&&B.hasOwnProperty(l.default.SUPPLEMENTAL_PROPERTY_ASARRAY)){var _e=D(B.SupplementalProperty_asArray),me;try{for(_e.s();!(me=_e.n()).done;){var Se=me.value;Se.hasOwnProperty(p.default.SCHEME_ID_URI)&&Se.hasOwnProperty(l.default.VALUE)&&(se[Se[p.default.SCHEME_ID_URI]]=Se[l.default.VALUE])}}catch(Pe){_e.e(Pe)}finally{_e.f()}}return se}function Mt(B){return!B||!B.hasOwnProperty(l.default.SUPPLEMENTAL_PROPERTY_ASARRAY)||!B.SupplementalProperty_asArray.length?[]:B.SupplementalProperty_asArray.map(function(se){var _e=new m.default;return _e.init(se)})}function O(B){var se={};if(B&&B.hasOwnProperty(l.default.SUPPLEMENTAL_PROPERTY_ASARRAY)){var _e=D(B.SupplementalProperty_asArray),me;try{for(_e.s();!(me=_e.n()).done;){var Se=me.value;Se.hasOwnProperty(p.default.SCHEME_ID_URI)&&Se.hasOwnProperty(l.default.VALUE)&&(se[Se[p.default.SCHEME_ID_URI]]=Se[l.default.VALUE])}}catch(Pe){_e.e(Pe)}finally{_e.f()}}return se}function ae(B){return!B||!B.hasOwnProperty(l.default.SUPPLEMENTAL_PROPERTY_ASARRAY)||!B.SupplementalProperty_asArray.length?[]:B.SupplementalProperty_asArray.map(function(se){var _e=new m.default;return _e.init(se)})}function G(B){B&&(B.errHandler&&(X=B.errHandler),B.BASE64&&(te=B.BASE64))}return W={getIsTypeOf:Ce,getIsText:Q,getIsFragmented:ve,getProducerReferenceTimesForAdaptation:I,getLanguageForAdaptation:L,getViewpointForAdaptation:K,getRolesForAdaptation:U,getAccessibilityForAdaptation:x,getAudioChannelConfigurationForAdaptation:y,getAudioChannelConfigurationForRepresentation:S,getAdaptationForIndex:de,getIndexForAdaptation:Me,getAdaptationForId:Ae,getAdaptationsForType:Ie,getRealPeriods:ie,getRealPeriodForIndex:q,getCodec:He,getSelectionPriority:_t,getMimeType:Be,getKID:Te,getLabelsForAdaptation:Fe,getContentProtectionData:ot,getIsDynamic:st,getId:at,hasProfile:ht,getDuration:Tt,getBandwidth:xe,getManifestUpdatePeriod:we,getPublishTime:$e,getRepresentationCount:et,getBitrateListForAdaptation:qe,getRepresentationFor:Re,getRepresentationsForAdaptation:be,getAdaptationsForPeriod:Ve,getRegularPeriods:rt,getMpd:Je,getEventsForPeriod:Le,getEssentialPropertiesForRepresentation:Xe,getEventStreamForAdaptationSet:Ze,getEventStreamForRepresentation:dt,getUTCTimingSources:vt,getBaseURLsFromElement:mt,getRepresentationSortFunction:b,getContentSteering:Pt,getLocation:bt,getPatchLocation:kt,getSuggestedPresentationDelay:Wt,getAvailabilityStartTime:Vt,getServiceDescriptions:lt,getSegmentAlignment:ze,getSubSegmentAlignment:Ye,getSupplementalPropertiesForAdaptation:St,getSupplementalPropertiesAsArrayForAdaptation:Mt,getSupplementalPropertiesForRepresentation:O,getSupplementalPropertiesAsArrayForRepresentation:ae,setConfig:G},pe(),W}N.__dashjs_factory_name="DashManifestModel";let H=d.default.getSingletonFactory(N)},"./src/dash/models/PatchManifestModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/dash/constants/DashConstants.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/core/Debug.js"),i=e("./src/dash/vo/SimpleXPath.js"),E=e("./src/dash/vo/PatchOperation.js");function h(){var g,C,T=this.context;function P(){C=(0,o.default)(T).getInstance().getLogger(g)}function R(c){return c&&c.hasOwnProperty(p.default.ORIGINAL_MPD_ID)||!1}function m(c){return c&&c.hasOwnProperty(p.default.PUBLISH_TIME)?new Date(c[p.default.PUBLISH_TIME]):null}function f(c){return c&&c.hasOwnProperty(p.default.ORIGINAL_PUBLISH_TIME)?new Date(c[p.default.ORIGINAL_PUBLISH_TIME]):null}function r(c){return c&&c[p.default.ORIGINAL_MPD_ID]||null}function d(c){return c?(c.__children||[]).map(function(M){var n=Object.keys(M)[0];if(n!=="add"&&n!=="remove"&&n!=="replace")return C.warn("Ignoring node of invalid action: ".concat(n)),null;var _=M[n],u=_.sel;if(n==="add"&&_.type){if(!_.type.startsWith("@"))return C.warn("Ignoring add action for prefixed namespace declaration: ".concat(_.type,"=").concat(_.__text)),null;u="".concat(u,"/").concat(_.type)}var A=new i.default(u);if(!A.isValid())return C.warn("Ignoring action with invalid selector: ".concat(n," - ").concat(u)),null;var D=null;A.findsAttribute()?D=_.__text||"":n!=="remove"&&(D=_.__children.reduce(function($,z){var ee=Object.keys(z)[0];return ee!=="#text"&&($[ee]=$[ee]||[],$[ee].push(z[ee])),$},{}));var j=new E.default(n,A,D);return n==="add"&&(j.position=_.pos),j}).filter(function(M){return!!M}):[]}return g={getIsPatch:R,getPublishTime:m,getOriginalPublishTime:f,getMpdId:r,getPatchOperations:d},P(),g}h.__dashjs_factory_name="PatchManifestModel";let t=l.default.getSingletonFactory(h)},"./src/dash/parser/DashParser.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/core/FactoryMaker.js"),l=e("./src/dash/parser/objectiron.js"),o=e("./externals/xml2json.js"),i=e("./src/dash/parser/matchers/StringMatcher.js"),E=e("./src/dash/parser/matchers/DurationMatcher.js"),h=e("./src/dash/parser/matchers/DateTimeMatcher.js"),t=e("./src/dash/parser/matchers/NumericMatcher.js"),g=e("./src/dash/parser/matchers/LangMatcher.js"),C=e("./src/dash/parser/maps/RepresentationBaseValuesMap.js"),T=e("./src/dash/parser/maps/SegmentValuesMap.js");function P(m){m=m||{};var f=this.context,r=m.debug,d,c,M,n,_;function u(){c=r.getLogger(d),M=[new E.default,new h.default,new t.default,new g.default,new i.default],n=new o.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:M}),_=(0,l.default)(f).create({adaptationset:new C.default,period:new T.default})}function A(){return M}function D(){return _}function j($){var z,ee=window.performance.now();if(z=n.xml_str2json($),!z)throw new Error("parsing the manifest failed");var k=window.performance.now();z.Patch?(z=z.Patch,z.add_asArray&&z.add_asArray.forEach(function(N){return _.run(N)}),z.replace_asArray&&z.replace_asArray.forEach(function(N){return _.run(N)})):(z=z.MPD,_.run(z));var w=window.performance.now();return c.info("Parsing complete: ( xml2json: "+(k-ee).toPrecision(3)+"ms, objectiron: "+(w-k).toPrecision(3)+"ms, total: "+((w-ee)/1e3).toPrecision(3)+"s)"),z.protocol="DASH",z}return d={parse:j,getMatchers:A,getIron:D},u(),d}P.__dashjs_factory_name="DashParser";let R=p.default.getClassFactory(P)},"./src/dash/parser/maps/CommonProperty.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(t){p(this,h);var g=function(T){return T&&T.length&&T.charAt(0)===T.charAt(0).toUpperCase()};this._name=t,this._merge=g(t)}return o(h,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),h}();let E=i},"./src/dash/parser/maps/MapNode.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/dash/parser/maps/CommonProperty.js");function l(t,g){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}function o(t,g){for(var C=0;C<g.length;C++){var T=g[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(t,T.key,T)}}function i(t,g,C){return g&&o(t.prototype,g),C&&o(t,C),t}var E=function(){function t(g,C,T){var P=this;l(this,t),this._name=g||"",this._properties=[],this._children=T||[],Array.isArray(C)&&C.forEach(function(R){P._properties.push(new p.default(R))})}return i(t,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),t}();let h=E},"./src/dash/parser/maps/RepresentationBaseValuesMap.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/dash/parser/maps/MapNode.js"),l=e("./src/dash/constants/DashConstants.js");function o(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(d){return typeof d}:o=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},o(f)}function i(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function E(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&h(f,r)}function h(f,r){return h=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},h(f,r)}function t(f){var r=T();return function(){var c=P(f),M;if(r){var n=P(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return g(this,M)}}function g(f,r){return r&&(o(r)==="object"||typeof r=="function")?r:C(f)}function C(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function P(f){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},P(f)}var R=function(f){E(d,f);var r=t(d);function d(){i(this,d);var c=[l.default.PROFILES,l.default.WIDTH,l.default.HEIGHT,l.default.SAR,l.default.FRAMERATE,l.default.AUDIO_SAMPLING_RATE,l.default.MIME_TYPE,l.default.SEGMENT_PROFILES,l.default.CODECS,l.default.MAXIMUM_SAP_PERIOD,l.default.START_WITH_SAP,l.default.MAX_PLAYOUT_RATE,l.default.CODING_DEPENDENCY,l.default.SCAN_TYPE,l.default.FRAME_PACKING,l.default.AUDIO_CHANNEL_CONFIGURATION,l.default.CONTENT_PROTECTION,l.default.ESSENTIAL_PROPERTY,l.default.ESSENTIAL_PROPERTY+"_asArray",l.default.SUPPLEMENTAL_PROPERTY,l.default.INBAND_EVENT_STREAM];return r.call(this,l.default.ADAPTATION_SET,c,[new p.default(l.default.REPRESENTATION,c,[new p.default(l.default.SUB_REPRESENTATION,c)])])}return d}(p.default);let m=R},"./src/dash/parser/maps/SegmentValuesMap.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/dash/parser/maps/MapNode.js"),l=e("./src/dash/constants/DashConstants.js");function o(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(d){return typeof d}:o=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},o(f)}function i(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function E(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&h(f,r)}function h(f,r){return h=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},h(f,r)}function t(f){var r=T();return function(){var c=P(f),M;if(r){var n=P(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return g(this,M)}}function g(f,r){return r&&(o(r)==="object"||typeof r=="function")?r:C(f)}function C(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function P(f){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},P(f)}var R=function(f){E(d,f);var r=t(d);function d(){i(this,d);var c=[l.default.SEGMENT_BASE,l.default.SEGMENT_TEMPLATE,l.default.SEGMENT_LIST];return r.call(this,l.default.PERIOD,c,[new p.default(l.default.ADAPTATION_SET,c,[new p.default(l.default.REPRESENTATION,c)])])}return d}(p.default);let m=R},"./src/dash/parser/matchers/BaseMatcher.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(t,g){p(this,h),this._test=t,this._converter=g}return o(h,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),h}();let E=i},"./src/dash/parser/matchers/DateTimeMatcher.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>d});var p=e("./src/dash/parser/matchers/BaseMatcher.js");function l(c){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(n){return typeof n}:l=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},l(c)}function o(c,M){if(!(c instanceof M))throw new TypeError("Cannot call a class as a function")}function i(c,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(M&&M.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),M&&E(c,M)}function E(c,M){return E=Object.setPrototypeOf||function(_,u){return _.__proto__=u,_},E(c,M)}function h(c){var M=C();return function(){var _=T(c),u;if(M){var A=T(this).constructor;u=Reflect.construct(_,arguments,A)}else u=_.apply(this,arguments);return t(this,u)}}function t(c,M){return M&&(l(M)==="object"||typeof M=="function")?M:g(c)}function g(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(c){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},T(c)}var P=60,R=60,m=1e3,f=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,r=function(c){i(n,c);var M=h(n);function n(){return o(this,n),M.call(this,function(_){return f.test(_.value)},function(_){var u=f.exec(_),A;if(A=Date.UTC(parseInt(u[1],10),parseInt(u[2],10)-1,parseInt(u[3],10),parseInt(u[4],10),parseInt(u[5],10),u[6]&&parseInt(u[6],10)||0,u[7]&&parseFloat(u[7])*m||0),u[9]&&u[10]){var D=parseInt(u[9],10)*R+parseInt(u[10],10);A+=(u[8]==="+"?-1:1)*D*P*m}return new Date(A)})}return n}(p.default);let d=r},"./src/dash/parser/matchers/DurationMatcher.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>_});var p=e("./src/dash/parser/matchers/BaseMatcher.js"),l=e("./src/streaming/constants/Constants.js"),o=e("./src/dash/constants/DashConstants.js");function i(u){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(D){return typeof D}:i=function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},i(u)}function E(u,A){if(!(u instanceof A))throw new TypeError("Cannot call a class as a function")}function h(u,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(A&&A.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),A&&t(u,A)}function t(u,A){return t=Object.setPrototypeOf||function(j,$){return j.__proto__=$,j},t(u,A)}function g(u){var A=P();return function(){var j=R(u),$;if(A){var z=R(this).constructor;$=Reflect.construct(j,arguments,z)}else $=j.apply(this,arguments);return C(this,$)}}function C(u,A){return A&&(i(A)==="object"||typeof A=="function")?A:T(u)}function T(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function P(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R(u){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(D){return D.__proto__||Object.getPrototypeOf(D)},R(u)}var m=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,f=365*24*60*60,r=30*24*60*60,d=24*60*60,c=60*60,M=60,n=function(u){h(D,u);var A=g(D);function D(){return E(this,D),A.call(this,function(j){for(var $=[o.default.MIN_BUFFER_TIME,o.default.MEDIA_PRESENTATION_DURATION,o.default.MINIMUM_UPDATE_PERIOD,o.default.TIMESHIFT_BUFFER_DEPTH,o.default.MAX_SEGMENT_DURATION,o.default.MAX_SUBSEGMENT_DURATION,o.default.SUGGESTED_PRESENTATION_DELAY,o.default.START,l.default.START_TIME,o.default.DURATION],z=$.length,ee=0;ee<z;ee++)if(j.nodeName===$[ee])return m.test(j.value);return!1},function(j){var $=m.exec(j),z=parseFloat($[3]||0)*f+parseFloat($[5]||0)*r+parseFloat($[7]||0)*d+parseFloat($[9]||0)*c+parseFloat($[11]||0)*M+parseFloat($[13]||0);return $[1]!==void 0&&(z=-z),z})}return D}(p.default);let _=n},"./src/dash/parser/matchers/LangMatcher.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>d});var p=e("./src/dash/parser/matchers/BaseMatcher.js"),l=e("./src/dash/constants/DashConstants.js"),o=e("./node_modules/bcp-47-normalize/index.js"),i=e.n(o);function E(c){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?E=function(n){return typeof n}:E=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},E(c)}function h(c,M,n){return M in c?Object.defineProperty(c,M,{value:n,enumerable:!0,configurable:!0,writable:!0}):c[M]=n,c}function t(c,M){if(!(c instanceof M))throw new TypeError("Cannot call a class as a function")}function g(c,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(M&&M.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),M&&C(c,M)}function C(c,M){return C=Object.setPrototypeOf||function(_,u){return _.__proto__=u,_},C(c,M)}function T(c){var M=m();return function(){var _=f(c),u;if(M){var A=f(this).constructor;u=Reflect.construct(_,arguments,A)}else u=_.apply(this,arguments);return P(this,u)}}function P(c,M){return M&&(E(M)==="object"||typeof M=="function")?M:R(c)}function R(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}function m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f(c){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},f(c)}var r=function(c){g(n,c);var M=T(n);function n(){return t(this,n),M.call(this,function(_,u){var A,D=(A={},h(A,l.default.ADAPTATION_SET,[l.default.LANG]),h(A,l.default.REPRESENTATION,[l.default.LANG]),h(A,l.default.CONTENT_COMPONENT,[l.default.LANG]),h(A,l.default.LABEL,[l.default.LANG]),h(A,l.default.GROUP_LABEL,[l.default.LANG]),A);if(D.hasOwnProperty(u)){var j=D[u];return j!==void 0?j.indexOf(_.name)>=0:!1}return!1},function(_){var u=i()(_);return u!==void 0?u:String(_)})}return n}(p.default);let d=r},"./src/dash/parser/matchers/NumericMatcher.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/dash/parser/matchers/BaseMatcher.js");function l(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(d){return typeof d}:l=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},l(f)}function o(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function i(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&E(f,r)}function E(f,r){return E=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},E(f,r)}function h(f){var r=C();return function(){var c=T(f),M;if(r){var n=T(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return t(this,M)}}function t(f,r){return r&&(l(r)==="object"||typeof r=="function")?r:g(f)}function g(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(f){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},T(f)}var P=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,R=function(f){i(d,f);var r=h(d);function d(){return o(this,d),r.call(this,function(c){return P.test(c.value)},function(c){return parseFloat(c)})}return d}(p.default);let m=R},"./src/dash/parser/matchers/StringMatcher.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>f});var p=e("./src/dash/parser/matchers/BaseMatcher.js"),l=e("./src/dash/constants/DashConstants.js");function o(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(c){return typeof c}:o=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},o(r)}function i(r,d,c){return d in r?Object.defineProperty(r,d,{value:c,enumerable:!0,configurable:!0,writable:!0}):r[d]=c,r}function E(r,d){if(!(r instanceof d))throw new TypeError("Cannot call a class as a function")}function h(r,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(d&&d.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),d&&t(r,d)}function t(r,d){return t=Object.setPrototypeOf||function(M,n){return M.__proto__=n,M},t(r,d)}function g(r){var d=P();return function(){var M=R(r),n;if(d){var _=R(this).constructor;n=Reflect.construct(M,arguments,_)}else n=M.apply(this,arguments);return C(this,n)}}function C(r,d){return d&&(o(d)==="object"||typeof d=="function")?d:T(r)}function T(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function P(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R(r){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},R(r)}var m=function(r){h(c,r);var d=g(c);function c(){return E(this,c),d.call(this,function(M,n){var _,u=(_={},i(_,l.default.MPD,[l.default.ID,l.default.PROFILES]),i(_,l.default.PERIOD,[l.default.ID]),i(_,l.default.BASE_URL,[l.default.SERVICE_LOCATION,l.default.BYTE_RANGE]),i(_,l.default.SEGMENT_BASE,[l.default.INDEX_RANGE]),i(_,l.default.INITIALIZATION,[l.default.RANGE]),i(_,l.default.REPRESENTATION_INDEX,[l.default.RANGE]),i(_,l.default.SEGMENT_LIST,[l.default.INDEX_RANGE]),i(_,l.default.BITSTREAM_SWITCHING,[l.default.RANGE]),i(_,l.default.SEGMENT_URL,[l.default.MEDIA_RANGE,l.default.INDEX_RANGE]),i(_,l.default.SEGMENT_TEMPLATE,[l.default.INDEX_RANGE,l.default.MEDIA,l.default.INDEX,l.default.INITIALIZATION_MINUS,l.default.BITSTREAM_SWITCHING_MINUS]),i(_,l.default.ASSET_IDENTIFIER,[l.default.VALUE,l.default.ID]),i(_,l.default.EVENT_STREAM,[l.default.VALUE]),i(_,l.default.ADAPTATION_SET,[l.default.PROFILES,l.default.MIME_TYPE,l.default.SEGMENT_PROFILES,l.default.CODECS,l.default.CONTENT_TYPE]),i(_,l.default.FRAME_PACKING,[l.default.VALUE,l.default.ID]),i(_,l.default.AUDIO_CHANNEL_CONFIGURATION,[l.default.VALUE,l.default.ID]),i(_,l.default.CONTENT_PROTECTION,[l.default.VALUE,l.default.ID]),i(_,l.default.ESSENTIAL_PROPERTY,[l.default.VALUE,l.default.ID]),i(_,l.default.SUPPLEMENTAL_PROPERTY,[l.default.VALUE,l.default.ID]),i(_,l.default.INBAND_EVENT_STREAM,[l.default.VALUE,l.default.ID]),i(_,l.default.ACCESSIBILITY,[l.default.VALUE,l.default.ID]),i(_,l.default.ROLE,[l.default.VALUE,l.default.ID]),i(_,l.default.RATING,[l.default.VALUE,l.default.ID]),i(_,l.default.VIEWPOINT,[l.default.VALUE,l.default.ID]),i(_,l.default.CONTENT_COMPONENT,[l.default.CONTENT_TYPE]),i(_,l.default.REPRESENTATION,[l.default.ID,l.default.DEPENDENCY_ID,l.default.MEDIA_STREAM_STRUCTURE_ID]),i(_,l.default.SUBSET,[l.default.ID]),i(_,l.default.METRICS,[l.default.METRICS_MINUS]),i(_,l.default.REPORTING,[l.default.VALUE,l.default.ID]),_);if(u.hasOwnProperty(n)){var A=u[n];return A!==void 0?A.indexOf(M.name)>=0:!1}return!1},function(M){return String(M)})}return c}(p.default);let f=m},"./src/dash/parser/objectiron.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js");function l(h){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(g){return typeof g}:l=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(h)}function o(h){function t(P,R){for(var m in P)R.hasOwnProperty(m)||(R[m]=P[m])}function g(P,R,m){for(var f=0,r=P.length;f<r;++f){var d=P[f];if(R[d.name])if(m[d.name]){if(d.merge){var c=R[d.name],M=m[d.name];l(c)==="object"&&l(M)==="object"?t(c,M):m[d.name]=c+M}}else m[d.name]=R[d.name]}}function C(P,R){for(var m=0,f=P.children.length;m<f;++m){var r=P.children[m],d=R[r.name+"_asArray"];if(d)for(var c=0,M=d.length;c<M;++c){var n=d[c];g(P.properties,R,n),C(r,n)}}}function T(P){if(P===null||l(P)!=="object")return P;if(P.Period_asArray&&"period"in h)for(var R=h.period,m=P.Period_asArray,f=0,r=m.length;f<r;++f){var d=m[f];if(C(R,d),"adaptationset"in h){var c=d.AdaptationSet_asArray;if(c)for(var M=h.adaptationset,n=0,_=c.length;n<_;++n)C(M,c[n])}}return P}return{run:T}}o.__dashjs_factory_name="ObjectIron";var i=p.default.getClassFactory(o);let E=i},"./src/dash/utils/ListSegmentsGetter.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/constants/Constants.js"),o=e("./src/dash/utils/SegmentsUtils.js");function i(t,g){t=t||{};var C=t.timelineConverter,T;function P(){if(!C||!C.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(l.default.MISSING_CONFIG_ERROR)}function R(r){var d={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!r)return d;var c=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].SegmentList,M=r&&!isNaN(r.startNumber)?r.startNumber:1,n=Math.max(M-1,0);return d.numberOfSegments=n+c.SegmentURL_asArray.length,d}function m(r,d){if(P(),!r)return null;var c=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].SegmentList,M=c.SegmentURL_asArray.length,n=r&&!isNaN(r.startNumber)?r.startNumber:1,_=Math.max(n-1,0),u=Math.max(d-_,0),A=null;if(u<M){var D=c.SegmentURL_asArray[u];A=(0,o.getIndexBasedSegment)(C,g,r,d),A&&(A.replacementTime=(n+d-1)*r.segmentDuration,A.media=D.media?D.media:"",A.mediaRange=D.mediaRange,A.indexRange=D.indexRange)}return A}function f(r,d){if(P(),!r)return null;var c=r.segmentDuration;if(isNaN(c))return null;var M=C.calcPeriodRelativeTimeFromMpdRelativeTime(r,d),n=Math.floor(M/c);return m(r,n)}return T={getSegmentByIndex:m,getSegmentByTime:f,getMediaFinishedInformation:R},T}i.__dashjs_factory_name="ListSegmentsGetter";var E=p.default.getClassFactory(i);let h=E},"./src/dash/utils/Round10.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(){p(this,h)}return o(h,null,[{key:"round10",value:function(g,C){return E("round",g,C)}}]),h}();function E(h,t,g){return typeof g>"u"||+g==0?Math[h](t):(t=+t,g=+g,t===null||isNaN(t)||!(typeof g=="number"&&g%1===0)?NaN:(t=t.toString().split("e"),t=Math[h](+(t[0]+"e"+(t[1]?+t[1]-g:-g))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+g:g))))}},"./src/dash/utils/SegmentBaseGetter.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/constants/Constants.js");function o(h){h=h||{};var t=h.timelineConverter,g;function C(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(l.default.MISSING_CONFIG_ERROR)}function T(f){var r={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return!f||!f.segments||(r.numberOfSegments=f.segments.length),r}function P(f,r){if(C(),!f)return null;var d=f.segments?f.segments.length:-1,c;if(r<d&&(c=f.segments[r],c&&c.index===r))return c;for(var M=0;M<d;M++)if(c=f.segments[M],c&&c.index===r)return c;return null}function R(f,r){C();var d=m(f,r);return P(f,d)}function m(f,r){if(!f)return-1;var d=f.segments,c=d?d.length:null,M=-1,n,_,u,A,D;if(d&&c>0){for(D=0;D<c;D++)if(_=d[D],u=_.presentationStartTime,A=_.duration,n=A/2,r+n>=u&&r-n<u+A){M=_.index;break}}return M}return g={getSegmentByIndex:P,getSegmentByTime:R,getMediaFinishedInformation:T},g}o.__dashjs_factory_name="SegmentBaseGetter";var i=p.default.getClassFactory(o);let E=i},"./src/dash/utils/SegmentsUtils.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{getIndexBasedSegment:()=>C,getTimeBasedSegment:()=>T,replaceIDForTemplate:()=>E,replaceTokenForTemplate:()=>h,unescapeDollarsInTemplate:()=>i});var p=e("./src/dash/vo/Segment.js");function l(P,R){for(;P.length<R;)P="0"+P;return P}function o(P,R){return P.representation.startNumber+R}function i(P){return P&&P.split("$$").join("$")}function E(P,R){if(!R||!P||P.indexOf("$RepresentationID$")===-1)return P;var m=R.toString();return P.split("$RepresentationID$").join(m)}function h(P,R,m){var f="%0",r,d,c,M,n,_,u=R.length,A=f.length;if(!P)return P;for(;;){if(r=P.indexOf("$"+R),r<0||(d=P.indexOf("$",r+u),d<0))return P;if(c=P.indexOf(f,r+u),c>r&&c<d)switch(M=P.charAt(d-1),n=parseInt(P.substring(c+A,d-1),10),M){case"d":case"i":case"u":_=l(m.toString(),n);break;case"x":_=l(m.toString(16),n);break;case"X":_=l(m.toString(16),n).toUpperCase();break;case"o":_=l(m.toString(8),n);break;default:return P}else _=m;P=P.substring(0,r)+_+P.substring(d+1)}}function t(P,R,m,f,r,d,c,M){var n=new p.default;return n.representation=P,n.duration=R,n.presentationStartTime=m,n.mediaStartTime=f,n.availabilityStartTime=r.calcAvailabilityStartTimeFromPresentationTime(d,P,c),n.availabilityEndTime=r.calcAvailabilityEndTimeFromPresentationTime(d+R,P,c),n.wallStartTime=r.calcWallTimeForSegment(n,c),n.replacementNumber=o(n,M),n.index=M,n}function g(P,R,m,f){var r=R.adaptation.period;if(isFinite(r.duration)&&r.start+r.duration<=m.presentationStartTime)return!1;if(f){if(R.availabilityTimeOffset==="INF")return!0;var d=P.getClientReferenceTime();return m.availabilityStartTime.getTime()<=d&&(!isFinite(m.availabilityEndTime)||m.availabilityEndTime.getTime()>=d)}return!0}function C(P,R,m,f){var r,d,c;r=m.segmentDuration,isNaN(r)&&(r=m.adaptation.period.duration),d=parseFloat((m.adaptation.period.start+f*r).toFixed(5)),c=parseFloat((d+r).toFixed(5));var M=P.calcMediaTimeFromPresentationTime(d,m),n=t(m,r,d,M,P,c,R,f);return g(P,m,n,R)?n:null}function T(P,R,m,f,r,d,c,M,n,_){var u=f/d,A=r/d,D,j,$;return D=P.calcPresentationTimeFromMediaTime(u,m),j=D+A,$=t(m,A,D,u,P,j,R,n),g(P,m,$,R)?($.replacementTime=_||f,c=h(c,"Number",$.replacementNumber),c=h(c,"Time",$.replacementTime),$.media=c,$.mediaRange=M,$):null}},"./src/dash/utils/TemplateSegmentsGetter.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/constants/Constants.js"),o=e("./src/dash/utils/SegmentsUtils.js");function i(t,g){t=t||{};var C=t.timelineConverter,T;function P(){if(!C||!C.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(l.default.MISSING_CONFIG_ERROR)}function R(r){var d={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!r)return d;var c=r.segmentDuration;return isNaN(c)?d.numberOfSegments=1:d.numberOfSegments=Math.ceil(r.adaptation.period.duration/c),d}function m(r,d){if(P(),!r)return null;var c=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].SegmentTemplate;d=Math.max(d,0);var M=(0,o.getIndexBasedSegment)(C,g,r,d);if(M){M.replacementTime=Math.round((d-1)*r.segmentDuration*r.timescale,10);var n=c.media;n=(0,o.replaceTokenForTemplate)(n,"Number",M.replacementNumber),n=(0,o.replaceTokenForTemplate)(n,"Time",M.replacementTime),M.media=n}return M}function f(r,d){if(P(),!r)return null;var c=r.segmentDuration;if(isNaN(c))return null;var M=C.calcPeriodRelativeTimeFromMpdRelativeTime(r,d),n=Math.floor(M/c);return m(r,n)}return T={getSegmentByIndex:m,getSegmentByTime:f,getMediaFinishedInformation:R},T}i.__dashjs_factory_name="TemplateSegmentsGetter";var E=p.default.getClassFactory(i);let h=E},"./src/dash/utils/TimelineConverter.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>P});var p=e("./src/core/EventBus.js"),l=e("./src/core/events/Events.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/dash/constants/DashConstants.js"),E=e("./src/dash/models/DashManifestModel.js"),h=e("./src/core/Settings.js"),t=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/MediaPlayerEvents.js"),C=e("./src/streaming/constants/ConformanceViolationConstants.js");function T(){var R=this.context,m=(0,p.default)(R).getInstance(),f=(0,h.default)(R).getInstance(),r,d,c,M;function n(){d=(0,E.default)(R).getInstance(),ve()}function _(){Ce(),m.on(l.default.UPDATE_TIME_SYNC_OFFSET,pe,this)}function u(){return M}function A(Ee){M=Ee}function D(){return Date.now()-c*1e3+M*1e3}function j(Ee,ge,Q,le){var Y,I=ge.adaptation.period.mpd,L=I.availabilityStartTime;if(le)Q&&I.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?Y=new Date(L.getTime()+(Ee+I.timeShiftBufferDepth)*1e3):Y=I.availabilityEndTime;else if(Q){var K=ge.availabilityTimeOffset;Y=new Date(L.getTime()+(Ee-K)*1e3)}else Y=L;return Y}function $(Ee,ge,Q){return j(Ee,ge,Q)}function z(Ee,ge,Q){return j(Ee,ge,Q,!0)}function ee(Ee,ge){return(Ee.getTime()-ge.mpd.availabilityStartTime.getTime()+M*1e3)/1e3}function k(Ee,ge){var Q=ge.adaptation.period.start,le=ge.presentationTimeOffset;return Ee+(Q-le)}function w(Ee,ge){var Q=ge.adaptation.period.start,le=ge.presentationTimeOffset;return Ee-Q+le}function N(Ee,ge){var Q,le,Y;return ge&&(Q=Ee.representation.adaptation.period.mpd.suggestedPresentationDelay,le=Ee.presentationStartTime+Q,Y=new Date(Ee.availabilityStartTime.getTime()+le*1e3)),Y}function H(Ee,ge){if(!ge)return W(Ee);if(f.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var Q=X(Ee);return te(Q.now,Q.range),Q.range}return Z(Ee)}function W(Ee){var ge={start:NaN,end:NaN},Q=0,le=NaN;return Ee.forEach(function(Y){var I=Y.getStreamInfo();Q+=I.duration,(isNaN(le)||I.start<le)&&(le=I.start)}),ge.start=le,ge.end=le+Q,ge}function Z(Ee){var ge={start:NaN,end:NaN};if(!Ee||Ee.length===0)return ge;var Q=Ee[0].getAdapter().getRegularPeriods()[0],le=ee(new Date,Q),Y=Q.mpd.timeShiftBufferDepth,I=isNaN(Y)?0:le-Y;if(ge.start=fe(Ee,I),ge.end=!isNaN(ge.start)&&le<ge.start?le:fe(Ee,le,!0),!isNaN(Y)&&ge.end<le-Y&&(ge.end=NaN),f.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var L=X(Ee);if(L.range.end<ge.start)return m.trigger(g.default.CONFORMANCE_VIOLATION,{level:C.default.LEVELS.WARNING,event:C.default.EVENTS.INVALID_DVR_WINDOW}),te(L.now,L.range),L.range}return ge}function X(Ee){var ge={start:NaN,end:NaN},Q=Ee[0].getAdapter().getRegularPeriods()[0],le=ee(new Date,Q);if(!Ee||Ee.length===0)return{range:ge,now:le};Ee.forEach(function(I){var L=I.getAdapter(),K=L.getMediaInfoForType(I.getStreamInfo(),t.default.VIDEO)||L.getMediaInfoForType(I.getStreamInfo(),t.default.AUDIO),U=L.getVoRepresentations(K),x=U[0],y={start:NaN,end:NaN};if(x)if(x.segmentInfoType===i.default.SEGMENT_TIMELINE)y=J(x);else{var S=x.adaptation.period;y.start=S.start,y.end=Math.max(le,S.start+S.duration)}!isNaN(y.start)&&(isNaN(ge.start)||ge.start>y.start)&&(ge.start=y.start),!isNaN(y.end)&&(isNaN(ge.end)||ge.end<y.end)&&(ge.end=y.end)}),ge.end=Math.min(le,ge.end);var Y=fe(Ee,ge.end,!0);return ge.end=isNaN(Y)?ge.end:Y,ge.start=Q&&Q.mpd&&Q.mpd.timeShiftBufferDepth&&!isNaN(Q.mpd.timeShiftBufferDepth)&&!isNaN(ge.end)?Math.max(ge.end-Q.mpd.timeShiftBufferDepth,ge.start):ge.start,ge.start=fe(Ee,ge.start),{range:ge,now:le}}function te(Ee,ge){c=Ee-ge.end}function fe(Ee,ge){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;try{for(var le=0,Y=!1,I=NaN;!Y&&le<Ee.length;){var L=Ee[le].getStreamInfo();L.start<=ge&&(!isFinite(L.duration)||L.start+L.duration>=ge)?(I=ge,Y=!0):!Q&&L.start>ge&&(isNaN(I)||L.start<I)?I=L.start:Q&&L.start+L.duration<ge&&(isNaN(I)||L.start+L.duration>I)&&(I=L.start+L.duration),le+=1}return I}catch{return ge}}function J(Ee){var ge=Ee.adaptation.period.mpd.manifest.Period_asArray[Ee.adaptation.period.index].AdaptationSet_asArray[Ee.adaptation.index],Q=d.getRepresentationFor(Ee.index,ge),le=Q.SegmentTemplate||Q.SegmentList,Y=le.SegmentTimeline,I=le.timescale,L=Y.S_asArray,K={start:0,end:0},U=L[0].t,x=!isNaN(U),y=x?U:0,S=0,b,F,oe,ie;for(x&&(K.start=k(y/I,Ee)),oe=0,ie=L.length;oe<ie;oe++)b=L[oe],F=0,b.hasOwnProperty("r")&&(F=b.r),S+=b.d*(1+F);return K.end=k((y+S)/I,Ee),K}function ue(Ee,ge){var Q=Ee.adaptation.period.start;return ge-Q}function pe(Ee){Ee.offset!==void 0&&!isNaN(Ee.offset)&&A(Ee.offset/1e3)}function Ce(){M=0,c=0}function ve(){m.off(l.default.UPDATE_TIME_SYNC_OFFSET,pe,this),Ce()}return r={initialize:_,getClientTimeOffset:u,setClientTimeOffset:A,getClientReferenceTime:D,calcAvailabilityStartTimeFromPresentationTime:$,calcAvailabilityEndTimeFromPresentationTime:z,calcPresentationTimeFromWallTime:ee,calcPresentationTimeFromMediaTime:k,calcPeriodRelativeTimeFromMpdRelativeTime:ue,calcMediaTimeFromPresentationTime:w,calcWallTimeForSegment:N,calcTimeShiftBufferWindow:H,reset:ve},n(),r}T.__dashjs_factory_name="TimelineConverter";let P=o.default.getSingletonFactory(T)},"./src/dash/utils/TimelineSegmentsGetter.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/constants/Constants.js"),o=e("./src/dash/utils/SegmentsUtils.js");function i(t,g){t=t||{};var C=t.timelineConverter,T=t.dashMetrics,P;function R(){if(!C)throw new Error(l.default.MISSING_CONFIG_ERROR)}function m(n){if(!n)return 0;var _=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].SegmentTemplate||n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].SegmentList,u=_.SegmentTimeline,A=0,D=0,j=0,$,z,ee,k,w,N,H;for(H=n.timescale,$=u.S_asArray,k=$.length,ee=0;ee<k;ee++){if(z=$[ee],N=0,z.hasOwnProperty("r")&&(N=z.r),z.hasOwnProperty("t")&&(A=z.t,D=A/H),N<0){var W=$[ee+1];N=r(n,W,z,H,D)}for(w=0;w<=N;w++)j++,A+=z.d,D=A/H}return{numberOfSegments:j,mediaTimeOfLastSignaledSegment:D}}function f(n,_){var u=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].SegmentTemplate||n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].SegmentList,A=u.SegmentTimeline,D=u.SegmentURL_asArray,j=0,$=-1,z,ee,k,w,N,H,W;W=n.timescale,z=A.S_asArray;var Z=!1;for(k=0,w=z.length;k<w&&!Z;k++){if(ee=z[k],H=0,ee.hasOwnProperty("r")&&(H=ee.r),ee.hasOwnProperty("t")&&(j=ee.t),H<0){var X=z[k+1];H=r(n,X,ee,W,j/W)}for(N=0;N<=H&&!Z;N++)$++,Z=_(j,u,D,ee,W,$,k),Z&&(n.segmentDuration=ee.d/W),j+=ee.d}}function r(n,_,u,A,D){var j;if(_&&_.hasOwnProperty("t"))j=_.t/A;else try{var $=0;if(!isNaN(n.adaptation.period.start)&&!isNaN(n.adaptation.period.duration)&&isFinite(n.adaptation.period.duration))$=n.adaptation.period.start+n.adaptation.period.duration;else{var z=T.getCurrentDVRInfo();$=isNaN(z.end)?0:z.end}j=C.calcMediaTimeFromPresentationTime($,n),n.segmentDuration=u.d/A}catch{j=0}return Math.max(Math.ceil((j-D)/(u.d/A))-1,0)}function d(n,_,u){if(R(),!n)return null;var A=null,D=!1;return f(n,function(j,$,z,ee,k,w,N){if(D||u<0){var H=$.media,W=ee.mediaRange;return z&&(H=z[N].media||"",W=z[N].mediaRange),A=(0,o.getTimeBasedSegment)(C,g,n,j,ee.d,k,H,W,w,ee.tManifest),!0}else j>=u*k-ee.d*.5&&(D=!0);return!1}),A}function c(n,_){if(R(),!n)return null;_===void 0&&(_=null);var u=null,A=C.calcMediaTimeFromPresentationTime(_,n);return f(n,function(D,j,$,z,ee,k,w){var N=M(A*ee);if(N<D+z.d&&N>=D){var H=j.media,W=z.mediaRange;return $&&(H=$[w].media||"",W=$[w].mediaRange),u=(0,o.getTimeBasedSegment)(C,g,n,D,z.d,ee,H,W,k,z.tManifest),!0}return!1}),u}function M(n){return parseFloat(n.toPrecision(15))}return P={getSegmentByIndex:d,getSegmentByTime:c,getMediaFinishedInformation:m},P}i.__dashjs_factory_name="TimelineSegmentsGetter";var E=p.default.getClassFactory(i);let h=E},"./src/dash/vo/AdaptationSet.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.period=null,this.index=-1,this.type=null};let o=l},"./src/dash/vo/BaseURL.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}var l=1,o=1,i=function h(t,g,C,T){p(this,h),this.url=t||"",this.serviceLocation=g||t||"",this.dvb_priority=C||l,this.dvb_weight=T||o,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.queryParams={}};i.DEFAULT_DVB_PRIORITY=l,i.DEFAULT_DVB_WEIGHT=o;let E=i},"./src/dash/vo/ContentSteering.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.defaultServiceLocation=null,this.defaultServiceLocationArray=[],this.queryBeforeStart=!1,this.serverUrl=null,this.clientRequirement=!0};let o=l},"./src/dash/vo/ContentSteeringRequest.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/streaming/vo/metrics/HTTPRequest.js");function l(E,h){if(!(E instanceof h))throw new TypeError("Cannot call a class as a function")}var o=function E(h){l(this,E),this.url=h||null,this.type=p.HTTPRequest.CONTENT_STEERING_TYPE,this.responseType="json"};let i=o},"./src/dash/vo/ContentSteeringResponse.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.version=null,this.ttl=300,this.reloadUri=null,this.pathwayPriority=[],this.pathwayClones=[]};let o=l},"./src/dash/vo/DescriptorType.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(){p(this,h),this.schemeIdUri=null,this.value=null,this.id=null}return o(h,[{key:"init",value:function(g){return g&&(this.schemeIdUri=g.schemeIdUri?g.schemeIdUri:null,this.value=g.value?g.value:null,this.id=g.id?g.id:null),this}}]),h}();let E=i},"./src/dash/vo/Event.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.type="",this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};let o=l},"./src/dash/vo/EventStream.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0};let o=l},"./src/dash/vo/ManifestInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null,this.serviceDescriptions=[],this.protocol=null};let o=l},"./src/dash/vo/MediaInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.viewpointsWithSchemeIdUri=null,this.accessibility=null,this.accessibilitiesWithSchemeIdUri=null,this.audioChannelConfiguration=null,this.audioChannelConfigurationsWithSchemeIdUri=null,this.roles=null,this.rolesWithSchemeIdUri=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={},this.supplementalPropertiesAsArray=[],this.segmentAlignment=!1,this.subSegmentAlignment=!1};let o=l},"./src/dash/vo/Mpd.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};let o=l},"./src/dash/vo/MpdLocation.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h){p(this,i),this.url=E||"",this.serviceLocation=h||null,this.queryParams={}};let o=l},"./src/dash/vo/PatchLocation.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h,t){p(this,i),this.url=E||"",this.serviceLocation=h||null,this.ttl=t||NaN,this.queryParams={}};let o=l},"./src/dash/vo/PatchOperation.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(t,g,C){p(this,h),this.action=t,this.xpath=g,this.value=C,this.position=null}return o(h,[{key:"getMpdTarget",value:function(g){var C=this.action==="remove"||this.action==="replace"||this.position==="before"||this.position==="after";return this.xpath.getMpdTarget(g,C)}}]),h}();let E=i},"./src/dash/vo/Period.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};l.DEFAULT_ID="defaultId";let o=l},"./src/dash/vo/ProducerReferenceTime.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null};let o=l},"./src/dash/vo/Representation.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/dash/constants/DashConstants.js");function l(t,g){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}function o(t,g){for(var C=0;C<g.length;C++){var T=g[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(t,T.key,T)}}function i(t,g,C){return g&&o(t.prototype,g),C&&o(t,C),t}var E=function(){function t(){l(this,t),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.frameRate=null}return i(t,[{key:"hasInitialization",value:function(){return this.initialization!==null||this.range!==null}},{key:"hasSegments",value:function(){return this.segmentInfoType!==p.default.BASE_URL&&this.segmentInfoType!==p.default.SEGMENT_BASE&&!this.indexRange}}]),t}();let h=E},"./src/dash/vo/RepresentationInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};let o=l},"./src/dash/vo/Segment.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null};let o=l},"./src/dash/vo/SimpleXPath.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(t){var g=this;p(this,h),this.valid=t[0]=="/",this.path=t.split("/").filter(function(C){return C.length!==0}).map(function(C){var T={name:C},P=C.indexOf("[");if(P!=-1){T.name=C.substring(0,P);var R=C.substring(P+1,C.length-1);g.valid=g.valid&&R.indexOf("[")==-1;var m=R.indexOf("=");m!=-1?(T.attribute={name:R.substring(1,m),value:R.substring(m+1)},["'",'"'].indexOf(T.attribute.value[0])!=-1&&(T.attribute.value=T.attribute.value.substring(1,T.attribute.value.length-1))):T.position=parseInt(R,10)-1}return T})}return o(h,[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(g,C){for(var T=null,P=g,R=1,m="MPD";R<this.path.length&&P!==null;){T=P;var f=this.path[R];if(m=f.name,R!==this.path.length-1||!m.startsWith("@")){var r=T[m+"_asArray"]||[];r.length===0&&T[m]&&r.push(T[m]),f.position?P=r[f.position]||null:f.attribute?function(){var d=f.attribute;P=r.filter(function(c){return c[d.name]==d.value})[0]||null}():P=r[0]||null}R++}return P===null?null:m.startsWith("@")?{name:m.substring(1),leaf:P,target:P}:{name:m,leaf:P,target:C?T:P}}}]),h}();let E=i},"./src/dash/vo/StreamInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0};let o=l},"./src/dash/vo/UTCTiming.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.schemeIdUri="",this.value=""};let o=l},"./src/streaming/FragmentLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/net/URLLoader.js"),o=e("./src/streaming/vo/HeadRequest.js"),i=e("./src/streaming/vo/DashJSError.js"),E=e("./src/core/FactoryMaker.js");function h(g){g=g||{};var C=this.context,T=g.eventBus,P=g.events,R=g.urlUtils,m=g.errors,f=g.streamId,r,d;function c(){d=(0,l.default)(C).create({errHandler:g.errHandler,errors:m,dashMetrics:g.dashMetrics,mediaPlayerModel:g.mediaPlayerModel,requestModifier:g.requestModifier,urlUtils:R,constants:p.default,boxParser:g.boxParser,dashConstants:g.dashConstants,requestTimeout:g.settings.get().streaming.fragmentRequestTimeout})}function M(A){var D=function(z){T.trigger(P.CHECK_FOR_EXISTENCE_COMPLETED,{request:A,exists:z})};if(A){var j=new o.default(A.url);d.load({request:j,success:function(){D(!0)},error:function(){D(!1)}})}else D(!1)}function n(A){var D=function($,z){T.trigger(P.LOADING_COMPLETED,{request:A,response:$||null,error:z||null,sender:r})};A?d.load({request:A,progress:function($){T.trigger(P.LOADING_PROGRESS,{request:A,stream:$.stream,streamId:f}),$.data&&T.trigger(P.LOADING_DATA_PROGRESS,{request:A,response:$.data||null,error:null,sender:r})},success:function($){D($)},error:function($,z,ee){D(void 0,new i.default(m.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,ee,z))},abort:function($){$&&T.trigger(P.LOADING_ABANDONED,{mediaType:$.mediaType,request:$,sender:r})}}):D(void 0,new i.default(m.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,m.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))}function _(){d&&d.abort()}function u(){d&&(d.abort(),d=null)}return r={checkForExistence:M,load:n,abort:_,reset:u},c(),r}h.__dashjs_factory_name="FragmentLoader";let t=E.default.getClassFactory(h)},"./src/streaming/ManifestLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>d});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/dash/constants/DashConstants.js"),o=e("./src/streaming/controllers/XlinkController.js"),i=e("./src/streaming/net/URLLoader.js"),E=e("./src/streaming/utils/URLUtils.js"),h=e("./src/streaming/vo/TextRequest.js"),t=e("./src/streaming/vo/DashJSError.js"),g=e("./src/streaming/vo/metrics/HTTPRequest.js"),C=e("./src/core/EventBus.js"),T=e("./src/core/events/Events.js"),P=e("./src/core/errors/Errors.js"),R=e("./src/core/FactoryMaker.js"),m=e("./src/dash/parser/DashParser.js");function f(c){c=c||{};var M=this.context,n=c.debug,_=c.settings,u=(0,C.default)(M).getInstance(),A=(0,E.default)(M).getInstance(),D,j,$,z,ee,k=c.mssHandler,w=c.errHandler;function N(){j=n.getLogger(D),u.on(T.default.XLINK_READY,H,D),$=(0,i.default)(M).create({errHandler:c.errHandler,dashMetrics:c.dashMetrics,mediaPlayerModel:c.mediaPlayerModel,requestModifier:c.requestModifier,urlUtils:A,constants:p.default,dashConstants:l.default,errors:P.default,requestTimeout:c.settings.get().streaming.manifestRequestTimeout}),z=(0,o.default)(M).create({errHandler:w,dashMetrics:c.dashMetrics,mediaPlayerModel:c.mediaPlayerModel,requestModifier:c.requestModifier,settings:c.settings}),ee=null}function H(te){u.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:te.manifest})}function W(te){var fe=null;return te.indexOf("SmoothStreamingMedia")>-1?(k&&(fe=k.createMssParser(),k.createMssFragmentProcessor(),k.registerEvents()),fe):te.indexOf("MPD")>-1||te.indexOf("Patch")>-1?(0,m.default)(M).create({debug:n}):fe}function Z(te){var fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,ue=new Date,pe=new h.default(te,g.HTTPRequest.MPD_TYPE);fe&&(pe.serviceLocation=fe),J&&(pe.queryParams=J),pe.requestStartDate||(pe.requestStartDate=ue),u.trigger(T.default.MANIFEST_LOADING_STARTED,{request:pe}),$.load({request:pe,success:function(ve,Ee,ge){if(z){var Q,le,Y;if(ge&&ge!==te?(le=A.parseBaseUrl(ge),Q=ge):(A.isRelative(te)&&(te=A.resolve(te,window.location.href)),le=A.parseBaseUrl(te)),Ee=="No Content"){u.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null});return}if(ee===null&&(ee=W(ve)),ee===null){u.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new t.default(P.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,P.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(te))});return}z.setMatchers(ee.getMatchers()),z.setIron(ee.getIron());try{Y=ee.parse(ve)}catch{u.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new t.default(P.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,P.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(te))});return}if(Y){if(Y.url=Q||te,Y.originalUrl||(Y.originalUrl=Y.url),_&&_.get().streaming.enableManifestDurationMismatchFix&&Y.mediaPresentationDuration&&Y.Period_asArray.length>1){var I=Y.Period_asArray.reduce(function(L,K){return L+K.duration},0);!isNaN(I)&&Y.mediaPresentationDuration>I&&(j.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),Y.mediaPresentationDuration=I)}Y.baseUri=le,Y.loadedTime=new Date,z.resolveManifestOnLoad(Y),u.trigger(T.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:ve})}else u.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new t.default(P.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,P.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(te))})}},error:function(ve,Ee,ge){u.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new t.default(P.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,P.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(te,", ").concat(ge))})}})}function X(){u.off(T.default.XLINK_READY,H,D),k&&k.reset(),z&&(z.reset(),z=null),$&&($.abort(),$=null)}return D={load:Z,reset:X},N(),D}f.__dashjs_factory_name="ManifestLoader";var r=R.default.getClassFactory(f);let d=r},"./src/streaming/ManifestUpdater.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>P});var p=e("./src/core/EventBus.js"),l=e("./src/core/events/Events.js"),o=e("./src/streaming/MediaPlayerEvents.js"),i=e("./src/core/FactoryMaker.js"),E=e("./src/core/Debug.js"),h=e("./src/core/errors/Errors.js"),t=e("./src/dash/constants/DashConstants.js"),g=e("./src/streaming/utils/URLUtils.js"),C=e("./src/streaming/utils/LocationSelector.js");function T(){var R=this.context,m=(0,p.default)(R).getInstance(),f=(0,g.default)(R).getInstance(),r,d,c,M,n,_,u,A,D,j,$,z,ee,k;function w(){d=(0,E.default)(R).getInstance().getLogger(r),j=(0,C.default)(R).create()}function N(Y){Y&&(Y.manifestModel&&(D=Y.manifestModel),Y.adapter&&($=Y.adapter),Y.manifestLoader&&(A=Y.manifestLoader),Y.errHandler&&(z=Y.errHandler),Y.locationSelector&&(j=Y.locationSelector),Y.settings&&(k=Y.settings),Y.contentSteeringController&&(ee=Y.contentSteeringController))}function H(){Z(),m.on(l.default.STREAMS_COMPOSED,Q,this),m.on(o.default.PLAYBACK_STARTED,Ee,this),m.on(o.default.PLAYBACK_PAUSED,ge,this),m.on(l.default.INTERNAL_MANIFEST_LOADED,ve,this)}function W(Y){pe(Y)}function Z(){c=NaN,u=!1,n=!0,_=!1,te()}function X(){m.off(o.default.PLAYBACK_STARTED,Ee,this),m.off(o.default.PLAYBACK_PAUSED,ge,this),m.off(l.default.STREAMS_COMPOSED,Q,this),m.off(l.default.INTERNAL_MANIFEST_LOADED,ve,this),Z()}function te(){M!==null&&(clearTimeout(M),M=null)}function fe(Y){te(),!_&&(isNaN(Y)&&!isNaN(c)&&(Y=c*1e3),isNaN(Y)||(d.debug("Refresh manifest in "+Y+" milliseconds."),M=setTimeout(Ce,Y)))}function J(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;u=!0;var I=D.getValue(),L=I.url,K=null,U=$.getPatchLocation(I),x=j.select(U),y=null;if(x&&!Y)L=x.url,K=x.serviceLocation,y=x.queryParams;else{var S=ue(I),b=j.select(S);b&&(L=b.url,K=b.serviceLocation,y=b.queryParams)}f.isRelative(L)&&(L=f.resolve(L,I.url)),A.load(L,K,y)}function ue(Y){var I=$.getLocation(Y),L=ee.getSynthesizedLocationElements(I);return I.concat(L)}function pe(Y){if(!Y)Y=D.getValue(),Y.loadedTime=new Date;else if($.getIsPatch(Y)){var I=Y;Y=D.getValue();var L=$.isPatchValid(Y,I),K=L;if(L){var U=$.getPublishTime(Y);K=$.applyPatchToManifest(Y,I);var x=$.getPublishTime(Y);K=U.getTime()!=x.getTime()}if(!K){d.debug("Patch provided is invalid, performing full manifest refresh"),J(!0);return}Y.loadedTime=new Date}if(D.getValue()&&D.getValue().type===t.default.DYNAMIC&&Y.type===t.default.STATIC){m.trigger(l.default.DYNAMIC_TO_STATIC),u=!1,_=!0;return}D.setValue(Y);var y=new Date,S=(y.getTime()-Y.loadedTime.getTime())/1e3;c=$.getManifestUpdatePeriod(Y,S),c*1e3>2147483647&&(c=2147483647e-3),m.trigger(l.default.MANIFEST_UPDATED,{manifest:Y}),d.info("Manifest has been refreshed at "+y+"["+y.getTime()/1e3+"] "),n||fe()}function Ce(){if(!n){if(u){fe(k.get().streaming.manifestUpdateRetryInterval);return}J()}}function ve(Y){Y.error?Y.error.code===h.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&z.error(Y.error):pe(Y.manifest)}function Ee(){n=!1,fe()}function ge(){n=!k.get().streaming.scheduling.scheduleWhilePaused,n&&te()}function Q(){u=!1}function le(){return u}return r={initialize:H,setManifest:W,refreshManifest:J,getIsUpdating:le,setConfig:N,reset:X},w(),r}T.__dashjs_factory_name="ManifestUpdater";let P=i.default.getClassFactory(T)},"./src/streaming/MediaPlayer.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>y});var p=e("./externals/cea608-parser.js"),l=e.n(p),o=e("./src/streaming/constants/Constants.js"),i=e("./src/dash/constants/DashConstants.js"),E=e("./src/streaming/constants/MetricsConstants.js"),h=e("./src/streaming/controllers/PlaybackController.js"),t=e("./src/streaming/controllers/StreamController.js"),g=e("./src/streaming/controllers/GapController.js"),C=e("./src/streaming/controllers/CatchupController.js"),T=e("./src/dash/controllers/ServiceDescriptionController.js"),P=e("./src/dash/controllers/ContentSteeringController.js"),R=e("./src/streaming/controllers/MediaController.js"),m=e("./src/streaming/controllers/BaseURLController.js"),f=e("./src/streaming/ManifestLoader.js"),r=e("./src/streaming/utils/ErrorHandler.js"),d=e("./src/streaming/utils/Capabilities.js"),c=e("./src/streaming/utils/CapabilitiesFilter.js"),M=e("./src/streaming/utils/RequestModifier.js"),n=e("./src/streaming/models/URIFragmentModel.js"),_=e("./src/streaming/models/ManifestModel.js"),u=e("./src/streaming/models/MediaPlayerModel.js"),A=e("./src/streaming/controllers/AbrController.js"),D=e("./src/streaming/net/SchemeLoaderFactory.js"),j=e("./src/streaming/models/VideoModel.js"),$=e("./src/streaming/models/CmcdModel.js"),z=e("./src/streaming/models/CmsdModel.js"),ee=e("./src/streaming/utils/DOMStorage.js"),k=e("./src/core/Debug.js"),w=e("./src/core/errors/Errors.js"),N=e("./src/core/EventBus.js"),H=e("./src/core/events/Events.js"),W=e("./src/streaming/MediaPlayerEvents.js"),Z=e("./src/core/FactoryMaker.js"),X=e("./src/core/Settings.js"),te=e("./src/core/Version.js"),fe=e("./src/dash/controllers/SegmentBaseController.js"),J=e("./src/dash/DashAdapter.js"),ue=e("./src/dash/DashMetrics.js"),pe=e("./src/dash/utils/TimelineConverter.js"),Ce=e("./src/streaming/vo/metrics/HTTPRequest.js"),ve=e("./externals/base64.js"),Ee=e("./node_modules/codem-isoboxer/dist/iso_boxer.js"),ge=e("./src/streaming/vo/DashJSError.js"),Q=e("./src/streaming/utils/SupervisorTools.js"),le=e("./src/streaming/ManifestUpdater.js"),Y=e("./src/streaming/utils/URLUtils.js"),I=e("./src/streaming/utils/BoxParser.js"),L=e("./src/streaming/text/TextController.js"),K=e("./src/streaming/models/CustomParametersModel.js");function U(){var S="You must first call initialize() and set a source before calling this method",b="You must first call initialize() and set a valid source and view before calling this method",F="You must first call attachView() to set the video element before calling this method",oe="You must first call attachSource() with a valid source before calling this method",ie="MediaPlayer not initialized!",q=this.context,Ae=(0,N.default)(q).getInstance(),de=(0,X.default)(q).getInstance(),Me=(0,k.default)(q).getInstance({settings:de}),Ie,He,Be,ze,Ye,Te,Fe,ot,st,at,ht,Tt,xe,we,$e,et,qe,_t,Xe,Re,ye,be,We,Qe,Ve,rt,ft,Je,yt,At,Le,Ue,Ze,dt,vt,mt,Pt,Ft,bt;function kt(){He=Me.getLogger(Ie),Ye=!1,Fe=!1,Te=!1,ot=!0,st=NaN,we=null,qe=null,ze=null,_t=null,bt=null,H.default.extend(W.default),Xe=(0,u.default)(q).getInstance(),Re=(0,K.default)(q).getInstance(),mt=(0,j.default)(q).getInstance(),Pt=(0,n.default)(q).getInstance()}function Wt(Ge){Ge&&(Ge.capabilities&&(We=Ge.capabilities),Ge.capabilitiesFilter&&(Qe=Ge.capabilitiesFilter),Ge.streamController&&(Ve=Ge.streamController),Ge.textController&&(rt=Ge.textController),Ge.gapController&&(ft=Ge.gapController),Ge.playbackController&&(Je=Ge.playbackController),Ge.serviceDescriptionController&&(yt=Ge.serviceDescriptionController),Ge.contentSteeringController&&(At=Ge.contentSteeringController),Ge.catchupController&&(Le=Ge.catchupController),Ge.mediaPlayerModel&&(Xe=Ge.mediaPlayerModel),Ge.customParametersModel&&(Re=Ge.customParametersModel),Ge.abrController&&(at=Ge.abrController),Ge.schemeLoaderFactory&&(ht=Ge.schemeLoaderFactory),Ge.mediaController&&(xe=Ge.mediaController),Ge.settings&&(de=Ge.settings))}function Vt(Ge,Et,Dt){var Kt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:NaN;if(We||(We=(0,d.default)(q).getInstance(),We.setConfig({settings:de})),ye||(ye=(0,r.default)(q).getInstance()),!We.supportsMediaSource()){ye.error(new ge.default(w.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,w.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE));return}Ye||(Ye=!0,Tt=(0,pe.default)(q).getInstance(),at||(at=(0,A.default)(q).getInstance(),at.setConfig({settings:de})),ht||(ht=(0,D.default)(q).getInstance()),Je||(Je=(0,h.default)(q).getInstance()),xe||(xe=(0,R.default)(q).getInstance()),Ve||(Ve=(0,t.default)(q).getInstance()),ft||(ft=(0,g.default)(q).getInstance()),Le||(Le=(0,C.default)(q).getInstance()),yt||(yt=(0,T.default)(q).getInstance()),At||(At=(0,P.default)(q).getInstance()),Qe||(Qe=(0,c.default)(q).getInstance()),_t=(0,J.default)(q).getInstance(),Ze=(0,_.default)(q).getInstance(),dt=(0,$.default)(q).getInstance(),vt=(0,z.default)(q).getInstance(),Ue=(0,ue.default)(q).getInstance({settings:de}),Ft=(0,ee.default)(q).getInstance({settings:de}),_t.setConfig({constants:o.default,cea608parser:l(),errHandler:ye,BASE64:ve}),be||(be=(0,m.default)(q).create()),be.setConfig({adapter:_t,contentSteeringController:At}),yt.setConfig({adapter:_t}),bt||(bt=(0,fe.default)(q).getInstance({dashMetrics:Ue,mediaPlayerModel:Xe,errHandler:ye,baseURLController:be,events:H.default,eventBus:Ae,debug:Me,boxParser:(0,I.default)(q).getInstance(),requestModifier:(0,M.default)(q).getInstance(),errors:w.default})),xe.setConfig({domStorage:Ft,settings:de,customParametersModel:Re}),Xe.setConfig({playbackController:Je,serviceDescriptionController:yt}),At.setConfig({adapter:_t,errHandler:ye,dashMetrics:Ue,mediaPlayerModel:Xe,manifestModel:Ze,serviceDescriptionController:yt,eventBus:Ae,requestModifier:(0,M.default)(q).getInstance()}),Fr(),pr(Dt!==void 0?Dt:!0),Hn()),Ge&&Dr(Ge),Et&&En(Et,Kt),He.info("[dash.js "+G()+"] MediaPlayer has been initialized")}function lt(){En(null),Dr(null),ze=null,we&&(we.reset(),we=null),$e&&($e.reset(),$e=null),Re&&Re.reset(),de.reset(),qe&&(qe.reset(),qe=null)}function St(){lt(),Z.default.deleteSingletonInstances(q)}function Mt(){return!!Be&&!!mt.getElement()}function O(Ge,Et,Dt,Kt){Ae.on(Ge,Et,Dt,Kt)}function ae(Ge,Et,Dt){Ae.off(Ge,Et,Dt)}function G(){return(0,te.getVersionString)()}function B(){return Me}function se(){if(!(mt.getElement()||Te))if(Be)pn(st);else throw oe}function _e(){if(!Fe)throw b;(!ot||Se()&&Fe)&&Je.play(!0)}function me(){if(!Fe)throw b;Je.pause()}function Se(){if(!Fe)throw b;return Je.isPaused()}function Pe(Ge){if(!Fe)throw b;if((0,Q.checkParameterType)(Ge,"number"),isNaN(Ge))throw o.default.BAD_ARGUMENT_ERROR;Ge<0&&(Ge=0);var Et=Je.getIsDynamic()?It(Ge):Ge,Dt=Yt();!Je.getIsDynamic()&&Dt.duration&&(Et=Math.min(Dt.duration,Et)),Je.seek(Et,!1,!1,!0)}function ke(){!Fe||!Oe()||Je.seekToOriginalLive()}function De(){if(!Fe)throw b;return Je.isSeeking()}function Oe(){if(!Fe)throw b;return Je.getIsDynamic()}function Ne(){if(!Fe)throw b;return Je.getLowLatencyModeEnabled()}function tt(Ge){Yt().playbackRate=Ge}function gt(){return Yt().playbackRate}function ct(Ge){(0,Q.checkParameterType)(Ge,"boolean"),Yt().muted=Ge}function Ct(){return Yt().muted}function Ke(Ge){if(typeof Ge!="number"||isNaN(Ge)||Ge<0||Ge>1)throw o.default.BAD_ARGUMENT_ERROR;Yt().volume=Ge}function ut(){return Yt().volume}function nt(Ge){var Et=[o.default.VIDEO,o.default.AUDIO,o.default.TEXT];if(Ge)if(Et.indexOf(Ge)!==-1){var Kt=Ot().getCurrentBufferLevel(Ge);return Kt||NaN}else return He.warn("getBufferLength requested for invalid type"),NaN;else{var Dt=Et.map(function(Ht){return kn(Ht).length>0?Ot().getCurrentBufferLevel(Ht):Number.MAX_VALUE}).reduce(function(Ht,Ur){return Math.min(Ht,Ur)});return Dt===Number.MAX_VALUE?NaN:Dt}}function Rt(){var Ge=Ve&&Ve.hasVideoTrack()?o.default.VIDEO:o.default.AUDIO,Et=Ue.getCurrentDVRInfo(Ge);return Et?Et.manifestInfo.dvrWindowSize:0}function It(Ge){var Et=Ve&&Ve.hasVideoTrack()?o.default.VIDEO:o.default.AUDIO,Dt=Ue.getCurrentDVRInfo(Et);if(!Dt)return 0;var Kt=Je.getOriginalLiveDelay(),Ht=Dt.range.start+Ge;return Ht>Dt.range.end-Kt&&(Ht=Dt.range.end-Kt),Ht}function Ut(){if(!Fe)throw b;return Je.getOriginalLiveDelay()}function Nt(Ge){if(!Fe)throw b;var Et=Yt().currentTime;if(Ge!==void 0)Et=Ve.getTimeRelativeToStreamId(Et,Ge);else if(Je.getIsDynamic()){var Dt=Ve&&Ve.hasVideoTrack()?o.default.VIDEO:o.default.AUDIO,Kt=Ue.getCurrentDVRInfo(Dt);Et=Kt===null||Et===0?0:Math.max(0,Et-Kt.range.start)}return Et}function jt(){if(!Fe)throw b;var Ge=Yt().duration;if(Je.getIsDynamic()){var Et=Ve&&Ve.hasVideoTrack()?o.default.VIDEO:o.default.AUDIO,Dt=Ue.getCurrentDVRInfo(Et);Ge=Dt?Dt.range.end-Dt.range.start:0}return Ge}function Xt(){if(!Fe)throw b;return Nt()<0?NaN:Gn(Nt())}function $t(){if(!Fe)throw b;return Gn(jt())}function ar(Ge){if(!Te)throw S;return at.getTopBitrateInfoFor(Ge)}function lr(Ge){if(!Te)throw S;if(Ge===o.default.IMAGE){var Et=Qr();if(!Et)return-1;var Dt=Et.getThumbnailController();return Dt?Dt.getCurrentTrackIndex():-1}return at.getQualityFor(Ge)}function gr(Ge,Et){var Dt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!Te)throw S;if(Ge===o.default.IMAGE){var Kt=Qr();if(!Kt)return;var Ht=Kt.getThumbnailController();Ht&&Ht.setTrackByIndex(Et)}at.setPlaybackQuality(Ge,Ve.getActiveStreamInfo(),Et,{forceReplace:Dt})}function Rr(){at.setElementSize(),at.setWindowResizeEventCalled(!0)}function pr(Ge){(0,Q.checkParameterType)(Ge,"boolean"),ot=Ge}function ur(){return ot}function Cr(){if(!Ye)throw ie;return Fe?Je.getCurrentLiveLatency():NaN}function Yr(Ge,Et,Dt){Re.addAbrCustomRule(Ge,Et,Dt)}function wr(Ge){Re.removeAbrCustomRule(Ge)}function zr(){Re.removeAllAbrCustomRule()}function hn(){return Re.getAbrCustomRules()}function gn(Ge,Et){Re.addUTCTimingSource(Ge,Et)}function Xr(Ge,Et){Re.removeUTCTimingSource(Ge,Et)}function Mr(){Re.clearDefaultUTCTimingSources()}function Fr(){Re.restoreDefaultUTCTimingSources()}function Pr(Ge){var Et=at.getThroughputHistory(),Dt=Je.getIsDynamic();return Et?Et.getAverageThroughput(Ge,Dt):0}function je(Ge,Et){Re.setXHRWithCredentialsForType(Ge,Et)}function it(Ge){return Re.getXHRWithCredentialsForType(Ge)}function pt(){return Hn()}function Ot(){return Ue}function Lt(Ge){var Et=Ve.getActiveStreamInfo();return!Et||!rt?!1:rt.enableText(Et.id,Ge)}function Bt(Ge){var Et=Ve.getActiveStreamInfo();return!Et||!rt?!1:rt.enableForcedTextStreaming(Ge)}function xt(){var Ge=Ve.getActiveStreamInfo();return!Ge||!rt?!1:rt.isTextEnabled(Ge)}function Qt(Ge){if(!Fe)throw b;var Et=Ve.getActiveStreamInfo();!Et||!rt||rt.setTextTrack(Et.id,Ge)}function zt(){var Ge=NaN,Et=Ve.getActiveStreamInfo();if(!(!Et||!rt))return Ge=rt.getCurrentTrackIdx(Et.id),Ge}function Yt(){if(!mt.getElement())throw F;return mt.getElement()}function Dr(Ge){if(!Ye)throw ie;mt.setElement(Ge),Ge&&(vn(),ts(),rs(),Ve&&Ve.switchToVideoElement(st)),Fe&&Wn(),pn(st)}function Br(){return mt?mt.getTTMLRenderingDiv():null}function pi(Ge){if(!mt.getElement())throw F;mt.setTTMLRenderingDiv(Ge)}function yi(Ge){if(!mt.getElement())throw F;mt.setVttRenderingDiv(Ge)}function Ti(Ge){if(!Te)throw S;var Et=Qr();return Et?Et.getBitrateListFor(Ge):[]}function Ai(Ge){if(!Te)throw S;return _t.getStreamsInfo(Ge)}function kn(Ge){if(!Te)throw S;var Et=Ve.getActiveStreamInfo();return Et?xe.getTracksFor(Ge,Et.id):[]}function Si(Ge,Et,Dt){if(!Te)throw S;return Dt=Dt||_t.getStreamsInfo(Et,1)[0],Dt?_t.getAllMediaInfoForType(Dt,Ge,Et):[]}function Ri(Ge){if(!Te)throw S;var Et=Ve.getActiveStreamInfo();return xe.getCurrentTrackFor(Ge,Et.id)}function Ci(Ge,Et){if(!Ye)throw ie;xe.setInitialSettings(Ge,Et)}function Mi(Ge){if(!Ye)throw ie;return xe.getInitialSettings(Ge)}function Pi(Ge){if(!Te)throw S;xe.setTrack(Ge)}function Di(Ge){Re.registerCustomCapabilitiesFilter(Ge)}function Ii(Ge){Re.unregisterCustomCapabilitiesFilter(Ge)}function Oi(Ge){Re.setCustomInitialTrackSelectionFunction(Ge)}function bi(){Re.resetCustomInitialTrackSelectionFunction(null)}function Li(Ge){Re.registerLicenseRequestFilter(Ge)}function Ni(Ge){Re.registerLicenseResponseFilter(Ge)}function wi(Ge){Re.unregisterLicenseRequestFilter(Ge)}function Fi(Ge){Re.unregisterLicenseResponseFilter(Ge)}function Bi(){return vn()}function Ui(Ge){we=Ge}function xi(Ge){ze=Ge,Ve&&Ve.setProtectionData(ze)}function Ki(Ge,Et){if(typeof Et=="function"){if(Ge<0){Et(null);return}var Dt=Je.getIsDynamic()?It(Ge):Ge,Kt=Ve.getStreamForTime(Dt);if(Kt===null){Et(null);return}var Ht=Kt.getThumbnailController();if(!Ht){Et(null);return}return Ht.provide(Dt,Et)}}function ji(Ge,Et){var Dt=_n(),Kt=this,Ht=function Ur(Ir){Ir.error?Et(null,Ir.error):Et(Ir.manifest),Ae.off(H.default.INTERNAL_MANIFEST_LOADED,Ur,Kt),Dt.reset()};Ae.on(H.default.INTERNAL_MANIFEST_LOADED,Ht,Kt),Pt.initialize(Ge),Dt.load(Ge)}function ki(){if(!Be)throw oe;return Be}function Wi(Ge){Be=Ge,Ve.load(Be)}function En(Ge){var Et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;if(!Ye)throw ie;typeof Ge=="string"&&Pt.initialize(Ge),Et==null&&(Et=NaN),isNaN(Et)||(Et=Math.max(0,Et)),st=Et,Be=Ge,(Te||Fe)&&Wn(),Mt()&&pn(st)}function Hi(){return de.get()}function Gi(Ge){de.update(Ge)}function Vi(){de.reset()}function Yi(Ge,Et,Dt){var Kt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,Ht=new Date(Ge*1e3),Ur=Ht.toLocaleDateString(Et),Ir=Ht.toLocaleTimeString(Et,{hour12:Dt});return Kt?Ir+" "+Ur:Ir}function zi(Ge){Ge=Math.max(Ge,0);var Et=Math.floor(Ge/3600),Dt=Math.floor(Ge%3600/60),Kt=Math.floor(Ge%3600%60);return(Et===0?"":Et<10?"0"+Et.toString()+":":Et.toString()+":")+(Dt<10?"0"+Dt.toString():Dt.toString())+":"+(Kt<10?"0"+Kt.toString():Kt.toString())}function Xi(Ge,Et,Dt){Z.default.extend(Ge,Et,Dt,q)}function Qr(){if(!Te)throw S;var Ge=Ve.getActiveStreamInfo();return Ge?Ve.getStreamById(Ge.id):null}function Qi(){return _t}function $i(){if(At)return At.loadSteeringData()}function Ji(){if(At)return At.getCurrentSteeringResponseData()}function Zi(){var Ge=Ze.getValue();return Ge?be.getBaseUrls(Ge):[]}function qi(){var Ge=Ze.getValue();if(!Ge)return[];var Et=_t.getLocation(Ge),Dt=At.getSynthesizedLocationElements(Et);return Et.concat(Dt)}function Wn(){Fe=!1,Te=!1,_t.reset(),Ve.reset(),ft.reset(),Le.reset(),Je.reset(),yt.reset(),At.reset(),at.reset(),xe.reset(),bt.reset(),we&&(de.get().streaming.protection.keepProtectionMediaKeys?we.stop():(we.reset(),we=null,vn())),rt.reset(),dt.reset(),vt.reset()}function es(){var Ge=_n();Ve||(Ve=(0,t.default)(q).getInstance()),rt||(rt=(0,L.default)(q).create({errHandler:ye,manifestModel:Ze,adapter:_t,mediaController:xe,videoModel:mt,settings:de})),Qe.setConfig({capabilities:We,customParametersModel:Re,adapter:_t,settings:de,manifestModel:Ze,errHandler:ye}),Ve.setConfig({capabilities:We,capabilitiesFilter:Qe,manifestLoader:Ge,manifestModel:Ze,mediaPlayerModel:Xe,customParametersModel:Re,protectionController:we,textController:rt,adapter:_t,dashMetrics:Ue,errHandler:ye,timelineConverter:Tt,videoModel:mt,playbackController:Je,serviceDescriptionController:yt,contentSteeringController:At,abrController:at,mediaController:xe,settings:de,baseURLController:be,uriFragmentModel:Pt,segmentBaseController:bt}),ft.setConfig({settings:de,playbackController:Je,streamController:Ve,videoModel:mt,timelineConverter:Tt,adapter:_t}),Je.setConfig({streamController:Ve,serviceDescriptionController:yt,dashMetrics:Ue,adapter:_t,videoModel:mt,timelineConverter:Tt,settings:de}),Le.setConfig({streamController:Ve,playbackController:Je,mediaPlayerModel:Xe,videoModel:mt,settings:de}),at.setConfig({streamController:Ve,domStorage:Ft,mediaPlayerModel:Xe,customParametersModel:Re,cmsdModel:vt,dashMetrics:Ue,adapter:_t,videoModel:mt,settings:de}),dt.setConfig({abrController:at,dashMetrics:Ue,playbackController:Je}),vt.setConfig({}),at.initialize(),Ve.initialize(ot,ze),rt.initialize(),ft.initialize(),Le.initialize(),dt.initialize(),vt.initialize(),At.initialize(),bt.initialize()}function _n(){return(0,f.default)(q).create({debug:Me,errHandler:ye,dashMetrics:Ue,mediaPlayerModel:Xe,requestModifier:(0,M.default)(q).getInstance(),mssHandler:et,settings:de})}function vn(){if(we)return we;var Ge=dashjs.Protection;if(typeof Ge=="function"){var Et=Ge(q).create();return H.default.extend(Ge.events),W.default.extend(Ge.events,{publicOnly:!0}),w.default.extend(Ge.errors),We||(We=(0,d.default)(q).getInstance()),we=Et.createProtectionSystem({debug:Me,errHandler:ye,videoModel:mt,customParametersModel:Re,capabilities:We,eventBus:Ae,events:H.default,BASE64:ve,constants:o.default,cmcdModel:dt,settings:de}),we}return null}function ts(){if(!$e){var Ge=dashjs.MetricsReporting;if(typeof Ge=="function"){var Et=Ge(q).create();$e=Et.createMetricsReporting({debug:Me,eventBus:Ae,mediaElement:Yt(),adapter:_t,dashMetrics:Ue,mediaPlayerModel:Xe,events:H.default,constants:o.default,metricsConstants:E.default})}}}function rs(){if(!et){var Ge=dashjs.MssHandler;typeof Ge=="function"&&(w.default.extend(Ge.errors),et=Ge(q).create({eventBus:Ae,mediaPlayerModel:Xe,dashMetrics:Ue,manifestModel:Ze,playbackController:Je,streamController:Ve,protectionController:we,baseURLController:be,errHandler:ye,events:H.default,constants:o.default,debug:Me,initSegmentType:Ce.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:ve,ISOBoxer:Ee,settings:de}))}}function Hn(){if(!Ye)throw ie;if(qe)return qe;var Ge=dashjs.OfflineController;if(typeof Ge=="function"){H.default.extend(Ge.events),W.default.extend(Ge.events,{publicOnly:!0}),w.default.extend(Ge.errors);var Et=_n(),Dt=(0,le.default)(q).create();return Dt.setConfig({manifestModel:Ze,adapter:_t,manifestLoader:Et,errHandler:ye,contentSteeringController:At}),qe=Ge(q).create({debug:Me,manifestUpdater:Dt,baseURLController:be,manifestLoader:Et,manifestModel:Ze,mediaPlayerModel:Xe,abrController:at,playbackController:Je,adapter:_t,errHandler:ye,dashMetrics:Ue,timelineConverter:Tt,segmentBaseController:bt,schemeLoaderFactory:ht,eventBus:Ae,events:H.default,errors:w.default,constants:o.default,settings:de,dashConstants:i.default,urlUtils:(0,Y.default)(q).getInstance()}),qe}return null}function Gn(Ge){var Et=Ve&&Ve.hasVideoTrack()?o.default.VIDEO:o.default.AUDIO,Dt=Ue.getCurrentDVRInfo(Et),Kt,Ht;return Dt?(Kt=Dt.manifestInfo.availableFrom.getTime()/1e3,Ht=Ge+(Kt+Dt.range.start),Ht):0}function pn(){var Ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN;qe&&qe.resetRecords(),!Te&&Be&&(Te=!0,He.info("Streaming Initialized"),es(),typeof Be=="string"?Ve.load(Be,Ge):Ve.loadWithManifest(Be,Ge)),!Fe&&Mt()&&(Fe=!0,He.info("Playback Initialized"))}return Ie={initialize:Vt,setConfig:Wt,on:O,off:ae,extend:Xi,attachView:Dr,attachSource:En,isReady:Mt,preload:se,play:_e,isPaused:Se,pause:me,isSeeking:De,isDynamic:Oe,getLowLatencyModeEnabled:Ne,seek:Pe,seekToOriginalLive:ke,setPlaybackRate:tt,getPlaybackRate:gt,setMute:ct,isMuted:Ct,setVolume:Ke,getVolume:ut,time:Nt,duration:jt,timeAsUTC:Xt,durationAsUTC:$t,getActiveStream:Qr,getDVRWindowSize:Rt,getDVRSeekOffset:It,getAvailableBaseUrls:Zi,getAvailableLocations:qi,getTargetLiveDelay:Ut,convertToTimeCode:zi,formatUTC:Yi,getVersion:G,getDebug:B,getBufferLength:nt,getTTMLRenderingDiv:Br,getVideoElement:Yt,getSource:ki,updateSource:Wi,getCurrentLiveLatency:Cr,getTopBitrateInfoFor:ar,setAutoPlay:pr,getAutoPlay:ur,getDashMetrics:Ot,getQualityFor:lr,setQualityFor:gr,updatePortalSize:Rr,enableText:Lt,enableForcedTextStreaming:Bt,isTextEnabled:xt,setTextTrack:Qt,getBitrateInfoListFor:Ti,getStreamsFromManifest:Ai,getTracksFor:kn,getTracksForTypeFromManifest:Si,getCurrentTrackFor:Ri,setInitialMediaSettingsFor:Ci,getInitialMediaSettingsFor:Mi,setCurrentTrack:Pi,addABRCustomRule:Yr,removeABRCustomRule:wr,removeAllABRCustomRule:zr,getABRCustomRules:hn,getAverageThroughput:Pr,retrieveManifest:ji,addUTCTimingSource:gn,removeUTCTimingSource:Xr,clearDefaultUTCTimingSources:Mr,restoreDefaultUTCTimingSources:Fr,setXHRWithCredentialsForType:je,getXHRWithCredentialsForType:it,getProtectionController:Bi,attachProtectionController:Ui,setProtectionData:xi,registerLicenseRequestFilter:Li,registerLicenseResponseFilter:Ni,unregisterLicenseRequestFilter:wi,unregisterLicenseResponseFilter:Fi,registerCustomCapabilitiesFilter:Di,unregisterCustomCapabilitiesFilter:Ii,setCustomInitialTrackSelectionFunction:Oi,resetCustomInitialTrackSelectionFunction:bi,attachTTMLRenderingDiv:pi,attachVttRenderingDiv:yi,getCurrentTextTrackIndex:zt,provideThumbnail:Ki,getDashAdapter:Qi,getOfflineController:pt,triggerSteeringRequest:$i,getCurrentSteeringResponseData:Ji,getSettings:Hi,updateSettings:Gi,resetSettings:Vi,reset:lt,destroy:St},kt(),Ie}U.__dashjs_factory_name="MediaPlayer";var x=Z.default.getClassFactory(U);x.events=W.default,x.errors=w.default,Z.default.updateClassFactory(U.__dashjs_factory_name,x);let y=x},"./src/streaming/MediaPlayerEvents.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/core/events/EventsBase.js");function l(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(d){return typeof d}:l=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},l(f)}function o(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function i(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&E(f,r)}function E(f,r){return E=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},E(f,r)}function h(f){var r=C();return function(){var c=T(f),M;if(r){var n=T(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return t(this,M)}}function t(f,r){return r&&(l(r)==="object"||typeof r=="function")?r:g(f)}function g(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(f){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},T(f)}var P=function(f){i(d,f);var r=h(d);function d(){var c;return o(this,d),c=r.call(this),c.AST_IN_FUTURE="astInFuture",c.BASE_URLS_UPDATED="baseUrlsUpdated",c.BUFFER_EMPTY="bufferStalled",c.BUFFER_LOADED="bufferLoaded",c.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",c.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",c.DYNAMIC_TO_STATIC="dynamicToStatic",c.ERROR="error",c.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",c.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",c.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",c.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",c.LOG="log",c.MANIFEST_LOADING_STARTED="manifestLoadingStarted",c.MANIFEST_LOADING_FINISHED="manifestLoadingFinished",c.MANIFEST_LOADED="manifestLoaded",c.METRICS_CHANGED="metricsChanged",c.METRIC_CHANGED="metricChanged",c.METRIC_ADDED="metricAdded",c.METRIC_UPDATED="metricUpdated",c.PERIOD_SWITCH_STARTED="periodSwitchStarted",c.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",c.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",c.QUALITY_CHANGE_RENDERED="qualityChangeRendered",c.TRACK_CHANGE_RENDERED="trackChangeRendered",c.STREAM_INITIALIZING="streamInitializing",c.STREAM_UPDATED="streamUpdated",c.STREAM_ACTIVATED="streamActivated",c.STREAM_DEACTIVATED="streamDeactivated",c.STREAM_INITIALIZED="streamInitialized",c.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",c.TEXT_TRACKS_ADDED="allTextTracksAdded",c.TEXT_TRACK_ADDED="textTrackAdded",c.THROUGHPUT_MEASUREMENT_STORED="throughputMeasurementStored",c.TTML_PARSED="ttmlParsed",c.TTML_TO_PARSE="ttmlToParse",c.CAPTION_RENDERED="captionRendered",c.CAPTION_CONTAINER_RESIZE="captionContainerResize",c.CAN_PLAY="canPlay",c.CAN_PLAY_THROUGH="canPlayThrough",c.PLAYBACK_ENDED="playbackEnded",c.PLAYBACK_ERROR="playbackError",c.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",c.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",c.PLAYBACK_LOADED_DATA="playbackLoadedData",c.PLAYBACK_PAUSED="playbackPaused",c.PLAYBACK_PLAYING="playbackPlaying",c.PLAYBACK_PROGRESS="playbackProgress",c.PLAYBACK_RATE_CHANGED="playbackRateChanged",c.PLAYBACK_SEEKED="playbackSeeked",c.PLAYBACK_SEEKING="playbackSeeking",c.PLAYBACK_STALLED="playbackStalled",c.PLAYBACK_STARTED="playbackStarted",c.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",c.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",c.PLAYBACK_WAITING="playbackWaiting",c.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",c.EVENT_MODE_ON_START="eventModeOnStart",c.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",c.CONFORMANCE_VIOLATION="conformanceViolation",c.REPRESENTATION_SWITCH="representationSwitch",c.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",c.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",c.INBAND_PRFT="inbandPrft",c}return d}(p.default),R=new P;let m=R},"./src/streaming/MediaPlayerFactory.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>g});var p=e("./src/streaming/MediaPlayer.js");function l(){var C="application/dash+xml",T;function P(f,r,d){if(!f||!/^VIDEO$/i.test(f.nodeName))return null;if(f._dashjs_player)return f._dashjs_player;var c,M=f.id||f.name||"video element";if(r=r||[].slice.call(f.querySelectorAll("source")).filter(function(n){return n.type==C})[0],!r&&f.src)r=document.createElement("source"),r.src=f.src;else if(!r&&!f.src)return null;return d=d||{},c=(0,p.default)(d).create(),c.initialize(f,r.src,f.autoplay),T||(T=c.getDebug().getLogger()),T.debug("Converted "+M+" to dash.js player and added content: "+r.src),f._dashjs_player=c,c}function R(f,r){var d=[];f=f||"[data-dashjs-player]",r=r||document;for(var c=r.querySelectorAll(f),M=0;M<c.length;M++){var n=P(c[M],null);d.push(n)}for(var _=r.querySelectorAll('source[type="'+C+'"]'),u=0;u<_.length;u++){var A=m(_[u]),D=P(A,null);d.push(D)}return d}function m(f){return/^VIDEO$/i.test(f.nodeName)?f:m(f.parentNode)}return{create:P,createAll:R}}var o=l(),i;function E(){window.removeEventListener("load",E),o.createAll()}function h(){window.dashjs&&(window.clearInterval(i),o.createAll())}var t=typeof window<"u"&&window&&window.dashjs&&window.dashjs.skipAutoCreate;!t&&typeof window<"u"&&window&&window.addEventListener&&(window.document.readyState==="complete"?window.dashjs?o.createAll():i=window.setInterval(h,500):window.addEventListener("load",E));let g=o},"./src/streaming/PreBufferSink.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/Debug.js"),l=e("./src/core/FactoryMaker.js");function o(h){var t=this.context,g,C,T,P=[],R=h;function m(){C=(0,p.default)(t).getInstance().getLogger(g)}function f(){P=[],T=null,R=null}function r(j){return j.segmentType!=="InitializationSegment"?(P.push(j),P.sort(function($,z){return $.start-z.start}),T=null):T=j,C.debug("PreBufferSink appended chunk s: "+j.start+"; e: "+j.end),R&&R({chunk:j}),Promise.resolve()}function d(j,$){return P=P.filter(function(z){return!((isNaN($)||z.start<$)&&(isNaN(j)||z.end>j))}),Promise.resolve()}function c(){return Promise.resolve()}function M(){for(var j=[],$=0;$<P.length;$++){var z=P[$];j.length===0||z.start>j[j.length-1].end?j.push({start:z.start,end:z.end}):j[j.length-1].end=z.end}var ee={start:function(w){return j[w].start},end:function(w){return j[w].end}};return Object.defineProperty(ee,"length",{get:function(){return j.length}}),ee}function n(){return Promise.resolve()}function _(){return this}function u(j,$){var z=A(j,$);return T&&(z.push(T),T=null),d(j,$),z}function A(j,$){return P.filter(function(z){return(isNaN($)||z.start<$)&&(isNaN(j)||z.end>j)})}function D(j){j()}return g={getAllBufferRanges:M,append:r,remove:d,abort:c,discharge:u,reset:f,updateTimestampOffset:n,waitForUpdateEnd:D,getBuffer:_},m(),g}o.__dashjs_factory_name="PreBufferSink";var i=l.default.getClassFactory(o);let E=i},"./src/streaming/SourceBufferSink.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>f});var p=e("./src/core/Debug.js"),l=e("./src/streaming/vo/DashJSError.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/core/errors/Errors.js"),E=e("./src/core/Settings.js"),h=e("./src/streaming/constants/Constants.js"),t=e("./src/streaming/vo/metrics/HTTPRequest.js"),g=e("./src/core/events/Events.js"),C=.1,T=.01,P=50;function R(r){var d=this.context,c=(0,E.default)(d).getInstance(),M=r.textController,n=r.eventBus,_,u,A,D,j,$,z=[],ee=[],k=!1,w=r.mediaSource,N=null;function H(){A=(0,p.default)(d).getInstance().getLogger(_)}function W(F,oe,ie){j=F,u=j.type;var q=j.codec;X(ie),J();var Ae=[];return Ae.push(Y()),Ae.push(Ce(j.streamInfo)),c.get().streaming.buffer.useChangeTypeForTrackSwitch&&Ae.push(Z(q)),oe&&oe.MSETimeOffset!==void 0&&Ae.push(ve(oe.MSETimeOffset)),Promise.all(Ae)}function Z(F){return new Promise(function(oe){b(function(){D.changeType&&D.changeType(F),oe()})})}function X(F){D=F.getBuffer()}function te(F,oe,ie){j=oe,u=j.type;var q=j.codec;try{if(q.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return fe(F);D=w.addSourceBuffer(q),J();var Ae=[];return Ae.push(Ce(j.streamInfo)),ie&&ie.MSETimeOffset!==void 0&&Ae.push(ve(ie.MSETimeOffset)),Promise.all(Ae)}catch(de){return j.type==h.default.TEXT&&!j.isFragmented||q.indexOf('codecs="stpp')!==-1||q.indexOf('codecs="vtt')!==-1?fe(F):Promise.reject(de)}}function fe(F){return D=M.getTextSourceBuffer(F),Promise.resolve()}function J(){if(typeof D.addEventListener=="function")try{D.addEventListener("updateend",x,!1),D.addEventListener("error",y,!1),D.addEventListener("abort",y,!1)}catch{$=setInterval(x,P)}else $=setInterval(x,P)}function ue(){return u}function pe(){try{typeof D.removeEventListener=="function"&&(D.removeEventListener("updateend",x,!1),D.removeEventListener("error",y,!1),D.removeEventListener("abort",y,!1)),clearInterval($)}catch(F){A.error(F)}}function Ce(F){return new Promise(function(oe){if(!D||!c.get().streaming.buffer.useAppendWindow){oe();return}b(function(){try{if(!D){oe();return}var ie=w.duration,q=0;F&&!isNaN(F.start)&&!isNaN(F.duration)&&isFinite(F.duration)&&(ie=F.start+F.duration),F&&!isNaN(F.start)&&(q=F.start),(D.appendWindowEnd!==ie||D.appendWindowStart!==q)&&(D.appendWindowStart=0,D.appendWindowEnd=ie+T,D.appendWindowStart=Math.max(q-C,0),A.debug("Updated append window for ".concat(j.type,". Set start to ").concat(D.appendWindowStart," and end to ").concat(D.appendWindowEnd))),oe()}catch{A.warn("Failed to set append window"),oe()}})})}function ve(F){return new Promise(function(oe){if(!D){oe();return}b(function(){try{D.timestampOffset!==F&&!isNaN(F)&&(D.timestampOffset=F,A.debug("Set MSE timestamp offset to ".concat(F))),oe()}catch{oe()}})})}function Ee(){if(D){try{z=[],pe(),k=!1,ee=[],(!D.getClassName||D.getClassName()!=="TextSourceBuffer")&&(A.debug("Removing sourcebuffer from media source"),w.removeSourceBuffer(D))}catch{}D=null}N=null}function ge(){return D}function Q(){try{return D.buffered}catch(F){return A.error("getAllBufferRanges exception: "+F.message),null}}function le(F){var oe=this,ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise(function(q,Ae){if(!F){Ae({chunk:F,error:new l.default(i.default.APPEND_ERROR_CODE,i.default.APPEND_ERROR_MESSAGE)});return}ee.push({data:F,promise:{resolve:q,reject:Ae},request:ie}),b(L.bind(oe))})}function Y(){return new Promise(function(F){b(function(){var oe=D.appendWindowStart,ie=D.appendWindowEnd;D&&(D.abort(),D.appendWindowStart=oe,D.appendWindowEnd=ie),F()})})}function I(F){return new Promise(function(oe,ie){var q=F.start,Ae=F.end;if(!(q>=0&&Ae>q)){oe();return}b(function(){try{D.remove(q,Ae),b(function(){oe({from:q,to:Ae,unintended:!1}),F.resolve&&F.resolve()})}catch(de){ie({from:q,to:Ae,unintended:!1,error:new l.default(i.default.REMOVE_ERROR_CODE,i.default.REMOVE_ERROR_MESSAGE)}),F.reject&&F.reject(de)}})})}function L(){if(!k&&ee.length>0){k=!0;var F=ee[0];ee.splice(0,1);var oe=function(){k=!1,ee.length>0&&L.call(this),F&&F.data&&F.data.segmentType&&F.data.segmentType!==t.HTTPRequest.INIT_SEGMENT_TYPE&&delete F.data.bytes,F.promise.resolve({chunk:F.data})};try{N=F.request,F.data.bytes.byteLength===0?oe.call(this):(D.appendBuffer?D.appendBuffer(F.data.bytes):D.append(F.data.bytes,F.data),b(oe.bind(this)))}catch(ie){A.fatal('SourceBuffer append failed "'+ie+'"'),ee.length>0?L():k=!1,delete F.data.bytes,F.promise.reject({chunk:F.data,error:new l.default(ie.code,ie.message)})}}}function K(){return new Promise(function(F){try{ee=[],w.readyState==="open"?b(function(){try{D&&D.abort(),F()}catch{F()}}):(D&&D.setTextTrack&&w.readyState==="ended"&&D.abort(),F())}catch{F()}})}function U(){if(z.length>0&&!D.updating){var F=z.shift();F(),U()}}function x(){D.updating||U()}function y(F){var oe=F.target||{};S(g.default.SOURCE_BUFFER_ERROR,{error:oe,lastRequestAppended:N})}function S(F,oe){var ie=oe||{};n.trigger(F,ie,{streamId:j.streamInfo.id,mediaType:u})}function b(F){z.push(F),D.updating||U()}return _={getType:ue,getAllBufferRanges:Q,getBuffer:ge,append:le,remove:I,abort:K,reset:Ee,updateTimestampOffset:ve,initializeForStreamSwitch:W,initializeForFirstUse:te,updateAppendWindow:Ce,changeType:Z},H(),_}R.__dashjs_factory_name="SourceBufferSink";var m=o.default.getClassFactory(R);let f=m},"./src/streaming/Stream.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>c});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/dash/constants/DashConstants.js"),o=e("./src/streaming/StreamProcessor.js"),i=e("./src/streaming/controllers/FragmentController.js"),E=e("./src/streaming/thumbnail/ThumbnailController.js"),h=e("./src/core/EventBus.js"),t=e("./src/core/events/Events.js"),g=e("./src/core/Debug.js"),C=e("./src/core/errors/Errors.js"),T=e("./src/core/FactoryMaker.js"),P=e("./src/streaming/vo/DashJSError.js"),R=e("./src/streaming/utils/BoxParser.js"),m=e("./src/streaming/utils/URLUtils.js"),f=e("./src/streaming/controllers/BlacklistController.js"),r=[p.default.VIDEO,p.default.AUDIO,p.default.TEXT,p.default.MUXED,p.default.IMAGE];function d(M){M=M||{};var n=this.context,_=(0,h.default)(n).getInstance(),u=(0,m.default)(n).getInstance(),A=M.manifestModel,D=M.mediaPlayerModel,j=M.dashMetrics,$=M.manifestUpdater,z=M.adapter,ee=M.timelineConverter,k=M.capabilities,w=M.errHandler,N=M.abrController,H=M.playbackController,W=M.eventController,Z=M.mediaController,X=M.protectionController,te=M.textController,fe=M.videoModel,J=M.streamInfo,ue=M.settings,pe,Ce,ve,Ee,ge,Q,le,Y,I,L,K,U,x,y,S,b,F,oe;function ie(){try{b=(0,g.default)(n).getInstance(),Ce=b.getLogger(pe),et(),S=(0,R.default)(n).getInstance(),x=(0,f.default)(n).create({updateEventName:t.default.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:t.default.SEGMENT_LOCATION_BLACKLIST_ADD}),K=(0,i.default)(n).create({streamInfo:J,mediaPlayerModel:D,dashMetrics:j,errHandler:w,settings:ue,boxParser:S,dashConstants:l.default,urlUtils:u})}catch(me){throw me}}function q(){Ae(),Me(),te.initializeForStream(J),_.trigger(t.default.STREAM_UPDATED,{streamInfo:J})}function Ae(){_.on(t.default.BUFFERING_COMPLETED,vt,pe),_.on(t.default.DATA_UPDATE_COMPLETED,mt,pe),_.on(t.default.INBAND_EVENTS,Pt,pe)}function de(){_.off(t.default.DATA_UPDATE_COMPLETED,mt,pe),_.off(t.default.BUFFERING_COMPLETED,vt,pe),_.off(t.default.INBAND_EVENTS,Pt,pe)}function Me(){X&&(_.on(t.default.KEY_ERROR,yt,pe),_.on(t.default.SERVER_CERTIFICATE_UPDATED,yt,pe),_.on(t.default.LICENSE_REQUEST_COMPLETE,yt,pe),_.on(t.default.KEY_SYSTEM_SELECTED,yt,pe),_.on(t.default.KEY_SESSION_CREATED,yt,pe),_.on(t.default.KEY_STATUSES_CHANGED,yt,pe))}function Ie(){X&&(_.off(t.default.KEY_ERROR,yt,pe),_.off(t.default.SERVER_CERTIFICATE_UPDATED,yt,pe),_.off(t.default.LICENSE_REQUEST_COMPLETE,yt,pe),_.off(t.default.KEY_SYSTEM_SELECTED,yt,pe),_.off(t.default.KEY_SESSION_CREATED,yt,pe),_.off(t.default.KEY_STATUSES_CHANGED,yt,pe))}function He(){return J?J.id:null}function Be(me,Se){return new Promise(function(Pe,ke){if(ge){Pe(Se);return}if(B()){ge=!0,_.trigger(t.default.STREAM_ACTIVATED,{streamInfo:J}),Pe(Se);return}Ye(me,Se).then(function(De){ge=!0,_.trigger(t.default.STREAM_ACTIVATED,{streamInfo:J}),Pe(De)}).catch(function(De){ke(De)})})}function ze(me,Se){return new Promise(function(Pe,ke){if(B()){ke();return}Ce.info("[startPreloading] Preloading next stream with id ".concat(be())),G(!0),Te(me,Se).then(function(){for(var De=0;De<ve.length&&ve[De];De++)ve[De].setExplicitBufferingTime(ye()),ve[De].getScheduleController().startScheduleTimer();Pe()}).catch(function(){G(!1),ke()})})}function Ye(me,Se){return Te(me,Se)}function Te(me,Se){return new Promise(function(Pe,ke){ft(),L=!0,Ue();var De=fe.getElement(),Oe=[];r.forEach(function(Ne){!(Ne===p.default.TEXT&&!me)&&(Ne!==p.default.VIDEO||!De||De&&/^VIDEO$/i.test(De.nodeName))&&Oe.push(ot(Ne,me))}),Promise.all(Oe).then(function(){return ht(Se)}).then(function(Ne){if(L=!1,ve.length===0){var tt="No streams to play.";w.error(new P.default(C.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,tt,A.getValue())),Ce.fatal(tt)}else Ze();me&&te.createTracks(J),Pe(Ne)}).catch(function(Ne){ke(Ne)})})}function Fe(me){return new Promise(function(Se,Pe){ot(p.default.TEXT,me).then(function(){return Tt()}).then(function(){te.createTracks(J),Se()}).catch(function(ke){Pe(ke)})})}function ot(me,Se){var Pe=z.getAllMediaInfoForType(J,me),ke=[],De=null,Oe;if(!Pe||Pe.length===0)return Ce.info("No "+me+" data."),Promise.resolve();me===p.default.VIDEO&&(le=!0),me===p.default.AUDIO&&(Y=!0);for(var Ne=0,tt=Pe.length;Ne<tt;Ne++)De=Pe[Ne],me===p.default.TEXT&&De.isEmbedded&&(te.addEmbeddedTrack(J,De),ke.push(De)),st(De)&&Z.addTrack(De);if(ke.length>0&&(Z.setInitialMediaSettingsForType(me,J),te.addMediaInfosToBuffer(J,me,ke)),Pe=Pe.filter(function(ct){return!ct.isEmbedded}),Pe.length===0)return Promise.resolve();if(me===p.default.IMAGE)return U=(0,E.default)(n).create({streamInfo:J,adapter:z,baseURLController:M.baseURLController,timelineConverter:M.timelineConverter,debug:b,eventBus:_,events:t.default,dashConstants:l.default,dashMetrics:M.dashMetrics,segmentBaseController:M.segmentBaseController}),U.initialize(),Promise.resolve();_.trigger(t.default.STREAM_INITIALIZING,{streamInfo:J,mediaInfo:De}),Z.setInitialMediaSettingsForType(me,J);var gt=at(Pe,Se);return Oe=Z.getCurrentTrackFor(me,J.id),Oe?(N.updateTopQualityIndex(Oe),gt.selectMediaInfo(me!==p.default.TEXT||!Oe.isEmbedded?Oe:Pe[0])):Promise.resolve()}function st(me){var Se=me?me.type:null,Pe;return Se===p.default.MUXED?(Pe="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",Ce.fatal(Pe),w.error(new P.default(C.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,Pe,A.getValue())),!1):Se===p.default.TEXT||Se===p.default.IMAGE?!0:me.contentProtection&&!k.supportsEncryptedMedia()?(w.error(new P.default(C.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,C.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),!1):!0}function at(me,Se){var Pe=me&&me.length>0?me[0]:null,ke=K.getModel(Pe?Pe.type:null),De=Pe?Pe.type:null,Oe=Pe?Pe.mimeType:null,Ne=Pe?Pe.isFragmented:null,tt=(0,o.default)(n).create({streamInfo:J,type:De,mimeType:Oe,timelineConverter:ee,adapter:z,manifestModel:A,mediaPlayerModel:D,fragmentModel:ke,dashMetrics:M.dashMetrics,baseURLController:M.baseURLController,segmentBaseController:M.segmentBaseController,abrController:N,playbackController:H,mediaController:Z,textController:te,errHandler:w,settings:ue,boxParser:S,segmentBlacklistController:x});tt.initialize(Se,le,Ne),ve.push(tt);for(var gt=0;gt<me.length;gt++)tt.addMediaInfo(me[gt]);return De===p.default.TEXT&&te.addMediaInfosToBuffer(J,De,me,ke),tt}function ht(me){return new Promise(function(Se){var Pe={},ke=ve.map(function(De){return De.createBufferSinks(me)});Promise.all(ke).then(function(De){De.forEach(function(Oe){Oe&&(Pe[Oe.getType()]=Oe)}),Se(Pe)}).catch(function(){Se(Pe)})})}function Tt(){var me=bt(p.default.TEXT);return me?me.createBufferSinks():Promise.resolve()}function xe(me){for(var Se=ve?ve.length:0,Pe=!1,ke=0;ke<Se;ke++){var De=ve[ke].getFragmentModel();De.abortRequests(),De.resetInitialSettings(),ve[ke].reset(Pe,me)}te&&te.deactivateStream(J),ve=[],ge=!1,Q=!1,G(!1),Re(!1),_.trigger(t.default.STREAM_DEACTIVATED,{streamInfo:J})}function we(){return ge}function $e(me){return new Promise(function(Se,Pe){for(var ke=[],De=0;De<ve.length;)st(ve[De].getMediaInfo())?(ke.push(ve[De].setMediaSource(me)),De++):(ve[De].reset(),ve.splice(De,1));Promise.all(ke).then(function(){for(var Oe=0;Oe<ve.length;Oe++)ve[Oe].dischargePreBuffer();if(ve.length===0){var Ne="No streams to play.";w.error(new P.default(C.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,Ne+"nostreams",A.getValue())),Ce.fatal(Ne)}Se()}).catch(function(Oe){Ce.error(Oe),Pe(Oe)})})}function et(me){xe(me),Ee=!1,le=!1,Y=!1,I={},L=!1,F=!1,oe=[]}function qe(me){K&&(K.reset(),K=null),N&&J&&N.clearDataForStream(J.id),x&&(x.reset(),x=null),et(me),J=null,de(),Ie()}function _t(){return J?J.duration:NaN}function Xe(){return F}function Re(me){F=me}function ye(){return J?J.start:NaN}function be(){return J?J.id:null}function We(){return J}function Qe(){return Y}function Ve(){return le}function rt(){return U}function ft(){if(!fe||!N)throw new Error(p.default.MISSING_CONFIG_ERROR)}function Je(me){if(ft(),me===p.default.IMAGE)return U?U.getBitrateList():[];var Se=dt(me);return N.getBitrateList(Se)}function yt(me){me.error&&(w.error(me.error),Ce.fatal(me.error.message))}function At(me){if(!(!ge||!J)){Q=!1;var Se=me.newMediaInfo,Pe=A.getValue();z.setCurrentMediaInfo(J.id,Se.type,Se);var ke=Ft(Se);if(ke){var De=H.getTime();Ce.info("Stream -  Process track changed at current time "+De),Pe.refreshManifestOnSwitchTrack?(oe.push(me),$.getIsUpdating()||(Ce.debug("Stream -  Refreshing manifest for switch track"),$.refreshManifest())):ke.selectMediaInfo(Se).then(function(){(Se.type===p.default.VIDEO||Se.type===p.default.AUDIO)&&N.updateTopQualityIndex(Se),ke.prepareTrackSwitch()})}}}function Le(me){var Se=bt(me.mediaType);Se&&Se.prepareQualityChange(me)}function Ue(){if(W){var me=z.getEventsFor(J);me&&me.length>0&&W.addInlineEvents(me,J.id)}}function Ze(){for(var me=ve.length,Se=!!I.audio||!!I.video,Pe=Se?new P.default(C.default.DATA_UPDATE_FAILED_ERROR_CODE,C.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,ke=0;ke<me;ke++)if(ve[ke].isUpdating()||L)return;if(X){X.clearMediaInfoArray();for(var De=0;De<me&&ve[De];De++){var Oe=ve[De].getType(),Ne=ve[De].getMediaInfo();if(Oe===p.default.AUDIO||Oe===p.default.VIDEO||Oe===p.default.TEXT&&Ne.isFragmented){var tt=ve[De].getMediaInfo();tt&&X.initializeForMedia(tt)}}X.handleKeySystemFromManifest()}Pe?w.error(Pe):Ee||(Ee=!0,fe.waitForReadyState(p.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){_.trigger(t.default.STREAM_INITIALIZED,{streamInfo:J})}))}function dt(me){for(var Se=null,Pe=0;Pe<ve.length;Pe++)if(Se=ve[Pe],Se.getType()===me)return Se.getMediaInfo();return null}function vt(){var me=kt(),Se=me.length;if(Se===0){Ce.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined");return}for(var Pe=0;Pe<Se;Pe++)if(!me[Pe].isBufferingCompleted()&&(me[Pe].getType()===p.default.AUDIO||me[Pe].getType()===p.default.VIDEO)){Ce.debug("onBufferingCompleted - One streamProcessor has finished but",me[Pe].getType(),"one is not buffering completed");return}Ce.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),Q=!0,_.trigger(t.default.STREAM_BUFFERING_COMPLETED,{streamInfo:J},{streamInfo:J})}function mt(me){I[me.mediaType]=me.error,Ze()}function Pt(me){W&&W.addInbandEvents(me.events,J.id)}function Ft(me){return!me||!me.type?null:bt(me.type)}function bt(me){if(!me)return null;var Se=kt();return Se.filter(function(Pe){return Pe.getType()===me})[0]}function kt(){for(var me=[],Se,Pe,ke=0;ke<ve.length;ke++)Pe=ve[ke],Se=Pe.getType(),(Se===p.default.AUDIO||Se===p.default.VIDEO||Se===p.default.TEXT)&&me.push(Pe);return me}function Wt(){for(var me=ve.length,Se=0;Se<me&&ve[Se];Se++)ve[Se].getScheduleController().startScheduleTimer()}function Vt(me){return new Promise(function(Se){L=!0,J=me,W&&Ue();for(var Pe=[],ke=0,De=ve.length;ke<De;ke++){var Oe=ve[ke],Ne=Oe.getMediaInfo();Pe.push(Oe.updateStreamInfo(J));var tt=z.getAllMediaInfoForType(J,Oe.getType());if(tt=tt.filter(function(Ct){return!Ct.isEmbedded}),tt){Oe.clearMediaInfoArray();for(var gt=0;gt<tt.length;gt++){var ct=tt[gt];Oe.addMediaInfo(tt[gt]),z.areMediaInfosEqual(Ne,ct)&&(N.updateTopQualityIndex(ct),Pe.push(Oe.selectMediaInfo(ct)))}}}Promise.all(Pe).then(function(){for(Pe=[];oe.length>0;){var Ct=oe.pop(),Ke=Ct.newMediaInfo,ut=Ft(Ct.oldMediaInfo);if(!ut)return;Pe.push(ut.prepareTrackSwitch()),Pe.push(ut.selectMediaInfo(Ke))}return Promise.all(Pe)}).then(function(){L=!1,Ze(),_.trigger(t.default.STREAM_UPDATED,{streamInfo:J}),Se()})})}function lt(me){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return ae(me,p.default.VIDEO,Se)&&ae(me,p.default.AUDIO,Se)}function St(me){return me?Mt(p.default.VIDEO,me)&&Mt(p.default.AUDIO,me):!0}function Mt(me,Se){var Pe=We(),ke=Se.getStreamInfo();if(!ke||!Pe)return!0;var De=z.getAdaptationForType(ke.index,me,ke),Oe=z.getAdaptationForType(Pe.index,me,Pe);return!De||!Oe?!De&&!Oe:!(!O(Oe)&&O(De))}function O(me){return me?!!(me.ContentProtection||me.Representation_asArray&&me.Representation_asArray.length>0&&me.Representation_asArray[0].ContentProtection):!1}function ae(me,Se){var Pe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!me||!me.hasOwnProperty("getStreamInfo"))return!1;var ke=me.getStreamInfo(),De=Pe?Pe.getStreamInfo():We();if(!ke||!De)return!1;var Oe=z.getAdaptationForType(ke.index,Se,ke),Ne=z.getAdaptationForType(De.index,Se,De);if(!Oe||!Ne)return!Oe&&!Ne;var tt=Oe&&Ne&&Oe.mimeType===Ne.mimeType,gt=Ne.Representation_asArray.map(function(ut){return ut.codecs}),ct=Oe.Representation_asArray.map(function(ut){return ut.codecs}),Ct=ct.some(function(ut){return gt.indexOf(ut)>-1}),Ke=ct.some(function(ut){return gt.some(function(nt){return k.codecRootCompatibleWithCodec(nt,ut)})});return Ct||Ke&&tt}function G(me){y=me}function B(){return y}function se(){return Q}function _e(){return z}return pe={initialize:q,getStreamId:He,activate:Be,deactivate:xe,getIsActive:we,getDuration:_t,getStartTime:ye,getId:be,getStreamInfo:We,getHasAudioTrack:Qe,getHasVideoTrack:Ve,startPreloading:ze,initializeForTextWithMediaSource:Fe,getThumbnailController:rt,getBitrateListFor:Je,updateData:Vt,reset:qe,getProcessors:kt,setMediaSource:$e,isMediaCodecCompatible:lt,isProtectionCompatible:St,getPreloaded:B,getIsEndedEventSignaled:Xe,setIsEndedEventSignaled:Re,getAdapter:_e,getHasFinishedBuffering:se,setPreloaded:G,startScheduleControllers:Wt,prepareTrackChange:At,prepareQualityChange:Le},ie(),pe}d.__dashjs_factory_name="Stream";let c=T.default.getClassFactory(d)},"./src/streaming/StreamProcessor.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>$});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/dash/constants/DashConstants.js"),o=e("./src/streaming/constants/MetricsConstants.js"),i=e("./src/streaming/models/FragmentModel.js"),E=e("./src/streaming/controllers/BufferController.js"),h=e("./src/streaming/text/NotFragmentedTextBufferController.js"),t=e("./src/streaming/controllers/ScheduleController.js"),g=e("./src/dash/controllers/RepresentationController.js"),C=e("./src/core/FactoryMaker.js"),T=e("./src/streaming/utils/SupervisorTools.js"),P=e("./src/core/EventBus.js"),R=e("./src/core/events/Events.js"),m=e("./src/streaming/MediaPlayerEvents.js"),f=e("./src/dash/DashHandler.js"),r=e("./src/core/errors/Errors.js"),d=e("./src/streaming/vo/DashJSError.js"),c=e("./src/core/Debug.js"),M=e("./src/streaming/utils/RequestModifier.js"),n=e("./src/streaming/utils/URLUtils.js"),_=e("./src/streaming/vo/metrics/PlayList.js"),u=e("./src/dash/controllers/SegmentsController.js"),A=e("./src/streaming/vo/metrics/HTTPRequest.js"),D=e("./src/streaming/utils/TimeUtils.js");function j(z){z=z||{};var ee=this.context,k=(0,P.default)(ee).getInstance(),w=z.streamInfo,N=z.type,H=z.errHandler,W=z.mimeType,Z=z.timelineConverter,X=z.adapter,te=z.manifestModel,fe=z.mediaPlayerModel,J=z.fragmentModel,ue=z.abrController,pe=z.playbackController,Ce=z.mediaController,ve=z.textController,Ee=z.dashMetrics,ge=z.settings,Q=z.boxParser,le=z.segmentBlacklistController,Y,I,L,K,U,x,y,S,b,F,oe,ie,q,Ae;function de(){I=(0,c.default)(ee).getInstance().getLogger(Y),ze(),k.on(R.default.DATA_UPDATE_COMPLETED,qe,Y,{priority:P.default.EVENT_PRIORITY_HIGH}),k.on(R.default.INIT_FRAGMENT_NEEDED,at,Y),k.on(R.default.MEDIA_FRAGMENT_NEEDED,ht,Y),k.on(R.default.INIT_FRAGMENT_LOADED,se,Y),k.on(R.default.MEDIA_FRAGMENT_LOADED,_e,Y),k.on(R.default.BUFFER_LEVEL_STATE_CHANGED,_t,Y),k.on(R.default.BUFFER_CLEARED,Xe,Y),k.on(R.default.SEEK_TARGET,gt,Y),k.on(R.default.FRAGMENT_LOADING_ABANDONED,rt,Y),k.on(R.default.FRAGMENT_LOADING_COMPLETED,ft,Y),k.on(R.default.QUOTA_EXCEEDED,Le,Y),k.on(R.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,yt,Y),k.on(R.default.SET_NON_FRAGMENTED_TEXT,At,Y),k.on(R.default.SOURCE_BUFFER_ERROR,Re,Y),k.on(R.default.BYTES_APPENDED_END_FRAGMENT,ye,Y)}function Me(Ke,ut,nt){ie=(0,u.default)(ee).create({events:R.default,eventBus:k,streamInfo:w,timelineConverter:Z,dashConstants:l.default,segmentBaseController:z.segmentBaseController,type:N}),oe=(0,f.default)(ee).create({streamInfo:w,type:N,timelineConverter:Z,dashMetrics:Ee,mediaPlayerModel:fe,baseURLController:z.baseURLController,errHandler:H,segmentsController:ie,settings:ge,boxParser:Q,events:R.default,eventBus:k,errors:r.default,debug:(0,c.default)(ee).getInstance(),requestModifier:(0,M.default)(ee).getInstance(),dashConstants:l.default,constants:p.default,urlUtils:(0,n.default)(ee).getInstance()}),L=w.manifestInfo.isDynamic,oe.initialize(L),ue.registerStreamType(N,Y),S=(0,g.default)(ee).create({streamInfo:w,type:N,abrController:ue,dashMetrics:Ee,playbackController:pe,timelineConverter:Z,dashConstants:l.default,events:R.default,eventBus:k,errors:r.default,isDynamic:L,adapter:X,segmentsController:ie}),x=tt(N,nt),x&&x.initialize(Ke),y=(0,t.default)(ee).create({streamInfo:w,type:N,mimeType:W,adapter:X,dashMetrics:Ee,mediaPlayerModel:fe,fragmentModel:J,abrController:ue,playbackController:pe,textController:ve,mediaController:Ce,bufferController:x,representationController:S,settings:ge}),y.initialize(ut),q=0,b=!1}function Ie(){return w.id}function He(){return N}function Be(){return X.getIsTextTrack(S.getData())}function ze(){U=[],K=null,q=0,b=!1,F=!1,Ae=null}function Ye(Ke,ut){oe&&oe.reset(),x&&(x.reset(Ke,ut),x=null),y&&(y.reset(),y=null),S&&(S.reset(),S=null),ie&&(ie=null),ue&&ue.unRegisterStreamType(Ie(),N),k.off(R.default.DATA_UPDATE_COMPLETED,qe,Y),k.off(R.default.INIT_FRAGMENT_NEEDED,at,Y),k.off(R.default.MEDIA_FRAGMENT_NEEDED,ht,Y),k.off(R.default.INIT_FRAGMENT_LOADED,se,Y),k.off(R.default.MEDIA_FRAGMENT_LOADED,_e,Y),k.off(R.default.BUFFER_LEVEL_STATE_CHANGED,_t,Y),k.off(R.default.BUFFER_CLEARED,Xe,Y),k.off(R.default.SEEK_TARGET,gt,Y),k.off(R.default.FRAGMENT_LOADING_ABANDONED,rt,Y),k.off(R.default.FRAGMENT_LOADING_COMPLETED,ft,Y),k.off(R.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,yt,Y),k.off(R.default.SET_NON_FRAGMENTED_TEXT,At,Y),k.off(R.default.QUOTA_EXCEEDED,Le,Y),k.off(R.default.SOURCE_BUFFER_ERROR,Re,Y),k.off(R.default.BYTES_APPENDED_END_FRAGMENT,ye,Y),ze(),N=null,w=null}function Te(){return S?S.isUpdating():!1}function Fe(Ke){return new Promise(function(ut){var nt=x.hasBufferAtTime(Ke.seekTime);if(nt){x.pruneBuffer();var Rt=x.getContinuousBufferTimeForTargetTime(Ke.seekTime);ot(Rt)&&x.setIsBufferingCompleted(!0),ut();return}y.clearScheduleTimer(),J.abortRequests(),x.prepareForPlaybackSeek().then(function(){var It=x.getAllRangesWithSafetyFactor(Ke.seekTime);return x.clearBuffers(It)}).then(function(){var It=x.getContinuousBufferTimeForTargetTime(Ke.seekTime);if(ot(It))x.setIsBufferingCompleted(!0),ut();else{var Ut=isNaN(It)?Ke.seekTime:It;ct(Ut),x.setSeekTarget(Ut);var Nt=[];Nt.push(x.updateAppendWindow());var jt=O();Nt.push(x.updateBufferTimestampOffset(jt)),Promise.all(Nt).then(function(){y.setInitSegmentRequired(!0),y.setCheckPlaybackQuality(!1),y.startScheduleTimer(),ut()})}}).catch(function(It){I.error(It)})})}function ot(Ke){return!isNaN(Ke)&&!isNaN(w.duration)&&isFinite(w.duration)&&Ke>=w.start+w.duration}function st(){return new Promise(function(Ke,ut){try{y.clearScheduleTimer(),J.abortRequests(),x.prepareForPlaybackSeek().then(function(){return x.pruneAllSafely()}).then(function(){Ke()})}catch(nt){ut(nt)}})}function at(Ke){var ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(Ke.sender){if(pe.getIsManifestUpdateInProgress()){et();return}if(!(Be()&&!ve.isTextEnabled())&&x&&Ke.representationId&&!x.appendInitSegmentFromCache(Ke.representationId)){var nt=S.getCurrentRepresentation();if(nt.range===0){ht();return}var Rt=oe?oe.getInitRequest(K,nt):null;Rt?J.executeRequest(Rt):ut&&(y.setInitSegmentRequired(!0),et())}}}function ht(Ke){var ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(pe.getIsManifestUpdateInProgress()||x.getIsPruningInProgress()){et();return}var nt=$e();nt?(b=!1,Tt(nt)):xe(ut)}function Tt(Ke){isNaN(Ke.startTime+Ke.duration)||(q=Ke.startTime+Ke.duration),Ke.delayLoadingTime=new Date().getTime()+y.getTimeToLoadDelay(),y.setTimeToLoadDelay(0),we(Ke)?(I.warn("Fragment request url ".concat(Ke.url," for stream id ").concat(w.id," and media type ").concat(N," is on the ignore list and will be skipped")),et()):(I.debug("Next fragment request url for stream id ".concat(w.id," and media type ").concat(N," is ").concat(Ke.url)),J.executeRequest(Ke))}function xe(Ke){var ut=S.getCurrentRepresentation();if(ge.get().streaming.gaps.enableSeekFix&&(b||pe.getTime()===0)){var nt;if(L?L&&ut.segmentInfoType===l.default.SEGMENT_TIMELINE&&(nt=oe.getValidTimeAheadOfTargetTime(q,K,ut,ge.get().streaming.gaps.threshold)):nt=oe.getValidTimeAheadOfTargetTime(q,K,ut,ge.get().streaming.gaps.threshold),!isNaN(nt)&&nt!==q){pe.isSeeking()||pe.getTime()===0?(I.warn("Adjusting playback time ".concat(nt," because of gap in the manifest. Seeking by ").concat(nt-q)),pe.seek(nt,!1,!1)):(I.warn("Adjusting buffering time ".concat(nt," because of gap in the manifest. Adjusting time by ").concat(nt-q)),ct(nt),Ke&&et());return}}var Rt=oe.isLastSegmentRequested(ut,q);if(Rt){var It=oe.getCurrentIndex();I.debug("Segment requesting for stream ".concat(w.id," has finished")),k.trigger(R.default.STREAM_REQUESTING_COMPLETED,{segmentIndex:It},{streamId:w.id,mediaType:N}),x.segmentRequestingCompleted(It),y.clearScheduleTimer();return}Ke&&et()}function we(Ke){var ut=Ke.url;return Ke.range&&(ut=ut.concat("_",Ke.range)),le.contains(ut)}function $e(){var Ke=O(),ut;if(isNaN(q)||He()===p.default.TEXT&&!ve.isTextEnabled())return null;if(oe){var nt=S&&Ke?S.getRepresentationForQuality(Ke.quality):null;b?ut=oe.getSegmentRequestForTime(K,nt,q):ut=oe.getNextSegmentRequest(K,nt)}return ut}function et(){y.startScheduleTimer(pe.getLowLatencyModeEnabled()?ge.get().streaming.scheduling.lowLatencyTimeout:ge.get().streaming.scheduling.defaultTimeout)}function qe(Ke){Ke.error||x.getIsBufferingCompleted()||x.updateBufferTimestampOffset(Ke.currentRepresentation)}function _t(Ke){Ee.addBufferState(N,Ke.state,y.getBufferTarget()),Ke.state===o.default.BUFFER_EMPTY&&!pe.isSeeking()&&(I.info("Buffer is empty! Stalling!"),Ee.pushPlayListTraceMetrics(new Date,_.PlayListTrace.REBUFFERING_REASON))}function Xe(Ke){J.syncExecutedRequestsWithBufferedRange(x.getBuffer().getAllBufferRanges(),w.duration),Ke.quotaExceeded&&Ke.from>pe.getTime()&&ct(Ke.from),Ke.hasEnoughSpaceToAppend&&Ke.quotaExceeded&&y.startScheduleTimer()}function Re(Ke){if(!(!Ke||!Ke.lastRequestAppended||!Ke.lastRequestAppended.url)){var ut=Ke.lastRequestAppended.url;Ke.lastRequestAppended.range&&(ut=ut.concat("_",Ke.lastRequestAppended.range)),I.warn("Blacklisting segment with url ".concat(ut)),le.add(ut)}}function ye(Ke){if(I.debug("Appended bytes for ".concat(Ke.mediaType," and stream id ").concat(Ke.streamId)),Ke.segmentType===A.HTTPRequest.INIT_SEGMENT_TYPE){var ut=Ke.quality;y.setLastInitializedQuality(ut),I.info("["+N+"] lastInitializedRepresentationInfo changed to "+Ke.quality)}Ae?Ve(Ae):y.startScheduleTimer(0)}function be(Ke){Ae&&I.warning("Canceling queued representation switch to ".concat(Ae.quality," for ").concat(N)),I.debug("Preparing quality switch for type ".concat(N));var ut=Ke.newQuality;F=!0,y.clearScheduleTimer(),S.prepareQualityChange(ut);var nt=O(ut);Ke.reason&&Ke.reason.forceReplace?We(nt):ge.get().streaming.buffer.fastSwitchEnabled?Qe(nt):Ve(nt),Ee.pushPlayListTraceMetrics(new Date,_.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),Ee.createPlaylistTraceMetrics(nt.id,pe.getTime()*1e3,pe.getPlaybackRate())}function We(Ke){J.abortRequests(),k.trigger(R.default.BUFFER_REPLACEMENT_STARTED,{mediaType:N,streamId:w.id},{mediaType:N,streamId:w.id}),x.prepareForForceReplacementQualitySwitch(Ke).then(function(){Oe(),F=!1}).catch(function(){Oe(),F=!1})}function Qe(Ke){var ut=pe.getTime(),nt=1.5*(isNaN(Ke.fragmentDuration)?1:Ke.fragmentDuration),Rt=J.getRequests({state:i.default.FRAGMENT_MODEL_EXECUTED,time:ut+nt,threshold:0})[0];if(Rt&&!Be()){var It=x.getBufferLevel(),Ut=ue.getAbandonmentStateFor(w.id,N);Rt.quality<Ke.quality&&It>=nt&&Ut!==o.default.ABANDON_LOAD?x.updateBufferTimestampOffset(Ke).then(function(){J.abortRequests();var Nt=ut+nt;ct(Nt),y.setCheckPlaybackQuality(!1),y.startScheduleTimer(),F=!1}).catch(function(){F=!1}):Ve(Ke)}else y.startScheduleTimer(),F=!1}function Ve(Ke){var ut=J.getRequests({state:i.default.FRAGMENT_MODEL_LOADING});if(ut&&ut.length>0){I.debug("Preparing for default quality switch: Waiting for ongoing segment request to be finished before applying switch."),Ae=Ke;return}x.updateBufferTimestampOffset(Ke).then(function(){K.segmentAlignment||K.subSegmentAlignment?y.startScheduleTimer():Ne(),Ae=null,F=!1}).catch(function(){Ae=null,F=!1})}function rt(Ke){I.info("onFragmentLoadingAbandoned request: "+Ke.request.url+" has been aborted"),!pe.isSeeking()&&!y.getSwitchTrack()&&!F&&(I.info("onFragmentLoadingAbandoned request: "+Ke.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),Ke.request&&Ke.request.isInitializationRequest()?y.setInitSegmentRequired(!0):ct(Ke.request.startTime+Ke.request.duration/2),y.startScheduleTimer(0))}function ft(Ke){I.info("OnFragmentLoadingCompleted for stream id "+w.id+" and media type "+N+" - Url:",Ke.request?Ke.request.url:"undefined",Ke.request.range?", Range:"+Ke.request.range:""),Be()&&y.startScheduleTimer(0),Ke.error&&Ke.request.serviceLocation&&Je(Ke)}function Je(Ke){I.info("Fragment loading completed with an error"),!(!Ke||!Ke.request||!Ke.request.type)&&(Ke.request.type===A.HTTPRequest.INIT_SEGMENT_TYPE?at({representationId:Ke.request.representationId,sender:{}},!1):Ke.request.type===A.HTTPRequest.MEDIA_SEGMENT_TYPE&&(ct(Ke.request.startTime+Ke.request.duration/2),ht({},!1)))}function yt(){ct(pe.getTime()),Mt().startScheduleTimer()}function At(Ke){var ut=Ke.currentTrackInfo;if(ut){var nt=U.find(function(Rt){return Rt.index===ut.index&&Rt.lang===ut.lang});nt&&bt(nt).then(function(){x.setIsBufferingCompleted(!1),ct(pe.getTime()),y.setInitSegmentRequired(!0),y.startScheduleTimer()})}}function Le(Ke){ct(Ke.quotaExceededTime),y.clearScheduleTimer()}function Ue(){return S}function Ze(){return x?x.getBuffer():null}function dt(){return x}function vt(){x.dischargePreBuffer()}function mt(){return J}function Pt(Ke){return w=Ke,ae()?Promise.resolve():x.updateAppendWindow()}function Ft(){return w}function bt(Ke){Ke!==K&&(!Ke||!K||Ke.type===K.type)&&(K=Ke);var ut=X.getRealAdaptation(w,K),nt=X.getVoRepresentations(K);if(S){var Rt=S.getData(),It=ue.getMaxAllowedIndexFor(N,w.id),Ut=ue.getMinAllowedIndexFor(N,w.id),Nt,jt,Xt=null;return(Rt===null||Rt.id!==ut.id)&&N!==p.default.TEXT?(jt=ue.getThroughputHistory().getAverageThroughput(N,L),Xt=jt||ue.getInitialBitrateFor(N,w.id),Nt=ue.getQualityForBitrate(K,Xt,w.id)):Nt=ue.getQualityFor(N,w.id),Ut!==void 0&&Nt<Ut&&(Nt=Ut),Nt>It&&(Nt=It),S.updateData(ut,nt,N,K.isFragmented,Nt)}else return Promise.resolve()}function kt(Ke){U.indexOf(Ke)===-1&&U.push(Ke)}function Wt(){U=[]}function Vt(){return K}function lt(){return x.getMediaSource()}function St(Ke){return x.setMediaSource(Ke,K)}function Mt(){return y}function O(Ke){var ut;return Ke!==void 0?((0,T.checkInteger)(Ke),ut=S?S.getRepresentationForQuality(Ke):null):ut=S?S.getCurrentRepresentation():null,X.convertRepresentationToRepresentationInfo(ut)}function ae(){return x?x.getIsBufferingCompleted():!1}function G(){return x?x.getBufferLevel():0}function B(){var Ke=O(),ut=S&&Ke?S.getRepresentationForQuality(Ke.quality):null;return oe.getNextSegmentRequestIdempotent(K,ut)}function se(Ke){if(ge.get().streaming.enableManifestTimescaleMismatchFix){var ut=Ke.chunk,nt=ut.bytes,Rt=ut.quality,It=O(Rt),Ut=S&&It?S.getRepresentationForQuality(It.quality):null;It&&Ut&&(Ut.timescale=Q.getMediaTimescaleFromMoov(nt))}}function _e(Ke){var ut=Ke.chunk,nt=ut.bytes,Rt=ut.quality,It=O(Rt),Ut=S&&It?S.getRepresentationForQuality(It.quality):null;if(It&&Ut){var Nt;if(ge.get().streaming.parseInbandPrft&&Ke.request.type===A.HTTPRequest.MEDIA_SEGMENT_TYPE){Nt=Nt||Q.parse(nt);var jt=Ut.timescale,Xt=me(Nt,jt);Xt&&Xt.length&&k.trigger(m.default.INBAND_PRFT,{data:Xt},{streamId:w.id,mediaType:N})}var $t=X.getEventsFor(It.mediaInfo,null,w),ar=X.getEventsFor(It,Ut,w);if($t&&$t.length>0||ar&&ar.length>0){var lr=J.getRequests({state:i.default.FRAGMENT_MODEL_EXECUTED,quality:Rt,index:ut.index})[0];Nt=Nt||Q.parse(nt);var gr=Pe(Nt,lr,$t,ar);k.trigger(R.default.INBAND_EVENTS,{events:gr},{streamId:w.id})}}}function me(Ke,ut){var nt=Ke.getBoxes("prft"),Rt=[];return nt.forEach(function(It){Rt.push(Se(It,ut))}),Rt}function Se(Ke,ut){var nt="unknown";switch(Ke.flags){case 0:nt=l.default.PRODUCER_REFERENCE_TIME_TYPE.ENCODER;break;case 16:nt=l.default.PRODUCER_REFERENCE_TIME_TYPE.APPLICATION;break;case 24:nt=l.default.PRODUCER_REFERENCE_TIME_TYPE.CAPTURED;break;default:break}var Rt=Ke.ntp_timestamp_sec*1e3+Ke.ntp_timestamp_frac/Math.pow(2,32)*1e3;Rt=(0,D.default)(ee).getInstance().ntpToUTC(Rt);var It=Ke.media_time/ut;return{type:nt,ntpTimestamp:Rt,mediaTime:It}}function Pe(Ke,ut,nt,Rt){try{for(var It={},Ut=[],Nt=nt.concat(Rt),jt=0,Xt=Nt.length;jt<Xt;jt++)It[Nt[jt].schemeIdUri+"/"+Nt[jt].value]=Nt[jt];var $t=Ke.getBoxes("emsg");if(!$t||$t.length===0)return Ut;for(var ar=Ke.getBox("sidx"),lr=ar&&!isNaN(ar.earliest_presentation_time)&&!isNaN(ar.timescale)?ar.earliest_presentation_time/ar.timescale:ut&&!isNaN(ut.mediaStartTime)?ut.mediaStartTime:0,gr=Math.max(lr,0),Rr=S.getCurrentRepresentation(),pr=0,ur=$t.length;pr<ur;pr++){var Cr=X.getEvent($t[pr],It,gr,Rr);Cr&&Ut.push(Cr)}return Ut}catch{return[]}}function ke(Ke){var ut=Ze();return ut?Promise.resolve(ut):x?x.createBufferSink(K,Ke):Promise.resolve(null)}function De(){return new Promise(function(Ke){I.debug("Preparing track switch for type ".concat(N));var ut=N===p.default.TEXT||ge.get().streaming.trackSwitchMode[N]===p.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&pe.getTimeToStreamEnd(w)>ge.get().streaming.buffer.stallThreshold;if(x.getIsBufferingCompleted()&&!ut){x.prepareForNonReplacementTrackSwitch(K.codec).then(function(){k.trigger(R.default.BUFFERING_COMPLETED,{},{streamId:w.id,mediaType:N})}).catch(function(){k.trigger(R.default.BUFFERING_COMPLETED,{},{streamId:w.id,mediaType:N})}),Ke();return}y.clearScheduleTimer(),y.setSwitchTrack(!0),ut?(k.trigger(R.default.BUFFER_REPLACEMENT_STARTED,{mediaType:N,streamId:w.id},{mediaType:N,streamId:w.id}),J.abortRequests(),x.prepareForReplacementTrackSwitch(K.codec).then(function(){var nt=O();return x.updateBufferTimestampOffset(nt)}).then(function(){Oe(),Ke()}).catch(function(){Oe(),Ke()})):x.prepareForNonReplacementTrackSwitch(K.codec).then(function(){Ne(),Ke()}).catch(function(){Ne(),Ke()})})}function Oe(){var Ke=pe.getTime();ge.get().streaming.buffer.flushBufferAtTrackSwitch&&pe.seek(Ke+.001,!1,!0),ct(Ke),x.setSeekTarget(Ke),y.startScheduleTimer()}function Ne(){var Ke=pe.getTime(),ut=x.getContinuousBufferTimeForTargetTime(Ke),nt=isNaN(ut)?Ke:ut;ct(nt),y.startScheduleTimer()}function tt(Ke,ut){var nt=null;return Ke?(Ke===p.default.TEXT&&!ut?nt=(0,h.default)(ee).create({streamInfo:w,type:Ke,mimeType:W,fragmentModel:J,textController:ve,errHandler:H,settings:ge}):nt=(0,E.default)(ee).create({streamInfo:w,type:Ke,mediaPlayerModel:fe,manifestModel:te,fragmentModel:J,errHandler:H,mediaController:Ce,representationController:S,adapter:X,textController:ve,abrController:ue,playbackController:pe,settings:ge}),nt):(H.error(new d.default(r.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,r.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}function gt(Ke){Ke&&!isNaN(Ke.time)&&(ct(Ke.time),x.setSeekTarget(Ke.time))}function ct(Ke){q=Ke,b=!0}function Ct(Ke,ut){Ee.pushPlayListTraceMetrics(Ke,ut)}return Y={initialize:Me,getStreamId:Ie,getType:He,isUpdating:Te,getBufferController:dt,dischargePreBuffer:vt,getFragmentModel:mt,getScheduleController:Mt,getRepresentationController:Ue,getRepresentationInfo:O,getBufferLevel:G,isBufferingCompleted:ae,createBufferSinks:ke,updateStreamInfo:Pt,getStreamInfo:Ft,selectMediaInfo:bt,clearMediaInfoArray:Wt,addMediaInfo:kt,prepareTrackSwitch:De,prepareQualityChange:be,getMediaInfo:Vt,getMediaSource:lt,setMediaSource:St,getBuffer:Ze,setExplicitBufferingTime:ct,finalisePlayList:Ct,probeNextRequest:B,prepareInnerPeriodPlaybackSeeking:Fe,prepareOuterPeriodPlaybackSeeking:st,reset:Ye},de(),Y}j.__dashjs_factory_name="StreamProcessor";let $=C.default.getClassFactory(j)},"./src/streaming/XlinkLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/streaming/vo/DashJSError.js"),l=e("./src/streaming/net/URLLoader.js"),o=e("./src/streaming/vo/metrics/HTTPRequest.js"),i=e("./src/streaming/vo/TextRequest.js"),E=e("./src/core/EventBus.js"),h=e("./src/core/events/Events.js"),t=e("./src/core/FactoryMaker.js"),g=e("./src/core/errors/Errors.js");function C(P){P=P||{};var R="urn:mpeg:dash:resolve-to-zero:2013",m=this.context,f=(0,E.default)(m).getInstance(),r=(0,l.default)(m).create({errHandler:P.errHandler,dashMetrics:P.dashMetrics,mediaPlayerModel:P.mediaPlayerModel,requestModifier:P.requestModifier,errors:g.default}),d;function c(n,_,u){var A=function($,z){_.resolved=!0,_.resolvedContent=$||null,f.trigger(h.default.XLINK_ELEMENT_LOADED,{element:_,resolveObject:u,error:$||z?null:new p.default(g.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,g.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+n)})};if(n===R)A(null,!0);else{var D=new i.default(n,o.HTTPRequest.XLINK_EXPANSION_TYPE);r.load({request:D,success:function($){A($)},error:function(){A(null)}})}}function M(){r&&(r.abort(),r=null)}return d={load:c,reset:M},d}C.__dashjs_factory_name="XlinkLoader";let T=t.default.getClassFactory(C)},"./src/streaming/constants/ConformanceViolationConstants.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>p});let p={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}}},"./src/streaming/constants/Constants.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});function p(t,g){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}function l(t,g){for(var C=0;C<g.length;C++){var T=g[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(t,T.key,T)}}function o(t,g,C){return g&&l(t.prototype,g),C&&l(t,C),t}var i=function(){function t(){p(this,t),this.init()}return o(t,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"}}}]),t}(),E=new i;let h=E},"./src/streaming/constants/MetricsConstants.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});function p(t,g){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}function l(t,g){for(var C=0;C<g.length;C++){var T=g[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(t,T.key,T)}}function o(t,g,C){return g&&l(t.prototype,g),C&&l(t,C),t}var i=function(){function t(){p(this,t),this.init()}return o(t,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting"}}]),t}(),E=new i;let h=E},"./src/streaming/constants/ProtectionConstants.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});function p(t,g){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}function l(t,g){for(var C=0;C<g.length;C++){var T=g[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(t,T.key,T)}}function o(t,g,C){return g&&l(t.prototype,g),C&&l(t,C),t}var i=function(){function t(){p(this,t),this.init()}return o(t,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}]),t}(),E=new i;let h=E},"./src/streaming/controllers/AbrController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>D});var p=e("./src/streaming/rules/abr/ABRRulesCollection.js"),l=e("./src/streaming/constants/Constants.js"),o=e("./src/streaming/constants/MetricsConstants.js"),i=e("./src/streaming/vo/BitrateInfo.js"),E=e("./src/streaming/models/FragmentModel.js"),h=e("./src/core/EventBus.js"),t=e("./src/core/events/Events.js"),g=e("./src/core/FactoryMaker.js"),C=e("./src/streaming/rules/RulesContext.js"),T=e("./src/streaming/rules/SwitchRequest.js"),P=e("./src/streaming/rules/SwitchRequestHistory.js"),R=e("./src/streaming/rules/DroppedFramesHistory.js"),m=e("./src/streaming/rules/ThroughputHistory.js"),f=e("./src/core/Debug.js"),r=e("./src/streaming/vo/metrics/HTTPRequest.js"),d=e("./src/streaming/utils/SupervisorTools.js"),c=e("./src/streaming/MediaPlayerEvents.js"),M=1e3,n=100,_=0;function u(){var j=this.context,$=(0,f.default)(j).getInstance(),z=(0,h.default)(j).getInstance(),ee,k,w,N,H,W,Z,X,te,fe,J,ue,pe,Ce,ve,Ee,ge,Q,le,Y,I,L,K,U,x,y,S;function b(){k=$.getLogger(ee),Ae()}function F(){I=(0,R.default)(j).create(),L=(0,m.default)(j).create({settings:S}),w=(0,p.default)(j).create({dashMetrics:y,customParametersModel:Ee,mediaPlayerModel:ve,settings:S}),w.initialize(),z.on(c.default.QUALITY_CHANGE_RENDERED,Be,ee),z.on(c.default.METRIC_ADDED,ze,ee),z.on(t.default.LOADING_PROGRESS,He,ee)}function oe(Le,Ue){var Ze=Ue.getStreamInfo().id;Z[Ze]||(Z[Ze]={}),Y[Ze]||(Y[Ze]={}),X[Ze]||(X[Ze]={}),Y[Ze][Le]=(0,P.default)(j).create(),Z[Ze][Le]=Ue,X[Ze][Le]={},X[Ze][Le].state=o.default.ALLOW_LOAD,ie(Le),Le===l.default.VIDEO&&yt()}function ie(Le){var Ue=S.get().streaming.abr.ABRStrategy;Ue===l.default.ABR_STRATEGY_L2A?(K[Le]=!1,x[Le]=!1,U[Le]=!0):Ue===l.default.ABR_STRATEGY_LoLP?(K[Le]=!1,x[Le]=!0,U[Le]=!1):Ue===l.default.ABR_STRATEGY_BOLA?(K[Le]=!0,x[Le]=!1,U[Le]=!1):Ue===l.default.ABR_STRATEGY_THROUGHPUT?(K[Le]=!1,x[Le]=!1,U[Le]=!1):Ue===l.default.ABR_STRATEGY_DYNAMIC&&(K[Le]=K&&K[Le]?K[Le]:!1,x[Le]=!1,U[Le]=!1)}function q(Le,Ue){try{Z[Le]&&Z[Le][Ue]&&delete Z[Le][Ue],Y[Le]&&Y[Le][Ue]&&delete Y[Le][Ue],X[Le]&&X[Le][Ue]&&delete X[Le][Ue]}catch{}}function Ae(){H={},W={},X={},Z={},Y={},K={},U={},x={},fe===void 0&&(fe=!1),I&&I.reset(),le=void 0,I=void 0,L=void 0,clearTimeout(te),te=null}function de(){Ae(),z.off(t.default.LOADING_PROGRESS,He,ee),z.off(c.default.QUALITY_CHANGE_RENDERED,Be,ee),z.off(c.default.METRIC_ADDED,ze,ee),w&&w.reset()}function Me(Le){Le&&(Le.streamController&&(N=Le.streamController),Le.domStorage&&(Q=Le.domStorage),Le.mediaPlayerModel&&(ve=Le.mediaPlayerModel),Le.customParametersModel&&(Ee=Le.customParametersModel),Le.cmsdModel&&(ge=Le.cmsdModel),Le.dashMetrics&&(y=Le.dashMetrics),Le.adapter&&(pe=Le.adapter),Le.videoModel&&(Ce=Le.videoModel),Le.settings&&(S=Le.settings))}function Ie(){if(!Q||!Q.hasOwnProperty("getSavedBitrateSettings"))throw new Error(l.default.MISSING_CONFIG_ERROR)}function He(Le){var Ue=Le.request.mediaType,Ze=Le.streamId;if(!(!Ue||!Ze||!Z[Ze]||!S.get().streaming.abr.autoSwitchBitrate[Ue])){var dt=Z[Ze][Ue];if(dt){var vt=(0,C.default)(j).create({abrController:ee,streamProcessor:dt,currentRequest:Le.request,useBufferOccupancyABR:K[Ue],useL2AABR:U[Ue],useLoLPABR:x[Ue],videoModel:Ce}),mt=w.shouldAbandonFragment(vt,Ze);if(mt.quality>T.default.NO_CHANGE){var Pt=dt.getFragmentModel(),Ft=Pt.getRequests({state:E.default.FRAGMENT_MODEL_LOADING,index:Le.request.index})[0];Ft&&(X[Ze][Ue].state=o.default.ABANDON_LOAD,Y[Ze][Ue].reset(),Y[Ze][Ue].push({oldValue:et(Ue,Ze),newValue:mt.quality,confidence:1,reason:mt.reason}),qe(Ue,N.getActiveStreamInfo(),mt.quality,mt.reason),clearTimeout(te),te=setTimeout(function(){X[Ze][Ue].state=o.default.ALLOW_LOAD,te=null},S.get().streaming.abandonLoadTimeout))}}}}function Be(Le){Le.mediaType===l.default.VIDEO&&(le!==void 0&&I.push(Le.streamId,le,Ce.getPlaybackQuality()),le=Le.newQuality)}function ze(Le){Le.metric===o.default.HTTP_REQUEST&&Le.value&&Le.value.type===r.HTTPRequest.MEDIA_SEGMENT_TYPE&&(Le.mediaType===l.default.AUDIO||Le.mediaType===l.default.VIDEO)&&L.push(Le.mediaType,Le.value,S.get().streaming.abr.useDeadTimeLatency),Le.metric===o.default.BUFFER_LEVEL&&(Le.mediaType===l.default.AUDIO||Le.mediaType===l.default.VIDEO)&&We(Le.mediaType,.001*Le.value.level)}function Ye(Le,Ue){try{var Ze;return H[Ue]=H[Ue]||{},H[Ue].hasOwnProperty(Le)||(H[Ue][Le]=0),Ze=st(Le,Ue),Ze=ht(Ze,Le,Ue),Ze=Tt(Ze,Le,Ue),S.get().streaming.cmsd.enabled&&S.get().streaming.cmsd.abr.applyMb&&(Ze=at(Ze,Le,Ue)),Ze}catch{return}}function Te(Le,Ue){try{return ot(Le,Ue)}catch{return}}function Fe(Le,Ue){try{var Ze=ve.getAbrBitrateParameter("maxBitrate",Le);return Ze>-1?ye(Z[Ue][Le].getMediaInfo(),Ze,Ue):void 0}catch{return}}function ot(Le,Ue){try{var Ze=ve.getAbrBitrateParameter("minBitrate",Le);if(Ze>-1){var dt=Z[Ue][Le].getMediaInfo(),vt=be(dt),mt=ye(dt,Ze,Ue);return vt[mt]&&mt<vt.length-1&&vt[mt].bitrate<Ze*1e3&&mt++,mt}else return}catch{return}}function st(Le,Ue){var Ze=H[Ue][Le],dt=Ze;if(!Z[Ue]||!Z[Ue][Le])return dt;var vt=Te(Le,Ue);vt!==void 0&&(dt=Math.max(Ze,vt));var mt=Fe(Le,Ue);return mt!==void 0&&(dt=Math.min(dt,mt)),dt}function at(Le,Ue,Ze){if(Ue!=="video")return Le;var dt=ge.getMaxBitrate(Ue);if(dt<0)return Le;var vt=Re(Ze,"audio",et("audio",Ze));dt-=vt?vt.bitrate/1e3:0;var mt=ye(Z[Ze][Ue].getMediaInfo(),dt,Ze);return k.debug("Stream ID: "+Ze+" ["+Ue+"] Apply max bit rate from CMSD: "+dt),Math.min(Le,mt)}function ht(Le,Ue,Ze){var dt=H[Ze][Ue],vt=S.get().streaming.abr.maxRepresentationRatio[Ue];return isNaN(vt)||vt>=1||vt<0?Le:Math.min(Le,Math.round(dt*vt))}function Tt(Le,Ue,Ze){if(Ue!==l.default.VIDEO||!S.get().streaming.abr.limitBitrateByPortal||!Z[Ze]||!Z[Ze][Ue])return Le;fe||yt();var dt=Z[Ze][Ue].getStreamInfo(),vt=pe.getAdaptationForType(dt.index,Ue,dt).Representation_asArray,mt=Le;if(J>0&&ue>0){for(;mt>0&&vt[mt]&&J<vt[mt].width&&J-vt[mt-1].width<vt[mt].width-J;)mt=mt-1;for(;mt<vt.length-1&&vt[mt].width===vt[mt+1].width;)mt=mt+1}return mt}function xe(Le){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(Ue||(Ue=N.getActiveStreamInfo().id),Le&&Z&&Z[Ue]&&Z[Ue][Le]){var Ze=Ye(Le,Ue),dt=be(Z[Ue][Le].getMediaInfo());return dt[Ze]?dt[Ze]:null}return null}function we(Le,Ue){if(Ie(),Le===l.default.TEXT)return NaN;var Ze=Q.getSavedBitrateSettings(Le),dt=ve.getAbrBitrateParameter("initialBitrate",Le),vt=S.get().streaming.abr.initialRepresentationRatio[Le];if(dt===-1)if(vt>-1){var mt=Z[Ue][Le].getStreamInfo(),Pt=pe.getAdaptationForType(mt.index,Le,mt).Representation_asArray;if(Array.isArray(Pt)){var Ft=Math.max(Math.round(Pt.length*vt)-1,0);dt=Pt[Ft].bandwidth/1e3}else dt=0}else isNaN(Ze)?dt=Le===l.default.VIDEO?M:n:dt=Ze;return dt}function $e(Le,Ue){try{if(!Le||!Z||!Z[Ue]||!Z[Ue][Le])return!1;if(I){var Ze=Ce.getPlaybackQuality();Ze&&I.push(Ue,le,Ze)}if(!S.get().streaming.abr.autoSwitchBitrate[Le])return!1;var dt=et(Le,Ue),vt=(0,C.default)(j).create({abrController:ee,switchHistory:Y[Ue][Le],droppedFramesHistory:I,streamProcessor:Z[Ue][Le],currentValue:dt,useBufferOccupancyABR:K[Le],useL2AABR:U[Le],useLoLPABR:x[Le],videoModel:Ce}),mt=Te(Le,Ue),Pt=Ye(Le,Ue),Ft=w.getMaxQuality(vt),bt=Ft.quality;return mt!==void 0&&(bt>T.default.NO_CHANGE?bt:dt)<mt&&(bt=mt),bt>Pt&&(bt=Pt),Y[Ue][Le].push({oldValue:dt,newValue:bt}),bt>T.default.NO_CHANGE&&bt!==dt&&(X[Ue][Le].state===o.default.ALLOW_LOAD||bt<dt)?(Xe(Le,dt,bt,Pt,Ft.reason,Ue),!0):!1}catch{return!1}}function et(Le){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;try{if(Ue||(Ue=N.getActiveStreamInfo().id),Le&&Z[Ue]&&Z[Ue][Le]){var Ze;if(Ue)return W[Ue]=W[Ue]||{},W[Ue].hasOwnProperty(Le)||(W[Ue][Le]=_),Ze=W[Ue][Le],Ze}return _}catch{return _}}function qe(Le,Ue,Ze){var dt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!(!Ue||!Ue.id||!Le)){var vt=Ue.id,mt=et(Le,vt);(0,d.checkInteger)(Ze);var Pt=Ye(Le,vt);Ze!==mt&&Ze>=0&&Ze<=Pt&&Xe(Le,mt,Ze,Pt,dt,vt)}}function _t(Le,Ue){return X[Le]&&X[Le][Ue]?X[Le][Ue].state:null}function Xe(Le,Ue,Ze,dt,vt,mt){if(Le&&Z[mt]&&Z[mt][Le]){var Pt=Z[mt][Le].getStreamInfo(),Ft=Pt&&Pt.manifestInfo&&Pt.manifestInfo.isDynamic,bt=y.getCurrentBufferLevel(Le);k.info("Stream ID: "+mt+" ["+Le+"] switch from "+Ue+" to "+Ze+"/"+dt+" (buffer: "+bt+") "+(vt?JSON.stringify(vt):".")),W[mt]=W[mt]||{},W[mt][Le]=Ze;var kt=Re(mt,Le,Ze);z.trigger(t.default.QUALITY_CHANGE_REQUESTED,{oldQuality:Ue,newQuality:Ze,reason:vt,streamInfo:Pt,bitrateInfo:kt,maxIdx:dt,mediaType:Le},{streamId:Pt.id,mediaType:Le});var Wt=L.getAverageThroughput(Le,Ft);isNaN(Wt)||Q.setSavedBitrateSettings(Le,Wt)}}function Re(Le,Ue,Ze){if(Ue&&Z&&Z[Le]&&Z[Le][Ue]){var dt=be(Z[Le][Ue].getMediaInfo());return dt[Ze]?dt[Ze]:null}return null}function ye(Le,Ue,Ze){var dt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,vt=Le&&Le.type?Z[Ze][Le.type].getRepresentationInfo():null;if(S.get().streaming.abr.useDeadTimeLatency&&dt&&vt&&vt.fragmentDuration){dt=dt/1e3;var mt=vt.fragmentDuration;if(dt>mt)return 0;var Pt=dt/mt;Ue=Ue*(1-Pt)}for(var Ft=be(Le),bt=Ft.length-1;bt>=0;bt--){var kt=Ft[bt];if(Ue*1e3>=kt.bitrate)return bt}return _}function be(Le){var Ue=[];if(!Le||!Le.bitrateList)return Ue;for(var Ze=Le.bitrateList,dt=Le.type,vt,mt=0,Pt=Ze.length;mt<Pt;mt++)vt=new i.default,vt.mediaType=dt,vt.qualityIndex=mt,vt.bitrate=Ze[mt].bandwidth,vt.width=Ze[mt].width,vt.height=Ze[mt].height,vt.scanType=Ze[mt].scanType,Ue.push(vt);return Ue}function We(Le,Ue){var Ze=S.get().streaming.abr.ABRStrategy;Ze===l.default.ABR_STRATEGY_DYNAMIC&&Qe(Le,Ue)}function Qe(Le,Ue){try{var Ze=ve.getStableBufferTime(),dt=Ze,vt=.5*Ze,mt=K[Le],Pt=Ue>(mt?vt:dt);K[Le]=Pt,Pt!==mt&&(Pt?k.info("["+Le+"] switching from throughput to buffer occupancy ABR rule (buffer: "+Ue.toFixed(3)+")."):k.info("["+Le+"] switching from buffer occupancy to throughput ABR rule (buffer: "+Ue.toFixed(3)+")."))}catch(Ft){k.error(Ft)}}function Ve(){return L}function rt(Le){var Ue=Le.type,Ze=Le.streamInfo.id,dt=Le.representationCount-1;return H[Ze]=H[Ze]||{},H[Ze][Ue]=dt,dt}function ft(Le){var Ue=Le?Le.id:null,Ze=et(l.default.AUDIO,Ue),dt=et(l.default.VIDEO,Ue),vt=Ze===Ye(l.default.AUDIO,Ue)&&dt===Ye(l.default.VIDEO,Ue);return vt}function Je(Le){fe=Le}function yt(){if(Ce){var Le=S.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio"),Ue=Le?window.devicePixelRatio:1;J=Ce.getClientWidth()*Ue,ue=Ce.getClientHeight()*Ue}}function At(Le){I&&I.clearForStream(Le),Z[Le]&&delete Z[Le],Y[Le]&&delete Y[Le],X[Le]&&delete X[Le]}return ee={initialize:F,isPlayingAtTopQuality:ft,updateTopQualityIndex:rt,clearDataForStream:At,getThroughputHistory:Ve,getBitrateList:be,getQualityForBitrate:ye,getTopBitrateInfoFor:xe,getMinAllowedIndexFor:Te,getMaxAllowedIndexFor:Ye,getInitialBitrateFor:we,getQualityFor:et,getAbandonmentStateFor:_t,setPlaybackQuality:qe,checkPlaybackQuality:$e,setElementSize:yt,setWindowResizeEventCalled:Je,registerStreamType:oe,unRegisterStreamType:q,setConfig:Me,reset:de},b(),ee}u.__dashjs_factory_name="AbrController";var A=g.default.getSingletonFactory(u);A.QUALITY_DEFAULT=_,g.default.updateSingletonFactory(u.__dashjs_factory_name,A);let D=A},"./src/streaming/controllers/BaseURLController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/streaming/models/BaseURLTreeModel.js"),l=e("./src/streaming/utils/BaseURLSelector.js"),o=e("./src/streaming/utils/URLUtils.js"),i=e("./src/dash/vo/BaseURL.js"),E=e("./src/core/FactoryMaker.js"),h=e("./src/core/EventBus.js"),t=e("./src/core/events/Events.js"),g=e("./src/streaming/MediaPlayerEvents.js");function C(){var P,R,m=this.context,f=(0,h.default)(m).getInstance(),r=(0,o.default)(m).getInstance(),d,c,M;function n(ee){d.invalidateSelectedIndexes(ee.entry)}function _(){d=(0,p.default)(m).create(),c=(0,l.default)(m).create(),f.on(t.default.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,n,P)}function u(ee){ee.baseURLTreeModel&&(d=ee.baseURLTreeModel),ee.baseURLSelector&&(c=ee.baseURLSelector),ee.adapter&&(R=ee.adapter),ee.contentSteeringController&&(M=ee.contentSteeringController)}function A(ee){d.update(ee),c.chooseSelector(R.getIsDVB(ee)),f.trigger(g.default.BASE_URLS_UPDATED,{baseUrls:$(ee)})}function D(ee){var k=d.getForPath(ee),w=k.reduce(function(N,H){var W=c.select(H);if(W)r.isRelative(W.url)?N.url=r.resolve(W.url,N.url):(N.url=W.url,N.serviceLocation=W.serviceLocation),N.availabilityTimeOffset=W.availabilityTimeOffset,N.availabilityTimeComplete=W.availabilityTimeComplete,N.queryParams=W.queryParams;else return new i.default;return N},new i.default);if(!r.isRelative(w.url))return w}function j(){d.reset(),c.reset()}function $(ee){return d.getBaseUrls(ee)}function z(ee){d.setConfig({adapter:R,contentSteeringController:M}),A(ee)}return P={reset:j,initialize:z,resolve:D,setConfig:u,getBaseUrls:$,update:A},_(),P}C.__dashjs_factory_name="BaseURLController";let T=E.default.getClassFactory(C)},"./src/streaming/controllers/BlacklistController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/EventBus.js");function o(E){E=E||{};var h,t=[],g=(0,l.default)(this.context).getInstance(),C=E.updateEventName,T=E.addBlacklistEventName;function P(d){return!t.length||!d||!d.length?!1:t.indexOf(d)!==-1}function R(d){t.indexOf(d)===-1&&(t.push(d),g.trigger(C,{entry:d}))}function m(d){R(d.entry)}function f(){T&&g.on(T,m,h)}function r(){t=[]}return h={add:R,contains:P,reset:r},f(),h}o.__dashjs_factory_name="BlackListController";let i=p.default.getClassFactory(o)},"./src/streaming/controllers/BufferController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>_});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/constants/MetricsConstants.js"),o=e("./src/streaming/models/FragmentModel.js"),i=e("./src/streaming/SourceBufferSink.js"),E=e("./src/streaming/PreBufferSink.js"),h=e("./src/core/EventBus.js"),t=e("./src/core/events/Events.js"),g=e("./src/core/FactoryMaker.js"),C=e("./src/core/Debug.js"),T=e("./src/streaming/utils/InitCache.js"),P=e("./src/streaming/vo/DashJSError.js"),R=e("./src/core/errors/Errors.js"),m=e("./src/streaming/vo/metrics/HTTPRequest.js"),f=e("./src/streaming/MediaPlayerEvents.js"),r=.5,d=.01,c=22,M="BufferController";function n(u){u=u||{};var A=this.context,D=(0,h.default)(A).getInstance(),j=u.errHandler,$=u.fragmentModel,z=u.representationController,ee=u.adapter,k=u.textController,w=u.abrController,N=u.playbackController,H=u.streamInfo,W=u.type,Z=u.settings,X,te,fe,J,ue,pe,Ce,ve,Ee,ge,Q,le,Y,I,L,K,U,x,y,S,b;function F(){te=(0,C.default)(A).getInstance().getLogger(X),x=(0,T.default)(A).getInstance(),Pe()}function oe(De){de(De),D.on(t.default.INIT_FRAGMENT_LOADED,Te,X),D.on(t.default.MEDIA_FRAGMENT_LOADED,ot,X),D.on(t.default.WALLCLOCK_TIME_UPDATED,Wt,X),D.on(f.default.PLAYBACK_PLAYING,Qe,X),D.on(f.default.PLAYBACK_PROGRESS,be,X),D.on(f.default.PLAYBACK_TIME_UPDATED,be,X),D.on(f.default.PLAYBACK_RATE_CHANGED,Vt,X),D.on(f.default.PLAYBACK_STALLED,We,X)}function ie(){return H.id}function q(){return W}function Ae(){return M}function de(De){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise(function(Ne,tt){pe=De,Ee&&Oe&&typeof Ee.discharge=="function"?(ge=Ee,Ie(Oe).then(function(){Ne()}).catch(function(gt){tt(gt)})):Ne()})}function Me(De){return ee.convertRepresentationToRepresentationInfo(z.getRepresentationForQuality(De))}function Ie(De){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return new Promise(function(Ne,tt){if(!x||!De){Ne(null);return}pe?(Q=!1,Be(De,Oe).then(function(gt){Ne(gt)}).catch(function(gt){tt(gt)})):(Q=!0,He().then(function(gt){Ne(gt)}).catch(function(gt){tt(gt)}))})}function He(){var De=this;return new Promise(function(Oe,Ne){var tt=w.getQualityFor(W,H.id);Ee=(0,E.default)(A).create(ht.bind(De)),Ft(Me(tt)).then(function(){Oe(Ee)}).catch(function(){Ne()})})}function Be(De,Oe){return new Promise(function(Ne,tt){var gt=w.getQualityFor(W,H.id);Ee=(0,i.default)(A).create({mediaSource:pe,textController:k,eventBus:D}),ze(De,Oe,gt).then(function(){return Ft(Me(gt))}).then(function(){Ne(Ee)}).catch(function(ct){te.fatal("Caught error on create SourceBuffer: "+ct),j.error(new P.default(R.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,R.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+W)),tt(ct)})})}function ze(De,Oe,Ne){var tt=Me(Ne);return Oe&&Oe[W]&&(W===p.default.VIDEO||W===p.default.AUDIO)?Ee.initializeForStreamSwitch(De,tt,Oe[W]):Ee.initializeForFirstUse(H,De,tt)}function Ye(){if(Ee&&ge&&typeof ge.discharge=="function"){var De=ge.getAllBufferRanges();if(De.length>0){for(var Oe="Beginning "+W+"PreBuffer discharge, adding buffer for:",Ne=0;Ne<De.length;Ne++)Oe+=" start: "+De.start(Ne)+", end: "+De.end(Ne)+";";te.debug(Oe)}else te.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");le=[];for(var tt=ge.discharge(),gt=null,ct=0;ct<tt.length;ct++){var Ct=tt[ct];if(Ct.segmentType!==m.HTTPRequest.INIT_SEGMENT_TYPE){var Ke=x.extract(Ct.streamId,Ct.representationId);Ke&&gt!==Ke&&(le.push(Ke),Ee.append(Ke),gt=Ke)}le.push(Ct),Ee.append(Ct)}ge.reset(),ge=null}}function Te(De){Z.get().streaming.cacheInitSegments&&(te.info("Init fragment finished loading saving to",W+"'s init cache"),x.save(De.chunk)),te.debug("Append Init fragment",W," with representationId:",De.chunk.representationId," and quality:",De.chunk.quality,", data size:",De.chunk.bytes.byteLength),st(De.chunk)}function Fe(De){var Oe=x.extract(H.id,De);return Oe?(te.info("Append Init fragment",W," with representationId:",Oe.representationId," and quality:",Oe.quality,", data size:",Oe.bytes.byteLength),st(Oe),!0):!1}function ot(De){st(De.chunk,De.request)}function st(De){var Oe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ee.append(De,Oe).then(function(Ne){ht(Ne)}).catch(function(Ne){ht(Ne)}),De.mediaInfo.type===p.default.VIDEO&&Se(t.default.VIDEO_CHUNK_RECEIVED,{chunk:De})}function at(De){if(De&&De.length>0)for(var Oe=0,Ne=De.length;Oe<Ne;Oe++)te.debug("Buffered range: "+De.start(Oe)+" - "+De.end(Oe)+", currentTime = ",N.getTime())}function ht(De){if(De.error){De.error.code===c&&xe(),(De.error.code===c||!_e())&&(te.warn("Clearing playback buffer to overcome quota exceed situation"),Se(t.default.QUOTA_EXCEEDED,{criticalBufferLevel:ue,quotaExceededTime:De.chunk.start}),dt(Ze()));return}if(Ee&&(Je(),U=!1,I=De.chunk,!(!I||!I.endFragment))){I&&!isNaN(I.index)&&(Ce=Math.max(I.index,Ce),yt());var Oe=Ee.getAllBufferRanges();I.segmentType===m.HTTPRequest.MEDIA_SEGMENT_TYPE&&(at(Oe),be(),Tt());var Ne=!1;le&&(le.indexOf(I)>0&&(Ne=!0),le=null),I&&!Ne&&Se(t.default.BYTES_APPENDED_END_FRAGMENT,{quality:I.quality,startTime:I.start,index:I.index,bufferedRanges:Oe,segmentType:I.segmentType,mediaType:W})}}function Tt(){if(!(isNaN(b)||Q)){if(W!==p.default.AUDIO&&W!==p.default.VIDEO){b=NaN;return}var De=N.getTime(),Oe=rt(De,0),Ne=rt(b,0);if(Oe&&Ne&&Oe.start===Ne.start){b=NaN;return}var tt=z.getCurrentRepresentation().segmentDuration,gt=rt(b,tt);gt&&(Z.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(De-b)>tt?b<=gt.end&&N.seek(Math.max(b,gt.start),!1,!0):De<gt.start&&N.seek(gt.start,!1,!0))}}function xe(){if(U=!0,ue=B()*.8,te.warn("Quota exceeded, Critical Buffer: "+ue),ue>0){var De=Math.max(.2*ue,1),Oe=ue-De,Ne=Math.min(Z.get().streaming.buffer.bufferTimeAtTopQuality,Oe*.9),tt=Math.min(Z.get().streaming.buffer.bufferTimeAtTopQualityLongForm,Oe*.9),gt={streaming:{buffer:{bufferToKeep:parseFloat(De.toFixed(5)),bufferTimeAtTopQuality:parseFloat(Ne.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(tt.toFixed(5))}}};Z.update(gt)}}function we(){return fe&&ae(!1),Ee.abort()}function $e(De){return new Promise(function(Oe,Ne){Ee.abort().then(function(){return bt()}).then(function(){return Z.get().streaming.buffer.useChangeTypeForTrackSwitch?Ee.changeType(De):Promise.resolve()}).then(function(){return _t()}).then(function(){ae(!1),Oe()}).catch(function(tt){Ne(tt)})})}function et(De){return new Promise(function(Oe,Ne){Ee.abort().then(function(){return bt()}).then(function(){return _t()}).then(function(){return Ft(De)}).then(function(){ae(!1),Oe()}).catch(function(tt){Ne(tt)})})}function qe(De){return new Promise(function(Oe,Ne){bt().then(function(){return Z.get().streaming.buffer.useChangeTypeForTrackSwitch?Ee.changeType(De):Promise.resolve()}).then(function(){Oe()}).catch(function(tt){Ne(tt)})})}function _t(){return new Promise(function(De,Oe){var Ne=Xe();if(!Ne||Ne.length===0){be(),De();return}dt(Ne).then(function(){De()}).catch(function(tt){Oe(tt)})})}function Xe(De){var Oe=[],Ne=Ee.getAllBufferRanges();if(!Ne||Ne.length===0)return Oe;if(!De&&De!==0||isNaN(De))Oe.push({start:Ne.start(0),end:Ne.end(Ne.length-1)+r});else{var tt=Re(De,Ne),gt=ye(De,Ne);tt&&Oe.push(tt),gt&&Oe.push(gt)}return Oe}function Re(De,Oe){var Ne=Z.get().streaming.buffer.bufferToKeep,tt=Oe.start(0),gt=De-tt;if(gt>Ne){var ct=Math.max(0,De-Ne),Ct=$.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:De,threshold:d})[0];if(Ct&&(ct=Math.min(Ct.startTime,ct)),ct>0)return{start:tt,end:ct}}return null}function ye(De,Oe){var Ne=Oe.end(Oe.length-1)+r,tt=se(De),gt=H.manifestInfo.duration>=Z.get().streaming.buffer.longFormContentDurationThreshold,ct=gt?Z.get().streaming.buffer.bufferTimeAtTopQualityLongForm:Z.get().streaming.buffer.bufferTimeAtTopQuality,Ct=isNaN(tt)?De:Math.min(tt,De+ct);if(Ct>=Oe.end(Oe.length-1))return null;var Ke=$.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:De,threshold:d})[0];Ke&&(Ct=Math.max(Ke.startTime+Ke.duration,Ct));var ut=Z.get().streaming.buffer.avoidCurrentTimeRangePruning;if(ut){for(var nt=0;nt<Oe.length;nt++)if(Oe.start(nt)<=De&&De<=Oe.end(nt)&&Oe.start(nt)<=Ct&&Ct<=Oe.end(nt)){var Rt=Ct;nt+1<Oe.length?Ct=Oe.start(nt+1):Ct=Oe.end(nt)+1,te.debug("Buffered range ["+Oe.start(nt)+", "+Oe.end(nt)+"] overlaps with targetTime "+De+" and range to be pruned ["+Rt+", "+Ne+"], using ["+Ct+", "+Ne+"] instead"+(Ct<Ne?"":" (no actual pruning)"));break}}return Ct<Oe.end(Oe.length-1)?{start:Ct,end:Ne}:null}function be(){(!S||W===p.default.TEXT&&k.isTextEnabled())&&Je()}function We(){At()}function Qe(){At(),b=NaN}function Ve(De){try{var Oe=Ee.getAllBufferRanges();if(!Oe||Oe.length===0)return!1;for(var Ne=0;Ne<Oe.length;){var tt=Oe.start(Ne),gt=Oe.end(Ne);if(De>=tt&&De<=gt)return!0;Ne+=1}return!1}catch(ct){return te.error(ct),!1}}function rt(De,Oe){var Ne=Ee.getAllBufferRanges(),tt=0,gt=0,ct=null,Ct=null,Ke=0,ut,nt,Rt=isNaN(Oe)?.15:Oe;if(Ne!=null){for(nt=0,ut=Ne.length;nt<ut;nt++)if(tt=Ne.start(nt),gt=Ne.end(nt),ct===null)Ke=Math.abs(tt-De),(De>=tt&&De<gt||Ke<=Rt)&&(ct=tt,Ct=gt);else if(Ke=tt-Ct,Ke<=Rt)Ct=gt;else break;if(ct!==null)return{start:ct,end:Ct}}return null}function ft(De,Oe){var Ne,tt;return Z.get().streaming.gaps.jumpGaps&&(Oe=Z.get().streaming.gaps.smallGapLimit),Ne=rt(De,Oe),Ne===null?tt=0:tt=Ne.end-De,tt}function Je(){if(N){var De=N.getTime()||0;Q&&(De=isNaN(b)?0:b);var Oe=Z.get().streaming.gaps.jumpGaps&&!isNaN(Z.get().streaming.gaps.smallGapLimit)?Z.get().streaming.gaps.smallGapLimit:NaN;J=Math.max(ft(De,Oe),0),Se(t.default.BUFFER_LEVEL_UPDATED,{mediaType:W,bufferLevel:J}),At()}}function yt(){var De=Ce>=ve-1,Oe=N.getTimeToStreamEnd(H)-J<1e-5;(De||Oe)&&!fe&&(ae(!0),te.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(H.id," and type ").concat(W)))}function At(){W!==p.default.AUDIO&&W!==p.default.VIDEO||((!N.getLowLatencyModeEnabled()&&J<Z.get().streaming.buffer.stallThreshold||J===0)&&!fe?Le(l.default.BUFFER_EMPTY):(fe||J>=Z.get().streaming.buffer.stallThreshold||N.getLowLatencyModeEnabled()&&J>0)&&Le(l.default.BUFFER_LOADED))}function Le(De){Y===De||De===l.default.BUFFER_EMPTY&&N.getTime()===0||W===p.default.TEXT&&!k.isTextEnabled()||(Y=De,Se(t.default.BUFFER_LEVEL_STATE_CHANGED,{state:De}),Se(De===l.default.BUFFER_LOADED?t.default.BUFFER_LOADED:t.default.BUFFER_EMPTY),te.debug(De===l.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function Ue(){!Ee||W===p.default.TEXT||fe||dt(Ze())}function Ze(){var De=[],Oe=Ee.getAllBufferRanges();if(!Oe||Oe.length===0)return De;var Ne=N.getTime(),tt=Math.max(0,Ne-Z.get().streaming.buffer.bufferToKeep),gt=$.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:Ne,threshold:d})[0];if(gt)tt=Math.min(gt.startTime,tt);else if(Ne===0&&N.getIsDynamic())return[];if(Oe.start(0)<=tt){for(var ct={start:0,end:tt},Ct=0;Ct<Oe.length&&Oe.end(Ct)<=tt;Ct++)ct.end=Oe.end(Ct);ct.start<ct.end&&De.push(ct)}return De}function dt(De){return new Promise(function(Oe,Ne){if(!De||!Ee||De.length===0){Oe();return}var tt=[];De.forEach(function(gt){tt.push(vt(gt))}),K||mt(),Promise.all(tt).then(function(){Oe()}).catch(function(gt){Ne(gt)})})}function vt(De){return new Promise(function(Oe,Ne){De.resolve=Oe,De.reject=Ne,y.push(De)})}function mt(){try{if(y.length===0||!Ee){te.debug("Nothing to prune, halt pruning"),y=[],K=!1;return}var De=Ee.getBuffer();if(!De||!De.buffered||De.buffered.length===0){te.debug("SourceBuffer is empty (or does not exist), halt pruning"),y=[],K=!1;return}var Oe=y.shift();te.debug("".concat(W,": Removing buffer from: ").concat(Oe.start," to ").concat(Oe.end)),K=!0;var Ne=N.getTime();Ne<Oe.end&&ae(!1),Ee.remove(Oe).then(function(tt){Pt(tt)}).catch(function(tt){Pt(tt)})}catch{K=!1}}function Pt(De){te.debug("onRemoved buffer from:",De.from,"to",De.to);var Oe=Ee.getAllBufferRanges();at(Oe),y.length===0&&(K=!1,Je()),De.unintended&&(te.warn("Detected unintended removal from:",De.from,"to",De.to,"setting streamprocessor time to",De.from),Se(t.default.SEEK_TARGET,{time:De.from})),K?mt():(S?S=!1:Je(),Se(t.default.BUFFER_CLEARED,{from:De.from,to:De.to,unintended:De.unintended,hasEnoughSpaceToAppend:_e(),quotaExceeded:U}))}function Ft(De){return new Promise(function(Oe){if(!De||De.MSETimeOffset===void 0||!Ee||!Ee.updateTimestampOffset){Oe();return}Ee.updateTimestampOffset(De.MSETimeOffset).then(function(){Oe()}).catch(function(){Oe()})})}function bt(){return Ee&&!fe?Ee.updateAppendWindow(H):Promise.resolve()}function kt(De){isNaN(De)||(ve=De,yt())}function Wt(){L++;var De=L*(Z.get().streaming.wallclockTimeUpdateInterval/1e3);De>=Z.get().streaming.buffer.bufferPruningInterval&&(L=0,Ue())}function Vt(){At()}function lt(){return Ee}function St(){return J}function Mt(){return pe}function O(){return fe}function ae(De){fe=De,fe?Se(t.default.BUFFERING_COMPLETED):ve=Number.POSITIVE_INFINITY}function G(){return K}function B(){try{var De=Ee.getAllBufferRanges(),Oe=0,Ne,tt;if(!De)return Oe;for(tt=0,Ne=De.length;tt<Ne;tt++)Oe+=De.end(tt)-De.start(tt);return Oe}catch{return 0}}function se(De){try{var Oe=De,Ne=Ee.getAllBufferRanges();if(!Ne||Ne.length===0)return NaN;for(var tt=0;Oe===De&&tt<Ne.length;){var gt=Ne.start(tt),ct=Ne.end(tt);Oe>=gt&&Oe<=ct&&(Oe=ct),tt+=1}return Oe===De?NaN:Oe}catch{}}function _e(){var De=B();return isNaN(De)||De<ue}function me(De){b=De}function Se(De,Oe){var Ne=Oe||{};D.trigger(De,Ne,{streamId:H.id,mediaType:W})}function Pe(De,Oe){if(ue=Number.POSITIVE_INFINITY,Y=void 0,ve=Number.POSITIVE_INFINITY,Ce=0,I=null,fe=!1,K=!1,U=!1,J=0,L=0,y=[],b=NaN,Q=!1,Ee){var Ne=Ee;Ee=null,!De&&!Oe&&Ne.abort().then(function(){Ne.reset(Oe),Ne=null})}S=!1}function ke(De,Oe){D.off(t.default.INIT_FRAGMENT_LOADED,Te,this),D.off(t.default.MEDIA_FRAGMENT_LOADED,ot,this),D.off(t.default.WALLCLOCK_TIME_UPDATED,Wt,this),D.off(f.default.PLAYBACK_PLAYING,Qe,this),D.off(f.default.PLAYBACK_PROGRESS,be,this),D.off(f.default.PLAYBACK_TIME_UPDATED,be,this),D.off(f.default.PLAYBACK_RATE_CHANGED,Vt,this),D.off(f.default.PLAYBACK_STALLED,We,this),Pe(De,Oe)}return X={initialize:oe,getStreamId:ie,getType:q,getBufferControllerType:Ae,createBufferSink:Ie,dischargePreBuffer:Ye,getBuffer:lt,getBufferLevel:St,getRangeAt:rt,hasBufferAtTime:Ve,pruneBuffer:Ue,setMediaSource:de,getMediaSource:Mt,appendInitSegmentFromCache:Fe,getIsBufferingCompleted:O,setIsBufferingCompleted:ae,getIsPruningInProgress:G,reset:ke,prepareForPlaybackSeek:we,prepareForReplacementTrackSwitch:$e,prepareForNonReplacementTrackSwitch:qe,prepareForForceReplacementQualitySwitch:et,updateAppendWindow:bt,getAllRangesWithSafetyFactor:Xe,getContinuousBufferTimeForTargetTime:se,clearBuffers:dt,pruneAllSafely:_t,updateBufferTimestampOffset:Ft,setSeekTarget:me,segmentRequestingCompleted:kt},F(),X}n.__dashjs_factory_name=M;let _=g.default.getClassFactory(n)},"./src/streaming/controllers/CatchupController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/core/EventBus.js"),i=e("./src/streaming/constants/Constants.js"),E=e("./src/streaming/MediaPlayerEvents.js"),h=e("./src/core/events/Events.js"),t=e("./src/streaming/constants/MetricsConstants.js"),g=e("./src/core/Utils.js");function C(){var P=this.context,R=(0,o.default)(P).getInstance(),m,f,r,d,c,M,n,_,u,A;function D(){$(),ge()}function j(Q){Q&&(Q.settings&&(c=Q.settings),Q.videoModel&&(d=Q.videoModel),Q.streamController&&(M=Q.streamController),Q.playbackController&&(n=Q.playbackController),Q.mediaPlayerModel&&(_=Q.mediaPlayerModel))}function $(){R.on(E.default.BUFFER_LEVEL_UPDATED,H,m),R.on(E.default.BUFFER_LEVEL_STATE_CHANGED,W,m),R.on(E.default.PLAYBACK_PROGRESS,X,m),R.on(E.default.PLAYBACK_TIME_UPDATED,X,m),R.on(E.default.PLAYBACK_SEEKED,N,m),R.on(h.default.SETTING_UPDATED_CATCHUP_ENABLED,Z,m),R.on(h.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,ge,m),R.on(h.default.SETTING_UPDATED_PLAYBACK_RATE_MAX,ge,m),R.on(E.default.STREAM_INITIALIZED,ge,m)}function z(){R.off(E.default.BUFFER_LEVEL_UPDATED,H,m),R.off(E.default.BUFFER_LEVEL_STATE_CHANGED,W,m),R.off(E.default.PLAYBACK_PROGRESS,X,m),R.off(E.default.PLAYBACK_TIME_UPDATED,X,m),R.off(E.default.PLAYBACK_SEEKED,N,m),R.off(h.default.SETTING_UPDATED_CATCHUP_ENABLED,Z,m),R.off(h.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,ge,m),R.off(h.default.SETTING_UPDATED_PLAYBACK_RATE_MAX,ge,m),R.off(E.default.STREAM_INITIALIZED,ge,m)}function ee(){A=(0,l.default)(P).getInstance().getLogger(m),w()}function k(){z(),w(),d.setPlaybackRate(1,!0)}function w(){f=!1;var Q=g.default.parseUserAgent();r=Q&&Q.browser&&Q.browser.name&&Q.browser.name.toLowerCase()==="safari"}function N(){f=!1}function H(Q){if(!(Q.streamId!==M.getActiveStreamInfo().id||!u)){var le=n.getLiveDelay(),Y=n.getBufferLevel();Y>le/2&&(u=!1)}}function W(Q){Q.streamId===M.getActiveStreamInfo().id&&(u=Q.state===t.default.BUFFER_EMPTY)}function Z(){_.getCatchupModeEnabled()||d.setPlaybackRate(1)}function X(){n.getIsDynamic()&&_.getCatchupModeEnabled()&&(_.getCatchupPlaybackRates().max>0||_.getCatchupPlaybackRates().min<0)&&!n.isPaused()&&!n.isSeeking()&&J()&&te()}function te(){if(!f&&d){var Q,le=d.getPlaybackRate(),Y=_.getCatchupPlaybackRates(),I=n.getBufferLevel(),L=fe(),K=_.getCatchupMaxDrift();if(!isNaN(K)&&K>0&&L>K)A.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),f=!0,n.seekToCurrentLive(!0,!1);else{var U=n.getCurrentLiveLatency(),x=n.getLiveDelay();if(ue()===i.default.LIVE_CATCHUP_MODE_LOLP){var y=c.get().streaming.liveCatchup.playbackBufferMin;Q=Ee(Y,U,x,y,I)}else Q=ve(Y,U,x,I);var S=r?.25:.02/(.5/Y.max);Q&&Math.abs(le-Q)>=S&&(A.debug("[CatchupController]: Setting playback rate to ".concat(Q)),d.setPlaybackRate(Q))}}}function fe(){var Q=n.getCurrentLiveLatency(),le=n.getLiveDelay();return Q-le}function J(){try{if(!n.getTime()>0||f)return!1;var Q=ue();if(Q===i.default.LIVE_CATCHUP_MODE_LOLP){var le=n.getBufferLevel(),Y=c.get().streaming.liveCatchup.playbackBufferMin;return Ce(le,Y)}else return pe()}catch{return!1}}function ue(){var Q=c.get().streaming.liveCatchup.playbackBufferMin;return c.get().streaming.liveCatchup.mode===i.default.LIVE_CATCHUP_MODE_LOLP&&Q!==null&&!isNaN(Q)?i.default.LIVE_CATCHUP_MODE_LOLP:i.default.LIVE_CATCHUP_MODE_DEFAULT}function pe(){try{var Q=Math.abs(fe());return Q>0}catch{return!1}}function Ce(Q,le){try{var Y=Math.abs(fe());return Y>0||Q<le}catch{return!1}}function ve(Q,le,Y,I){if(u)return 1;var L=le-Y,K=L<0?Math.abs(Q.min):Q.max,U=L*5,x=K*2/(1+Math.pow(Math.E,-U)),y=1-K+x;return n.getPlaybackStalled()&&I<=Y/2&&L>0&&(y=1),y}function Ee(Q,le,Y,I,L){var K;if(L<I){var U=Math.abs(Q.min),x=L-I,y=x*5,S=U*2/(1+Math.pow(Math.E,-y));K=1-U+S,A.debug("[LoL+ playback control_buffer-based] bufferLevel: "+L+", newRate: "+K)}else{var b=Q.max,F=.02;if(Math.abs(le-Y)<=F*Y)K=1;else{var oe=le-Y,ie=oe*5,q=b*2/(1+Math.pow(Math.E,-ie));K=1-b+q}A.debug("[LoL+ playback control_latency-based] latency: "+le+", newRate: "+K)}return K}function ge(){_.getCatchupPlaybackRates(!0)}return m={reset:k,setConfig:j,initialize:D},ee(),m}C.__dashjs_factory_name="CatchupController";let T=p.default.getSingletonFactory(C)},"./src/streaming/controllers/EventController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/core/EventBus.js"),i=e("./src/streaming/MediaPlayerEvents.js"),E=e("./src/streaming/net/XHRLoader.js");function h(){var g="urn:mpeg:dash:event:2012",C=1,T="urn:mpeg:dash:event:callback:2015",P=1,R=300,m={DISCARDED:"discarded",UPDATED:"updated",ADDED:"added"},f=this.context,r=(0,o.default)(f).getInstance(),d,c,M,n,_,u,A,D,j,$,z;function ee(){c=(0,l.default)(f).getInstance().getLogger(d),w()}function k(){if(!A||!D)throw new Error("setConfig function has to be called previously")}function w(){z=!1,M={},n={},_=null,$=!1,u=Date.now()/1e3}function N(){try{_!==null&&z&&(clearInterval(_),_=null,z=!1,pe())}catch(y){throw y}}function H(){try{k(),c.debug("Start Event Controller");var y=j.get().streaming.eventControllerRefreshDelay;!z&&!isNaN(y)&&(z=!0,_=setInterval(W,y))}catch(S){throw S}}function W(){try{if(!$){$=!0;var y=D.getTime(),S=y-u;S=u>0?Math.max(0,S):0,Z(n,S,y),Z(M,S,y),X(n),X(M),u=y,$=!1}}catch(b){$=!1,c.error(b)}}function Z(y,S,b){try{var F=function(ie){if(ie!==void 0){var q=isNaN(ie.duration)?0:ie.duration;ie.calculatedPresentationTime<=b&&ie.calculatedPresentationTime+S+q>=b?Q(ie,i.default.EVENT_MODE_ON_START):(Ee(b,q+S,ie.calculatedPresentationTime)||ge(ie))&&(c.debug("Removing event ".concat(ie.id," from period ").concat(ie.eventStream.period.id," as it is expired or invalid")),le(y,ie))}};ve(y,F)}catch(oe){c.error(oe)}}function X(y){try{for(var S in y)y.hasOwnProperty(S)&&Object.keys(y[S]).length===0&&delete y[S]}catch(b){c.error(b)}}function te(y,S){try{if(k(),M[S]||(M[S]={}),y)for(var b=0;b<y.length;b++){var F=y[b],oe=D.getTime(),ie=isNaN(F.duration)?0:F.duration;if(!Ee(oe,ie,F.calculatedPresentationTime)){var q=J(F,M[S],!0);q===m.ADDED?(c.debug("Added inline event with id ".concat(F.id," from period ").concat(S)),Q(F,i.default.EVENT_MODE_ON_RECEIVE)):q===m.UPDATED&&c.debug("Updated inline event with id ".concat(F.id," from period ").concat(S))}}}catch(Ae){throw Ae}}function fe(y,S){try{k(),n[S]||(n[S]={});for(var b=0;b<y.length;b++){var F=y[b],oe=D.getTime(),ie=isNaN(F.duration)?0:F.duration;if(!Ee(oe,ie,F.calculatedPresentationTime)){var q=J(F,n[S],!1);q===m.ADDED?(F.eventStream.schemeIdUri===g&&ue(F),c.debug("Added inband event with id ".concat(F.id," from period ").concat(S)),Q(F,i.default.EVENT_MODE_ON_RECEIVE)):c.debug("Inband event with scheme_id_uri ".concat(F.eventStream.schemeIdUri,", value ").concat(F.eventStream.value,", period id ").concat(S," and event id ").concat(F.id," was ignored because it has been added before."))}}W()}catch(Ae){throw Ae}}function J(y,S){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,F=y.eventStream.schemeIdUri,oe=y.eventStream.value,ie=y.id,q=m.DISCARDED;S[F]||(S[F]=[]);var Ae=S[F].findIndex(function(Me){return(!oe||Me.eventStream.value&&Me.eventStream.value===oe)&&Me.id===ie});if(Ae===-1)S[F].push(y),y.triggeredReceivedEvent=!1,y.triggeredStartEvent=!1,q=m.ADDED;else if(b){var de=S[F][Ae];y.triggeredReceivedEvent=de.triggeredReceivedEvent,y.triggeredStartEvent=de.triggeredStartEvent,S[F][Ae]=y,q=m.UPDATED}return q}function ue(y){try{if(y.eventStream.value==C){var S=y.calculatedPresentationTime,b;y.calculatedPresentationTime==4294967295?b=NaN:b=y.calculatedPresentationTime+y.duration,r.trigger(i.default.MANIFEST_VALIDITY_CHANGED,{id:y.id,validUntil:S,newDuration:b,newManifestValidAfter:NaN},{mode:i.default.EVENT_MODE_ON_START})}}catch(F){c.error(F)}}function pe(){try{Ce(n),Ce(M)}catch(y){c.error(y)}}function Ce(y){try{var S=D.getTime(),b=function(oe){var ie=oe.eventStream&&oe.eventStream.period&&!isNaN(oe.eventStream.period.duration)?oe.eventStream.period.duration:NaN,q=oe.eventStream&&oe.eventStream.period&&!isNaN(oe.eventStream.period.start)?oe.eventStream.period.start:NaN;if(!(isNaN(ie)||isNaN(q))){var Ae=oe.calculatedPresentationTime;Math.abs(Ae-S)<R&&Q(oe,i.default.EVENT_MODE_ON_START)}};ve(y,b)}catch(F){c.error(F)}}function ve(y,S){try{if(y)for(var b=Object.keys(y),F=0;F<b.length;F++)for(var oe=y[b[F]],ie=Object.keys(oe),q=0;q<ie.length;q++){var Ae=oe[ie[q]];Ae.forEach(function(de){de!==void 0&&S(de)})}}catch(de){c.error(de)}}function Ee(y,S,b){try{return y-S>b}catch(F){return c.error(F),!1}}function ge(y){try{var S=y.eventStream.period.start+y.eventStream.period.duration;return y.calculatedPresentationTime>S}catch(b){return c.error(b),!1}}function Q(y,S){try{var b=D.getTime(),F=y.id;if(S===i.default.EVENT_MODE_ON_RECEIVE&&!y.triggeredReceivedEvent){c.debug("Received event ".concat(F)),y.triggeredReceivedEvent=!0,r.trigger(y.eventStream.schemeIdUri,{event:y},{mode:S});return}y.triggeredStartEvent||(y.eventStream.schemeIdUri===g&&y.eventStream.value==C?(y.duration!==0||y.presentationTimeDelta!==0)&&(c.debug("Starting manifest refresh event ".concat(F," at ").concat(b)),Y()):y.eventStream.schemeIdUri===T&&y.eventStream.value==P?(c.debug("Starting callback event ".concat(F," at ").concat(b)),I(y.messageData)):(c.debug("Starting event ".concat(F," from period ").concat(y.eventStream.period.id," at ").concat(b)),r.trigger(y.eventStream.schemeIdUri,{event:y},{mode:S})),y.triggeredStartEvent=!0)}catch(oe){c.error(oe)}}function le(y,S){try{var b=S.eventStream.schemeIdUri,F=S.eventStream.period.id,oe=S.eventStream.value,ie=S.id;y[F][b]=y[F][b].filter(function(q){return oe&&q.eventStream.value&&q.eventStream.value!==oe||q.id!==ie}),y[F][b].length===0&&delete y[F][b]}catch(q){c.error(q)}}function Y(){try{k(),A.refreshManifest()}catch(y){c.error(y)}}function I(y){try{var S=(0,E.default)(f).create({});S.load({method:"get",url:y,request:{responseType:"arraybuffer"}})}catch(b){c.error(b)}}function L(y){try{if(!y)return;y.manifestUpdater&&(A=y.manifestUpdater),y.playbackController&&(D=y.playbackController),y.settings&&(j=y.settings)}catch(S){throw S}}function K(){return M}function U(){return n}function x(){N(),w()}return d={addInlineEvents:te,addInbandEvents:fe,getInbandEvents:U,getInlineEvents:K,start:H,setConfig:L,reset:x},ee(),d}h.__dashjs_factory_name="EventController";let t=p.default.getSingletonFactory(h)},"./src/streaming/controllers/FragmentController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>f});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/vo/DataChunk.js"),o=e("./src/streaming/models/FragmentModel.js"),i=e("./src/streaming/FragmentLoader.js"),E=e("./src/streaming/utils/RequestModifier.js"),h=e("./src/core/EventBus.js"),t=e("./src/core/events/Events.js"),g=e("./src/streaming/MediaPlayerEvents.js"),C=e("./src/core/errors/Errors.js"),T=e("./src/core/FactoryMaker.js"),P=e("./src/core/Debug.js"),R=e("./src/streaming/utils/SegmentResponseModifier.js");function m(r){r=r||{};var d=this.context,c=(0,h.default)(d).getInstance(),M=r.errHandler,n=r.mediaPlayerModel,_=r.dashMetrics,u=(0,P.default)(d).getInstance(),A=(0,R.default)(d).getInstance(),D=r.streamInfo,j,$,z;function ee(){$=u.getLogger(j),N(),c.on(g.default.FRAGMENT_LOADING_COMPLETED,Z,j),c.on(g.default.FRAGMENT_LOADING_PROGRESS,Z,j)}function k(){return D.id}function w(X){var te=z[X];return te||(te=(0,o.default)(d).create({streamInfo:D,type:X,dashMetrics:_,fragmentLoader:(0,i.default)(d).create({dashMetrics:_,mediaPlayerModel:n,errHandler:M,requestModifier:(0,E.default)(d).getInstance(),settings:r.settings,boxParser:r.boxParser,eventBus:c,events:t.default,errors:C.default,dashConstants:r.dashConstants,urlUtils:r.urlUtils,streamId:k()}),debug:u,eventBus:c,events:t.default}),z[X]=te),te}function N(){for(var X in z)z[X].reset();z={}}function H(){c.off(g.default.FRAGMENT_LOADING_COMPLETED,Z,this),c.off(g.default.FRAGMENT_LOADING_PROGRESS,Z,this),N()}function W(X,te,fe,J){var ue=new l.default;return ue.streamId=fe,ue.mediaInfo=te.mediaInfo,ue.segmentType=te.type,ue.start=te.startTime,ue.duration=te.duration,ue.end=ue.start+ue.duration,ue.bytes=X,ue.index=te.index,ue.quality=te.quality,ue.representationId=te.representationId,ue.endFragment=J,ue}function Z(X){if(X.sender){var te=X.request,fe=X.response,J=te.isInitializationRequest(),ue=te.mediaInfo.streamInfo;if(X.error&&(te.mediaType===p.default.AUDIO||te.mediaType===p.default.VIDEO||te.mediaType===p.default.TEXT&&te.mediaInfo.isFragmented)&&c.trigger(t.default.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD,{entry:X.request.serviceLocation}),!fe||!ue){$.warn("No "+te.mediaType+" bytes to push or stream is inactive.");return}var pe=W(fe,te,D.id,X.type!==t.default.FRAGMENT_LOADING_PROGRESS);A.modifyResponseAsync(pe).then(function(Ce){c.trigger(J?t.default.INIT_FRAGMENT_LOADED:t.default.MEDIA_FRAGMENT_LOADED,{chunk:Ce,request:te},{streamId:ue.id,mediaType:te.mediaType})}).catch(function(Ce){$.error(Ce),c.trigger(J?t.default.INIT_FRAGMENT_LOADED:t.default.MEDIA_FRAGMENT_LOADED,{chunk:pe,request:te},{streamId:ue.id,mediaType:te.mediaType})})}}return j={getStreamId:k,getModel:w,reset:H},ee(),j}m.__dashjs_factory_name="FragmentController";let f=T.default.getClassFactory(m)},"./src/streaming/controllers/GapController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/core/events/Events.js"),i=e("./src/core/EventBus.js"),E=e("./src/streaming/constants/Constants.js"),h=100,t=10,g=.1;function C(){var P=this.context,R=(0,i.default)(P).getInstance(),m,f,r,d,c,M,n,_,u,A,D,j;function $(){N()}function z(){j=(0,l.default)(P).getInstance().getLogger(m),ee()}function ee(){Ee(),H(),k()}function k(){c=null,M=NaN,d=0,A=null,D={}}function w(Q){Q&&(Q.settings&&(r=Q.settings),Q.playbackController&&(n=Q.playbackController),Q.streamController&&(_=Q.streamController),Q.videoModel&&(u=Q.videoModel))}function N(){R.on(o.default.WALLCLOCK_TIME_UPDATED,fe,this),R.on(o.default.INITIAL_STREAM_SWITCH,te,this),R.on(o.default.PLAYBACK_SEEKING,W,this),R.on(o.default.BUFFER_REPLACEMENT_STARTED,Z,m),R.on(o.default.TRACK_CHANGE_RENDERED,X,m)}function H(){R.off(o.default.WALLCLOCK_TIME_UPDATED,fe,this),R.off(o.default.INITIAL_STREAM_SWITCH,te,this),R.off(o.default.PLAYBACK_SEEKING,W,this),R.off(o.default.BUFFER_REPLACEMENT_STARTED,Z,m),R.off(o.default.TRACK_CHANGE_RENDERED,X,m)}function W(){A&&(clearTimeout(A),A=null)}function Z(Q){try{if(Q.streamId!==_.getActiveStreamInfo().id||Q.mediaType!==E.default.VIDEO&&Q.mediaType!==E.default.AUDIO)return;Q.streamId===_.getActiveStreamInfo().id&&(D[Q.mediaType]=!0)}catch(le){j.error(le)}}function X(Q){!Q||!Q.mediaType||(D[Q.mediaType]=!1)}function te(){c||ve()}function fe(){if(J(r.get().streaming.gaps.enableSeekFix)&&(d++,d>=t)){var Q=n.getTime();f===Q?ge(Q,!0):(f=Q,M=NaN),d=0}}function J(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!_.getActiveStream())return!1;var le=Object.keys(D).some(function(I){return D[I]}),Y=Q?ue():!1;return!le&&r.get().streaming.gaps.jumpGaps&&_.getActiveStreamProcessors().length>0&&(!n.isSeeking()||Y)&&!n.isPaused()&&!_.getIsStreamSwitchInProgress()&&!_.getHasMediaOrInitialisationError()}function ue(){var Q=_.getActiveStream(),le=parseFloat((Q.getStartTime()+Q.getDuration()).toFixed(5));return n.getTime()+r.get().streaming.gaps.threshold>=le}function pe(Q,le){try{if(!Q||Q.length<=1&&le>0)return NaN;for(var Y=NaN,I=0;isNaN(Y)&&I<Q.length;){var L=I>0?Q.end(I-1):0;le<Q.start(I)&&L-le<r.get().streaming.gaps.threshold&&(Y=I),I+=1}return Y}catch{return null}}function Ce(Q,le){for(var Y=0,I=Q.length;Y<I;Y++)if(le>=Q.start(Y)&&le<=Q.end(Y))return!0;return!1}function ve(){try{c||(j.debug("Starting the gap controller"),c=setInterval(function(){if(J()){var Q=n.getTime();ge(Q)}},h))}catch{}}function Ee(){j.debug("Stopping the gap controller"),c&&(clearInterval(c),c=null)}function ge(Q){var le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Y=r.get().streaming.gaps.enableStallFix,I=r.get().streaming.gaps.stallSeek,L=r.get().streaming.gaps.smallGapLimit,K=r.get().streaming.gaps.jumpLargeGaps,U=u.getBufferRange(),x,y=NaN,S=!1;if(x=pe(U,Q),!isNaN(x)){var b=U.start(x),F=b-Q;F>0&&(F<=L||K)&&(y=b)}var oe=n.getTimeToStreamEnd();if(isNaN(y)&&le&&isFinite(oe)&&!isNaN(oe)&&oe<L&&(y=parseFloat(n.getStreamEndTime().toFixed(5)),S=!0),Y&&isNaN(y)&&le&&isNaN(x)&&Ce(U,Q)&&(I===0?(j.warn("Toggle play pause to break stall"),u.pause(),u.play()):(j.warn("Jumping ".concat(I,"s to break stall")),y=Q+I)),y>0&&M!==y&&y>Q&&!A){var ie=y-Q;if(S){var q=_.getStreamForTime(y),Ae=q&&!!q.getPreloaded();j.warn("Jumping to end of stream because of gap from ".concat(Q," to ").concat(y,". Gap duration: ").concat(ie)),n.seek(y,!0,Ae)}else{var de=n.getIsDynamic(),Me=x>0?U.end(x-1):Q,Ie=de?Math.max(0,ie-g)*1e3:0;A=window.setTimeout(function(){n.seek(y,!0,!0),j.warn("Jumping gap occuring in period ".concat(_.getActiveStream().getStreamId()," starting at ").concat(Me," and ending at ").concat(y,". Jumping by: ").concat(y-Me)),A=null},Ie)}M=y}}return m={reset:ee,setConfig:w,initialize:$},z(),m}C.__dashjs_factory_name="GapController";let T=p.default.getSingletonFactory(C)},"./src/streaming/controllers/MediaController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>P});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/core/events/Events.js"),o=e("./src/core/EventBus.js"),i=e("./src/core/FactoryMaker.js"),E=e("./src/core/Debug.js"),h=e("./node_modules/bcp-47-normalize/index.js"),t=e.n(h),g=e("./node_modules/bcp-47-match/index.js");function C(){var R=this.context,m=(0,o.default)(R).getInstance(),f,r,d,c,M,n,_,u;function A(){r=(0,E.default)(R).getInstance().getLogger(f),te()}function D(ie,q){var Ae=n[ie]||N(ie),de=$(ie,q.id),Me=[];Ae||(Ae=u.getSavedMediaSettings(ie),w(ie,Ae)),!(!de||de.length===0)&&(Ae&&(Me=Array.from(de),Me=J(Me,ue,Ae),Me=J(Me,pe,Ae),Me=J(Me,Ce,Ae),ie===p.default.AUDIO&&n[ie]||(Me=J(Me,ve,Ae)),Me=J(Me,Ee,Ae),Me=J(Me,ge,Ae)),Me.length===0?k(U(ie,de),!0):Me.length>1?k(U(ie,Me,!!n[ie])):k(Me[0]))}function j(ie){if(ie){var q=ie.type;if(W(q)){var Ae=ie.streamInfo.id;d[Ae]||(d[Ae]=oe());for(var de=d[Ae][q].list,Me=0,Ie=de.length;Me<Ie;++Me)if(Z(de[Me],ie))return;de.push(ie)}}}function $(ie,q){return ie?!d[q]||!d[q][ie]?[]:d[q][ie].list:[]}function z(ie,q){return!ie||!d[q]||!d[q][ie]?null:d[q][ie].current}function ee(ie){if(!ie)return!1;var q=ie.type,Ae=ie.streamInfo.id;return d[Ae]&&d[Ae][q]&&Z(d[Ae][q].current,ie)}function k(ie){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!(!ie||!ie.streamInfo)){var Ae=ie.type,de=ie.streamInfo,Me=de.id,Ie=z(Ae,Me);if(!(!d[Me]||!d[Me][Ae])&&(d[Me][Ae].current=ie,d[Me][Ae].current&&(Ae!==p.default.TEXT&&!Z(ie,Ie)||Ae===p.default.TEXT&&ie.isFragmented)&&m.trigger(l.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:Ie,newMediaInfo:ie,switchMode:c.get().streaming.trackSwitchMode[Ae]},{streamId:Me}),!q)){var He=fe(ie);if(!He||!d[Me][Ae].storeLastSettings)return;He.roles&&(He.role=He.roles[0],delete He.roles),He.accessibility&&(He.accessibility=He.accessibility[0]),He.audioChannelConfiguration&&(He.audioChannelConfiguration=He.audioChannelConfiguration[0]),n[Ae]=He,u.setSavedMediaSettings(Ae,He)}}}function w(ie,q){!ie||!q||(M[ie]=q)}function N(ie){return ie?M[ie]:null}function H(){u.setSavedMediaSettings(p.default.TEXT,null)}function W(ie){return ie===p.default.AUDIO||ie===p.default.VIDEO||ie===p.default.TEXT||ie===p.default.IMAGE}function Z(ie,q){if(!ie&&!q)return!0;if(!ie||!q)return!1;var Ae=ie.id===q.id,de=ie.viewpoint===q.viewpoint,Me=JSON.stringify(ie.viewpointsWithSchemeIdUri)===JSON.stringify(q.viewpointsWithSchemeIdUri),Ie=ie.lang===q.lang,He=ie.codec===q.codec,Be=ie.roles.toString()===q.roles.toString(),ze=JSON.stringify(ie.rolesWithSchemeIdUri)===JSON.stringify(q.rolesWithSchemeIdUri),Ye=ie.accessibility.toString()===q.accessibility.toString(),Te=JSON.stringify(ie.accessibilitiesWithSchemeIdUri)===JSON.stringify(q.accessibilitiesWithSchemeIdUri),Fe=ie.audioChannelConfiguration.toString()===q.audioChannelConfiguration.toString(),ot=JSON.stringify(ie.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(q.audioChannelConfigurationsWithSchemeIdUri);return Ae&&He&&de&&Me&&Ie&&Be&&ze&&Ye&&Te&&Fe&&ot}function X(ie){ie&&(ie.domStorage&&(u=ie.domStorage),ie.settings&&(c=ie.settings),ie.customParametersModel&&(_=ie.customParametersModel))}function te(){d={},n={},le()}function fe(ie){var q={lang:ie.lang,viewpoint:ie.viewpoint,roles:ie.roles,accessibility:ie.accessibility,audioChannelConfiguration:ie.audioChannelConfiguration},Ae=q.lang||q.viewpoint||q.role&&q.role.length>0||q.accessibility&&q.accessibility.length>0||q.audioChannelConfiguration&&q.audioChannelConfiguration.length>0;return Ae?q:null}function J(ie,q,Ae){var de=[];return ie.forEach(function(Me){q(Ae,Me)&&de.push(Me)}),de.length!==0?de:ie}function ue(ie,q){return!ie.lang||ie.lang instanceof RegExp?q.lang.match(ie.lang):q.lang!==""?(0,g.extendedFilter)(q.lang,t()(ie.lang)).length>0:!1}function pe(ie,q){return ie.index===void 0||ie.index===null||q.index===ie.index}function Ce(ie,q){return!ie.viewpoint||ie.viewpoint===q.viewpoint}function ve(ie,q){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,de=!ie.role||!!q.roles.filter(function(Me){return Me===ie.role})[0];return de||q.type===p.default.AUDIO&&Ae}function Ee(ie,q){var Ae;return ie.accessibility?Ae=!!q.accessibility.filter(function(de){return de===ie.accessibility})[0]:Ae=!q.accessibility.length,Ae}function ge(ie,q){var Ae=!ie.audioChannelConfiguration||!!q.audioChannelConfiguration.filter(function(de){return de===ie.audioChannelConfiguration})[0];return Ae}function Q(ie,q){var Ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;try{var de=!1;if(!ie.lang)de=!0;else if(ie.lang instanceof RegExp)de=q.lang.match(ie.lang);else if(q.lang!==""){var Me=t()(ie.lang);Me&&(de=(0,g.extendedFilter)(q.lang,Me).length>0)}var Ie=ie.index===void 0||ie.index===null||q.index===ie.index,He=!ie.viewpoint||ie.viewpoint===q.viewpoint,Be=!ie.role||!!q.roles.filter(function(Te){return Te===ie.role})[0],ze=!ie.accessibility||!!q.accessibility.filter(function(Te){return Te===ie.accessibility})[0],Ye=!ie.audioChannelConfiguration||!!q.audioChannelConfiguration.filter(function(Te){return Te===ie.audioChannelConfiguration})[0];return de&&Ie&&He&&(Be||q.type===p.default.AUDIO&&Ae)&&ze&&Ye}catch(Te){return!1}}function le(){M={audio:null,video:null,text:null}}function Y(ie){var q=0,Ae=[];return ie.forEach(function(de){isNaN(de.selectionPriority)||(de.selectionPriority>q?(q=de.selectionPriority,Ae=[de]):de.selectionPriority===q&&Ae.push(de))}),Ae}function I(ie){var q=0,Ae=[],de;return ie.forEach(function(Me){de=Math.max.apply(Math,Me.bitrateList.map(function(Ie){return Ie.bandwidth})),de>q?(q=de,Ae=[Me]):de===q&&Ae.push(Me)}),Ae}function L(ie){var q=1/0,Ae=[],de;return ie.forEach(function(Me){var Ie=Me.bitrateList.reduce(function(He,Be){var ze=Math.max(1,Be.width*Be.height),Ye=Be.bandwidth/ze;return He+Ye},0);de=Ie/Me.bitrateList.length,de<q?(q=de,Ae=[Me]):de===q&&Ae.push(Me)}),Ae}function K(ie){var q=0,Ae=[],de;return ie.forEach(function(Me){de=Me.representationCount,de>q?(q=de,Ae=[Me]):de===q&&Ae.push(Me)}),Ae}function U(ie,q){if(ie===p.default.TEXT)return q[0];var Ae=c.get().streaming.selectionModeForInitialTrack,de,Me=_.getCustomInitialTrackSelectionFunction();if(Me&&typeof Me=="function")de=Me(q);else switch(Ae){case p.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:de=x(q);break;case p.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:de=y(q);break;case p.default.TRACK_SELECTION_MODE_FIRST_TRACK:de=S(q);break;case p.default.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:de=b(q);break;case p.default.TRACK_SELECTION_MODE_WIDEST_RANGE:de=F(q);break;default:r.warn("Track selection mode ".concat(Ae," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),de=S(q);break}return de.length>0?de[0]:q[0]}function x(ie){var q=Y(ie);return q.length>1&&(q=I(q)),q.length>1&&(q=K(q)),q}function y(ie){var q=I(ie);return q.length>1&&(q=K(q)),q}function S(ie){return ie[0]}function b(ie){var q=L(ie);return q.length>1&&(q=I(q)),q}function F(ie){var q=K(ie);return q.length>1&&(q=I(ie)),q}function oe(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}}}return f={setInitialMediaSettingsForType:D,addTrack:j,getTracksFor:$,getCurrentTrackFor:z,isCurrentTrack:ee,setTrack:k,selectInitialTrack:U,setInitialSettings:w,getInitialSettings:N,getTracksWithHighestBitrate:I,getTracksWithHighestEfficiency:L,getTracksWithWidestRange:K,isTracksEqual:Z,matchSettings:Q,matchSettingsLang:ue,matchSettingsIndex:pe,matchSettingsViewPoint:Ce,matchSettingsRole:ve,matchSettingsAccessibility:Ee,matchSettingsAudioChannelConfig:ge,saveTextSettingsDisabled:H,setConfig:X,reset:te},A(),f}C.__dashjs_factory_name="MediaController";var T=i.default.getSingletonFactory(C);i.default.updateSingletonFactory(C.__dashjs_factory_name,T);let P=T},"./src/streaming/controllers/MediaSourceController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js");function o(){var E,h,t,g=this.context;function C(){t=(0,l.default)(g).getInstance().getLogger(E)}function T(){var c="WebKitMediaSource"in window,M="MediaSource"in window;return M?h=new MediaSource:c&&(h=new WebKitMediaSource),h}function P(c){var M=window.URL.createObjectURL(h);return c.setSource(M),M}function R(c){c.setSource(null)}function m(c){!h||h.readyState!=="open"||c===null&&isNaN(c)||h.duration!==c&&(d(h)?setTimeout(m.bind(null,c),50):(t.info("Set MediaSource duration:"+c),h.duration=c))}function f(c,M){h&&typeof h.setLiveSeekableRange=="function"&&typeof h.clearLiveSeekableRange=="function"&&h.readyState==="open"&&c>=0&&c<M&&(h.clearLiveSeekableRange(),h.setLiveSeekableRange(c,M))}function r(c){if(!(!c||c.readyState!=="open")){for(var M=c.sourceBuffers,n=0;n<M.length;n++)if(M[n].updating||M[n].buffered.length===0)return;t.info("call to mediaSource endOfStream"),c.endOfStream()}}function d(c){for(var M=c.sourceBuffers,n=0;n<M.length;n++)if(M[n].updating)return!0;return!1}return E={createMediaSource:T,attachMediaSource:P,detachMediaSource:R,setDuration:m,setSeekable:f,signalEndOfStream:r},C(),E}o.__dashjs_factory_name="MediaSourceController";let i=p.default.getSingletonFactory(o)},"./src/streaming/controllers/PlaybackController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/core/EventBus.js"),o=e("./src/core/events/Events.js"),i=e("./src/core/FactoryMaker.js"),E=e("./src/core/Debug.js"),h=e("./src/streaming/MediaPlayerEvents.js"),t=e("./src/streaming/constants/MetricsConstants.js"),g=500;function C(){var P=this.context,R=(0,l.default)(P).getInstance(),m,f,r,d,c,M,n,_,u,A,D,j,$,z,ee,k,w,N,H,W,Z,X,te,fe;function J(){f=(0,E.default)(P).getInstance().getLogger(m),ue()}function ue(){le(),z=!1,A=0,D=0,k=0,X=!1,w=!0,N=!1,te=!1,H=NaN,n&&(R.off(o.default.DATA_UPDATE_COMPLETED,at,m),R.off(o.default.LOADING_PROGRESS,Ze,m),R.off(o.default.MANIFEST_UPDATED,Ft,m),R.off(o.default.STREAMS_COMPOSED,bt,m),R.off(h.default.PLAYBACK_ENDED,ft,m),R.off(h.default.STREAM_INITIALIZING,vt,m),R.off(h.default.REPRESENTATION_SWITCH,mt,m),R.off(h.default.BUFFER_LEVEL_STATE_CHANGED,xe,m),st(),Vt()),u=null,n=null,j=null,$=null}function pe(lt,St){j=lt,St!==!0&&Ce()}function Ce(){Wt(),$=j.manifestInfo.isDynamic,Z=!1,W=!1,R.on(o.default.DATA_UPDATE_COMPLETED,at,m),R.on(o.default.LOADING_PROGRESS,Ze,m),R.on(o.default.MANIFEST_UPDATED,Ft,m),R.on(o.default.STREAMS_COMPOSED,bt,m),R.on(h.default.PLAYBACK_ENDED,ft,m,{priority:l.default.EVENT_PRIORITY_HIGH}),R.on(h.default.STREAM_INITIALIZING,vt,m),R.on(h.default.REPRESENTATION_SWITCH,mt,m),R.on(h.default.BUFFER_LEVEL_STATE_CHANGED,xe,m),z&&(z=!1,Q())}function ve(){return Z}function Ee(){var lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return parseFloat((ge(lt)-x()).toFixed(5))}function ge(lt){var St=lt||j;return St.start+St.duration}function Q(){var lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;j&&n&&n.getElement()?(lt&&$&&U(x()),n.play()):z=!0}function le(){j&&n&&n.pause()}function Y(lt){var St=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!(!j||!n||!n.getElement())){var ae=isNaN(H)?n.getTime():H;lt!==ae&&(W=Mt===!0,W||(H=lt),f.info("Requesting seek to time: "+lt+(W?" (internal)":"")),$&&O&&U(lt),n.setCurrentTime(lt,St))}}function I(){var lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,St=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=K();if(O!==0){A=D;var ae=O-A;Y(ae,lt,St,Mt)}}function L(){var lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,St=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=K();if(O!==0){var ae=O-A;Y(ae,lt,St,Mt)}}function K(){if(!(!j||!n||!$)){var lt=r&&r.hasVideoTrack()?p.default.VIDEO:p.default.AUDIO,St=c.getCurrentDVRInfo(lt);return St&&St.range?St.range.end:0}}function U(lt){var St=new Date(_.getClientReferenceTime()),Mt=M.getRegularPeriods()[0],O=_.calcPresentationTimeFromWallTime(St,Mt);A=O-lt}function x(){return j&&n?n.getTime():null}function y(){return j&&n?n.isPaused():null}function S(){return j&&n?n.isSeeking():null}function b(){return j&&n?n.isStalled():null}function F(){return j&&n?n.getPlaybackRate():null}function oe(){return j&&n?n.getPlayedRanges():null}function ie(){return j&&n?n.getEnded():null}function q(){return $}function Ae(){return r}function de(){return X}function Me(){return k}function Ie(){return A}function He(){return D}function Be(){if(!$||isNaN(k))return NaN;var lt=x();if(isNaN(lt)||lt===0)return 0;var St=new Date().getTime()+_.getClientTimeOffset()*1e3;return Math.max(((St-k-lt*1e3)/1e3).toFixed(3),0)}function ze(lt,St){var Mt,O,ae,G=4,B=4,se=!isNaN(lt)&&isFinite(lt)?lt:NaN,_e=M.getSuggestedPresentationDelay(),me=d.getServiceDescriptionSettings();return isNaN(fe.get().streaming.delay.liveDelay)?fe.get().streaming.delay.liveDelayFragmentCount!==null&&!isNaN(fe.get().streaming.delay.liveDelayFragmentCount)&&!isNaN(se)?Mt=se*fe.get().streaming.delay.liveDelayFragmentCount:me&&!isNaN(me.liveDelay)&&me.liveDelay>0?Mt=me.liveDelay:fe.get().streaming.delay.useSuggestedPresentationDelay===!0&&_e!==null&&!isNaN(_e)&&_e>0?Mt=_e:isNaN(se)?Mt=St&&!isNaN(St.minBufferTime)?St.minBufferTime*G:j.manifestInfo.minBufferTime*G:Mt=se*B:Mt=fe.get().streaming.delay.liveDelay,ae=M.getAvailabilityStartTime(),ae!==null&&(k=ae),St&&St.dvrWindowSize>0?O=Math.min(Mt,St.dvrWindowSize):O=Mt,A=O,D=O,O}function Ye(lt){lt&&(lt.streamController&&(r=lt.streamController),lt.serviceDescriptionController&&(d=lt.serviceDescriptionController),lt.dashMetrics&&(c=lt.dashMetrics),lt.adapter&&(M=lt.adapter),lt.videoModel&&(n=lt.videoModel),lt.timelineConverter&&(_=lt.timelineConverter),lt.settings&&(fe=lt.settings))}function Te(){var lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!(y()||!$||n.getReadyState()===0||S()||X)){lt||(lt=r.hasVideoTrack()?p.default.VIDEO:p.default.AUDIO);var St=x(),Mt=Fe(St,lt),O=!isNaN(Mt)&&Mt!==St;O&&!S()&&(b()||Z||n.getReadyState()===1)&&(f.debug("UpdateCurrentTime: Seek to actual time: ".concat(Mt," from currentTime: ").concat(St)),Y(Mt,!1,!1))}}function Fe(lt,St){var Mt=c.getCurrentDVRInfo(St),O=Mt?Mt.range:null,ae;return O?(lt>O.end?ae=Math.max(O.end-A,O.start):lt>0&&lt+.25<O.start&&Math.abs(lt-O.start)<31536e4?N?ae=Math.max(O.end-A,O.start):ae=O.start:ae=lt,ae):NaN}function ot(){u===null&&(u=setInterval(function(){yt()},fe.get().streaming.wallclockTimeUpdateInterval))}function st(){clearInterval(u),u=null}function at(lt){var St=M.convertRepresentationToRepresentationInfo(lt.currentRepresentation),Mt=St?St.mediaInfo.streamInfo:null;Mt===null||j.id!==Mt.id||(j=Mt)}function ht(){R.trigger(o.default.CAN_PLAY)}function Tt(){R.trigger(o.default.CAN_PLAY_THROUGH)}function xe(lt){lt.streamId===r.getActiveStreamInfo().id&&(Z=lt.state===t.default.BUFFER_EMPTY,fe.get().streaming.buffer.setStallState&&n.setStallState(lt.mediaType,lt.state===t.default.BUFFER_EMPTY))}function we(){f.info("Native video element event: play"),Te(),ot(),R.trigger(o.default.PLAYBACK_STARTED,{startTime:x()})}function $e(){f.info("Native video element event: waiting"),R.trigger(o.default.PLAYBACK_WAITING,{playingTime:x()})}function et(){f.info("Native video element event: playing"),W=!1,R.trigger(o.default.PLAYBACK_PLAYING,{playingTime:x()})}function qe(){f.info("Native video element event: pause"),R.trigger(o.default.PLAYBACK_PAUSED,{ended:ie()})}function _t(){if(!W){var lt=x();!isNaN(H)&&H!==lt&&(lt=H),H=NaN,f.info("Seeking to: "+lt),ot(),R.trigger(o.default.PLAYBACK_SEEKING,{seekTime:lt,streamId:j.id})}}function Xe(){f.info("Native video element event: seeked"),W=!1,R.trigger(o.default.PLAYBACK_SEEKED)}function Re(){j&&R.trigger(o.default.PLAYBACK_TIME_UPDATED,{timeToEnd:Ee(),time:x(),streamId:j.id})}function ye(){R.trigger(o.default.PLAYBACK_PROGRESS,{streamId:j.id})}function be(){var lt=F();f.info("Native video element event: ratechange: ",lt),R.trigger(o.default.PLAYBACK_RATE_CHANGED,{playbackRate:lt})}function We(){f.info("Native video element event: loadedmetadata"),R.trigger(o.default.PLAYBACK_METADATA_LOADED),ot()}function Qe(){f.info("Native video element event: loadeddata"),R.trigger(o.default.PLAYBACK_LOADED_DATA)}function Ve(){f.info("Native video element event: ended"),le(),st();var lt=r?r.getActiveStreamInfo():null;lt&&R.trigger(o.default.PLAYBACK_ENDED,{isLast:lt.isLast})}function rt(){R.trigger(o.default.PLAYBACK_VOLUME_CHANGED)}function ft(lt){if(u&&lt.isLast){f.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var St=lt.seekTime?lt.seekTime:ge();n.setCurrentTime(St),le(),st()}}function Je(lt){var St=lt.target||lt.srcElement;R.trigger(o.default.PLAYBACK_ERROR,{error:St.error})}function yt(){R.trigger(o.default.WALLCLOCK_TIME_UPDATED,{isDynamic:$,time:new Date}),q()&&(r.addDVRMetric(),y()?At():Te())}function At(){var lt=Date.now();(!ee||lt>ee+g)&&(ee=lt,Re())}function Le(){var lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,St=null;return r.getActiveStreamProcessors().forEach(function(Mt){if(!lt||lt.length===0||lt.indexOf(Mt.getType())===-1){var O=Mt.getBufferLevel();St===null?St=O:St=Math.min(St,O)}}),St}function Ue(){return N}function Ze(lt){if(lt.stream===!1&&N&&!isNaN(lt.request.duration)){var St=1.2*lt.request.duration;St>A&&(f.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",St.toFixed(2)),A=St,D=St)}}function dt(lt){R.trigger(o.default.PLAYBACK_STALLED,{e:lt})}function vt(lt){kt(lt.mediaInfo)}function mt(lt){var St=r.getActiveStreamInfo();!lt||!St||!lt.currentRepresentation||!lt.streamId||lt.streamId!==St.id||!lt.mediaType||lt.mediaType!==p.default.VIDEO&&lt.mediaType!==p.default.AUDIO||(w=lt.currentRepresentation.availabilityTimeComplete,N=!w,N&&!te&&(te=!0))}function Pt(){return te}function Ft(){X=!0}function bt(){X=!1}function kt(lt){lt&&lt.supplementalProperties&&lt.supplementalProperties[p.default.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]==="true"&&(f.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),N=!0)}function Wt(){n.addEventListener("canplay",ht),n.addEventListener("canplaythrough",Tt),n.addEventListener("play",we),n.addEventListener("waiting",$e),n.addEventListener("playing",et),n.addEventListener("pause",qe),n.addEventListener("error",Je),n.addEventListener("seeking",_t),n.addEventListener("seeked",Xe),n.addEventListener("timeupdate",Re),n.addEventListener("progress",ye),n.addEventListener("ratechange",be),n.addEventListener("loadedmetadata",We),n.addEventListener("loadeddata",Qe),n.addEventListener("stalled",dt),n.addEventListener("ended",Ve),n.addEventListener("volumechange",rt)}function Vt(){n.removeEventListener("canplay",ht),n.removeEventListener("canplaythrough",Tt),n.removeEventListener("play",we),n.removeEventListener("waiting",$e),n.removeEventListener("playing",et),n.removeEventListener("pause",qe),n.removeEventListener("error",Je),n.removeEventListener("seeking",_t),n.removeEventListener("seeked",Xe),n.removeEventListener("timeupdate",Re),n.removeEventListener("progress",ye),n.removeEventListener("ratechange",be),n.removeEventListener("loadedmetadata",We),n.removeEventListener("loadeddata",Qe),n.removeEventListener("stalled",dt),n.removeEventListener("ended",Ve),n.removeEventListener("volumechange",rt)}return m={initialize:pe,setConfig:Ye,getTimeToStreamEnd:Ee,getBufferLevel:Le,getPlaybackStalled:ve,getTime:x,getLowLatencyModeEnabled:Ue,getInitialCatchupModeActivated:Pt,getIsManifestUpdateInProgress:de,getPlaybackRate:F,getPlayedRanges:oe,getEnded:ie,getIsDynamic:q,getStreamController:Ae,computeAndSetLiveDelay:ze,getLiveDelay:Ie,getOriginalLiveDelay:He,getCurrentLiveLatency:Be,play:Q,isPaused:y,isStalled:b,pause:le,isSeeking:S,getStreamEndTime:ge,seek:Y,seekToOriginalLive:I,seekToCurrentLive:L,reset:ue,updateCurrentTime:Te,getAvailabilityStartTime:Me},J(),m}C.__dashjs_factory_name="PlaybackController";let T=i.default.getSingletonFactory(C)},"./src/streaming/controllers/ScheduleController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/models/FragmentModel.js"),o=e("./src/core/EventBus.js"),i=e("./src/core/events/Events.js"),E=e("./src/core/FactoryMaker.js"),h=e("./src/core/Debug.js"),t=e("./src/streaming/constants/MetricsConstants.js"),g=e("./src/streaming/MediaPlayerEvents.js");function C(P){P=P||{};var R=this.context,m=(0,o.default)(R).getInstance(),f=P.dashMetrics,r=P.mediaPlayerModel,d=P.fragmentModel,c=P.abrController,M=P.playbackController,n=P.textController,_=P.type,u=P.bufferController,A=P.representationController,D=P.settings,j,$,z,ee,k,w,N,H,W,Z,X,te;function fe(){z=(0,h.default)(R).getInstance().getLogger(j),Be(),$=P.streamInfo}function J(Te){w=Te,m.on(i.default.URL_RESOLUTION_FAILED,oe,j),m.on(g.default.PLAYBACK_STARTED,ie,j),m.on(g.default.PLAYBACK_RATE_CHANGED,q,j),m.on(g.default.PLAYBACK_TIME_UPDATED,b,j)}function ue(){return _}function pe(){return $.id}function Ce(Te){if(!u.getIsBufferingCompleted()){ve();var Fe=isNaN(Te)?0:Te;k=setTimeout(ge,Fe)}}function ve(){k&&(clearTimeout(k),k=null)}function Ee(){var Te=$.id,Fe=c.getMaxAllowedIndexFor(_,Te);return isNaN(H)||H!=Fe?(z.info("Top quality "+_+" index has changed from "+H+" to "+Fe),H=Fe,!0):!1}function ge(){try{if(le()){ve();return}if(Y()){var Te=!1;te&&(Te=c.checkPlaybackQuality(_,$.id)),Te||Q()}else Ce(M.getLowLatencyModeEnabled()?D.get().streaming.scheduling.lowLatencyTimeout:D.get().streaming.scheduling.defaultTimeout)}catch{Ce(M.getLowLatencyModeEnabled()?D.get().streaming.scheduling.lowLatencyTimeout:D.get().streaming.scheduling.defaultTimeout)}}function Q(){var Te=A.getCurrentRepresentationInfo();X||Te.quality!==W||Z?(Z?(z.debug("Switch track for "+_+", representation id = "+Te.id),Z=!1):z.debug("Quality has changed, get init request for representationid = "+Te.id),m.trigger(i.default.INIT_FRAGMENT_NEEDED,{representationId:Te.id,sender:j},{streamId:$.id,mediaType:_}),te=!1,X=!1):(z.debug("Media segment needed for ".concat(_," and stream id ").concat($.id)),m.trigger(i.default.MEDIA_FRAGMENT_NEEDED,{},{streamId:$.id,mediaType:_}),te=!0)}function le(){try{return _===p.default.TEXT&&!n.isTextEnabled()||M.isPaused()&&(!M.getStreamController().getInitialPlayback()||!M.getStreamController().getAutoPlay())&&!D.get().streaming.scheduling.scheduleWhilePaused}catch{return!1}}function Y(){try{var Te=A.getCurrentRepresentationInfo();return Te&&(isNaN(W)||Z||Ee()||I())}catch{return!1}}function I(){var Te=A.getCurrentRepresentationInfo();if(!_||!Te)return!0;var Fe=f.getCurrentBufferLevel(_);return Fe<L()}function L(){var Te=NaN,Fe=A.getCurrentRepresentationInfo();return!_||!Fe||(_===p.default.TEXT?Te=K():_===p.default.AUDIO&&w?Te=U():Te=x()),Te}function K(){try{if(n.isTextEnabled()){var Te=A.getCurrentRepresentationInfo();if(isNaN(Te.fragmentDuration)){var Fe=f.getCurrentSchedulingInfo(t.default.SCHEDULING_INFO);return Fe?Fe.duration:0}else return Te.fragmentDuration}else return 0}catch{return 0}}function U(){try{var Te=f.getCurrentBufferLevel(p.default.VIDEO),Fe=A.getCurrentRepresentationInfo();return isNaN(Fe.fragmentDuration)?Te+1:Math.max(Te+1,Fe.fragmentDuration)}catch{return 0}}function x(){try{var Te=A.getCurrentRepresentationInfo(),Fe=Te.mediaInfo.streamInfo;if(c.isPlayingAtTopQuality(Fe)){var ot=Fe.manifestInfo.duration>=D.get().streaming.buffer.longFormContentDurationThreshold;return ot?D.get().streaming.buffer.bufferTimeAtTopQualityLongForm:D.get().streaming.buffer.bufferTimeAtTopQuality}else return r.getStableBufferTime()}catch{return r.getStableBufferTime()}}function y(Te){Z=Te}function S(){return Z}function b(){F(!0)}function F(Te){if(M&&d){var Fe=d.getRequests({state:l.default.FRAGMENT_MODEL_EXECUTED,time:M.getTime(),threshold:0})[0];Fe&&M.getTime()>=Fe.startTime&&((!N.mediaInfo||Fe.mediaInfo.type===N.mediaInfo.type&&Fe.mediaInfo.id!==N.mediaInfo.id)&&Te&&m.trigger(i.default.TRACK_CHANGE_RENDERED,{mediaType:_,oldMediaInfo:N.mediaInfo,newMediaInfo:Fe.mediaInfo,streamId:$.id}),(Fe.quality!==N.quality||Fe.adaptationIndex!==N.adaptationIndex)&&Te&&(z.debug("Quality change rendered for streamId ".concat($.id," and type ").concat(_)),m.trigger(i.default.QUALITY_CHANGE_RENDERED,{mediaType:_,oldQuality:N.quality,newQuality:Fe.quality,streamId:$.id})),N={mediaInfo:Fe.mediaInfo,quality:Fe.quality,adaptationIndex:Fe.adaptationIndex})}}function oe(){d.abortRequests(),ve()}function ie(){D.get().streaming.scheduling.scheduleWhilePaused||Ce()}function q(Te){f.updatePlayListTraceMetrics({playbackspeed:Te.playbackRate.toString()})}function Ae(Te){ee=Te}function de(){return ee}function Me(Te){te=Te}function Ie(Te){X=Te}function He(Te){W=Te}function Be(){te=!0,ee=0,W=NaN,N={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},H=NaN,Z=!1,X=!1}function ze(){m.off(i.default.URL_RESOLUTION_FAILED,oe,j),m.off(g.default.PLAYBACK_STARTED,ie,j),m.off(g.default.PLAYBACK_RATE_CHANGED,q,j),m.off(g.default.PLAYBACK_TIME_UPDATED,b,j),ve(),F(!1),Be(),$=null}function Ye(){return M}return j={initialize:J,getType:ue,getStreamId:pe,setTimeToLoadDelay:Ae,getTimeToLoadDelay:de,setSwitchTrack:y,getSwitchTrack:S,startScheduleTimer:Ce,clearScheduleTimer:ve,reset:ze,getBufferTarget:L,getPlaybackController:Ye,setCheckPlaybackQuality:Me,setInitSegmentRequired:Ie,setLastInitializedQuality:He},fe(),j}C.__dashjs_factory_name="ScheduleController";let T=E.default.getClassFactory(C)},"./src/streaming/controllers/StreamController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>ee});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/constants/MetricsConstants.js"),o=e("./src/streaming/Stream.js"),i=e("./src/streaming/ManifestUpdater.js"),E=e("./src/core/EventBus.js"),h=e("./src/core/events/Events.js"),t=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/vo/metrics/PlayList.js"),C=e("./src/core/Debug.js"),T=e("./src/streaming/utils/InitCache.js"),P=e("./src/streaming/MediaPlayerEvents.js"),R=e("./src/streaming/controllers/TimeSyncController.js"),m=e("./src/streaming/controllers/MediaSourceController.js"),f=e("./src/streaming/vo/DashJSError.js"),r=e("./src/core/errors/Errors.js"),d=e("./src/streaming/controllers/EventController.js"),c=e("./src/streaming/constants/ConformanceViolationConstants.js");function M(k){return A(k)||u(k)||_(k)||n()}function n(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _(k,w){if(k){if(typeof k=="string")return D(k,w);var N=Object.prototype.toString.call(k).slice(8,-1);if(N==="Object"&&k.constructor&&(N=k.constructor.name),N==="Map"||N==="Set")return Array.from(k);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return D(k,w)}}function u(k){if(typeof Symbol<"u"&&Symbol.iterator in Object(k))return Array.from(k)}function A(k){if(Array.isArray(k))return D(k)}function D(k,w){(w==null||w>k.length)&&(w=k.length);for(var N=0,H=new Array(w);N<w;N++)H[N]=k[N];return H}var j=200,$=2;function z(){var k=this.context,w=(0,E.default)(k).getInstance(),N,H,W,Z,X,te,fe,J,ue,pe,Ce,ve,Ee,ge,Q,le,Y,I,L,K,U,x,y,S,b,F,oe,ie,q,Ae,de,Me,Ie,He,Be,ze,Ye,Te,Fe,ot,st,at,ht,Tt,xe,we,$e,et;function qe(){H=(0,C.default)(k).getInstance().getLogger(N),Ce=(0,R.default)(k).getInstance(),pe=(0,m.default)(k).getInstance(),L=(0,T.default)(k).getInstance(),Xr()}function _t(je,it){ye(),oe=je,F=it,U.initialize(),X=(0,i.default)(k).create(),X.setConfig({manifestModel:fe,adapter:J,manifestLoader:te,errHandler:K,settings:Tt,contentSteeringController:ve}),X.initialize(),I=(0,d.default)(k).getInstance(),I.setConfig({manifestUpdater:X,playbackController:Ie,settings:Tt}),I.start(),Ce.setConfig({dashMetrics:ue,baseURLController:Ee,errHandler:K,settings:Tt}),Ce.initialize(),S&&(w.trigger(h.default.PROTECTION_CREATED,{controller:S}),S.setMediaElement(Me.getElement()),F&&S.setProtectionData(F)),Xe()}function Xe(){w.on(P.default.PLAYBACK_TIME_UPDATED,G,N),w.on(P.default.PLAYBACK_SEEKING,vt,N),w.on(P.default.PLAYBACK_ERROR,Rr,N),w.on(P.default.PLAYBACK_STARTED,B,N),w.on(P.default.PLAYBACK_PAUSED,se,N),w.on(P.default.PLAYBACK_ENDED,Oe,N),w.on(P.default.METRIC_ADDED,Fr,N),w.on(P.default.MANIFEST_VALIDITY_CHANGED,zr,N),w.on(P.default.BUFFER_LEVEL_UPDATED,Mt,N),w.on(P.default.QUALITY_CHANGE_REQUESTED,O,N),h.default.KEY_SESSION_UPDATED&&w.on(h.default.KEY_SESSION_UPDATED,rt,N),w.on(h.default.MANIFEST_UPDATED,jt,N),w.on(h.default.STREAM_BUFFERING_COMPLETED,_e,N),w.on(h.default.TIME_SYNCHRONIZATION_COMPLETED,Ve,N),w.on(h.default.CURRENT_TRACK_CHANGED,kt,N),w.on(h.default.SETTING_UPDATED_LIVE_DELAY,ae,N),w.on(h.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,ae,N)}function Re(){w.off(P.default.PLAYBACK_TIME_UPDATED,G,N),w.off(P.default.PLAYBACK_SEEKING,vt,N),w.off(P.default.PLAYBACK_ERROR,Rr,N),w.off(P.default.PLAYBACK_STARTED,B,N),w.off(P.default.PLAYBACK_PAUSED,se,N),w.off(P.default.PLAYBACK_ENDED,Oe,N),w.off(P.default.METRIC_ADDED,Fr,N),w.off(P.default.MANIFEST_VALIDITY_CHANGED,zr,N),w.off(P.default.BUFFER_LEVEL_UPDATED,Mt,N),w.off(P.default.QUALITY_CHANGE_REQUESTED,O,N),h.default.KEY_SESSION_UPDATED&&w.off(h.default.KEY_SESSION_UPDATED,rt,N),w.off(h.default.MANIFEST_UPDATED,jt,N),w.off(h.default.STREAM_BUFFERING_COMPLETED,_e,N),w.off(h.default.TIME_SYNCHRONIZATION_COMPLETED,Ve,N),w.off(h.default.CURRENT_TRACK_CHANGED,kt,N),w.off(h.default.SETTING_UPDATED_LIVE_DELAY,ae,N),w.off(h.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,ae,N)}function ye(){if(!te||!te.hasOwnProperty("load")||!U||!U.hasOwnProperty("initialize")||!U.hasOwnProperty("reset")||!U.hasOwnProperty("getClientTimeOffset")||!fe||!K||!ue||!Ie)throw new Error(p.default.MISSING_CONFIG_ERROR)}function be(){if(!X||!X.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}function We(je){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;ye(),$e=it,te.load(je)}function Qe(je){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;be(),$e=it,X.setManifest(je)}function Ve(){ft()}function rt(){xe=!0}function ft(){try{var je=J.getStreamsInfo();if(!y&&je.length===0)throw new Error("There are no periods in the MPD");y&&je.length>0&&ue.updateManifestUpdateInfo({currentTime:Ie.getTime(),buffered:Me.getBufferRange(),presentationStartTime:je[0].start,clientTimeOffset:U.getClientTimeOffset()}),x.length>0&&Ut(je);for(var it=[],pt=0,Ot=je.length;pt<Ot;pt++){var Lt=je[pt];it.push(Je(Lt)),ue.addManifestUpdateStreamInfo(Lt)}Promise.all(it).then(function(){return new Promise(function(Bt,xt){y?Bt():yt(je,Bt,xt)})}).then(function(){w.trigger(h.default.STREAMS_COMPOSED),me()}).catch(function(Bt){throw Bt})}catch(Bt){K.error(new f.default(r.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,Bt.message+" nostreamscomposed",fe.getValue())),Ae=!0,Mr()}}function Je(je){var it=wr(je.id);return it?it.updateData(je):(it=(0,o.default)(k).create({manifestModel:fe,mediaPlayerModel:Be,dashMetrics:ue,manifestUpdater:X,adapter:J,timelineConverter:U,capabilities:W,capabilitiesFilter:Z,errHandler:K,baseURLController:Ee,segmentBaseController:ge,textController:b,abrController:le,playbackController:Ie,eventController:I,mediaController:Y,protectionController:S,videoModel:Me,streamInfo:je,settings:Tt}),x.push(it),it.initialize(),Promise.resolve())}function yt(je,it,pt){try{St();var Ot=ue.getCurrentDVRInfo().range;if(Ot.end<Ot.start){we&&clearTimeout(we);var Lt=Math.min(((Ot.end-Ot.start)*-1+$)*1e3,2147483647);H.debug("Waiting for ".concat(Lt," ms before playback can start")),w.trigger(h.default.AST_IN_FUTURE,{delay:Lt}),we=setTimeout(function(){yt(je,it,pt)},Lt);return}Tt.get().streaming.applyProducerReferenceTime&&He.calculateProducerReferenceTimeOffsets(je);var Bt=je[0].manifestInfo;if(Tt.get().streaming.applyServiceDescription&&He.applyServiceDescription(Bt),J.getIsDynamic()){var xt=Nt(je,Bt);Ie.computeAndSetLiveDelay(xt,Bt)}At().then(function(){var Qt=fe.getValue();Qt&&Ee.update(Qt),Le(),it()}).catch(function(Qt){H.error(Qt),Le(),it()})}catch(Qt){pt(Qt)}}function At(){return Tt.get().streaming.applyContentSteering&&ve.shouldQueryBeforeStart()?ve.loadSteeringData():Promise.resolve()}function Le(){var je=ut(),it=lt(je),pt=it!==null?it:x[0];w.trigger(h.default.INITIAL_STREAM_SWITCH,{startTime:je}),Ue(pt,null,je),Se()}function Ue(je,it,pt){try{if(ie||!je||it===je&&je.getIsActive())return;ie=!0,w.trigger(h.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:it?it.getStreamInfo():null,toStreamInfo:je.getStreamInfo()});var Ot=!1;y=je,it&&(Ot=Wt(je,it),it.deactivate(Ot)),pt=isNaN(pt)?!Ot&&it?je.getStreamInfo().start:NaN:pt,H.info("Switch to stream ".concat(je.getId(),". Seektime is ").concat(pt,", current playback time is ").concat(Ie.getTime(),". Seamless period switch is set to ").concat(Ot)),at=at.filter(function(Lt){return Lt.getId()!==y.getId()}),Ie.initialize(ur(),!!it),Me.getElement()?Ze(pt,Ot,!1):dt(pt,Ot)}catch{ie=!1}}function Ze(je,it){var pt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Ot;function Lt(){if(!(!de||de.readyState!=="open")){H.debug("MediaSource is open!"),window.URL.revokeObjectURL(Ot),de.removeEventListener("sourceopen",Lt),de.removeEventListener("webkitsourceopen",Lt),gt();var xt=ue.getCurrentDVRInfo();pe.setSeekable(xt.range.start,xt.range.end),pt?(isNaN(je)||Ie.seek(je,!0,!0),y.setMediaSource(de).then(function(){y.initializeForTextWithMediaSource(de)})):dt(je,it)}}function Bt(){de.addEventListener("sourceopen",Lt,!1),de.addEventListener("webkitsourceopen",Lt,!1),Ot=pe.attachMediaSource(Me),H.debug("MediaSource attached to element.  Waiting on open...")}de?it?dt(je,it):(pe.detachMediaSource(Me),Bt()):(de=pe.createMediaSource(),Bt())}function dt(je,it){y.activate(de,it?st:void 0,je).then(function(pt){if(pt){var Ot=Object.keys(pt);Ot.length>0&&pt[Ot[0]].getBuffer().changeType&&(ht=!0),st=pt}isNaN(je)||(w.trigger(h.default.SEEK_TARGET,{time:je},{streamId:y.getId()}),Ie.seek(je,!1,!0),y.startScheduleControllers()),ie=!1,w.trigger(h.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:ur()})})}function vt(je){var it=je.seekTime,pt=lt(it);!pt||pt===y?(mt(),Ft(je)):pt&&pt!==y&&(mt(pt),bt(je,pt)),gr(g.PlayList.SEEK_START_REASON)}function mt(){var je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Pt()}function Pt(){at&&at.length>0&&(at.forEach(function(je){je.deactivate(!0)}),at=[])}function Ft(je){var it=y.getProcessors();it.forEach(function(pt){return pt.prepareInnerPeriodPlaybackSeeking(je)}),lr(g.PlayListTrace.USER_REQUEST_STOP_REASON)}function bt(je,it){var pt=je&&!isNaN(je.seekTime)?je.seekTime:NaN,Ot=y.getProcessors(),Lt=Ot.map(function(Bt){return Bt.prepareOuterPeriodPlaybackSeeking(je)});Promise.all(Lt).then(function(){Ue(it,y,pt)}).catch(function(Bt){K.error(Bt)})}function kt(je){je.newMediaInfo.streamInfo.id===y.getId()&&(Pt(),y.prepareTrackChange(je))}function Wt(je,it){try{return Tt.get().streaming.buffer.reuseExistingSourceBuffers&&(it.isProtectionCompatible(je)||xe)&&(ht&&Tt.get().streaming.buffer.useChangeTypeForTrackSwitch||it.isMediaCodecCompatible(je,it))}catch{return!1}}function Vt(je){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(de&&!je.getPreloaded()){var pt=Wt(je,it);pt&&je.startPreloading(de,st).then(function(){at.push(je)})}}function lt(je){if(isNaN(je))return null;for(var it=x.length,pt=0;pt<it;pt++){var Ot=x[pt],Lt=parseFloat((Ot.getStartTime()+Ot.getDuration()).toFixed(5));if(je<Lt)return Ot}return null}function St(){try{var je=J.getIsDynamic(),it=J.getStreamsInfo(),pt=it[0].manifestInfo,Ot=Ie.getTime(),Lt=U.calcTimeShiftBufferWindow(x,je),Bt=De();if(typeof Lt.start>"u"||typeof Lt.end>"u")return;!Bt||Bt.length===0?ue.addDVRInfo(p.default.VIDEO,Ot,pt,Lt):Bt.forEach(function(xt){ue.addDVRInfo(xt.getType(),Ot,pt,Lt)})}catch{}}function Mt(je){if(Te&&oe){var it=Be.getInitialBufferLevel(),pt=[p.default.TEXT];(isNaN(it)||it<=Ie.getBufferLevel(pt)||J.getIsDynamic()&&it>Ie.getLiveDelay())&&(Te=!1,gr(g.PlayList.INITIAL_PLAYOUT_START_REASON),Ie.play())}je&&je.mediaType&&ue.addBufferLevel(je.mediaType,new Date,je.bufferLevel*1e3)}function O(je){je.streamInfo.id===y.getId()&&je.reason&&je.reason.forceReplace&&Pt();var it=wr(je.streamInfo.id);it.prepareQualityChange(je)}function ae(){if(J.getIsDynamic()&&Ie.getOriginalLiveDelay()!==0&&y){var je=J.getStreamsInfo();if(je.length>0){var it=je[0].manifestInfo,pt=Nt(je,it);Ie.computeAndSetLiveDelay(pt,it)}}}function G(){if(Xt()){var je=Me.getPlaybackQuality();je&&ue.addDroppedFrames(je)}}function B(){H.debug("[onPlaybackStarted]"),!Te&&Ye&&gr(g.PlayList.RESUME_FROM_PAUSE_START_REASON),Te&&(Te=!1),Fe&&(Fe=!1,Tt.get().streaming.applyContentSteering&&!ve.shouldQueryBeforeStart()&&ve.loadSteeringData()),Ye=!1}function se(je){H.debug("[onPlaybackPaused]"),je.ended||(Ye=!0,lr(g.PlayListTrace.USER_REQUEST_STOP_REASON))}function _e(je){H.debug("Stream with id ".concat(je.streamInfo.id," finished buffering"));var it=je.streamInfo.isLast;de&&it?(H.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),pe.signalEndOfStream(de)):me()}function me(){if(!(!y||!y.getHasFinishedBuffering()))for(var je=tt(y),it=0;it<je.length;){var pt=je[it],Ot=it===0?y:je[it-1];!pt.getPreloaded()&&Ot.getHasFinishedBuffering()&&de&&Vt(pt,Ot),it+=1}}function Se(){ot||(ot=setInterval(function(){!ie&&Ie.getTimeToStreamEnd()<=0&&!Ie.isSeeking()&&w.trigger(h.default.PLAYBACK_ENDED,{isLast:ur().isLast})},j))}function Pe(){ot&&(clearInterval(ot),ot=null)}function ke(je,it){for(var pt=null,Ot=0,Lt=0,Bt=null,xt=0;xt<x.length;xt++){if(pt=x[xt],Lt=pt.getStartTime(),Bt=pt.getDuration(),Number.isFinite(Lt)&&(Ot=Lt),pt.getId()===it)return je-Ot;Number.isFinite(Bt)&&(Ot+=Bt)}return null}function De(){return y?y.getProcessors():[]}function Oe(je){if(y&&!y.getIsEndedEventSignaled()){y.setIsEndedEventSignaled(!0);var it=Ne();it?(H.debug("StreamController onEnded, found next stream with id ".concat(it.getStreamInfo().id,". Switching from ").concat(y.getStreamInfo().id," to ").concat(it.getStreamInfo().id)),Ue(it,y,NaN)):(H.debug("StreamController no next stream found"),y.setIsEndedEventSignaled(!1)),lr(it?g.PlayListTrace.END_OF_PERIOD_STOP_REASON:g.PlayListTrace.END_OF_CONTENT_STOP_REASON)}je&&je.isLast&&(Pe(),ve.stopSteeringRequestTimer())}function Ne(){var je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,it=je||y||null;if(!it)return null;for(var pt=it.getStreamInfo(),Ot=pt.start,Lt=0,Bt=-1,xt=NaN;Lt<x.length;){var Qt=x[Lt],zt=Qt.getStreamInfo(),Yt=zt.start-Ot;Yt>0&&(isNaN(xt)||Yt<xt)&&pt.id!==zt.id&&(xt=Yt,Bt=Lt),Lt+=1}return Bt>=0?x[Bt]:null}function tt(){var je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var it=je||y||null;if(it){var pt=it.getStreamInfo();return x.filter(function(Ot){var Lt=Ot.getStreamInfo();return Lt.start>pt.start&&pt.id!==Lt.id})}}catch{return[]}}function gt(je){var it=je||ur().manifestInfo.duration;pe.setDuration(it)}function ct(){return y}function Ct(){return Te}function Ke(){return oe}function ut(){var je,it=J.getIsDynamic();if(it){var pt=ue.getCurrentDVRInfo(),Ot=pt&&pt.range?pt.range.end:0;je=Ot-Ie.getOriginalLiveDelay();var Lt=pt?pt.range:null;if(Lt){if(!isNaN($e)||$e.toString().indexOf("posix:")!==-1){H.info("Start time provided by the app: ".concat($e));var Bt=Rt(!0,$e);isNaN(Bt)||(je=Math.min(je,Bt))}else{var xt=nt(!0);isNaN(xt)||(H.info("Start time from URI parameters: ".concat(xt)),je=Math.min(je,xt))}var Qt=Tt.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;je=Math.max(je,Lt.start+Qt)}}else{var zt=Pr(),Yt=zt[0].getStreamInfo();if(je=Yt.start,isNaN($e)){var Br=nt(!1);isNaN(Br)||(H.info("Start time from URI parameters: ".concat(Br)),je=Math.max(je,Br))}else{H.info("Start time provided by the app: ".concat($e));var Dr=Rt(!1,$e);isNaN(Dr)||(je=Math.max(je,Dr))}}return je}function nt(je){var it=Q.getURIFragmentData();if(!it||!it.t)return NaN;var pt=Pr()[0],Ot=pt.getStreamInfo().start;return it.t=it.t.split(",")[0],It(je,it.t,Ot)}function Rt(je,it){var pt=0;if(!je){var Ot=Pr()[0];pt=Ot.getStreamInfo().start}return It(je,it,pt)}function It(je,it,pt){var Ot=J.getRegularPeriods()[0],Lt=it.toString(),Bt=Lt.indexOf("posix:")!==-1?Lt.substring(6)==="now"?Date.now()/1e3:parseFloat(Lt.substring(6)):NaN,xt=je&&!isNaN(Bt)?U.calcPresentationTimeFromWallTime(new Date(Bt*1e3),Ot):parseFloat(Lt)+pt;return xt}function Ut(je){if(je.length===0){H.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects.");return}x=x.filter(function(it){var pt=je.filter(function(Lt){return Lt.id===it.getId()}).length>0,Ot=pt||it.getId()===y.getId();return Ot||(H.debug("Removing stream ".concat(it.getId())),it.reset(!0)),Ot})}function Nt(je,it){try{var pt=NaN;if(it&&!isNaN(it.maxFragmentDuration)&&isFinite(it.maxFragmentDuration))return it.maxFragmentDuration;if(je&&je.length===1){var Ot=je[0],Lt=[p.default.VIDEO,p.default.AUDIO,p.default.TEXT],Bt=Lt.reduce(function(xt,Qt){var zt=J.getMediaInfoForType(Ot,Qt);return zt&&zt.isFragmented!==!1&&xt.push(zt),xt},[]).reduce(function(xt,Qt){var zt=J.getVoRepresentations(Qt);return zt&&zt.length>0&&zt.forEach(function(Yt){Yt&&xt.push(Yt)}),xt},[]).reduce(function(xt,Qt){var zt=J.convertRepresentationToRepresentationInfo(Qt);return zt&&zt.fragmentDuration&&!isNaN(zt.fragmentDuration)&&xt.push(zt.fragmentDuration),xt},[]);pt=Math.max.apply(Math,M(Bt))}return isFinite(pt)?pt:NaN}catch{return NaN}}function jt(je){if(je.error)Ae=!0,Mr();else{H.info("Manifest updated... updating data system wide.");var it=je.manifest;J.updatePeriods(it);var pt=J.getUTCTimingSources();J.getIsDynamic()&&(!pt||pt.length===0)&&w.trigger(P.default.CONFORMANCE_VIOLATION,{level:c.default.LEVELS.WARNING,event:c.default.EVENTS.NO_UTC_TIMING_ELEMENT});var Ot=J.getIsDynamic()?pt.concat(ze.getUTCTimingSources()):pt;Z.filterUnsupportedFeatures(it).then(function(){Ee.initialize(it),Ce.attemptSync(Ot,J.getIsDynamic())})}}function Xt(){return y?y.getHasVideoTrack():!1}function $t(){return y?y.getHasAudioTrack():!1}function ar(je){y&&(Ie.initialize(ur()),Ze(je,!1,!0))}function lr(je,it){it=it||new Date,De().forEach(function(pt){pt.finalisePlayList(it,je)}),ue.addPlayList()}function gr(je){ue.createPlaylistMetrics(Ie.getTime()*1e3,je)}function Rr(je){if(je.error){var it="";switch(je.error.code){case 1:it="MEDIA_ERR_ABORTED";break;case 2:it="MEDIA_ERR_NETWORK";break;case 3:it="MEDIA_ERR_DECODE",et.counts.mediaErrorDecode+=1;break;case 4:it="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:it="MEDIA_ERR_ENCRYPTED";break;default:it="UNKNOWN";break}if(it==="MEDIA_ERR_DECODE"&&Tt.get().errors.recoverAttempts.mediaErrorDecode>=et.counts.mediaErrorDecode){pr();return}q=!0,je.error.message&&(it+=" ("+je.error.message+")"),je.error.msExtendedCode&&(it+=" (0x"+(je.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),H.fatal("Video Element Error: "+it),je.error&&H.fatal(je.error),K.error(new f.default(je.error.code,it)),Mr()}}function pr(){H.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var je=Ie.getTime();y.deactivate(!1),H.warn("MediaSource has been resetted. Resuming playback from time ".concat(je)),Ze(je,!1,!1)}function ur(){return y?y.getStreamInfo():null}function Cr(){return ie}function Yr(){return q||Ae}function wr(je){for(var it=0,pt=x.length;it<pt;it++)if(x[it].getId()===je)return x[it];return null}function zr(je){isNaN(je.newDuration)||gt(je.newDuration)}function hn(je){je&&(je.capabilities&&(W=je.capabilities),je.capabilitiesFilter&&(Z=je.capabilitiesFilter),je.manifestLoader&&(te=je.manifestLoader),je.manifestModel&&(fe=je.manifestModel),je.mediaPlayerModel&&(Be=je.mediaPlayerModel),je.customParametersModel&&(ze=je.customParametersModel),je.protectionController&&(S=je.protectionController),je.adapter&&(J=je.adapter),je.dashMetrics&&(ue=je.dashMetrics),je.errHandler&&(K=je.errHandler),je.timelineConverter&&(U=je.timelineConverter),je.videoModel&&(Me=je.videoModel),je.playbackController&&(Ie=je.playbackController),je.serviceDescriptionController&&(He=je.serviceDescriptionController),je.contentSteeringController&&(ve=je.contentSteeringController),je.textController&&(b=je.textController),je.abrController&&(le=je.abrController),je.mediaController&&(Y=je.mediaController),je.settings&&(Tt=je.settings),je.baseURLController&&(Ee=je.baseURLController),je.uriFragmentModel&&(Q=je.uriFragmentModel),je.segmentBaseController&&(ge=je.segmentBaseController))}function gn(je){F=je,S&&S.setProtectionData(F)}function Xr(){x=[],$e=NaN,S=null,ie=!1,y=null,q=!1,Ae=!1,Te=!0,Fe=!0,Ye=!1,oe=!0,ot=null,xe=!1,ht=!1,at=[],we=null,et={counts:{mediaErrorDecode:0}}}function Mr(){ye(),Ce.reset(),lr(q||Ae?g.PlayListTrace.FAILURE_STOP_REASON:g.PlayListTrace.USER_REQUEST_STOP_REASON);for(var je=0,it=x?x.length:0;je<it;je++){var pt=x[je];pt.reset(q)}Re(),Ee.reset(),X.reset(),I.reset(),ue.clearAllCurrentMetrics(),fe.setValue(null),te.reset(),U.reset(),L.reset(),de&&(pe.detachMediaSource(Me),de=null),Me=null,S&&(S=null,F=null,fe.getValue()&&w.trigger(h.default.PROTECTION_DESTROYED,{data:fe.getValue().url})),Pe(),w.trigger(h.default.STREAM_TEARDOWN_COMPLETE),Xr()}function Fr(je){if(je.metric===l.default.DVR_INFO){var it=$t()?p.default.AUDIO:p.default.VIDEO;je.mediaType===it&&pe.setSeekable(je.value.range.start,je.value.range.end)}}function Pr(){return x}return N={initialize:_t,getActiveStreamInfo:ur,addDVRMetric:St,hasVideoTrack:Xt,hasAudioTrack:$t,getStreamById:wr,getStreamForTime:lt,getTimeRelativeToStreamId:ke,load:We,loadWithManifest:Qe,getActiveStreamProcessors:De,setConfig:hn,setProtectionData:gn,getIsStreamSwitchInProgress:Cr,switchToVideoElement:ar,getHasMediaOrInitialisationError:Yr,getStreams:Pr,getActiveStream:ct,getInitialPlayback:Ct,getAutoPlay:Ke,reset:Mr},qe(),N}z.__dashjs_factory_name="StreamController";let ee=t.default.getSingletonFactory(z)},"./src/streaming/controllers/TimeSyncController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>n});var p=e("./src/streaming/vo/DashJSError.js"),l=e("./src/streaming/vo/metrics/HTTPRequest.js"),o=e("./src/core/EventBus.js"),i=e("./src/core/events/Events.js"),E=e("./src/core/errors/Errors.js"),h=e("./src/core/FactoryMaker.js"),t=e("./src/core/Debug.js"),g=e("./src/streaming/utils/URLUtils.js"),C=5e3,T=100,P=2,R=2,m=30,f=30,r=600,d=2;function c(){var _=this.context,u=(0,o.default)(_).getInstance(),A=(0,g.default)(_).getInstance(),D,j,$,z,ee,k,w,N,H,W,Z,X,te,fe,J,ue;function pe(){j=(0,t.default)(_).getInstance().getLogger(D),u.on(i.default.ATTEMPT_BACKGROUND_SYNC,Q,D)}function Ce(Be){Be&&(Be.dashMetrics&&(w=Be.dashMetrics),Be.baseURLController&&(ue=Be.baseURLController),Be.errHandler&&(J=Be.errHandler),Be.settings&&(ee=Be.settings))}function ve(){N=[],H=[],W=null,Z=null,te=null,X=NaN,$=!1,z=!1,fe=ee.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function Ee(){ve(),k={"urn:mpeg:dash:utc:http-head:2014":ie,"urn:mpeg:dash:utc:http-xsdate:2014":oe.bind(null,x),"urn:mpeg:dash:utc:http-iso:2014":oe.bind(null,y),"urn:mpeg:dash:utc:direct:2014":F,"urn:mpeg:dash:utc:http-head:2012":ie,"urn:mpeg:dash:utc:http-xsdate:2012":oe.bind(null,x),"urn:mpeg:dash:utc:http-iso:2012":oe.bind(null,y),"urn:mpeg:dash:utc:direct:2012":F,"urn:mpeg:dash:utc:http-ntp:2014":b,"urn:mpeg:dash:utc:ntp:2014":b,"urn:mpeg:dash:utc:sntp:2014":b}}function ge(Be,ze){if(H=Be,!$){if(!L(ze)){u.trigger(i.default.TIME_SYNCHRONIZATION_COMPLETED);return}$=!0,Y()}}function Q(){if(!(!ee.get().streaming.utcSynchronization.enabled||$||z||!te||!te.value||!te.schemeIdUri||isNaN(X)||isNaN(ee.get().streaming.utcSynchronization.backgroundAttempts))&&!(Z&&(Date.now()-Z)/1e3<f)){N=[],z=!0;var Be=isNaN(ee.get().streaming.utcSynchronization.backgroundAttempts)?R:ee.get().streaming.utcSynchronization.backgroundAttempts;le(Be)}}function le(Be){try{if(Be<=0){Me();return}var ze=Date.now();k[te.schemeIdUri](te.value,function(Ye){var Te=Date.now(),Fe=I(ze,Te,Ye);N.push(Fe),le(Be-1)},function(){Me()})}catch{Me()}}function Y(){var Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ze=Be||0;if(!H||H.length===0||ze>=H.length){K();return}var Ye=H[ze];if(Ye)if(k.hasOwnProperty(Ye.schemeIdUri)){var Te=new Date().getTime();k[Ye.schemeIdUri](Ye.value,function(Fe){var ot=new Date().getTime(),st=I(Te,ot,Fe);te=Ye,K(st)},function(){Y(ze+1)})}else Y(ze+1);else K()}function I(Be,ze,Ye){var Te=ze-(ze-Be)/2;return Ye-Te}function L(Be){try{if(!Be||!ee.get().streaming.utcSynchronization.enabled)return!1;var ze=isNaN(fe)?m:fe;return!W||!ze||isNaN(ze)?!0:(Date.now()-W)/1e3>=ze}catch{return!0}}function K(){var Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN,ze=isNaN(Be);ze&&ee.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?q():Ae(ze,Be)}function U(Be){var ze=60,Ye=60,Te=1e3,Fe=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,ot,st,at=Fe.exec(Be);return ot=Date.UTC(parseInt(at[1],10),parseInt(at[2],10)-1,parseInt(at[3],10),parseInt(at[4],10),parseInt(at[5],10),at[6]&&(parseInt(at[6],10)||0),at[7]&&parseFloat(at[7])*Te||0),at[9]&&at[10]&&(st=parseInt(at[9],10)*Ye+parseInt(at[10],10),ot+=(at[8]==="+"?-1:1)*st*ze*Te),new Date(ot).getTime()}function x(Be){var ze=Date.parse(Be);return isNaN(ze)&&(ze=U(Be)),ze}function y(Be){return Date.parse(Be)}function S(Be){return Date.parse(Be)}function b(Be,ze,Ye){Ye()}function F(Be,ze,Ye){var Te=x(Be);if(!isNaN(Te)){ze(Te);return}Ye()}function oe(Be,ze,Ye,Te,Fe){var ot,st,at=!1,ht=new XMLHttpRequest,Tt=Fe?l.HTTPRequest.HEAD:l.HTTPRequest.GET,xe=ze.match(/\S+/g);if(ze=xe.shift(),ot=function(){at||(at=!0,xe.length?oe(Be,xe.join(" "),Ye,Te,Fe):Te())},st=function(){var et,qe;ht.status===200&&(et=Fe?ht.getResponseHeader("Date"):ht.response,qe=Be(et),isNaN(qe)||(Ye(qe),at=!0))},A.isRelative(ze)){var we=ue.resolve();we&&(ze=A.resolve(ze,we.url))}ht.open(Tt,ze),ht.timeout=C||0,ht.onload=st,ht.onloadend=ot,ht.send()}function ie(Be,ze,Ye){oe(S,Be,ze,Ye,!0)}function q(){var Be=w.getLatestMPDRequestHeaderValueByID("Date"),ze=Be!==null?new Date(Be).getTime():Number.NaN;if(isNaN(ze))Ae(!0);else{var Ye=ze-Date.now();Ae(!1,Ye)}}function Ae(Be,ze){if(!isNaN(X)&&!isNaN(ze)&&!Be&&de(ze),!Be&&!isNaN(ze)){W=Date.now(),$=!1;var Ye=isNaN(X);X=ze,Ye&&Q(),j.debug("Completed UTC sync. Setting client - server offset to ".concat(ze))}Be&&(te=null,$=!1,J.error(new p.default(E.default.TIME_SYNC_FAILED_ERROR_CODE,E.default.TIME_SYNC_FAILED_ERROR_MESSAGE))),u.trigger(i.default.UPDATE_TIME_SYNC_OFFSET,{offset:ze}),u.trigger(i.default.TIME_SYNCHRONIZATION_COMPLETED)}function de(Be){try{var ze=Ie(Be),Ye=isNaN(fe)?m:fe,Te=isNaN(ee.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?P:ee.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,Fe=isNaN(ee.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?r:ee.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,ot=isNaN(ee.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?d:ee.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts,st;ze?(st=Math.min(Ye*Te,Fe),j.debug("Increasing timeBetweenSyncAttempts to ".concat(st))):(st=Math.max(Ye/Te,ot),j.debug("Decreasing timeBetweenSyncAttempts to ".concat(st))),fe=st}catch{}}function Me(){if(!(!N||N.length===0)){var Be=N.reduce(function(ze,Ye){return ze+Ye},0)/N.length;Ie(Be)?j.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(j.debug("Completed background UTC sync. Setting client - server offset to ".concat(Be)),X=Be,u.trigger(i.default.UPDATE_TIME_SYNC_OFFSET,{offset:X})),z=!1,Z=Date.now()}}function Ie(Be){try{if(isNaN(X))return!0;var ze=ee.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(ee.get().streaming.utcSynchronization.maximumAllowedDrift)?ee.get().streaming.utcSynchronization.maximumAllowedDrift:T,Ye=X-ze,Te=X+ze;return Be>=Ye&&Be<=Te}catch{return!0}}function He(){ve(),u.off(i.default.ATTEMPT_BACKGROUND_SYNC,Q,D)}return D={initialize:Ee,attemptSync:ge,setConfig:Ce,reset:He},pe(),D}c.__dashjs_factory_name="TimeSyncController";var M=h.default.getSingletonFactory(c);M.HTTP_TIMEOUT_MS=C,h.default.updateSingletonFactory(c.__dashjs_factory_name,M);let n=M},"./src/streaming/controllers/XlinkController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/streaming/XlinkLoader.js"),l=e("./src/core/EventBus.js"),o=e("./src/core/events/Events.js"),i=e("./src/core/FactoryMaker.js"),E=e("./externals/xml2json.js"),h=e("./src/streaming/utils/URLUtils.js"),t=e("./src/dash/constants/DashConstants.js"),g="onLoad",C="onActuate",T="urn:mpeg:dash:resolve-to-zero:2013";function P(m){m=m||{};var f=this.context,r=(0,l.default)(f).getInstance(),d=(0,h.default)(f).getInstance(),c,M,n,_,u,A;function D(){r.on(o.default.XLINK_ELEMENT_LOADED,w,c),A=(0,p.default)(f).create({errHandler:m.errHandler,dashMetrics:m.dashMetrics,mediaPlayerModel:m.mediaPlayerModel,requestModifier:m.requestModifier,settings:m.settings})}function j(fe){fe&&(M=fe)}function $(fe){fe&&(n=fe)}function z(fe){var J;u=new E.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:M}),_=fe,_.Period_asArray?(J=H(_.Period_asArray,_,t.default.PERIOD,g),k(J,t.default.PERIOD,g)):r.trigger(o.default.XLINK_READY,{manifest:_})}function ee(){r.off(o.default.XLINK_ELEMENT_LOADED,w,c),A&&(A.reset(),A=null)}function k(fe,J,ue){var pe={},Ce,ve;pe.elements=fe,pe.type=J,pe.resolveType=ue,pe.elements.length===0&&N(pe);for(var Ee=0;Ee<pe.elements.length;Ee++)Ce=pe.elements[Ee],d.isHTTPURL(Ce.url)?ve=Ce.url:ve=Ce.originalContent.BaseURL+Ce.url,A.load(ve,Ce,pe)}function w(fe){var J,ue,pe="<response>",Ce="</response>",ve="";if(J=fe.element,ue=fe.resolveObject,J.resolvedContent){var Ee=0;J.resolvedContent.indexOf("<?xml")===0&&(Ee=J.resolvedContent.indexOf("?>")+2),ve=J.resolvedContent.substr(0,Ee)+pe+J.resolvedContent.substr(Ee)+Ce,J.resolvedContent=u.xml_str2json(ve)}X(ue)&&N(ue)}function N(fe){var J=[],ue,pe;if(W(fe),fe.resolveType===C&&r.trigger(o.default.XLINK_READY,{manifest:_}),fe.resolveType===g)switch(fe.type){case t.default.PERIOD:for(ue=0;ue<_[t.default.PERIOD+"_asArray"].length;ue++)pe=_[t.default.PERIOD+"_asArray"][ue],pe.hasOwnProperty(t.default.ADAPTATION_SET+"_asArray")&&(J=J.concat(H(pe[t.default.ADAPTATION_SET+"_asArray"],pe,t.default.ADAPTATION_SET,g))),pe.hasOwnProperty(t.default.EVENT_STREAM+"_asArray")&&(J=J.concat(H(pe[t.default.EVENT_STREAM+"_asArray"],pe,t.default.EVENT_STREAM,g)));k(J,t.default.ADAPTATION_SET,g);break;case t.default.ADAPTATION_SET:r.trigger(o.default.XLINK_READY,{manifest:_});break}}function H(fe,J,ue,pe){var Ce=[],ve,Ee,ge;for(Ee=fe.length-1;Ee>=0;Ee--)ve=fe[Ee],ve.hasOwnProperty("xlink:href")&&ve["xlink:href"]===T&&fe.splice(Ee,1);for(Ee=0;Ee<fe.length;Ee++)ve=fe[Ee],ve.hasOwnProperty("xlink:href")&&ve.hasOwnProperty("xlink:actuate")&&ve["xlink:actuate"]===pe&&(ge=Z(ve["xlink:href"],J,ue,Ee,pe,ve),Ce.push(ge));return Ce}function W(fe){var J=[],ue,pe,Ce,ve,Ee,ge;for(ve=fe.elements.length-1;ve>=0;ve--){if(ue=fe.elements[ve],pe=ue.type+"_asArray",!ue.resolvedContent||te())delete ue.originalContent["xlink:actuate"],delete ue.originalContent["xlink:href"],J.push(ue.originalContent);else if(ue.resolvedContent)for(Ee=0;Ee<ue.resolvedContent[pe].length;Ee++)Ce=ue.resolvedContent[pe][Ee],J.push(Ce);for(ue.parentElement[pe].splice(ue.index,1),ge=0;ge<J.length;ge++)ue.parentElement[pe].splice(ue.index+ge,0,J[ge]);J=[]}fe.elements.length>0&&n.run(_)}function Z(fe,J,ue,pe,Ce,ve){return{url:fe,parentElement:J,type:ue,index:pe,resolveType:Ce,originalContent:ve,resolvedContent:null,resolved:!1}}function X(fe){var J,ue;for(J=0;J<fe.elements.length;J++)if(ue=fe.elements[J],ue.resolved===!1)return!1;return!0}function te(){return!1}return c={resolveManifestOnLoad:z,setMatchers:j,setIron:$,reset:ee},D(),c}P.__dashjs_factory_name="XlinkController";let R=i.default.getClassFactory(P)},"./src/streaming/metrics/MetricsReporting.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>g});var p=e("./src/streaming/metrics/utils/DVBErrorsTranslator.js"),l=e("./src/streaming/metrics/MetricsReportingEvents.js"),o=e("./src/streaming/metrics/controllers/MetricsCollectionController.js"),i=e("./src/streaming/metrics/metrics/MetricsHandlerFactory.js"),E=e("./src/streaming/metrics/reporting/ReportingFactory.js");function h(){var C=this.context,T,P;function R(r){return P=(0,p.default)(C).getInstance({eventBus:r.eventBus,dashMetrics:r.dashMetrics,metricsConstants:r.metricsConstants,events:r.events}),P.initialize(),(0,o.default)(C).create(r)}function m(){return(0,E.default)(C).getInstance()}function f(){return(0,i.default)(C).getInstance()}return T={createMetricsReporting:R,getReportingFactory:m,getMetricsHandlerFactory:f},T}h.__dashjs_factory_name="MetricsReporting";var t=dashjs.FactoryMaker.getClassFactory(h);t.events=l.default,dashjs.FactoryMaker.updateClassFactory(h.__dashjs_factory_name,t);let g=t},"./src/streaming/metrics/MetricsReportingEvents.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/core/events/EventsBase.js");function l(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(d){return typeof d}:l=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},l(f)}function o(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function i(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&E(f,r)}function E(f,r){return E=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},E(f,r)}function h(f){var r=C();return function(){var c=T(f),M;if(r){var n=T(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return t(this,M)}}function t(f,r){return r&&(l(r)==="object"||typeof r=="function")?r:g(f)}function g(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(f){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},T(f)}var P=function(f){i(d,f);var r=h(d);function d(){var c;return o(this,d),c=r.call(this),c.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",c.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",c.CMCD_DATA_GENERATED="cmcdDataGenerated",c}return d}(p.default),R=new P;let m=R},"./src/streaming/metrics/controllers/MetricsCollectionController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/streaming/metrics/controllers/MetricsController.js"),l=e("./src/streaming/metrics/utils/ManifestParsing.js"),o=e("./src/streaming/metrics/MetricsReportingEvents.js");function i(h){h=h||{};var t,g={},C=this.context,T=h.eventBus,P=h.events;function R(d){if(!d.error){var c=Object.keys(g),M=(0,l.default)(C).getInstance({adapter:h.adapter,constants:h.constants}).getMetrics(d.manifest);M.forEach(function(n){var _=JSON.stringify(n);if(g.hasOwnProperty(_))c.splice(_,1);else try{var u=(0,p.default)(C).create(h);u.initialize(n),g[_]=u}catch{}}),c.forEach(function(n){g[n].reset(),delete g[n]}),T.trigger(o.default.METRICS_INITIALISATION_COMPLETE)}}function m(){Object.keys(g).forEach(function(d){g[d].reset()}),g={}}function f(){T.on(P.MANIFEST_UPDATED,R,t),T.on(P.STREAM_TEARDOWN_COMPLETE,m,t)}function r(){T.off(P.MANIFEST_UPDATED,R,t),T.off(P.STREAM_TEARDOWN_COMPLETE,m,t)}return t={reset:r},f(),t}i.__dashjs_factory_name="MetricsCollectionController";let E=dashjs.FactoryMaker.getClassFactory(i)},"./src/streaming/metrics/controllers/MetricsController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/streaming/metrics/controllers/RangeController.js"),l=e("./src/streaming/metrics/controllers/ReportingController.js"),o=e("./src/streaming/metrics/controllers/MetricsHandlersController.js");function i(h){h=h||{};var t,g,C,T,P=this.context;function R(f){try{C=(0,p.default)(P).create({mediaElement:h.mediaElement}),C.initialize(f.Range),g=(0,l.default)(P).create({debug:h.debug,metricsConstants:h.metricsConstants,mediaPlayerModel:h.mediaPlayerModel}),g.initialize(f.Reporting,C),t=(0,o.default)(P).create({debug:h.debug,eventBus:h.eventBus,metricsConstants:h.metricsConstants,events:h.events}),t.initialize(f.metrics,g)}catch(r){throw m(),r}}function m(){t&&t.reset(),g&&g.reset(),C&&C.reset()}return T={initialize:R,reset:m},T}i.__dashjs_factory_name="MetricsController";let E=dashjs.FactoryMaker.getClassFactory(i)},"./src/streaming/metrics/controllers/MetricsHandlersController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/streaming/metrics/metrics/MetricsHandlerFactory.js");function l(i){i=i||{};var E=[],h,t=this.context,g=i.eventBus,C=i.events,T=(0,p.default)(t).getInstance({debug:i.debug,eventBus:i.eventBus,metricsConstants:i.metricsConstants});function P(f){E.forEach(function(r){r.handleNewMetric(f.metric,f.value,f.mediaType)})}function R(f,r){f.split(",").forEach(function(d,c,M){var n;if(d.indexOf("(")!==-1&&d.indexOf(")")===-1){var _=M[c+1];_&&_.indexOf("(")===-1&&_.indexOf(")")!==-1&&(d+=","+_,delete M[c+1])}n=T.create(d,r),n&&E.push(n)}),g.on(C.METRIC_ADDED,P,h),g.on(C.METRIC_UPDATED,P,h)}function m(){g.off(C.METRIC_ADDED,P,h),g.off(C.METRIC_UPDATED,P,h),E.forEach(function(f){return f.reset()}),E=[]}return h={initialize:R,reset:m},h}l.__dashjs_factory_name="MetricsHandlersController";let o=dashjs.FactoryMaker.getClassFactory(l)},"./src/streaming/metrics/controllers/RangeController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/streaming/utils/CustomTimeRanges.js");function l(i){i=i||{};var E=!1,h=this.context,t,g,C=i.mediaElement;function T(f){f&&f.length&&(f.forEach(function(r){var d=r.starttime,c=d+r.duration;g.add(d,c)}),E=!!f[0]._useWallClockTime)}function P(){g.clear()}function R(){g=(0,p.default)(h).create()}function m(){var f=g.length,r;if(!f)return!0;r=E?new Date().getTime()/1e3:C.currentTime;for(var d=0;d<f;d+=1){var c=g.start(d),M=g.end(d);if(c<=r&&r<M)return!0}return!1}return t={initialize:T,reset:P,isEnabled:m},R(),t}l.__dashjs_factory_name="RangeController";let o=dashjs.FactoryMaker.getClassFactory(l)},"./src/streaming/metrics/controllers/ReportingController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/streaming/metrics/reporting/ReportingFactory.js");function l(i){var E=[],h,t=(0,p.default)(this.context).getInstance(i);function g(P,R){P.some(function(m){var f=t.create(m,R);if(f)return E.push(f),!0})}function C(){E.forEach(function(P){return P.reset()}),E=[]}function T(P,R){E.forEach(function(m){return m.report(P,R)})}return h={initialize:g,reset:C,report:T},h}l.__dashjs_factory_name="ReportingController";let o=dashjs.FactoryMaker.getClassFactory(l)},"./src/streaming/metrics/metrics/MetricsHandlerFactory.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js"),l=e("./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js"),o=e("./src/streaming/metrics/metrics/handlers/HttpListHandler.js"),i=e("./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js");function E(t){t=t||{};var g,C=t.debug?t.debug.getLogger(g):{},T=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,P=this.context,R={BufferLevel:p.default,DVBErrors:l.default,HttpList:o.default,PlayList:i.default,RepSwitchList:i.default,TcpList:i.default};function m(d,c){var M=d.match(T),n;if(M){try{n=R[M[1]](P).create({eventBus:t.eventBus,metricsConstants:t.metricsConstants}),n.initialize(M[1],c,M[3],M[5])}catch(_){n=null,C.error("MetricsHandlerFactory: Could not create handler for type ".concat(M[1]," with args ").concat(M[3],", ").concat(M[5]," (").concat(_.message,")"))}return n}}function f(d,c){R[d]=c}function r(d){delete R[d]}return g={create:m,register:f,unregister:r},g}E.__dashjs_factory_name="MetricsHandlerFactory";let h=dashjs.FactoryMaker.getSingletonFactory(E)},"./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/streaming/metrics/utils/HandlerHelpers.js");function l(i){i=i||{};var E,h,t,g,C,T,P=this.context,R=(0,p.default)(P).getInstance(),m=[],f=i.metricsConstants;function r(){try{return Object.keys(m).map(function(_){return m[_]}).reduce(function(_,u){return _.level<u.level?_:u})}catch{return}}function d(){var _=r();_&&T!==_.t&&(T=_.t,h.report(g,_))}function c(_,u,A){u&&(t=R.validateN(A),h=u,g=R.reconstructFullMetricName(_,A),C=setInterval(d,t))}function M(){clearInterval(C),C=null,t=0,h=null,T=null}function n(_,u,A){_===f.BUFFER_LEVEL&&(m[A]=u)}return E={initialize:c,reset:M,handleNewMetric:n},E}l.__dashjs_factory_name="BufferLevelHandler";let o=dashjs.FactoryMaker.getClassFactory(l)},"./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/streaming/metrics/MetricsReportingEvents.js");function l(i){i=i||{};var E,h,t=i.eventBus,g=i.metricsConstants;function C(){t.off(p.default.METRICS_INITIALISATION_COMPLETE,C,this),t.trigger(p.default.BECAME_REPORTING_PLAYER)}function T(m,f){f&&(h=f,t.on(p.default.METRICS_INITIALISATION_COMPLETE,C,this))}function P(){h=null}function R(m,f){m===g.DVB_ERRORS&&h&&h.report(m,f)}return E={initialize:T,reset:P,handleNewMetric:R},E}let o=dashjs.FactoryMaker.getClassFactory(l)},"./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>l});function p(){var o,i,E;function h(C,T){i=C,E=T}function t(){E=null,i=void 0}function g(C,T){C===i&&E&&E.report(i,T)}return o={initialize:h,reset:t,handleNewMetric:g},o}p.__dashjs_factory_name="GenericMetricHandler";let l=dashjs.FactoryMaker.getClassFactory(p)},"./src/streaming/metrics/metrics/handlers/HttpListHandler.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/streaming/metrics/utils/HandlerHelpers.js");function l(i){i=i||{};var E,h,t,g,C,T,P=[],R=(0,p.default)(this.context).getInstance(),m=i.metricsConstants;function f(){var M=P;M.length&&h&&h.report(C,M),P=[]}function r(M,n,_,u){n&&(t=R.validateN(_),h=n,u&&u.length&&(g=u),C=R.reconstructFullMetricName(M,_,u),T=setInterval(f,t))}function d(){clearInterval(T),T=null,t=null,g=null,P=[],h=null}function c(M,n){M===m.HTTP_REQUEST&&(!g||g===n.type)&&P.push(n)}return E={initialize:r,reset:d,handleNewMetric:c},E}l.__dashjs_factory_name="HttpListHandler";let o=dashjs.FactoryMaker.getClassFactory(l)},"./src/streaming/metrics/reporting/ReportingFactory.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/streaming/metrics/reporting/reporters/DVBReporting.js");function l(i){i=i||{};var E={"urn:dvb:dash:reporting:2014":p.default},h=this.context,t,g=i.debug?i.debug.getLogger(t):{},C=i.metricsConstants,T=i.mediaPlayerModel||{};function P(f,r){var d;try{d=E[f.schemeIdUri](h).create({metricsConstants:C,mediaPlayerModel:T}),d.initialize(f,r)}catch(c){d=null,g.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(f.schemeIdUri," (").concat(c.message,")"))}return d}function R(f,r){E[f]=r}function m(f){delete E[f]}return t={create:P,register:R,unregister:m},t}l.__dashjs_factory_name="ReportingFactory";let o=dashjs.FactoryMaker.getSingletonFactory(l)},"./src/streaming/metrics/reporting/reporters/DVBReporting.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/streaming/metrics/utils/MetricSerialiser.js"),l=e("./src/streaming/metrics/utils/RNG.js"),o=e("./src/streaming/models/CustomParametersModel.js");function i(h){h=h||{};var t,g=this.context,C,T,P,R,m,f,r,d=!0,c=!0,M=[],n=h.metricsConstants;function _(){C=(0,p.default)(g).getInstance(),P=(0,l.default)(g).getInstance(),T=(0,o.default)(g).getInstance(),j()}function u(z,ee,k){var w=new XMLHttpRequest;w.withCredentials=T.getXHRWithCredentialsForType(n.HTTP_REQUEST_DVB_REPORTING_TYPE);var N=function(){var W=M.indexOf(w);W!==-1&&(M.splice(W,1),w.status>=200&&w.status<300?ee&&ee():k&&k())};M.push(w);try{w.open("GET",z),w.onloadend=N,w.onerror=N,w.send()}catch{w.onerror()}}function A(z,ee){Array.isArray(ee)||(ee=[ee]),m&&r.isEnabled()&&ee.forEach(function(k){var w=C.serialise(k);d&&z!==n.DVB_ERRORS&&(w="metricname=".concat(z,"&").concat(w)),w="".concat(f,"?").concat(w),u(w,null,function(){m=!1})})}function D(z,ee){var k;if(r=ee,f=z.dvb_reportingUrl,!f)throw new Error("required parameter missing (dvb:reportingUrl)");R||(k=z.dvb_probability,k&&(k===1e3||k/1e3>=P.random())&&(m=!0),R=!0)}function j(){R=!1,m=!1,f=null,r=null}function $(){c||(M.forEach(function(z){return z.abort()}),M=[]),j()}return t={report:A,initialize:D,reset:$},_(),t}i.__dashjs_factory_name="DVBReporting";let E=dashjs.FactoryMaker.getClassFactory(i)},"./src/streaming/metrics/utils/DVBErrorsTranslator.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/streaming/metrics/vo/DVBErrors.js"),l=e("./src/streaming/metrics/MetricsReportingEvents.js");function o(E){E=E||{};var h,t,g=E.eventBus,C=E.dashMetrics,T=E.metricsConstants,P=E.events;function R(u){var A=new p.default;if(t){for(var D in u)u.hasOwnProperty(D)&&(A[D]=u[D]);A.mpdurl||(A.mpdurl=t.originalUrl||t.url),A.terror||(A.terror=new Date),C.addDVBErrors(A)}}function m(u){u.error||(t=u.manifest)}function f(u){R({errorcode:p.default.BASE_URL_CHANGED,servicelocation:u.entry})}function r(){R({errorcode:p.default.BECAME_REPORTER})}function d(u){(u.responsecode===0||u.responsecode==null||u.responsecode>=400||u.responsecode<100||u.responsecode>=600)&&R({errorcode:u.responsecode||p.default.CONNECTION_ERROR,url:u.url,terror:u.tresponse,servicelocation:u._serviceLocation})}function c(u){switch(u.metric){case T.HTTP_REQUEST:d(u.value);break;default:break}}function M(u){var A=u.error?u.error.code:0,D;switch(A){case MediaError.MEDIA_ERR_NETWORK:D=p.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:D=p.default.CORRUPT_MEDIA_OTHER;break;default:return}R({errorcode:D})}function n(){g.on(P.MANIFEST_UPDATED,m,h),g.on(P.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,f,h),g.on(P.METRIC_ADDED,c,h),g.on(P.METRIC_UPDATED,c,h),g.on(P.PLAYBACK_ERROR,M,h),g.on(l.default.BECAME_REPORTING_PLAYER,r,h)}function _(){g.off(P.MANIFEST_UPDATED,m,h),g.off(P.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,f,h),g.off(P.METRIC_ADDED,c,h),g.off(P.METRIC_UPDATED,c,h),g.off(P.PLAYBACK_ERROR,M,h),g.off(l.default.BECAME_REPORTING_PLAYER,r,h)}return h={initialize:n,reset:_},h}o.__dashjs_factory_name="DVBErrorsTranslator";let i=dashjs.FactoryMaker.getSingletonFactory(o)},"./src/streaming/metrics/utils/HandlerHelpers.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>l});function p(){return{reconstructFullMetricName:function(i,E,h){var t=i;return E&&(t+="("+E,h&&h.length&&(t+=","+h),t+=")"),t},validateN:function(i){if(!i)throw new Error("missing n");if(isNaN(i))throw new Error("n is NaN");if(i<0)throw new Error("n must be positive");return i}}}p.__dashjs_factory_name="HandlerHelpers";let l=dashjs.FactoryMaker.getSingletonFactory(p)},"./src/streaming/metrics/utils/ManifestParsing.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/streaming/metrics/vo/Metrics.js"),l=e("./src/streaming/metrics/vo/Range.js"),o=e("./src/streaming/metrics/vo/Reporting.js");function i(h){h=h||{};var t,g=h.adapter,C=h.constants;function T(R,m,f){var r,d,c=0;return m?c=g.getAvailabilityStartTime(R)/1e3:(r=g.getRegularPeriods(R),r.length&&(c=r[0].start)),d=c,f&&f.hasOwnProperty(C.START_TIME)&&(d+=f.starttime),d}function P(R){var m=[];return R&&R.Metrics_asArray&&R.Metrics_asArray.forEach(function(f){var r=new p.default,d=g.getIsDynamic(R);if(f.hasOwnProperty("metrics"))r.metrics=f.metrics;else return;if(f.Range_asArray&&f.Range_asArray.forEach(function(c){var M=new l.default;M.starttime=T(R,d,c),c.hasOwnProperty("duration")?M.duration=c.duration:M.duration=g.getDuration(R),M._useWallClockTime=d,r.Range.push(M)}),f.Reporting_asArray)f.Reporting_asArray.forEach(function(c){var M=new o.default;if(c.hasOwnProperty(C.SCHEME_ID_URI))M.schemeIdUri=c.schemeIdUri;else return;c.hasOwnProperty("value")&&(M.value=c.value),c.hasOwnProperty(C.DVB_REPORTING_URL)&&(M.dvb_reportingUrl=c[C.DVB_REPORTING_URL]),c.hasOwnProperty(C.DVB_PROBABILITY)&&(M.dvb_probability=c[C.DVB_PROBABILITY]),r.Reporting.push(M)});else return;m.push(r)}),m}return t={getMetrics:P},t}i.__dashjs_factory_name="ManifestParsing";let E=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/metrics/utils/MetricSerialiser.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>l});function p(){function o(i){var E=[],h=[],t,g;for(t in i)if(i.hasOwnProperty(t)&&t.indexOf("_")!==0){if(g=i[t],g==null&&(g=""),Array.isArray(g)){if(!g.length)continue;h=[],g.forEach(function(C){var T=Object.prototype.toString.call(C).slice(8,-1)!=="Object";h.push(T?C:o(C))}),g=h.map(encodeURIComponent).join(",")}else typeof g=="string"?g=encodeURIComponent(g):g instanceof Date?g=g.toISOString():typeof g=="number"&&(g=Math.round(g));E.push(t+"="+g)}return E.join("&")}return{serialise:o}}p.__dashjs_factory_name="MetricSerialiser";let l=dashjs.FactoryMaker.getSingletonFactory(p)},"./src/streaming/metrics/utils/RNG.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>l});function p(){var o=window.crypto||window.msCrypto,i=Uint32Array,E=Math.pow(2,i.BYTES_PER_ELEMENT*8)-1,h=10,t,g,C;function T(){o&&(t||(t=new i(h)),o.getRandomValues(t),g=0)}function P(R,m){var f;return R||(R=0),m||(m=1),o?(g===t.length&&T(),f=t[g]/E,g+=1):f=Math.random(),f*(m-R)+R}return C={random:P},T(),C}p.__dashjs_factory_name="RNG";let l=dashjs.FactoryMaker.getSingletonFactory(p)},"./src/streaming/metrics/vo/DVBErrors.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};l.SSL_CONNECTION_FAILED_PREFIX="SSL",l.DNS_RESOLUTION_FAILED="C00",l.HOST_UNREACHABLE="C01",l.CONNECTION_REFUSED="C02",l.CONNECTION_ERROR="C03",l.CORRUPT_MEDIA_ISOBMFF="M00",l.CORRUPT_MEDIA_OTHER="M01",l.BASE_URL_CHANGED="F00",l.BECAME_REPORTER="S00";let o=l},"./src/streaming/metrics/vo/Metrics.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.metrics="",this.Range=[],this.Reporting=[]};let o=l},"./src/streaming/metrics/vo/Range.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};let o=l},"./src/streaming/metrics/vo/Reporting.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});function p(E,h){if(!(E instanceof h))throw new TypeError("Cannot call a class as a function")}var l=1e3,o=function E(){p(this,E),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=l};let i=o},"./src/streaming/models/BaseURLTreeModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/streaming/utils/ObjectUtils.js"),l=e("./src/core/FactoryMaker.js");function o(g,C){if(!(g instanceof C))throw new TypeError("Cannot call a class as a function")}var i=NaN,E=function g(C,T){o(this,g),this.data={baseUrls:C||null,selectedIdx:T||i},this.children=[]};function h(){var g,C,T,P,R=this.context,m=(0,p.default)(R).getInstance();function f(){j()}function r(z){z.adapter&&(T=z.adapter),z.contentSteeringController&&(P=z.contentSteeringController)}function d(){if(!T||!T.hasOwnProperty("getBaseURLsFromElement")||!T.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}function c(z,ee,k){var w=n(k);z[ee]?m.areEqual(w,z[ee].data.baseUrls)||(z[ee].data.baseUrls=w,z[ee].data.selectedIdx=i):z[ee]=new E(w)}function M(z){d();var ee=n(z);m.areEqual(ee,C.data.baseUrls)||(C.data.baseUrls=ee,C.data.selectedIdx=i),z&&z.Period_asArray&&z.Period_asArray.forEach(function(k,w){c(C.children,w,k),k.AdaptationSet_asArray&&k.AdaptationSet_asArray.forEach(function(N,H){c(C.children[w].children,H,N),N.Representation_asArray&&N.Representation_asArray.sort(T.getRepresentationSortFunction()).forEach(function(W,Z){c(C.children[w].children[H].children,Z,W)})})})}function n(z){var ee=T.getBaseURLsFromElement(z),k=P.getSynthesizedBaseUrlElements(ee);return k&&k.length>0&&(ee=ee.concat(k)),ee}function _(z){return n(z)}function u(z,ee){var k=ee||C;z(k.data),k.children&&k.children.forEach(function(w){return u(z,w)})}function A(z){u(function(ee){isNaN(ee.selectedIdx)||z===ee.baseUrls[ee.selectedIdx].serviceLocation&&(ee.selectedIdx=i)})}function D(z){M(z)}function j(){C=new E}function $(z){var ee=C,k=[ee.data];return z&&z.forEach(function(w){ee=ee.children[w],ee&&k.push(ee.data)}),k.filter(function(w){return w.baseUrls.length})}return g={reset:j,update:D,getForPath:$,invalidateSelectedIndexes:A,setConfig:r,getBaseUrls:_},f(),g}h.__dashjs_factory_name="BaseURLTreeModel";let t=l.default.getClassFactory(h)},"./src/streaming/models/CmcdModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>_});var p=e("./src/core/EventBus.js"),l=e("./src/streaming/MediaPlayerEvents.js"),o=e("./src/streaming/metrics/MetricsReportingEvents.js"),i=e("./src/core/FactoryMaker.js"),E=e("./src/core/Settings.js"),h=e("./src/streaming/constants/Constants.js"),t=e("./src/streaming/vo/metrics/HTTPRequest.js"),g=e("./src/dash/models/DashManifestModel.js"),C=e("./src/core/Utils.js");function T(u,A){var D;if(typeof Symbol>"u"||u[Symbol.iterator]==null){if(Array.isArray(u)||(D=P(u))||A&&u&&typeof u.length=="number"){D&&(u=D);var j=0,$=function(){};return{s:$,n:function(){return j>=u.length?{done:!0}:{done:!1,value:u[j++]}},e:function(N){throw N},f:$}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var z=!0,ee=!1,k;return{s:function(){D=u[Symbol.iterator]()},n:function(){var N=D.next();return z=N.done,N},e:function(N){ee=!0,k=N},f:function(){try{!z&&D.return!=null&&D.return()}finally{if(ee)throw k}}}}function P(u,A){if(u){if(typeof u=="string")return R(u,A);var D=Object.prototype.toString.call(u).slice(8,-1);if(D==="Object"&&u.constructor&&(D=u.constructor.name),D==="Map"||D==="Set")return Array.from(u);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return R(u,A)}}function R(u,A){(A==null||A>u.length)&&(A=u.length);for(var D=0,j=new Array(A);D<A;D++)j[D]=u[D];return j}var m="CMCD",f=1,r={MANIFEST:"m",AUDIO:"a",VIDEO:"v",INIT:"i",CAPTION:"c",ISOBMFF_TEXT_TRACK:"tt",ENCRYPTION_KEY:"k",OTHER:"o"},d={DASH:"d",MSS:"s"},c={VOD:"v",LIVE:"l"},M=5;function n(){var u,A,D,j,$,z,ee,k,w,N,H=this.context,W=(0,p.default)(H).getInstance(),Z=(0,E.default)(H).getInstance();function X(){u=(0,g.default)(H).getInstance(),J()}function te(){W.on(l.default.PLAYBACK_RATE_CHANGED,Ae,A),W.on(l.default.MANIFEST_LOADED,de,A),W.on(l.default.BUFFER_LEVEL_STATE_CHANGED,Me,A),W.on(l.default.PLAYBACK_SEEKED,Ie,A),W.on(l.default.PERIOD_SWITCH_COMPLETED,ue,A)}function fe(Te){Te&&(Te.abrController&&(j=Te.abrController),Te.dashMetrics&&($=Te.dashMetrics),Te.playbackController&&(z=Te.playbackController))}function J(){D={pr:1,nor:null,st:null,sf:null,sid:"".concat(C.default.generateUuid()),cid:null},w={},k={},N={},pe()}function ue(){pe()}function pe(){if(z){var Te=z.getStreamController();if(Te&&typeof Te.getActiveStream=="function"){var Fe=Te.getActiveStream();Fe&&(ee=Fe.getProcessors())}}}function Ce(Te){try{if(Z.get().streaming.cmcd&&Z.get().streaming.cmcd.enabled){var Fe=le(Te),ot=ve(Fe),st=He(ot);return W.trigger(o.default.CMCD_DATA_GENERATED,{url:Te.url,mediaType:Te.mediaType,cmcdData:Fe,cmcdString:st}),{key:m,value:st}}return null}catch{return null}}function ve(Te){try{var Fe=Z.get().streaming.cmcd.enabledKeys;return Object.keys(Te).filter(function(ot){return Fe.includes(ot)}).reduce(function(ot,st){return ot[st]=Te[st],ot},{})}catch{return Te}}function Ee(Te,Fe){var ot={},st=T(Fe),at;try{for(st.s();!(at=st.n()).done;){var ht=at.value;Te[ht]&&(ot[ht]=Te[ht])}}catch(Tt){st.e(Tt)}finally{st.f()}return ot}function ge(Te){try{if(Z.get().streaming.cmcd&&Z.get().streaming.cmcd.enabled){var Fe=le(Te),ot=Ee(Fe,Q(["br","d","ot","tb"])),st=Ee(Fe,Q(["bl","dl","mtp","nor","nrr","su"])),at=Ee(Fe,Q(["bs","rtp"])),ht=Ee(Fe,Q(["cid","pr","sf","sid","st","v"])),Tt={"CMCD-Object":He(ot),"CMCD-Request":He(st),"CMCD-Status":He(at),"CMCD-Session":He(ht)};return W.trigger(o.default.CMCD_DATA_GENERATED,{url:Te.url,mediaType:Te.mediaType,cmcdData:Fe,headers:Tt}),Tt}return null}catch{return null}}function Q(Te){var Fe=Z.get().streaming.cmcd.enabledKeys;return Te.filter(function(ot){return Fe.includes(ot)})}function le(Te){try{var Fe=null;return Te.type===t.HTTPRequest.MPD_TYPE?I(Te):Te.type===t.HTTPRequest.MEDIA_SEGMENT_TYPE?(K(Te.mediaType),L(Te)):Te.type===t.HTTPRequest.INIT_SEGMENT_TYPE?U(Te):Te.type===t.HTTPRequest.OTHER_TYPE||Te.type===t.HTTPRequest.XLINK_EXPANSION_TYPE?x(Te):Te.type===t.HTTPRequest.LICENSE?Y(Te):Fe}catch{return null}}function Y(Te){var Fe=y(Te);return Fe.ot=r.ENCRYPTION_KEY,Fe}function I(){var Te=y();return Te.ot=r.MANIFEST,Te}function L(Te){var Fe=y(),ot=S(Te),st=F(Te),at=oe(Te.mediaType),ht=ie(Te.mediaType),Tt=q(Te.mediaType),xe=b(Te.mediaType),we=D.pr,$e=Be(Te.mediaType),et;Te.mediaType===h.default.VIDEO&&(et=r.VIDEO),Te.mediaType===h.default.AUDIO&&(et=r.AUDIO),Te.mediaType===h.default.TEXT&&(Te.mediaInfo.mimeType==="application/mp4"?et=r.ISOBMFF_TEXT_TRACK:et=r.CAPTION);var qe=Z.get().streaming.cmcd.rtp;return qe||(qe=ze(Te)),isNaN(qe)||(Fe.rtp=qe),$e&&(Te.url!==$e.url?Fe.nor=encodeURIComponent(C.default.getRelativeUrl(Te.url,$e.url)):$e.range&&(Fe.nrr=$e.range)),ot&&(Fe.br=ot),et&&(Fe.ot=et),isNaN(st)||(Fe.d=st),isNaN(at)||(Fe.mtp=at),isNaN(ht)||(Fe.dl=ht),isNaN(Tt)||(Fe.bl=Tt),isNaN(xe)||(Fe.tb=xe),!isNaN(we)&&we!==1&&(Fe.pr=we),w[Te.mediaType]&&(Fe.bs=!0,w[Te.mediaType]=!1),(k[Te.mediaType]||!N[Te.mediaType])&&(Fe.su=!0,k[Te.mediaType]=!1,N[Te.mediaType]=!0),Fe}function K(Te){N.hasOwnProperty(Te)||(N[Te]=!1),k.hasOwnProperty(Te)||(k[Te]=!1),w.hasOwnProperty(Te)||(w[Te]=!1)}function U(){var Te=y();return Te.ot=r.INIT,Te.su=!0,Te}function x(){var Te=y();return Te.ot=r.OTHER,Te}function y(){var Te={},Fe=Z.get().streaming.cmcd.cid?Z.get().streaming.cmcd.cid:D.cid;return Te.v=f,Te.sid=Z.get().streaming.cmcd.sid?Z.get().streaming.cmcd.sid:D.sid,Te.sid="".concat(Te.sid),Fe&&(Te.cid="".concat(Fe)),!isNaN(D.pr)&&D.pr!==1&&D.pr!==null&&(Te.pr=D.pr),D.st&&(Te.st=D.st),D.sf&&(Te.sf=D.sf),Te}function S(Te){try{var Fe=Te.quality,ot=Te.mediaInfo.bitrateList;return parseInt(ot[Fe].bandwidth/1e3)}catch{return null}}function b(Te){try{var Fe=j.getTopBitrateInfoFor(Te);return Math.round(Fe.bitrate/1e3)}catch{return null}}function F(Te){try{return isNaN(Te.duration)?NaN:Math.round(Te.duration*1e3)}catch{return null}}function oe(Te){try{return parseInt(j.getThroughputHistory().getSafeAverageThroughput(Te)/100)*100}catch{return null}}function ie(Te){try{var Fe=D.pr,ot=$.getCurrentBufferLevel(Te);return!isNaN(Fe)&&!isNaN(ot)?parseInt(ot/Fe*10)*100:null}catch{return null}}function q(Te){try{var Fe=$.getCurrentBufferLevel(Te);return isNaN(Fe)?null:parseInt(Fe*10)*100}catch{return null}}function Ae(Te){try{D.pr=Te.playbackRate}catch{}}function de(Te){try{var Fe=u.getIsDynamic(Te.data),ot=Fe?c.LIVE:c.VOD,st=Te.protocol&&Te.protocol==="MSS"?d.MSS:d.DASH;D.st="".concat(ot),D.sf="".concat(st)}catch{}}function Me(Te){try{Te.state&&Te.mediaType&&Te.state===l.default.BUFFER_EMPTY&&(w[Te.mediaType]||(w[Te.mediaType]=!0),k[Te.mediaType]||(k[Te.mediaType]=!0))}catch{}}function Ie(){for(var Te in w)w.hasOwnProperty(Te)&&(w[Te]=!0);for(var Fe in k)k.hasOwnProperty(Fe)&&(k[Fe]=!0)}function He(Te){try{if(!Te)return null;var Fe=Object.keys(Te).sort(function(at,ht){return at.localeCompare(ht)}),ot=Fe.length,st=Fe.reduce(function(at,ht,Tt){return ht==="v"&&Te[ht]===1||(typeof Te[ht]=="string"&&ht!=="ot"&&ht!=="sf"&&ht!=="st"?at+="".concat(ht,"=").concat(JSON.stringify(Te[ht])):at+="".concat(ht,"=").concat(Te[ht]),Tt<ot-1&&(at+=",")),at},"");return st=st.replace(/=true/g,""),st=st.replace(/,\s*$/,""),st}catch{return null}}function Be(Te){if(!(!ee||ee.length===0)){var Fe=T(ee),ot;try{for(Fe.s();!(ot=Fe.n()).done;){var st=ot.value;if(st.getType()===Te)return st.probeNextRequest()}}catch(at){Fe.e(at)}finally{Fe.f()}}}function ze(Te){try{var Fe=z.getPlaybackRate();Fe||(Fe=1);var ot=Te.quality,st=Te.mediaType,at=Te.mediaInfo,ht=Te.duration;if(!at)return NaN;var Tt=q(st);Tt===0&&(Tt=500);var xe=at.bitrateList[ot].bandwidth,we=xe*ht/1e3,$e=Tt/Fe/1e3,et=we/$e,qe=Z.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(Z.get().streaming.cmcd.rtpSafetyFactor)?Z.get().streaming.cmcd.rtpSafetyFactor:M,_t=et*qe;return(parseInt(_t/100)+1)*100}catch{return NaN}}function Ye(){W.off(l.default.PLAYBACK_RATE_CHANGED,Ae,this),W.off(l.default.MANIFEST_LOADED,de,this),W.off(l.default.BUFFER_LEVEL_STATE_CHANGED,Me,A),W.off(l.default.PLAYBACK_SEEKED,Ie,A),J()}return A={getQueryParameter:Ce,getHeaderParameters:ge,setConfig:fe,reset:Ye,initialize:te},X(),A}n.__dashjs_factory_name="CmcdModel";let _=i.default.getSingletonFactory(n)},"./src/streaming/models/CmsdModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>ee});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/EventBus.js"),o=e("./src/core/events/Events.js"),i=e("./src/core/Debug.js");function E(k){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?E=function(N){return typeof N}:E=function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},E(k)}function h(k,w){h=function(fe,J){return new Z(fe,void 0,J)};var N=T(RegExp),H=RegExp.prototype,W=new WeakMap;function Z(te,fe,J){var ue=N.call(this,te,fe);return W.set(ue,J||W.get(te)),ue}t(Z,N),Z.prototype.exec=function(te){var fe=H.exec.call(this,te);return fe&&(fe.groups=X(fe,this)),fe},Z.prototype[Symbol.replace]=function(te,fe){if(typeof fe=="string"){var J=W.get(this);return H[Symbol.replace].call(this,te,fe.replace(/\$<([^>]+)>/g,function(pe,Ce){return"$"+J[Ce]}))}else if(typeof fe=="function"){var ue=this;return H[Symbol.replace].call(this,te,function(){var pe=[];return pe.push.apply(pe,arguments),E(pe[pe.length-1])!=="object"&&pe.push(X(pe,ue)),fe.apply(this,pe)})}else return H[Symbol.replace].call(this,te,fe)};function X(te,fe){var J=W.get(fe);return Object.keys(J).reduce(function(ue,pe){return ue[pe]=te[J[pe]],ue},Object.create(null))}return h.apply(this,arguments)}function t(k,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(w&&w.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),w&&f(k,w)}function g(k,w){return w&&(E(w)==="object"||typeof w=="function")?w:C(k)}function C(k){if(k===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k}function T(k){var w=typeof Map=="function"?new Map:void 0;return T=function(H){if(H===null||!m(H))return H;if(typeof H!="function")throw new TypeError("Super expression must either be null or a function");if(typeof w<"u"){if(w.has(H))return w.get(H);w.set(H,W)}function W(){return P(H,arguments,r(this).constructor)}return W.prototype=Object.create(H.prototype,{constructor:{value:W,enumerable:!1,writable:!0,configurable:!0}}),f(W,H)},T(k)}function P(k,w,N){return R()?P=Reflect.construct:P=function(W,Z,X){var te=[null];te.push.apply(te,Z);var fe=Function.bind.apply(W,te),J=new fe;return X&&f(J,X.prototype),J},P.apply(null,arguments)}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m(k){return Function.toString.call(k).indexOf("[native code]")!==-1}function f(k,w){return f=Object.setPrototypeOf||function(H,W){return H.__proto__=W,H},f(k,w)}function r(k){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(N){return N.__proto__||Object.getPrototypeOf(N)},r(k)}var d="static",c="dynamic",M="cmsd-",n=M+d,_=M+c,u={AVAILABILITY_TIME:"at",DURESS:"du",ENCODED_BITRATE:"br",ESTIMATED_THROUGHPUT:"etp",HELD_TIME:"ht",INTERMEDIARY_IDENTIFIER:"n",MAX_SUGGESTED_BITRATE:"mb",NEXT_OBJECT_RESPONSE:"nor",NEXT_RANGE_RESPONSE:"nrr",OBJECT_DURATION:"d",OBJECT_TYPE:"ot",RESPONSE_DELAY:"rd",ROUND_TRIP_TIME:"rtt",STARTUP:"su",STREAM_TYPE:"st",STREAMING_FORMAT:"sf",VERSION:"v"},A={MANIFEST:"m",AUDIO:"a",VIDEO:"v",INIT:"i",CAPTION:"c",ISOBMFF_TEXT_TRACK:"tt",ENCRYPTION_KEY:"k",OTHER:"o",STREAM:"stream"},D=[u.MAX_SUGGESTED_BITRATE,u.STREAM_TYPE,u.STREAMING_FORMAT,u.VERSION],j={video:A.VIDEO,audio:A.AUDIO,text:A.ISOBMFF_TEXT_TRACK,stream:A.STREAM},$=/^[-0-9]/;function z(){var k=this.context,w=(0,l.default)(k).getInstance(),N,H,W,Z;function X(){H=(0,i.default)(k).getInstance().getLogger(N),J()}function te(){}function fe(){}function J(){W={},Z={}}function ue(U){U&&Object.keys(U).forEach(function(x){D.includes(x)||delete U[x]})}function pe(U){return U?U.toLowerCase()==="false"?!1:$.test(U)?parseInt(U,10):U.replace(/["]+/g,""):!0}function Ce(U){try{for(var x={},y=U.split(","),S=0;S<y.length;S++){var b=y[S].split("="),F=b[0],oe=pe(b[1]);x[F]=oe}return x}catch(ie){H.error("Failed to parse CMSD-Static response header value:",ie)}}function ve(U){try{for(var x={},y=U.split(","),S=y[y.length-1],b=S.split(";"),F=1;F<b.length;F++){var oe=b[F].split("="),ie=oe[0],q=pe(oe[1]);x[ie]=q}return x}catch(Ae){return H.error("Failed to parse CMSD-Dynamic response header value:",Ae),[]}}function Ee(U){return j[U]||A.OTHER}function ge(U,x,y){var S=U===d?W:Z,b=S[x]||{},F=S[A.STREAM]||{},oe=b[y]||F[y];return oe}function Q(U,x){for(var y=null,S=null,b=U.split(`\r
`),F=b.length-1;F>=0;F--){var oe=b[F],ie=oe.match(h(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(ie&&ie.groups){var q=ie.groups.key.toLowerCase(),Ae=ie.groups.value;switch(q){case n:y=Ce(Ae),w.trigger(o.default.CMSD_STATIC_HEADER,y);break;case _:S||(S=ve(Ae));break;default:break}}}var de=A.STREAM;return y&&y[u.OBJECT_TYPE]?de=y[u.OBJECT_TYPE]:x&&(de=Ee(x)),ue(W[de]),ue(Z[de]),y&&(W[de]=Object.assign(W[de]||{},y)),S&&(Z[de]=Object.assign(Z[de]||{},S)),{static:y,dynamic:S}}function le(U){var x=Ee(U),y=ge(c,x,u.MAX_SUGGESTED_BITRATE);return y||-1}function Y(U){var x=Ee(U),y=ge(c,x,u.ESTIMATED_THROUGHPUT);return y||null}function I(U){var x=Ee(U),y=ge(c,x,u.RESPONSE_DELAY);return y||null}function L(U){var x=Ee(U),y=ge(c,x,u.ROUND_TRIP_TIME);return y||null}function K(){J()}return N={setConfig:fe,initialize:te,reset:K,parseResponseHeaders:Q,getMaxBitrate:le,getEstimatedThroughput:Y,getResponseDelay:I,getRoundTripTime:L},X(),N}z.__dashjs_factory_name="CmsdModel";let ee=p.default.getSingletonFactory(z)},"./src/streaming/models/CustomParametersModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>C});var p=e("./src/dash/vo/UTCTiming.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/core/Settings.js"),i=e("./src/streaming/utils/SupervisorTools.js"),E=e("./src/streaming/rules/abr/ABRRulesCollection.js"),h=e("./src/streaming/constants/Constants.js"),t=!1;function g(){var T,P,R,m,f,r,d,c,M=this.context,n=(0,o.default)(M).getInstance();function _(){R={default:t},u()}function u(){m=[],f=[],r=[],c=[],d=null,P=[]}function A(){u()}function D(){}function j(K){d=K}function $(){d=null}function z(){return d}function ee(){return m}function k(){return f}function w(K){m.push(K)}function N(K){f.push(K)}function H(K){fe(m,K)}function W(K){fe(f,K)}function Z(){return r}function X(K){r.push(K)}function te(K){fe(r,K)}function fe(K,U){var x=-1;K.some(function(y,S){if(y===U)return x=S,!0}),!(x<0)&&K.splice(x,1)}function J(K){var U;for(U=0;U<c.length;U++)if(c[U].rulename===K)return U;return-1}function ue(K,U,x){if(typeof K!="string"||K!==E.default.ABANDON_FRAGMENT_RULES&&K!==E.default.QUALITY_SWITCH_RULES||typeof U!="string")throw h.default.BAD_ARGUMENT_ERROR;var y=J(U);y===-1?c.push({type:K,rulename:U,rule:x}):(c[y].type=K,c[y].rule=x)}function pe(K){if(K){var U=J(K);U!==-1&&c.splice(U,1)}else c=[]}function Ce(){c=[]}function ve(){return c}function Ee(K,U){Q(K,U);var x=new p.default;x.schemeIdUri=K,x.value=U,P.push(x)}function ge(){return P}function Q(K,U){(0,i.checkParameterType)(K,"string"),(0,i.checkParameterType)(U,"string"),P.forEach(function(x,y){x.schemeIdUri===K&&x.value===U&&P.splice(y,1)})}function le(){P=[]}function Y(){var K=n.get().streaming.utcSynchronization.defaultTimingSource;Ee(K.scheme,K.value)}function I(K,U){K?R[K]=!!U:Object.keys(R).forEach(function(x){I(x,U)})}function L(K){var U=R[K];return U===void 0?R.default:U}return T={getCustomInitialTrackSelectionFunction:z,setCustomInitialTrackSelectionFunction:j,resetCustomInitialTrackSelectionFunction:$,getLicenseResponseFilters:k,getLicenseRequestFilters:ee,getCustomCapabilitiesFilters:Z,registerCustomCapabilitiesFilter:X,registerLicenseResponseFilter:N,registerLicenseRequestFilter:w,unregisterCustomCapabilitiesFilter:te,unregisterLicenseResponseFilter:W,unregisterLicenseRequestFilter:H,addAbrCustomRule:ue,removeAllAbrCustomRule:Ce,removeAbrCustomRule:pe,getAbrCustomRules:ve,addUTCTimingSource:Ee,removeUTCTimingSource:Q,getUTCTimingSources:ge,clearDefaultUTCTimingSources:le,restoreDefaultUTCTimingSources:Y,setXHRWithCredentialsForType:I,getXHRWithCredentialsForType:L,setConfig:D,reset:A},_(),T}g.__dashjs_factory_name="CustomParametersModel";let C=l.default.getSingletonFactory(g)},"./src/streaming/models/FragmentModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>C});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/vo/FragmentRequest.js"),o="loading",i="executed",E="canceled",h="failed";function t(T){T=T||{};var P=T.eventBus,R=T.events,m=T.dashMetrics,f=T.fragmentLoader,r=T.debug,d=T.streamInfo,c=T.type,M,n,_,u;function A(){n=r.getLogger(M),ge(),P.on(R.LOADING_COMPLETED,Ce,M),P.on(R.LOADING_DATA_PROGRESS,ve,M),P.on(R.LOADING_ABANDONED,Ee,M)}function D(){return d.id}function j(){return c}function $(Y){var I=function(y,S){return y.action===l.default.ACTION_COMPLETE&&y.action===S.action},L=function(y,S){return!isNaN(y.index)&&y.startTime===S.startTime&&y.adaptationIndex===S.adaptationIndex&&y.type===S.type},K=function(y,S){return isNaN(y.index)&&isNaN(S.index)&&y.quality===S.quality},U=function(y){var S=!1;return y.some(function(b){if(L(Y,b)||K(Y,b)||I(Y,b))return S=!0,S}),S};return Y?U(_):!1}function z(Y){var I=!1,L=0,K;if(I=$(Y),!I)for(L=0;L<u.length;L++)K=u[L],Y.url===K.url&&Y.startTime===K.startTime&&(I=!0);return I}function ee(Y){var I=Y?Y.state instanceof Array?Y.state:[Y.state]:[],L=[];return I.forEach(function(K){var U=ue(K);L=L.concat(J(U,Y))}),L}function k(Y){return isNaN(Y.duration)?.25:Math.min(Y.duration/8,.5)}function w(Y){_=_.filter(function(I){var L=k(I);return isNaN(I.startTime)||(Y!==void 0?I.startTime>=Y-L:!1)})}function N(Y){_=_.filter(function(I){return isNaN(I.startTime)||(Y!==void 0?I.startTime<Y:!1)})}function H(Y,I){I<=Y+.5||(_=_.filter(function(L){var K=k(L);return isNaN(L.startTime)||L.startTime>=I-K||isNaN(L.duration)||L.startTime+L.duration<=Y+K}))}function W(Y,I){if(!Y||Y.length===0){w();return}for(var L=0,K=0,U=Y.length;K<U;K++)H(L,Y.start(K)),L=Y.end(K);I>0&&H(L,I)}function Z(){n.debug("abort requests"),f.abort(),u=[]}function X(Y){switch(Y.action){case l.default.ACTION_DOWNLOAD:pe(Y,o),u.push(Y),te(Y);break;default:n.warn("Unknown request action.")}}function te(Y){P.trigger(R.FRAGMENT_LOADING_STARTED,{request:Y},{streamId:d.id,mediaType:c}),f.load(Y)}function fe(Y,I,L){for(var K=Y.length-1,U=K;U>=0;U--){var x=Y[U],y=x.startTime,S=y+x.duration;if(L=isNaN(L)?k(x):L,!isNaN(y)&&!isNaN(S)&&I+L>=y&&I-L<S||isNaN(y)&&isNaN(I))return x}return null}function J(Y,I){return I.hasOwnProperty("time")?[fe(Y,I.time,I.threshold)]:Y.filter(function(L){for(var K in I)if(K!=="state"&&I.hasOwnProperty(K)&&L[K]!=I[K])return!1;return!0})}function ue(Y){var I;switch(Y){case o:I=u;break;case i:I=_;break;default:I=[]}return I}function pe(Y,I){m.addSchedulingInfo(Y,I),m.addRequestsQueue(Y.mediaType,u,_)}function Ce(Y){Y.sender===f&&(u.splice(u.indexOf(Y.request),1),Y.response&&!Y.error&&_.push(Y.request),pe(Y.request,Y.error?h:i),P.trigger(R.FRAGMENT_LOADING_COMPLETED,{request:Y.request,response:Y.response,error:Y.error,sender:this},{streamId:d.id,mediaType:c}))}function ve(Y){Y.sender===f&&P.trigger(R.FRAGMENT_LOADING_PROGRESS,{request:Y.request,response:Y.response,error:Y.error,sender:this},{streamId:d.id,mediaType:c})}function Ee(Y){Y.sender===f&&P.trigger(R.FRAGMENT_LOADING_ABANDONED,{request:Y.request},{streamId:d.id,mediaType:c})}function ge(){_=[],u=[]}function Q(){P.off(R.LOADING_COMPLETED,Ce,this),P.off(R.LOADING_DATA_PROGRESS,ve,this),P.off(R.LOADING_ABANDONED,Ee,this),f&&f.reset(),ge()}function le(Y){_.push(Y)}return M={getStreamId:D,getType:j,getRequests:ee,isFragmentLoaded:$,isFragmentLoadedOrPending:z,removeExecutedRequestsBeforeTime:w,removeExecutedRequestsAfterTime:N,syncExecutedRequestsWithBufferedRange:W,abortRequests:Z,executeRequest:X,reset:Q,resetInitialSettings:ge,addExecutedRequest:le},A(),M}t.__dashjs_factory_name="FragmentModel";var g=p.default.getClassFactory(t);g.FRAGMENT_MODEL_LOADING=o,g.FRAGMENT_MODEL_EXECUTED=i,g.FRAGMENT_MODEL_CANCELED=E,g.FRAGMENT_MODEL_FAILED=h,p.default.updateClassFactory(t.__dashjs_factory_name,g);let C=g},"./src/streaming/models/LowLatencyThroughputModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/core/Debug.js"),l=e("./src/core/FactoryMaker.js");function o(){var E=10,h=.8,t=.6,g=1.05,C=250,T=this.context,P,R,m={};function f(){R=(0,p.default)(T).getInstance().getLogger(P)}function r(_){for(var u={},A=0,D=0,j=0,$=0,z=_.length,ee=0;ee<z;++ee)A+=_[ee].chunkDownloadTimeRelativeMS,D+=_[ee].bufferLevel,j+=_[ee].chunkDownloadTimeRelativeMS*_[ee].bufferLevel,$+=_[ee].chunkDownloadTimeRelativeMS*_[ee].chunkDownloadTimeRelativeMS;return u.m=(j-A*D/z)/($-A*A/z),u.b=D/z-u.m*A/z,function(k){return u.m*k+u.b}}function d(_){var u=!0,A,D=_.reduce(function(j,$){return j+$.bufferLevelAtSegmentEnd},0)/_.length;return _.forEach(function(j){Math.abs(j.bufferLevelAtSegmentEnd/j.bufferLevelAtSegmentStart)<.95&&(u=!1),j.bufferLevelAtSegmentEnd/D<.8&&(u=!1),A?A>j.bitrate&&(u=!1):A=j.bitrate}),u}function c(_){var u=m[_.mediaType].slice(-1).pop(),A=m[_.mediaType].slice(-3),D=u.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;u.bufferLevelAtSegmentStart=u.getEstimatedBufferLevel(D/2),u.bufferLevelAtSegmentEnd=u.getEstimatedBufferLevel(D);var j=d(A),$=j?t:h;if(u.isBufferStable&&u.segDurationMS*g<u.fetchDownloadDurationMS)return u.fetchDownloadDurationMS;if(!j||u.segDurationMS<u.fetchDownloadDurationMS||u.adjustedAvailabilityStartTimeMS<=u.requestTimeMS+u.throughputCapacityDelayMS-u.segDurationMS)return u.fetchDownloadDurationMS*h;for(var z=u.requestTimeMS+u.throughputCapacityDelayMS-u.adjustedAvailabilityStartTimeMS,ee=0,k=0,w=0,N=0;N<u.chunkMeasurements.length;N++){var H=u.chunkMeasurements[N];if(z<k+H.chunkDownloadDurationMS)break;k+=H.chunkDownloadDurationMS,ee+=H.chunkBytes,w++}if(z<0&&R.warn("request time was before adjusted availibitly start time"),ee&&k&&w>u.chunkMeasurements.length*.2){var W=ee/k,Z=u.segmentBytes/W;return u.fetchDownloadDurationMS<Z?u.fetchDownloadDurationMS*$:Z*$}var X=u.bitrate;return u.bitrateList.some(function(te){if(te.bandwidth>u.bitrate)return X=te.bandwidth,!0}),X===u.bitrate?u.fetchDownloadDurationMS*$:$*u.segmentBytes*8*1e3/X}function M(_,u){var A=m[_.mediaType]&&m[_.mediaType].slice(-3);return!A||A.length<3||!d(A)?0:u/4>C?C:u/4}function n(_,u,A,D,j){_&&_.mediaType&&!m[_.mediaType]&&(m[_.mediaType]=[]);var $=_.mediaInfo.bitrateList.find(function(z){return z.id===_.representationId});m[_.mediaType].push({index:_.index,repId:_.representationId,mediaType:_.mediaType,requestTimeMS:D,adjustedAvailabilityStartTimeMS:_.availabilityStartTime.getTime(),segDurationMS:_.duration*1e3,chunksDurationMS:A.reduce(function(z,ee){return z+ee.chunkDownloadDurationMS},0),segmentBytes:A.reduce(function(z,ee){return z+ee.chunkBytes},0),bitrate:$&&$.bandwidth,bitrateList:_.mediaInfo.bitrateList,chunkMeasurements:A,fetchDownloadDurationMS:u,throughputCapacityDelayMS:j,getEstimatedBufferLevel:r(A.slice(1))}),m[_.mediaType].length>E&&m[_.mediaType].shift()}return P={setup:f,addMeasurement:n,getThroughputCapacityDelayMS:M,getEstimatedDownloadDurationMS:c},f(),P}o.__dashjs_factory_name="LowLatencyThroughputModel";let i=l.default.getSingletonFactory(o)},"./src/streaming/models/ManifestModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/EventBus.js"),l=e("./src/core/events/Events.js"),o=e("./src/core/FactoryMaker.js");function i(){var h=this.context,t=(0,p.default)(h).getInstance(),g,C;function T(){return C}function P(R){C=R,R&&t.trigger(l.default.MANIFEST_LOADED,{data:R})}return g={getValue:T,setValue:P},g}i.__dashjs_factory_name="ManifestModel";let E=o.default.getSingletonFactory(i)},"./src/streaming/models/MediaPlayerModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>f});var p=e("./src/core/Debug.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/core/Settings.js"),i=12,E=20,h=10,t=5,g=12,C=-.5,T=.5,P=-.5,R=1;function m(){var r,d,c,M,n=this.context,_=(0,o.default)(n).getInstance();function u(){d=(0,p.default)(n).getInstance().getLogger(r)}function A(X){X.playbackController&&(c=X.playbackController),X.serviceDescriptionController&&(M=X.serviceDescriptionController)}function D(X,te){return isNaN(X)?0:X>0?(te&&d.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):X<P?(te&&d.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(P,": ").concat(P*100,"% playback speed.")),P):X}function j(X,te){return isNaN(X)?0:X<0?(te&&d.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):X>R?(te&&d.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(R,": ").concat((1+R)*100,"% playback speed.")),R):X}function $(){if(!isNaN(_.get().streaming.liveCatchup.maxDrift)&&_.get().streaming.liveCatchup.maxDrift>0)return _.get().streaming.liveCatchup.maxDrift;var X=M.getServiceDescriptionSettings();return X&&X.liveCatchup&&!isNaN(X.liveCatchup.maxDrift)&&X.liveCatchup.maxDrift>0?X.liveCatchup.maxDrift:g}function z(X){var te=_.get().streaming.liveCatchup.playbackRate;if(!isNaN(te.min)||!isNaN(te.max))return{min:D(te.min,X),max:j(te.max,X)};var fe=M.getServiceDescriptionSettings();if(fe&&fe.liveCatchup&&(!isNaN(fe.liveCatchup.playbackRate.min)||!isNaN(fe.liveCatchup.playbackRate.max))){var J=fe.liveCatchup.playbackRate;return{min:D(J.min,X),max:j(J.max,X)}}return{min:C,max:T}}function ee(){return _.get().streaming.liveCatchup.enabled!==null?_.get().streaming.liveCatchup.enabled:c.getInitialCatchupModeActivated()}function k(X,te){try{var fe=_.get().streaming.abr[X][te];if(!isNaN(fe)&&fe!==-1)return fe;var J=M.getServiceDescriptionSettings();return J&&J[X]&&!isNaN(J[X][te])?J[X][te]:-1}catch{return-1}}function w(){var X=_.get().streaming.buffer.initialBufferLevel;return isNaN(X)||X<0?0:Math.min(N(),X)}function N(){var X=_.get().streaming.buffer.stableBufferTime>0?_.get().streaming.buffer.stableBufferTime:_.get().streaming.buffer.fastSwitchEnabled?E:i,te=c.getLiveDelay();return!isNaN(te)&&te>0?Math.min(X,te):X}function H(X){var te=isNaN(_.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?t:_.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return c.getLowLatencyModeEnabled()?_.get().streaming.retryAttempts[X]*te:_.get().streaming.retryAttempts[X]}function W(X){var te=isNaN(_.get().streaming.retryIntervals.lowLatencyReductionFactor)?h:_.get().streaming.retryIntervals.lowLatencyReductionFactor;return c.getLowLatencyModeEnabled()?_.get().streaming.retryIntervals[X]/te:_.get().streaming.retryIntervals[X]}function Z(){}return r={getCatchupMaxDrift:$,getCatchupModeEnabled:ee,getStableBufferTime:N,getInitialBufferLevel:w,getRetryAttemptsForType:H,getRetryIntervalsForType:W,getCatchupPlaybackRates:z,getAbrBitrateParameter:k,setConfig:A,reset:Z},u(),r}m.__dashjs_factory_name="MediaPlayerModel";let f=l.default.getSingletonFactory(m)},"./src/streaming/models/MetricsModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>c});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/constants/MetricsConstants.js"),o=e("./src/streaming/vo/MetricsList.js"),i=e("./src/streaming/vo/metrics/HTTPRequest.js"),E=e("./src/streaming/vo/metrics/RepresentationSwitch.js"),h=e("./src/streaming/vo/metrics/BufferLevel.js"),t=e("./src/streaming/vo/metrics/BufferState.js"),g=e("./src/streaming/vo/metrics/DVRInfo.js"),C=e("./src/streaming/vo/metrics/DroppedFrames.js"),T=e("./src/streaming/vo/metrics/ManifestUpdate.js"),P=e("./src/streaming/vo/metrics/SchedulingInfo.js"),R=e("./src/core/EventBus.js"),m=e("./src/streaming/vo/metrics/RequestsQueue.js"),f=e("./src/core/events/Events.js"),r=e("./src/core/FactoryMaker.js");function d(M){M=M||{};var n=M.settings,_=this.context,u=(0,R.default)(_).getInstance(),A,D;function j(){D={}}function $(){u.trigger(f.default.METRICS_CHANGED)}function z(K){u.trigger(f.default.METRIC_CHANGED,{mediaType:K}),$()}function ee(K,U,x){u.trigger(f.default.METRIC_UPDATED,{mediaType:K,metric:U,value:x}),z(K)}function k(K,U,x){u.trigger(f.default.METRIC_ADDED,{mediaType:K,metric:U,value:x}),z(K)}function w(K){delete D[K],z(K)}function N(){D={},$()}function H(K,U){var x=null;return K&&(D.hasOwnProperty(K)?x=D[K]:U||(x=new o.default,D[K]=x)),x}function W(K,U,x){var y=H(K);y!==null&&(y[U].push(x),y[U].length>n.get().streaming.metrics.maxListDepth&&y[U].shift())}function Z(K,U,x,y){var S=new i.HTTPRequestTrace;return S.s=U,S.d=x,S.b=y,K.trace.push(S),K.interval||(K.interval=0),K.interval+=x,S}function X(K,U,x,y,S,b,F,oe,ie,q,Ae,de,Me,Ie,He,Be,ze){var Ye=new i.HTTPRequest;b&&b!==y&&(X(K,null,x,y,S,null,null,oe,ie,null,null,null,Me,null,null,Be,ze),Ye.actualurl=b),Ye.tcpid=U,Ye.type=x,Ye.url=y,Ye.range=oe,Ye.trequest=ie,Ye.tresponse=q,Ye.responsecode=de,Ye.cmsd=ze,Ye._tfinish=Ae,Ye._stream=K,Ye._mediaduration=Me,Ye._quality=S,Ye._responseHeaders=Ie,Ye._serviceLocation=F,Ye._fileLoaderType=Be,He?He.forEach(function(Te){Z(Ye,Te.s,Te.d,Te.b)}):(delete Ye.interval,delete Ye.trace),fe(K,l.default.HTTP_REQUEST,Ye)}function te(K,U,x,y,S){var b=new E.default;b.t=U,b.mt=x,b.to=y,S?b.lto=S:delete b.lto,fe(K,l.default.TRACK_SWITCH,b)}function fe(K,U,x){W(K,U,x),k(K,U,x)}function J(K,U,x){var y=new h.default;y.t=U,y.level=x,fe(K,l.default.BUFFER_LEVEL,y)}function ue(K,U,x){var y=new t.default;y.target=x,y.state=U,fe(K,l.default.BUFFER_STATE,y)}function pe(K,U,x,y){var S=new g.default;S.time=U,S.range=y,S.manifestInfo=x,fe(K,l.default.DVR_INFO,S)}function Ce(K,U){var x=new C.default,y=H(K).DroppedFrames;U&&(x.time=U.creationTime,x.droppedFrames=U.droppedVideoFrames,!(y.length>0&&y[y.length-1]==x)&&fe(K,l.default.DROPPED_FRAMES,x))}function ve(K,U,x,y,S,b,F,oe,ie){var q=new P.default;q.mediaType=K,q.t=U,q.type=x,q.startTime=y,q.availabilityStartTime=S,q.duration=b,q.quality=F,q.range=oe,q.state=ie,fe(K,l.default.SCHEDULING_INFO,q)}function Ee(K,U,x){var y=new m.default;y.loadingRequests=U,y.executedRequests=x,H(K).RequestsQueue=y,k(K,l.default.REQUESTS_QUEUE,y)}function ge(K,U,x,y,S,b,F,oe,ie,q){var Ae=new T.ManifestUpdate;Ae.mediaType=K,Ae.type=U,Ae.requestTime=x,Ae.fetchTime=y,Ae.availabilityStartTime=S,Ae.presentationStartTime=b,Ae.clientTimeOffset=F,Ae.currentTime=oe,Ae.buffered=ie,Ae.latency=q,W(p.default.STREAM,l.default.MANIFEST_UPDATE,Ae),k(K,l.default.MANIFEST_UPDATE,Ae)}function Q(K,U){if(K){for(var x in U)K[x]=U[x];ee(K.mediaType,l.default.MANIFEST_UPDATE,K)}}function le(K,U,x,y,S){if(K){var b=new T.ManifestUpdateStreamInfo;b.id=U,b.index=x,b.start=y,b.duration=S,K.streamInfo.push(b),ee(K.mediaType,l.default.MANIFEST_UPDATE_STREAM_INFO,K)}}function Y(K,U,x,y,S,b,F,oe){if(K&&K.representationInfo){var ie=new T.ManifestUpdateRepresentationInfo;ie.id=U,ie.index=x,ie.streamIndex=y,ie.mediaType=S,ie.startNumber=F,ie.fragmentInfoType=oe,ie.presentationTimeOffset=b,K.representationInfo.push(ie),ee(K.mediaType,l.default.MANIFEST_UPDATE_TRACK_INFO,K)}}function I(K){K.trace&&Array.isArray(K.trace)?K.trace.forEach(function(U){U.hasOwnProperty("subreplevel")&&!U.subreplevel&&delete U.subreplevel}):delete K.trace,fe(p.default.STREAM,l.default.PLAY_LIST,K)}function L(K){fe(p.default.STREAM,l.default.DVB_ERRORS,K)}return A={clearCurrentMetricsForType:w,clearAllCurrentMetrics:N,getMetricsFor:H,addHttpRequest:X,addRepresentationSwitch:te,addBufferLevel:J,addBufferState:ue,addDVRInfo:pe,addDroppedFrames:Ce,addSchedulingInfo:ve,addRequestsQueue:Ee,addManifestUpdate:ge,updateManifestUpdateInfo:Q,addManifestUpdateStreamInfo:le,addManifestUpdateRepresentationInfo:Y,addPlayList:I,addDVBErrors:L},j(),A}d.__dashjs_factory_name="MetricsModel";let c=r.default.getSingletonFactory(d)},"./src/streaming/models/URIFragmentModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/streaming/vo/URIFragmentData.js"),l=e("./src/core/FactoryMaker.js");function o(){var E,h;function t(C){if(h=new p.default,!C)return null;var T=C.indexOf("#");if(T!==-1)for(var P=C.substr(T+1).split("&"),R=0,m=P.length;R<m;++R){var f=P[R],r=f.indexOf("=");if(r!==-1){var d=f.substring(0,r);h.hasOwnProperty(d)&&(h[d]=f.substr(r+1))}}}function g(){return h}return E={initialize:t,getURIFragmentData:g},E}o.__dashjs_factory_name="URIFragmentModel";let i=l.default.getSingletonFactory(o)},"./src/streaming/models/VideoModel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>g});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/EventBus.js"),o=e("./src/core/events/Events.js"),i=e("./src/core/Debug.js"),E=e("./src/streaming/constants/Constants.js"),h=new Map([[E.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[E.default.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[E.default.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[E.default.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function t(){var C,T,P,R,m,f,r,d="element is not video or audio DOM type!",c=this.context,M=(0,l.default)(c).getInstance(),n=[];function _(){T=(0,i.default)(c).getInstance().getLogger(C),R=NaN}function u(){M.on(o.default.PLAYBACK_PLAYING,Ce,this)}function A(){M.off(o.default.PLAYBACK_PLAYING,Ce,this)}function D(){P&&(P.playbackRate=r||1,P.removeEventListener("canplay",D))}function j(Te){var Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;P&&(!Fe&&P.readyState<=2&&Te>0?P.addEventListener("canplay",D):P.playbackRate=Te)}function $(Te,Fe){P&&(R=Te,ze(E.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){if(P.currentTime===R){R=NaN;return}try{R=Fe?z(R):R,P.currentTime=R,R=NaN}catch(ot){P.readyState===0&&ot.code===ot.INVALID_STATE_ERR&&setTimeout(function(){P.currentTime=R,R=NaN},400)}}))}function z(Te){var Fe=S(),ot=Te,st=9999999999;if(Fe)for(var at=0;at<Fe.length;at++){var ht=Fe.start(at),Tt=Fe.end(at),xe=Math.abs(ht-Te),we=Math.abs(Tt-Te);if(Te>=ht&&Te<=Tt)return Te;xe<st&&(st=xe,ot=ht),we<st&&(st=we,ot=Tt)}return ot}function ee(){return P}function k(Te){if(Te==null||Te&&/^(VIDEO|AUDIO)$/i.test(Te.nodeName))P=Te,P&&(P.preload="auto");else throw d}function w(Te){P&&(Te?P.src=Te:(P.removeAttribute("src"),P.load()))}function N(){return P?P.src:null}function H(){return m}function W(){return f}function Z(Te){m=Te,m.style.position="absolute",m.style.display="flex",m.style.overflow="hidden",m.style.pointerEvents="none",m.style.top=0,m.style.left=0}function X(Te){f=Te}function te(Te,Fe){pe(Te,Fe)}function fe(){return n.length>0}function J(Te){Te===null||!P||P.seeking||n.indexOf(Te)!==-1||n.push(Te)}function ue(Te){var Fe=n.indexOf(Te);Te!==null&&Fe!==-1&&n.splice(Fe,1)}function pe(Te,Fe){Fe?J(Te):ue(Te)}function Ce(){if(P&&fe()&&P.playbackRate===0){var Te=document.createEvent("Event");Te.initEvent("waiting",!0,!1),P.dispatchEvent(Te)}}function ve(){if(!P)return null;var Te="webkitDroppedFrameCount"in P&&"webkitDecodedFrameCount"in P,Fe="getVideoPlaybackQuality"in P,ot=null;return Fe?ot=P.getVideoPlaybackQuality():Te&&(ot={droppedVideoFrames:P.webkitDroppedFrameCount,totalVideoFrames:P.webkitDroppedFrameCount+P.webkitDecodedFrameCount,creationTime:new Date}),ot}function Ee(){if(P){P.autoplay=!0;var Te=P.play();Te&&Te.catch&&typeof Promise<"u"&&Te.catch(function(Fe){Fe.name==="NotAllowedError"&&M.trigger(o.default.PLAYBACK_NOT_ALLOWED),T.warn("Caught pending play exception - continuing (".concat(Fe,")"))})}}function ge(){return P?P.paused:null}function Q(){P&&(P.pause(),P.autoplay=!1)}function le(){return P?P.seeking||!isNaN(R):null}function Y(){return P?isNaN(R)?P.currentTime:R:null}function I(){return P?P.playbackRate:null}function L(){return P?P.played:null}function K(){return P?P.ended:null}function U(Te,Fe){P&&P.addEventListener(Te,Fe)}function x(Te,Fe){P&&P.removeEventListener(Te,Fe)}function y(){return P?P.readyState:NaN}function S(){return P?P.buffered:null}function b(){return P?P.clientWidth:NaN}function F(){return P?P.clientHeight:NaN}function oe(){return P?P.videoWidth:NaN}function ie(){return P?P.videoHeight:NaN}function q(){if(P){var Te=P.parentNode.host||P.parentNode;return Te?P.getBoundingClientRect().top-Te.getBoundingClientRect().top:NaN}return NaN}function Ae(){if(P){var Te=P.parentNode.host||P.parentNode;return Te?P.getBoundingClientRect().left-Te.getBoundingClientRect().left:NaN}return NaN}function de(){return P?P.textTracks:[]}function Me(Te,Fe,ot,st,at){if(P){for(var ht=0;ht<P.textTracks.length;ht++)if(P.textTracks[ht].kind===Te&&(!Fe||P.textTracks[ht].label==Fe)&&P.textTracks[ht].language===ot&&P.textTracks[ht].isTTML===st&&P.textTracks[ht].isEmbedded===at)return P.textTracks[ht]}return null}function Ie(Te,Fe,ot,st,at){if(!P)return null;var ht=Me(Te,Fe,ot,st,at);return ht||(ht=P.addTextTrack(Te,Fe,ot),ht.isEmbedded=at,ht.isTTML=st),ht}function He(Te){P&&(P.appendChild(Te),Te.isTTML!==void 0&&(P.textTracks[P.textTracks.length-1].isTTML=Te.isTTML,P.textTracks[P.textTracks.length-1].isEmbedded=Te.isEmbedded))}function Be(Te){P&&P.removeChild(Te)}function ze(Te,Fe){if(Te===E.default.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||y()>=Te)Fe();else{var ot=h.get(Te);Ye(ot,Fe)}}function Ye(Te,Fe){var ot=function st(){x(Te,st),Fe(Te)};U(Te,ot)}return C={initialize:u,setCurrentTime:$,play:Ee,isPaused:ge,pause:Q,isStalled:fe,isSeeking:le,getTime:Y,getPlaybackRate:I,setPlaybackRate:j,getPlayedRanges:L,getEnded:K,setStallState:te,getElement:ee,setElement:k,setSource:w,getSource:N,getTTMLRenderingDiv:H,setTTMLRenderingDiv:Z,getVttRenderingDiv:W,setVttRenderingDiv:X,getPlaybackQuality:ve,addEventListener:U,removeEventListener:x,getReadyState:y,getBufferRange:S,getClientWidth:b,getClientHeight:F,getTextTracks:de,getTextTrack:Me,addTextTrack:Ie,appendChild:He,removeChild:Be,getVideoWidth:oe,getVideoHeight:ie,getVideoRelativeOffsetTop:q,getVideoRelativeOffsetLeft:Ae,waitForReadyState:ze,reset:A},_(),C}t.__dashjs_factory_name="VideoModel";let g=p.default.getSingletonFactory(t)},"./src/streaming/net/FetchLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>f});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Settings.js"),o=e("./src/streaming/constants/Constants.js"),i=e("./src/streaming/utils/RequestModifier.js");function E(r,d){return g(r)||t(r,d)||T(r,d)||h()}function h(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t(r,d){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(r)))){var c=[],M=!0,n=!1,_=void 0;try{for(var u=r[Symbol.iterator](),A;!(M=(A=u.next()).done)&&(c.push(A.value),!(d&&c.length===d));M=!0);}catch(D){n=!0,_=D}finally{try{!M&&u.return!=null&&u.return()}finally{if(n)throw _}}return c}}function g(r){if(Array.isArray(r))return r}function C(r,d){var c;if(typeof Symbol>"u"||r[Symbol.iterator]==null){if(Array.isArray(r)||(c=T(r))||d&&r&&typeof r.length=="number"){c&&(r=c);var M=0,n=function(){};return{s:n,n:function(){return M>=r.length?{done:!0}:{done:!1,value:r[M++]}},e:function(j){throw j},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _=!0,u=!1,A;return{s:function(){c=r[Symbol.iterator]()},n:function(){var j=c.next();return _=j.done,j},e:function(j){u=!0,A=j},f:function(){try{!_&&c.return!=null&&c.return()}finally{if(u)throw A}}}}function T(r,d){if(r){if(typeof r=="string")return P(r,d);var c=Object.prototype.toString.call(r).slice(8,-1);if(c==="Object"&&r.constructor&&(c=r.constructor.name),c==="Map"||c==="Set")return Array.from(r);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return P(r,d)}}function P(r,d){(d==null||d>r.length)&&(d=r.length);for(var c=0,M=new Array(d);c<d;c++)M[c]=r[c];return M}function R(r){r=r||{};var d=this.context,c=r.requestModifier,M=r.lowLatencyThroughputModel,n=r.boxParser,_=(0,l.default)(d).getInstance(),u,A;function D(H){A=H.dashMetrics}function j(H){c&&c.modifyRequest?(0,i.modifyRequest)(H,c).then(function(){return $(H)}):$(H)}function $(H){var W=new Date,Z=H.request,X=new Headers;if(Z.range&&X.append("Range","bytes="+Z.range),H.headers)for(var te in H.headers){var fe=H.headers[te];fe&&X.append(te,fe)}Z.requestStartDate||(Z.requestStartDate=W),c&&c.modifyRequestHeader&&c.modifyRequestHeader({setRequestHeader:function(ge,Q){X.append(ge,Q)}},{url:H.url});var J;typeof window.AbortController=="function"&&(J=new AbortController,H.abortController=J,J.signal.onabort=H.onabort);var ue={method:H.method,headers:X,credentials:H.withCredentials?"include":void 0,signal:J?J.signal:void 0},pe=_.get().streaming.abr.fetchThroughputCalculationMode,Ce=Date.now(),ve=0;new Promise(function(Ee){if(pe===o.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&M&&(ve=M.getThroughputCapacityDelayMS(Z,A.getCurrentBufferLevel(Z.mediaType)*1e3),ve))return setTimeout(Ee,ve);Ee()}).then(function(){var Ee=Date.now();fetch(H.url,ue).then(function(ge){H.response||(H.response={}),H.response.status=ge.status,H.response.statusText=ge.statusText,H.response.responseURL=ge.url,ge.ok||H.onerror();var Q="",le=C(ge.headers.keys()),Y;try{for(le.s();!(Y=le.n()).done;){var I=Y.value;Q+=I+": "+ge.headers.get(I)+`\r
`}}catch(ze){le.e(ze)}finally{le.f()}if(H.response.responseHeaders=Q,!ge.body)return ge.arrayBuffer().then(function(ze){H.response.response=ze;var Ye={loaded:ze.byteLength,total:ze.byteLength,stream:!1};H.progress(Ye),H.onload(),H.onend()});var L=parseInt(ge.headers.get("Content-Length"),10),K=0,U=!1,x=new Uint8Array,y=0;if(pe===o.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&M){var S=function(Ye){var Te=Ye.getReader(),Fe=[];Te.read().then(function ot(st){var at=st.value,ht=st.done;if(F=Date.now(),at&&at.length){var Tt=F-b,xe=at.length;Fe.push({chunkDownloadTimeRelativeMS:F-Ee,chunkDownloadDurationMS:Tt,chunkBytes:xe,kbps:Math.round(8*xe/(Tt/1e3)),bufferLevel:A.getCurrentBufferLevel(Z.mediaType)})}if(ht){var we=F-Ee,$e=Fe.reduce(function(et,qe){return et+qe.chunkBytes},0);M.addMeasurement(Z,we,Fe,Ce,ve,Q),H.progress({loaded:$e,total:$e,lengthComputable:!0,time:M.getEstimatedDownloadDurationMS(Z),stream:!0});return}return b=Date.now(),Te.read().then(ot)})},b=Ee,F=0,oe=ge.body.tee(),ie=E(oe,2),q=ie[0],Ae=ie[1];S(q),H.reader=Ae.getReader()}else H.reader=ge.body.getReader();var de=[],Me=[],Ie=[],He=!0,Be=function ze(Ye){var Te=Ye.value,Fe=Ye.done;if(Fe){if(x){if(pe!==o.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var ot=null,st=null;pe===o.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(ot=N(Me,Ie),ot&&(st=K*8/ot)):pe===o.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(st=w(de,K)),H.progress({loaded:K,total:isNaN(L)?K:L,lengthComputable:!0,time:st,stream:!0})}H.response.response=x.buffer}H.onload(),H.onend();return}if(Te&&Te.length>0){if(x=ee(x,Te),K+=Te.length,de.push({ts:Date.now(),bytes:Te.length}),pe===o.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&He){var at=n.findLastTopIsoBoxCompleted(["moof"],x,y);at.found&&(He=!1,Me.push({ts:performance.now(),bytes:Te.length}))}var ht=n.findLastTopIsoBoxCompleted(["moov","mdat"],x,y);if(ht.found){var Tt=ht.lastCompletedOffset+ht.size;pe===o.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&!He&&(He=!0,Ie.push({ts:performance.now(),bytes:x.length}));var xe;Tt===x.length?(xe=x,x=new Uint8Array):(xe=new Uint8Array(x.subarray(0,Tt)),x=x.subarray(Tt)),H.progress({data:xe.buffer,lengthComputable:!1,noTrace:!0}),y=0}else y=ht.lastCompletedOffset,U||(H.progress({lengthComputable:!1,noTrace:!0}),U=!0)}z(H,ze)};z(H,Be)}).catch(function(ge){H.onerror&&H.onerror(ge)})})}function z(H,W){H.reader.read().then(W).catch(function(Z){H.onerror&&H.response.status===200&&H.onerror(Z)})}function ee(H,W){if(H.length===0)return W;var Z=new Uint8Array(H.length+W.length);return Z.set(H),Z.set(W,H.length),Z}function k(H){if(H.abortController)H.abortController.abort();else if(H.reader)try{H.reader.cancel(),H.onabort()}catch{}}function w(H,W){try{if(H=H.filter(function(te){return te.bytes>W/4/H.length}),H.length>1){var Z=0,X=(H[H.length-1].ts-H[0].ts)/H.length;return H.forEach(function(te,fe){var J=H[fe+1];if(J){var ue=J.ts-te.ts;Z+=ue<X?ue:0}}),Z}return null}catch{return null}}function N(H,W){try{var Z,X;Z=H.filter(function(Ee,ge){return ge<H.length-1}),X=W.filter(function(Ee,ge){return ge<W.length-1});var te=[];if(Z.length>1){for(var fe=0,J=0,ue=0;ue<Z.length;ue++)if(Z[ue]&&X[ue]){var pe=X[ue].ts-Z[ue].ts;if(pe>1)te.push(8*X[ue].bytes/pe),J=0;else{J===0&&(J=Z[ue].ts,fe=0);var Ce=X[ue].ts-J;Ce>1?(fe+=X[ue].bytes,te.push(8*fe/Ce),J=0):fe+=X[ue].bytes}}if(te.length>0){var ve=te.reduce(function(Ee,ge){return Ee+ge},0);return ve/te.length}}return null}catch{return null}}return u={load:j,abort:k,calculateDownloadedTime:w,setup:D},u}R.__dashjs_factory_name="FetchLoader";var m=p.default.getClassFactory(R);let f=m},"./src/streaming/net/HTTPLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>n});var p=e("./src/streaming/net/XHRLoader.js"),l=e("./src/streaming/net/FetchLoader.js"),o=e("./src/streaming/vo/metrics/HTTPRequest.js"),i=e("./src/core/FactoryMaker.js"),E=e("./src/streaming/vo/DashJSError.js"),h=e("./src/streaming/models/CmcdModel.js"),t=e("./src/streaming/models/CmsdModel.js"),g=e("./src/core/Utils.js"),C=e("./src/core/Debug.js"),T=e("./src/core/EventBus.js"),P=e("./src/core/events/Events.js"),R=e("./src/core/Settings.js"),m=e("./src/streaming/constants/Constants.js"),f=e("./src/streaming/models/LowLatencyThroughputModel.js"),r=e("./src/streaming/models/CustomParametersModel.js");function d(_,u,A){return u in _?Object.defineProperty(_,u,{value:A,enumerable:!0,configurable:!0,writable:!0}):_[u]=A,_}function c(_){_=_||{};var u=this.context,A=_.errHandler,D=_.dashMetrics,j=_.mediaPlayerModel,$=_.requestModifier,z=_.boxParser,ee=_.errors,k=_.requestTimeout||0,w=(0,T.default)(u).getInstance(),N=(0,R.default)(u).getInstance(),H,W,Z,X,te,fe,J,ue,pe,Ce;function ve(){var Y;Ce=(0,C.default)(u).getInstance().getLogger(H),W=[],Z=[],X=[],fe=(0,h.default)(u).getInstance(),J=(0,t.default)(u).getInstance(),pe=(0,f.default)(u).getInstance(),ue=(0,r.default)(u).getInstance(),te=(Y={},d(Y,o.HTTPRequest.MPD_TYPE,ee.DOWNLOAD_ERROR_ID_MANIFEST_CODE),d(Y,o.HTTPRequest.XLINK_EXPANSION_TYPE,ee.DOWNLOAD_ERROR_ID_XLINK_CODE),d(Y,o.HTTPRequest.INIT_SEGMENT_TYPE,ee.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),d(Y,o.HTTPRequest.MEDIA_SEGMENT_TYPE,ee.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(Y,o.HTTPRequest.INDEX_SEGMENT_TYPE,ee.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(Y,o.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,ee.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(Y,o.HTTPRequest.OTHER_TYPE,ee.DOWNLOAD_ERROR_ID_CONTENT_CODE),Y)}function Ee(Y,I){var L=Y.request,K=[],U=!0,x=!0,y=new Date,S=y,b=0,F=null,oe=null,ie;if(!$||!D||!A)throw new Error("config object is not correct or missing");var q=function(we){L.requestStartDate=y,L.requestEndDate=new Date,L.firstByteDate=L.firstByteDate||y,L.fileLoaderType=oe;var $e=ie.response?ie.response.responseURL:null,et=ie.response?ie.response.status:null,qe=ie.response&&ie.response.getAllResponseHeaders?ie.response.getAllResponseHeaders():ie.response?ie.response.responseHeaders:null,_t=qe&&N.get().streaming.cmsd&&N.get().streaming.cmsd.enabled?J.parseResponseHeaders(qe,L.mediaType):null;D.addHttpRequest(L,$e,et,qe,we?K:null,_t)},Ae=function(we){x=!1,q(we),L.type===o.HTTPRequest.MPD_TYPE&&(D.addManifestUpdate(L),w.trigger(P.default.MANIFEST_LOADING_FINISHED,{request:L}))},de=function(){if(F&&(clearTimeout(F),F=null),W.indexOf(ie)!==-1&&(W.splice(W.indexOf(ie),1),x))if(Ae(!1),I>0){try{if(N.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&L.type===o.HTTPRequest.MEDIA_SEGMENT_TYPE){var we=j.getRetryAttemptsForType(o.HTTPRequest.MEDIA_SEGMENT_TYPE);we===I&&w.trigger(P.default.ATTEMPT_BACKGROUND_SYNC)}}catch{}I--;var $e={config:Y};X.push($e),$e.timeout=setTimeout(function(){X.indexOf($e)!==-1&&(X.splice(X.indexOf($e),1),Ee(Y,I))},j.getRetryIntervalsForType(L.type))}else{if(L.type===o.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;A.error(new E.default(te[L.type],L.url+" is not available",{request:L,response:ie.response})),Y.error&&Y.error(L,"error",ie.response.statusText,ie.response),Y.complete&&Y.complete(L,ie.response.statusText)}},Me=function(we){var $e=new Date;U&&(U=!1,(!we.lengthComputable||we.lengthComputable&&we.total!==we.loaded)&&(L.firstByteDate=$e)),we.lengthComputable&&(L.bytesLoaded=we.loaded,L.bytesTotal=we.total),we.noTrace||(K.push({s:S,d:we.time?we.time:$e.getTime()-S.getTime(),b:[we.loaded?we.loaded-b:0]}),S=$e,b=we.loaded),F&&(clearTimeout(F),F=null),N.get().streaming.fragmentRequestProgressTimeout>0&&(F=setTimeout(function(){Ce.warn("Abort request "+ie.url+" due to progress timeout"),ie.response.onabort=null,ie.loader.abort(ie),de()},N.get().streaming.fragmentRequestProgressTimeout)),Y.progress&&we&&Y.progress(we)},Ie=function(){ie.response.status>=200&&ie.response.status<=299&&(Ae(!0),Y.success&&Y.success(ie.response.response,ie.response.statusText,ie.response.responseURL),Y.complete&&Y.complete(L,ie.response.statusText))},He=function(){q(!0),F&&(clearTimeout(F),F=null),Y.abort&&Y.abort(L)},Be=function(we){var $e;if(we.lengthComputable){var et=we.loaded/we.total*100;$e="Request timeout: loaded: "+we.loaded+", out of: "+we.total+" : "+et.toFixed(3)+"% Completed"}else $e="Request timeout: non-computable download size";Ce.warn($e)},ze;L.hasOwnProperty("availabilityTimeComplete")&&L.availabilityTimeComplete===!1&&window.fetch&&L.responseType==="arraybuffer"&&L.type===o.HTTPRequest.MEDIA_SEGMENT_TYPE?(ze=(0,l.default)(u).create({requestModifier:$,lowLatencyThroughputModel:pe,boxParser:z}),ze.setup({dashMetrics:D}),oe=m.default.FILE_LOADER_TYPES.FETCH):(ze=(0,p.default)(u).create({requestModifier:$}),oe=m.default.FILE_LOADER_TYPES.XHR);var Ye=null,Te=$.modifyRequestURL?$.modifyRequestURL(L.url):L.url;if(N.get().streaming.cmcd&&N.get().streaming.cmcd.enabled){var Fe=N.get().streaming.cmcd.mode;if(Fe===m.default.CMCD_MODE_QUERY){var ot=ge(L);Te=g.default.addAditionalQueryParameterToUrl(Te,ot)}else Fe===m.default.CMCD_MODE_HEADER&&(Ye=fe.getHeaderParameters(L))}var st=ue.getXHRWithCredentialsForType(L.type);if(L.queryParams){var at=Object.keys(L.queryParams).map(function(xe){return{key:xe,value:L.queryParams[xe]}});Te=g.default.addAditionalQueryParameterToUrl(Te,at)}L.url=Te,ie={url:Te,method:o.HTTPRequest.GET,withCredentials:st,request:L,onload:Ie,onend:de,onerror:de,progress:Me,onabort:He,ontimeout:Be,loader:ze,timeout:k,headers:Ye};var ht=new Date().getTime();if(isNaN(L.delayLoadingTime)||ht>=L.delayLoadingTime)W.push(ie),ze.load(ie);else{var Tt={httpRequest:ie};Z.push(Tt),Tt.delayTimeout=setTimeout(function(){if(Z.indexOf(Tt)!==-1){Z.splice(Z.indexOf(Tt),1);try{y=new Date,S=y,W.push(Tt.httpRequest),ze.load(Tt.httpRequest)}catch{Tt.httpRequest.onerror()}}},L.delayLoadingTime-ht)}}function ge(Y){try{var I=[],L=fe.getQueryParameter(Y);return L&&I.push(L),I}catch{return[]}}function Q(Y){Y.request?Ee(Y,j.getRetryAttemptsForType(Y.request.type)):Y.error&&Y.error(Y.request,"error")}function le(){X.forEach(function(Y){clearTimeout(Y.timeout),Y.config.request&&Y.config.abort&&Y.config.abort(Y.config.request)}),X=[],Z.forEach(function(Y){return clearTimeout(Y.delayTimeout)}),Z=[],W.forEach(function(Y){Y.request.type!==o.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(Y.onloadend=Y.onerror=Y.onprogress=void 0,Y.loader.abort(Y))}),W=[]}return H={load:Q,abort:le},ve(),H}c.__dashjs_factory_name="HTTPLoader";var M=i.default.getClassFactory(c);let n=M},"./src/streaming/net/SchemeLoaderFactory.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/net/HTTPLoader.js");function o(){var h,t;function g(f,r){t[f]=r}function C(f){t[f]&&delete t[f]}function T(){t={}}function P(f){for(var r in t)if(t.hasOwnProperty(r)&&f.startsWith(r))return t[r];return l.default}function R(){T()}function m(){R()}return m(),h={getLoader:P,registerLoader:g,unregisterLoader:C,unregisterAllLoader:T,reset:R},h}o.__dashjs_factory_name="SchemeLoaderFactory";var i=p.default.getSingletonFactory(o);let E=i},"./src/streaming/net/URLLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/net/SchemeLoaderFactory.js");function o(h){h=h||{};var t=this.context,g,C,T;C=(0,l.default)(t).getInstance();function P(m){if(!T){var f=C.getLoader(m&&m.request?m.request.url:null);T=f(t).create({errHandler:h.errHandler,mediaPlayerModel:h.mediaPlayerModel,requestModifier:h.requestModifier,dashMetrics:h.dashMetrics,boxParser:h.boxParser?h.boxParser:null,constants:h.constants?h.constants:null,dashConstants:h.dashConstants?h.dashConstants:null,urlUtils:h.urlUtils?h.urlUtils:null,requestTimeout:isNaN(h.requestTimeout)?0:h.requestTimeout,errors:h.errors})}T.load(m)}function R(){T&&T.abort()}return g={load:P,abort:R},g}o.__dashjs_factory_name="URLLoader";var i=p.default.getClassFactory(o);let E=i},"./src/streaming/net/XHRLoader.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/utils/RequestModifier.js");function o(h){h=h||{};var t=h.requestModifier,g;function C(R){t&&t.modifyRequest?(0,l.modifyRequest)(R,t).then(function(){return T(R)}):T(R)}function T(R){var m=new Date,f=R.request,r=new XMLHttpRequest;if(r.open(R.method,R.url,!0),f.responseType&&(r.responseType=f.responseType),f.range&&r.setRequestHeader("Range","bytes="+f.range),f.requestStartDate||(f.requestStartDate=m),t&&t.modifyRequestHeader&&(r=t.modifyRequestHeader(r,{url:R.url})),R.headers)for(var d in R.headers){var c=R.headers[d];c&&r.setRequestHeader(d,c)}r.withCredentials=R.withCredentials,r.onload=R.onload,r.onloadend=R.onend,r.onerror=R.onerror,r.onprogress=R.progress,r.onabort=R.onabort,r.ontimeout=R.ontimeout,r.timeout=R.timeout,r.send(),R.response=r}function P(R){var m=R.response;m.onloadend=m.onerror=m.onprogress=void 0,m.abort()}return g={load:C,abort:P},g}o.__dashjs_factory_name="XHRLoader";var i=p.default.getClassFactory(o);let E=i},"./src/streaming/protection/CommonEncryption.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});function p(t,g){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}function l(t,g){for(var C=0;C<g.length;C++){var T=g[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(t,T.key,T)}}function o(t,g,C){return g&&l(t.prototype,g),C&&l(t,C),t}var i={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]},E=function(){function t(){p(this,t)}return o(t,null,[{key:"findCencContentProtection",value:function(C){for(var T=null,P=0;P<C.length;++P){var R=C[P];R.schemeIdUri.toLowerCase()==="urn:mpeg:dash:mp4protection:2011"&&(R.value.toLowerCase()==="cenc"||R.value.toLowerCase()==="cbcs")&&(T=R)}return T}},{key:"getPSSHData",value:function(C){var T=8,P=new DataView(C),R=P.getUint8(T);return T+=20,R>0&&(T+=4+16*P.getUint32(T)),T+=4,C.slice(T)}},{key:"getPSSHForKeySystem",value:function(C,T){var P=t.parsePSSHList(T);return C&&P.hasOwnProperty(C.uuid.toLowerCase())?P[C.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(C,T){return"pssh"in C?(C.pssh.__text=C.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),T.decodeArray(C.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(C){if(C==null)return[];for(var T=new DataView(C.buffer||C),P=!1,R={},m=0;!P;){var f=void 0,r=void 0,d=void 0,c=void 0,M=m;if(m>=T.buffer.byteLength)break;if(f=T.getUint32(m),r=m+f,m+=4,T.getUint32(m)!==1886614376){m=r;continue}if(m+=4,d=T.getUint8(m),d!==0&&d!==1){m=r;continue}m++,m+=3,c="";var n=void 0,_=void 0;for(n=0;n<4;n++)_=T.getUint8(m+n).toString(16),c+=_.length===1?"0"+_:_;for(m+=4,c+="-",n=0;n<2;n++)_=T.getUint8(m+n).toString(16),c+=_.length===1?"0"+_:_;for(m+=2,c+="-",n=0;n<2;n++)_=T.getUint8(m+n).toString(16),c+=_.length===1?"0"+_:_;for(m+=2,c+="-",n=0;n<2;n++)_=T.getUint8(m+n).toString(16),c+=_.length===1?"0"+_:_;for(m+=2,c+="-",n=0;n<6;n++)_=T.getUint8(m+n).toString(16),c+=_.length===1?"0"+_:_;m+=6,c=c.toLowerCase(),m+=4,R[c]=T.buffer.slice(M,r),m=r}return R}},{key:"getLicenseServerUrlFromMediaInfo",value:function(C,T){try{if(!C||C.length===0)return null;for(var P=0,R=null;P<C.length&&!R;){var m=C[P];if(m&&m.contentProtection&&m.contentProtection.length>0){var f=m.contentProtection.filter(function(u){return u.schemeIdUri&&u.schemeIdUri===T});if(f&&f.length>0)for(var r=0;r<f.length&&!R;){for(var d=f[r],c=0;c<i.attributes.length&&!R;){for(var M=0,n=i.attributes[c];M<i.prefixes.length&&!R;){var _=i.prefixes[M];d[n]&&d[n].__prefix&&d[n].__prefix===_&&d[n].__text&&(R=d[n].__text),M+=1}c+=1}r+=1}}P+=1}return R}catch{return null}}}]),t}();let h=E},"./src/streaming/protection/Protection.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/streaming/protection/controllers/ProtectionController.js"),l=e("./src/streaming/protection/controllers/ProtectionKeyController.js"),o=e("./src/streaming/protection/ProtectionEvents.js"),i=e("./src/streaming/protection/errors/ProtectionErrors.js"),E=e("./src/streaming/protection/models/ProtectionModel_21Jan2015.js"),h=e("./src/streaming/protection/models/ProtectionModel_3Feb2014.js"),t=e("./src/streaming/protection/models/ProtectionModel_01b.js"),g=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],C=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function T(){var m,f=this.context;function r(M){var n=null,_=(0,l.default)(f).getInstance();_.setConfig({debug:M.debug,BASE64:M.BASE64,settings:M.settings}),_.initialize();var u=d(M);return!n&&u&&(n=(0,p.default)(f).create({protectionModel:u,protectionKeyController:_,eventBus:M.eventBus,debug:M.debug,events:M.events,BASE64:M.BASE64,constants:M.constants,cmcdModel:M.cmcdModel,customParametersModel:M.customParametersModel,settings:M.settings}),M.capabilities.setEncryptedMediaSupported(!0)),n}function d(M){var n=M.debug,_=n.getLogger(m),u=M.eventBus,A=M.errHandler,D=M.videoModel?M.videoModel.getElement():null;return(!D||D.onencrypted!==void 0)&&(!D||D.mediaKeys!==void 0)?(_.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,E.default)(f).create({debug:n,eventBus:u,events:M.events})):c(D,C)?(_.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,h.default)(f).create({debug:n,eventBus:u,events:M.events,api:c(D,C)})):c(D,g)?(_.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,t.default)(f).create({debug:n,eventBus:u,errHandler:A,events:M.events,api:c(D,g)})):(_.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function c(M,n){for(var _=0;_<n.length;_++){var u=n[_];if(typeof M[u[Object.keys(u)[0]]]=="function")return u}return null}return m={createProtectionSystem:r},m}T.__dashjs_factory_name="Protection";var P=dashjs.FactoryMaker.getClassFactory(T);P.events=o.default,P.errors=i.default,dashjs.FactoryMaker.updateClassFactory(T.__dashjs_factory_name,P);let R=P},"./src/streaming/protection/ProtectionEvents.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/core/events/EventsBase.js");function l(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(d){return typeof d}:l=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},l(f)}function o(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function i(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&E(f,r)}function E(f,r){return E=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},E(f,r)}function h(f){var r=C();return function(){var c=T(f),M;if(r){var n=T(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return t(this,M)}}function t(f,r){return r&&(l(r)==="object"||typeof r=="function")?r:g(f)}function g(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(f){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},T(f)}var P=function(f){i(d,f);var r=h(d);function d(){var c;return o(this,d),c=r.call(this),c.INTERNAL_KEY_MESSAGE="internalKeyMessage",c.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",c.KEY_ADDED="public_keyAdded",c.KEY_ERROR="public_keyError",c.KEY_MESSAGE="public_keyMessage",c.KEY_SESSION_CLOSED="public_keySessionClosed",c.KEY_SESSION_CREATED="public_keySessionCreated",c.KEY_SESSION_REMOVED="public_keySessionRemoved",c.KEY_STATUSES_CHANGED="public_keyStatusesChanged",c.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",c.KEY_SYSTEM_SELECTED="public_keySystemSelected",c.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",c.LICENSE_REQUEST_SENDING="public_licenseRequestSending",c.NEED_KEY="needkey",c.PROTECTION_CREATED="public_protectioncreated",c.PROTECTION_DESTROYED="public_protectiondestroyed",c.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",c.TEARDOWN_COMPLETE="protectionTeardownComplete",c.VIDEO_ELEMENT_SELECTED="videoElementSelected",c.KEY_SESSION_UPDATED="public_keySessionUpdated",c}return d}(p.default),R=new P;let m=R},"./src/streaming/protection/controllers/ProtectionController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>n});var p=e("./src/streaming/protection/CommonEncryption.js"),l=e("./src/streaming/protection/vo/MediaCapability.js"),o=e("./src/streaming/protection/vo/KeySystemConfiguration.js"),i=e("./src/streaming/protection/errors/ProtectionErrors.js"),E=e("./src/streaming/vo/DashJSError.js"),h=e("./src/streaming/protection/vo/LicenseRequest.js"),t=e("./src/streaming/protection/vo/LicenseResponse.js"),g=e("./src/streaming/vo/metrics/HTTPRequest.js"),C=e("./src/core/Utils.js"),T=e("./src/streaming/constants/Constants.js"),P=e("./src/core/FactoryMaker.js");function R(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(A){return typeof A}:R=function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},R(_)}var m=5,f=500,r=3,d=1e3,c=8e3;function M(_){_=_||{};var u=_.protectionKeyController,A=_.protectionModel,D=_.eventBus,j=_.events,$=_.debug,z=_.BASE64,ee=_.constants,k=[],w=_.cmcdModel,N=_.settings,H=_.customParametersModel,W,Z,X,te,fe,J,ue,pe,Ce,ve,Ee;function ge(){Z=$.getLogger(W),X=[],te=[],J="temporary",ue="",ve=null,Ee=null,D.on(j.INTERNAL_KEY_MESSAGE,st,W),D.on(j.INTERNAL_KEY_STATUS_CHANGED,ot,W)}function Q(){if(!D||!D.hasOwnProperty("on")||!u||!u.hasOwnProperty("getSupportedKeySystemsFromContentProtection"))throw new Error("Missing config parameter(s)")}function le(ye){if(!ye)throw new Error("mediaInfo can not be null or undefined");Q(),te.push(ye)}function Y(){if(!(!te||te.length===0)){var ye=[];te.forEach(function(be){var We=u.getSupportedKeySystemsFromContentProtection(be.contentProtection,fe,J);We.length>0&&(ye.length===0&&(ye=We),X.push(We))}),ye&&ye.length>0&&L(ye,!0)}}function I(ye){X.push(ye),L(ye,!1)}function L(ye,be){!pe&&!Ce?K(ye,be):pe&&U()}function K(ye,be){if(!Ce){Ce=!0;var We=[];ye=ye.sort(function(ft,Je){var yt=fe&&fe[ft.ks.systemString]&&fe[ft.ks.systemString].priority>=0?fe[ft.ks.systemString].priority:ye.length,At=fe&&fe[Je.ks.systemString]&&fe[Je.ks.systemString].priority>=0?fe[Je.ks.systemString].priority:ye.length;return yt-At});for(var Qe=0;Qe<ye.length;Qe++){var Ve=Fe(ye[Qe]);We.push({ks:ye[Qe].ks,configs:[Ve],protData:ye[Qe].protData})}var rt;A.requestKeySystemAccess(We).then(function(ft){rt=ft.data;var Je=rt.mksa&&rt.mksa.selectedSystemString?rt.mksa.selectedSystemString:rt.keySystem.systemString;return Z.info("DRM: KeySystem Access Granted for system string ("+Je+")!  Selecting key system..."),A.selectKeySystem(rt)}).then(function(ft){if(pe=ft,Ce=!1,!!A){D.trigger(j.KEY_SYSTEM_SELECTED,{data:rt});var Je=b(pe);Je&&Je.serverCertificate&&Je.serverCertificate.length>0&&A.setServerCertificate(z.decodeArray(Je.serverCertificate).buffer),U()}}).catch(function(ft){pe=null,Ce=!1,be||D.trigger(j.KEY_SYSTEM_SELECTED,{data:null,error:new E.default(i.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,i.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+ft.error)})})}}function U(){for(var ye,be=0;be<X.length;be++)for(ye=0;ye<X[be].length;ye++)if(pe===X[be][ye].ks){var We=X[be][ye];x(We);break}X=[]}function x(ye){if(u.isClearKey(pe)&&ye.protData&&ye.protData.hasOwnProperty("clearkeys")&&Object.keys(ye.protData.clearkeys).length!==0){var be={kids:Object.keys(ye.protData.clearkeys)};ye.initData=new TextEncoder().encode(JSON.stringify(be))}ye.sessionId?y(ye):ye.initData!==null&&S(ye)}function y(ye){Q(),A.loadKeySession(ye)}function S(ye){var be=p.default.getPSSHForKeySystem(pe,ye?ye.initData:null);if(be){if(ie(ye.keyId)||q(be))return;try{ye.initData=be,A.createKeySession(ye)}catch(We){D.trigger(j.KEY_SESSION_CREATED,{data:null,error:new E.default(i.default.KEY_SESSION_CREATED_ERROR_CODE,i.default.KEY_SESSION_CREATED_ERROR_MESSAGE+We.message)})}}else ye&&ye.initData?A.createKeySession(ye):D.trigger(j.KEY_SESSION_CREATED,{data:null,error:new E.default(i.default.KEY_SESSION_CREATED_ERROR_CODE,i.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(pe?pe.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function b(ye){if(ye){var be=ye.systemString;if(fe)return be in fe?fe[be]:null}return null}function F(){te=[]}function oe(ye){return Q(),u.getSupportedKeySystemsFromContentProtection(ye,fe,J)}function ie(ye){if(!ye)return!1;try{for(var be=A.getSessions(),We=0;We<be.length;We++)if(be[We].getKeyId()===ye)return!0;return!1}catch{return!1}}function q(ye){if(!ye)return!1;try{for(var be=A.getAllInitData(),We=0;We<be.length;We++)if(u.initDataEquals(ye,be[We]))return Z.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch{return!1}}function Ae(ye){Q(),A.removeKeySession(ye)}function de(ye){Q(),A.closeKeySession(ye)}function Me(ye){Q(),A.setServerCertificate(ye)}function Ie(ye){Q(),ye?(A.setMediaElement(ye),D.on(j.NEED_KEY,_t,W)):ye===null&&(A.setMediaElement(ye),D.off(j.NEED_KEY,_t,W))}function He(ye){J=ye}function Be(ye){ue=ye}function ze(ye){fe=ye,u.setProtectionData(ye)}function Ye(){xe(),A&&A.stop()}function Te(){D.off(j.INTERNAL_KEY_MESSAGE,st,W),D.off(j.INTERNAL_KEY_STATUS_CHANGED,ot,W),Q(),xe(),Ie(null),pe=null,Ce=!1,A&&(A.reset(),A=null),k.forEach(function(ye){return clearTimeout(ye)}),k=[],te=[],X=[]}function Fe(ye){var be=ye.protData,We=[],Qe=[],Ve=be&&be.audioRobustness&&be.audioRobustness.length>0?be.audioRobustness:ue,rt=be&&be.videoRobustness&&be.videoRobustness.length>0?be.videoRobustness:ue,ft=ye.sessionType,Je=be&&be.distinctiveIdentifier?be.distinctiveIdentifier:"optional",yt=be&&be.persistentState?be.persistentState:ft==="temporary"?"optional":"required";return te.forEach(function(At){At.type===ee.AUDIO?We.push(new l.default(At.codec,Ve)):At.type===ee.VIDEO&&Qe.push(new l.default(At.codec,rt))}),new o.default(We,Qe,Je,yt,[ft])}function ot(ye){ye.error?D.trigger(j.KEY_STATUSES_CHANGED,{data:null,error:ye.error}):Z.debug("DRM: key status = "+ye.status)}function st(ye){Z.debug("DRM: onKeyMessage");var be=ye.data;D.trigger(j.KEY_MESSAGE,{data:be});var We=be.messageType?be.messageType:"license-request",Qe=be.message,Ve=be.sessionToken,rt=b(pe),ft=u.getLicenseServerModelInstance(pe,rt,We),Je={sessionToken:Ve,messageType:We};if(!Qe||Qe.byteLength===0){at(Je,new E.default(i.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,i.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE));return}if(!ft){Z.debug("DRM: License server request not required for this message (type = "+ye.data.messageType+").  Session ID = "+Ve.getSessionId()),at(Je);return}if(u.isClearKey(pe)){var yt=u.processClearKeyLicenseRequest(pe,rt,Qe);if(yt&&yt.keyPairs&&yt.keyPairs.length>0){Z.debug("DRM: ClearKey license request handled by application!"),at(Je),A.updateKeySession(Ve,yt);return}}ht(be,ft,rt)}function at(ye,be){D.trigger(j.LICENSE_REQUEST_COMPLETE,{data:ye,error:be})}function ht(ye,be,We){var Qe=ye.sessionToken,Ve=ye.messageType?ye.messageType:"license-request",rt={sessionToken:Qe,messageType:Ve},ft=pe?pe.systemString:null,Je=we(We,Ve,Qe,ye,be);if(!Je){at(rt,new E.default(i.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,i.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE));return}var yt={},At=!1;We&&$e(yt,We.httpRequestHeaders);var Le=ye.message,Ue=pe.getRequestHeadersFromMessage(Le);$e(yt,Ue),Object.keys(yt).forEach(function(St){St.toLowerCase()==="authorization"&&(At=!0)}),We&&typeof We.withCredentials=="boolean"&&(At=We.withCredentials);var Ze=function(Mt){if(A)if(Mt.status>=200&&Mt.status<=299){var O=C.default.parseHttpHeaders(Mt.getAllResponseHeaders?Mt.getAllResponseHeaders():null),ae=new t.default(Mt.responseURL,O,Mt.response),G=H.getLicenseResponseFilters();qe(G,ae).then(function(){var B=be.getLicenseMessage(ae.data,ft,Ve);B!==null?(at(rt),A.updateKeySession(Qe,B)):et(Mt,rt,ft,Ve,be)})}else et(Mt,rt,ft,Ve,be)},dt=function(Mt){at(rt,new E.default(i.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,i.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+ft+' update, XHR aborted. status is "'+Mt.statusText+'" ('+Mt.status+"), readyState is "+Mt.readyState))},vt=function(Mt){at(rt,new E.default(i.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,i.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+ft+' update, XHR error. status is "'+Mt.statusText+'" ('+Mt.status+"), readyState is "+Mt.readyState))},mt=pe.getLicenseRequestFromMessage(Le),Pt=be.getHTTPMethod(Ve),Ft=be.getResponseType(ft,Ve),bt=We&&!isNaN(We.httpTimeout)?We.httpTimeout:c,kt=Qe.getSessionId()||null,Wt=new h.default(Je,Pt,Ft,yt,At,Ve,kt,mt),Vt=isNaN(N.get().streaming.retryAttempts[g.HTTPRequest.LICENSE])?r:N.get().streaming.retryAttempts[g.HTTPRequest.LICENSE],lt=H.getLicenseRequestFilters();qe(lt,Wt).then(function(){Tt(Wt,Vt,bt,Ze,dt,vt)})}function Tt(ye,be,We,Qe,Ve,rt){var ft=new XMLHttpRequest;if(N.get().streaming.cmcd&&N.get().streaming.cmcd.enabled){var Je=N.get().streaming.cmcd.mode;if(Je===T.default.CMCD_MODE_QUERY){var yt=w.getQueryParameter({url:ye.url,type:g.HTTPRequest.LICENSE});yt&&(ye.url=C.default.addAditionalQueryParameterToUrl(ye.url,[yt]))}}ft.open(ye.method,ye.url,!0),ft.responseType=ye.responseType,ft.withCredentials=ye.withCredentials,We>0&&(ft.timeout=We);for(var At in ye.headers)ft.setRequestHeader(At,ye.headers[At]);if(N.get().streaming.cmcd&&N.get().streaming.cmcd.enabled){var Le=N.get().streaming.cmcd.mode;if(Le===T.default.CMCD_MODE_HEADER){var Ue=w.getHeaderParameters({url:ye.url,type:g.HTTPRequest.LICENSE});if(Ue)for(var Ze in Ue){var dt=Ue[Ze];dt&&ft.setRequestHeader(Ze,dt)}}}var vt=function(){be--;var Pt=isNaN(N.get().streaming.retryIntervals[g.HTTPRequest.LICENSE])?d:N.get().streaming.retryIntervals[g.HTTPRequest.LICENSE];Ee=setTimeout(function(){Tt(ye,be,We,Qe,Ve,rt)},Pt)};ft.onload=function(){ve=null,this.status>=200&&this.status<=299||be<=0?Qe(this):(Z.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+be),vt())},ft.ontimeout=ft.onerror=function(){ve=null,be<=0?rt(this):(Z.warn("License request network request failed . Retrying it... Pending retries: "+be),vt())},ft.onabort=function(){Ve(this)},D.trigger(j.LICENSE_REQUEST_SENDING,{url:ye.url,headers:ye.headers,payload:ye.data,sessionId:ye.sessionId}),ve=ft,ft.send(ye.data)}function xe(){ve&&(ve.onloadend=ve.onerror=ve.onprogress=void 0,ve.abort(),ve=null),Ee&&(clearTimeout(Ee),Ee=null)}function we(ye,be,We,Qe,Ve){var rt=null,ft=Qe.message;if(ye&&ye.serverURL){var Je=ye.serverURL;typeof Je=="string"&&Je!==""?rt=Je:R(Je)==="object"&&Je.hasOwnProperty(be)&&(rt=Je[be])}else if(ye&&ye.laURL&&ye.laURL!=="")rt=ye.laURL;else if(rt=p.default.getLicenseServerUrlFromMediaInfo(te,pe.schemeIdURI),!rt&&!u.isClearKey(pe)){var yt=p.default.getPSSHData(We.initData);rt=pe.getLicenseServerURLFromInitData(yt),rt||(rt=Qe.laURL)}return rt=Ve.getServerURLFromMessage(rt,ft,be),rt}function $e(ye,be){if(be)for(var We in be)ye[We]=be[We]}function et(ye,be,We,Qe,Ve){var rt="NONE",ft=null;ye.response&&(rt=Ve.getErrorResponse(ye.response,We,Qe),ft={serverResponse:ye.response||null,responseCode:ye.status||null,responseText:ye.statusText||null}),at(be,new E.default(i.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,i.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+We+' update, XHR complete. status is "'+ye.statusText+'" ('+ye.status+"), readyState is "+ye.readyState+".  Response is "+rt,ft))}function qe(ye,be){return ye?ye.reduce(function(We,Qe){return We.then(function(){return Qe(be)})},Promise.resolve()):Promise.resolve()}function _t(ye,be){if(!N.get().streaming.protection.ignoreEmeEncryptedEvent){if(Z.debug("DRM: onNeedKey"),ye.key.initDataType!=="cenc"){Z.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+ye.key.initDataType);return}if(te.length===0&&(Z.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),be=typeof be>"u"?1:be+1,be<m)){k.push(setTimeout(function(){_t(ye,be)},f));return}var We=ye.key.initData;if(ArrayBuffer.isView(We)&&(We=We.buffer),pe){var Qe=p.default.getPSSHForKeySystem(pe,We);if(Qe&&q(Qe))return}Z.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(We)));var Ve=u.getSupportedKeySystemsFromSegmentPssh(We,fe,J);if(Ve.length===0){Z.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");return}I(Ve)}}function Xe(){return u?u.getKeySystems():[]}function Re(ye){u&&u.setKeySystems(ye)}return W={initializeForMedia:le,clearMediaInfoArray:F,handleKeySystemFromManifest:Y,createKeySession:S,loadKeySession:y,removeKeySession:Ae,closeKeySession:de,setServerCertificate:Me,setMediaElement:Ie,setSessionType:He,setRobustnessLevel:Be,setProtectionData:ze,getSupportedKeySystemsFromContentProtection:oe,getKeySystems:Xe,setKeySystems:Re,stop:Ye,reset:Te},ge(),W}M.__dashjs_factory_name="ProtectionController";let n=P.default.getClassFactory(M)},"./src/streaming/protection/controllers/ProtectionKeyController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/streaming/protection/CommonEncryption.js"),l=e("./src/streaming/protection/drm/KeySystemClearKey.js"),o=e("./src/streaming/protection/drm/KeySystemW3CClearKey.js"),i=e("./src/streaming/protection/drm/KeySystemWidevine.js"),E=e("./src/streaming/protection/drm/KeySystemPlayReady.js"),h=e("./src/streaming/protection/servers/DRMToday.js"),t=e("./src/streaming/protection/servers/PlayReady.js"),g=e("./src/streaming/protection/servers/Widevine.js"),C=e("./src/streaming/protection/servers/ClearKey.js"),T=e("./src/streaming/constants/ProtectionConstants.js");function P(){var m=this.context,f,r,d,c,M,n,_,u;function A(J){J&&(J.debug&&(r=J.debug,d=r.getLogger(f)),J.BASE64&&(M=J.BASE64),J.settings&&(n=J.settings))}function D(){c=[];var J;J=(0,E.default)(m).getInstance({BASE64:M,settings:n}),c.push(J),J=(0,i.default)(m).getInstance({BASE64:M}),c.push(J),J=(0,l.default)(m).getInstance({BASE64:M}),c.push(J),_=J,J=(0,o.default)(m).getInstance({BASE64:M,debug:r}),c.push(J),u=J}function j(){return c}function $(J){c=J}function z(J){for(var ue=0;ue<c.length;ue++)if(c[ue].systemString===J)return c[ue];return null}function ee(J){return J===_||J===u}function k(J,ue){if(J.byteLength===ue.byteLength){for(var pe=new Uint8Array(J),Ce=new Uint8Array(ue),ve=0;ve<pe.length;ve++)if(pe[ve]!==Ce[ve])return!1;return!0}return!1}function w(J,ue,pe){var Ce,ve,Ee,ge,Q=[];if(J){var le=p.default.findCencContentProtection(J);for(Ee=0;Ee<c.length;++Ee){ve=c[Ee];var Y=X(ve.systemString,ue);for(ge=0;ge<J.length;++ge)if(Ce=J[ge],Ce.schemeIdUri.toLowerCase()===ve.schemeIdURI){var I=ve.getInitData(Ce,le);Q.push({ks:c[Ee],keyId:Ce.keyId,initData:I,protData:Y,cdmData:ve.getCDMData(Y?Y.cdmData:null),sessionId:te(Y,Ce),sessionType:fe(Y,pe)})}}}return Q}function N(J,ue,pe){for(var Ce=[],ve=p.default.parsePSSHList(J),Ee,ge,Q=0;Q<c.length;++Q){Ee=c[Q],ge=Ee.systemString;var le=X(ge,ue);Ee.uuid in ve&&Ce.push({ks:Ee,initData:ve[Ee.uuid],protData:le,cdmData:Ee.getCDMData(le?le.cdmData:null),sessionId:te(le),sessionType:fe(le,pe)})}return Ce}function H(J,ue,pe){if(pe==="license-release"||pe==="individualization-request")return null;var Ce=null;return ue&&ue.hasOwnProperty("drmtoday")?Ce=(0,h.default)(m).getInstance({BASE64:M}):J.systemString===T.default.WIDEVINE_KEYSTEM_STRING?Ce=(0,g.default)(m).getInstance():J.systemString===T.default.PLAYREADY_KEYSTEM_STRING?Ce=(0,t.default)(m).getInstance():J.systemString===T.default.CLEARKEY_KEYSTEM_STRING&&(Ce=(0,C.default)(m).getInstance()),Ce}function W(J,ue,pe){try{return J.getClearKeysFromProtectionData(ue,pe)}catch{return d.error("Failed to retrieve clearkeys from ProtectionData"),null}}function Z(J){for(var ue=function(Ee){var ge=null;return J&&(ge=Ee in J?J[Ee]:null),ge},pe=0;pe<c.length;pe++){var Ce=c[pe];Ce.hasOwnProperty("init")&&Ce.init(ue(Ce.systemString))}}function X(J,ue){return ue&&J in ue?ue[J]:null}function te(J,ue){return J&&J.sessionId?J.sessionId:ue&&ue.sessionId?ue.sessionId:null}function fe(J,ue){return J&&J.sessionType?J.sessionType:ue}return f={initialize:D,setProtectionData:Z,isClearKey:ee,initDataEquals:k,getKeySystems:j,setKeySystems:$,getKeySystemBySystemString:z,getSupportedKeySystemsFromContentProtection:w,getSupportedKeySystemsFromSegmentPssh:N,getLicenseServerModelInstance:H,processClearKeyLicenseRequest:W,setConfig:A},f}P.__dashjs_factory_name="ProtectionKeyController";let R=dashjs.FactoryMaker.getSingletonFactory(P)},"./src/streaming/protection/drm/KeySystemClearKey.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>C});var p=e("./src/streaming/protection/vo/KeyPair.js"),l=e("./src/streaming/protection/vo/ClearKeyKeySet.js"),o=e("./src/streaming/protection/CommonEncryption.js"),i=e("./src/streaming/constants/ProtectionConstants.js"),E="e2719d58-a985-b3c9-781a-b030af78d30e",h=i.default.CLEARKEY_KEYSTEM_STRING,t="urn:uuid:"+E;function g(T){T=T||{};var P,R=T.BASE64;function m(_,u){var A=null;if(_){for(var D=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(u))),j=[],$=0;$<D.kids.length;$++){var z=D.kids[$],ee=_.clearkeys&&_.clearkeys.hasOwnProperty(z)?_.clearkeys[z]:null;if(!ee)throw new Error("DRM: ClearKey keyID ("+z+") is not known!");j.push(new p.default(z,ee))}A=new l.default(j)}return A}function f(_,u){try{var A=o.default.parseInitDataFromContentProtection(_,R);if(!A&&u){var D=r(u["cenc:default_KID"]),j={kids:[D]};A=new TextEncoder().encode(JSON.stringify(j))}return A}catch{return null}}function r(_){try{var u=_.replace(/-/g,"");return u=btoa(u.match(/\w{2}/g).map(function(A){return String.fromCharCode(parseInt(A,16))}).join("")),u.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}catch{return null}}function d(){return{"Content-Type":"application/json"}}function c(_){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(_))))}function M(){return null}function n(){return null}return P={uuid:E,schemeIdURI:t,systemString:h,getInitData:f,getRequestHeadersFromMessage:d,getLicenseRequestFromMessage:c,getLicenseServerURLFromInitData:M,getCDMData:n,getClearKeysFromProtectionData:m},P}g.__dashjs_factory_name="KeySystemClearKey";let C=dashjs.FactoryMaker.getSingletonFactory(g)},"./src/streaming/protection/drm/KeySystemPlayReady.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>g});var p=e("./src/streaming/protection/CommonEncryption.js"),l=e("./src/streaming/constants/ProtectionConstants.js"),o="9a04f079-9840-4286-ab92-e65be0885f95",i=l.default.PLAYREADY_KEYSTEM_STRING,E="urn:uuid:"+o,h='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>';function t(C){C=C||{};var T,P="utf-16",R=C.BASE64,m=C.settings;function f(){if(!R||!R.hasOwnProperty("decodeArray")||!R.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function r(u){var A,D,j={},$=new DOMParser;if(m&&m.get().streaming.protection.detectPlayreadyMessageFormat&&P==="utf-16"&&u&&u.byteLength%2===1)return j["Content-Type"]="text/xml; charset=utf-8",j;var z=P==="utf-16"?new Uint16Array(u):new Uint8Array(u);A=String.fromCharCode.apply(null,z),D=$.parseFromString(A,"application/xml");for(var ee=D.getElementsByTagName("name"),k=D.getElementsByTagName("value"),w=0;w<ee.length;w++)j[ee[w].childNodes[0].nodeValue]=k[w].childNodes[0].nodeValue;return j.hasOwnProperty("Content")&&(j["Content-Type"]=j.Content,delete j.Content),j.hasOwnProperty("Content-Type")||(j["Content-Type"]="text/xml; charset=utf-8"),j}function d(u){var A=null,D=new DOMParser;if(m&&m.get().streaming.protection.detectPlayreadyMessageFormat&&P==="utf-16"&&u&&u.byteLength%2===1)return u;var j=P==="utf-16"?new Uint16Array(u):new Uint8Array(u);f();var $=String.fromCharCode.apply(null,j),z=D.parseFromString($,"application/xml");if(z.getElementsByTagName("PlayReadyKeyMessage")[0]){var ee=z.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;ee&&(A=R.decode(ee))}else return u;return A}function c(u){if(u)for(var A=new DataView(u),D=A.getUint16(4,!0),j=6,$=new DOMParser,z=0;z<D;z++){var ee=A.getUint16(j,!0);j+=2;var k=A.getUint16(j,!0);if(j+=2,ee!==1){j+=k;continue}var w=u.slice(j,j+k),N=String.fromCharCode.apply(null,new Uint16Array(w)),H=$.parseFromString(N,"application/xml");if(H.getElementsByTagName("LA_URL")[0]){var W=H.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(W)return W}if(H.getElementsByTagName("LUI_URL")[0]){var Z=H.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(Z)return Z}}return null}function M(u){var A=new Uint8Array([112,115,115,104,0,0,0,0]),D=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),j=0,$=null,z,ee,k,w,N;if(f(),!u)return null;if("pssh"in u)return p.default.parseInitDataFromContentProtection(u,R);if("pro"in u)$=R.decodeArray(u.pro.__text);else if("prheader"in u)$=R.decodeArray(u.prheader.__text);else return null;return z=$.length,ee=4+A.length+D.length+4+z,k=new ArrayBuffer(ee),w=new Uint8Array(k),N=new DataView(k),N.setUint32(j,ee),j+=4,w.set(A,j),j+=A.length,w.set(D,j),j+=D.length,N.setUint32(j,z),j+=4,w.set($,j),j+=z,w.buffer}function n(u){if(u!=="utf-8"&&u!=="utf-16")throw new Error('Specified message format is not one of "utf-8" or "utf-16"');P=u}function _(u){var A,D,j,$;if(f(),!u)return null;for(A=[],$=0;$<u.length;++$)A.push(u.charCodeAt($)),A.push(0);for(A=String.fromCharCode.apply(null,A),A=R.encode(A),D=h.replace("%CUSTOMDATA%",A),j=[],$=0;$<D.length;++$)j.push(D.charCodeAt($)),j.push(0);return new Uint8Array(j).buffer}return T={uuid:o,schemeIdURI:E,systemString:i,getInitData:M,getRequestHeadersFromMessage:r,getLicenseRequestFromMessage:d,getLicenseServerURLFromInitData:c,getCDMData:_,setPlayReadyMessageFormat:n},T}t.__dashjs_factory_name="KeySystemPlayReady";let g=dashjs.FactoryMaker.getSingletonFactory(t)},"./src/streaming/protection/drm/KeySystemW3CClearKey.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>C});var p=e("./src/streaming/protection/vo/KeyPair.js"),l=e("./src/streaming/protection/vo/ClearKeyKeySet.js"),o=e("./src/streaming/protection/CommonEncryption.js"),i=e("./src/streaming/constants/ProtectionConstants.js"),E="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",h=i.default.CLEARKEY_KEYSTEM_STRING,t="urn:uuid:"+E;function g(T){var P,R=T.BASE64,m=T.debug.getLogger(P);function f(_,u){var A=null;if(_){for(var D=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(u))),j=[],$=0;$<D.kids.length;$++){var z=D.kids[$],ee=_.clearkeys&&_.clearkeys.hasOwnProperty(z)?_.clearkeys[z]:null;if(!ee)throw new Error("DRM: ClearKey keyID ("+z+") is not known!");j.push(new p.default(z,ee))}A=new l.default(j),m.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return A}function r(_){return o.default.parseInitDataFromContentProtection(_,R)}function d(){return null}function c(_){return new Uint8Array(_)}function M(){return null}function n(){return null}return P={uuid:E,schemeIdURI:t,systemString:h,getInitData:r,getRequestHeadersFromMessage:d,getLicenseRequestFromMessage:c,getLicenseServerURLFromInitData:M,getCDMData:n,getClearKeysFromProtectionData:f},P}g.__dashjs_factory_name="KeySystemW3CClearKey";let C=dashjs.FactoryMaker.getSingletonFactory(g)},"./src/streaming/protection/drm/KeySystemWidevine.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/streaming/protection/CommonEncryption.js"),l=e("./src/streaming/constants/ProtectionConstants.js"),o="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",i=l.default.WIDEVINE_KEYSTEM_STRING,E="urn:uuid:"+o;function h(g){g=g||{};var C,T=g.BASE64;function P(d){return p.default.parseInitDataFromContentProtection(d,T)}function R(){return null}function m(d){return new Uint8Array(d)}function f(){return null}function r(){return null}return C={uuid:o,schemeIdURI:E,systemString:i,getInitData:P,getRequestHeadersFromMessage:R,getLicenseRequestFromMessage:m,getLicenseServerURLFromInitData:f,getCDMData:r},C}h.__dashjs_factory_name="KeySystemWidevine";let t=dashjs.FactoryMaker.getSingletonFactory(h)},"./src/streaming/protection/errors/ProtectionErrors.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/core/errors/ErrorsBase.js");function l(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(d){return typeof d}:l=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},l(f)}function o(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function i(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&E(f,r)}function E(f,r){return E=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},E(f,r)}function h(f){var r=C();return function(){var c=T(f),M;if(r){var n=T(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return t(this,M)}}function t(f,r){return r&&(l(r)==="object"||typeof r=="function")?r:g(f)}function g(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(f){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},T(f)}var P=function(f){i(d,f);var r=h(d);function d(){var c;return o(this,d),c=r.call(this),c.MEDIA_KEYERR_CODE=100,c.MEDIA_KEYERR_UNKNOWN_CODE=101,c.MEDIA_KEYERR_CLIENT_CODE=102,c.MEDIA_KEYERR_SERVICE_CODE=103,c.MEDIA_KEYERR_OUTPUT_CODE=104,c.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,c.MEDIA_KEYERR_DOMAIN_CODE=106,c.MEDIA_KEY_MESSAGE_ERROR_CODE=107,c.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,c.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,c.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,c.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,c.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,c.KEY_SESSION_CREATED_ERROR_CODE=113,c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,c.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",c.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",c.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",c.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",c.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",c.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",c.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",c.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",c.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",c.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",c.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",c.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",c.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",c}return d}(p.default),R=new P;let m=R},"./src/streaming/protection/models/ProtectionModel_01b.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>C});var p=e("./src/streaming/protection/controllers/ProtectionKeyController.js"),l=e("./src/streaming/protection/vo/NeedKey.js"),o=e("./src/streaming/vo/DashJSError.js"),i=e("./src/streaming/protection/vo/KeyMessage.js"),E=e("./src/streaming/protection/vo/KeySystemConfiguration.js"),h=e("./src/streaming/protection/vo/KeySystemAccess.js"),t=e("./src/streaming/protection/errors/ProtectionErrors.js");function g(T){T=T||{};var P=this.context,R=T.eventBus,m=T.events,f=T.debug,r=T.api,d=T.errHandler,c,M,n,_,u,A,D,j,$;function z(){M=f.getLogger(c),n=null,_=null,A=[],D=[],u=(0,p.default)(P).getInstance(),$=pe()}function ee(){n&&ve();for(var Ee=0;Ee<D.length;Ee++)te(D[Ee]);R.trigger(m.TEARDOWN_COMPLETE)}function k(){for(var Ee=[],ge=0;ge<A.length;ge++)Ee.push(A[ge].initData);for(var Q=0;Q<D.length;Q++)Ee.push(D[Q].initData);return Ee}function w(){return D.concat(A)}function N(Ee){return new Promise(function(ge,Q){var le=n;le||(le=document.createElement("video"));for(var Y=!1,I=0;I<Ee.length;I++)for(var L=Ee[I].ks.systemString,K=Ee[I].configs,U=null,x=null,y=0;y<K.length;y++){var S=K[y].videoCapabilities;if(S&&S.length!==0){x=[];for(var b=0;b<S.length;b++)le.canPlayType(S[b].contentType,L)!==""&&x.push(S[b])}if(!(!U&&!x||U&&U.length===0||x&&x.length===0)){Y=!0;var F=new E.default(U,x),oe=u.getKeySystemBySystemString(L),ie=new h.default(oe,F);R.trigger(m.KEY_SYSTEM_ACCESS_COMPLETE,{data:ie}),ge({data:ie});break}}if(!Y){var q="Key system access denied! -- No valid audio/video content configurations detected!";R.trigger(m.KEY_SYSTEM_ACCESS_COMPLETE,{error:q}),Q({error:q})}})}function H(Ee){return _=Ee.keySystem,Promise.resolve(_)}function W(Ee){if(n!==Ee){if(n){ve();for(var ge=0;ge<D.length;ge++)te(D[ge]);D=[]}n=Ee,n&&(n.addEventListener(r.keyerror,$),n.addEventListener(r.needkey,$),n.addEventListener(r.keymessage,$),n.addEventListener(r.keyadded,$),R.trigger(m.VIDEO_ELEMENT_SELECTED))}}function Z(Ee){if(!_)throw new Error("Can not create sessions until you have selected a key system");if(j||D.length===0){var ge={sessionId:null,keyId:Ee.keyId,initData:Ee.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return A.push(ge),n[r.generateKeyRequest](_.systemString,new Uint8Array(Ee.initData)),ge}else throw new Error("Multiple sessions not allowed!")}function X(Ee,ge){var Q=Ee.sessionId;if(!u.isClearKey(_))n[r.addKey](_.systemString,new Uint8Array(ge),new Uint8Array(Ee.initData),Q);else for(var le=0;le<ge.keyPairs.length;le++)n[r.addKey](_.systemString,ge.keyPairs[le].key,ge.keyPairs[le].keyID,Q);R.trigger(m.KEY_SESSION_UPDATED)}function te(Ee){try{n[r.cancelKeyRequest](_.systemString,Ee.sessionId)}catch(ge){R.trigger(m.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+Ee.sessionId+") "+ge.message})}}function fe(){}function J(){}function ue(){}function pe(){return{handleEvent:function(ge){var Q=null;switch(ge.type){case r.needkey:var le=ArrayBuffer.isView(ge.initData)?ge.initData.buffer:ge.initData;R.trigger(m.NEED_KEY,{key:new l.default(le,"cenc")});break;case r.keyerror:if(Q=Ce(D,ge.sessionId),Q||(Q=Ce(A,ge.sessionId)),Q){var Y=t.default.MEDIA_KEYERR_CODE,I="";switch(ge.errorCode.code){case 1:Y=t.default.MEDIA_KEYERR_UNKNOWN_CODE,I+="MEDIA_KEYERR_UNKNOWN - "+t.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:Y=t.default.MEDIA_KEYERR_CLIENT_CODE,I+="MEDIA_KEYERR_CLIENT - "+t.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:Y=t.default.MEDIA_KEYERR_SERVICE_CODE,I+="MEDIA_KEYERR_SERVICE - "+t.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:Y=t.default.MEDIA_KEYERR_OUTPUT_CODE,I+="MEDIA_KEYERR_OUTPUT - "+t.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:Y=t.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,I+="MEDIA_KEYERR_HARDWARECHANGE - "+t.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:Y=t.default.MEDIA_KEYERR_DOMAIN_CODE,I+="MEDIA_KEYERR_DOMAIN - "+t.default.MEDIA_KEYERR_DOMAIN_MESSAGE;break}I+="  System Code = "+ge.systemCode,R.trigger(m.KEY_ERROR,{error:new o.default(Y,I,Q)})}else M.error("No session token found for key error");break;case r.keyadded:Q=Ce(D,ge.sessionId),Q||(Q=Ce(A,ge.sessionId)),Q?(M.debug("DRM: Key added."),R.trigger(m.KEY_ADDED,{data:Q})):M.debug("No session token found for key added");break;case r.keymessage:if(j=ge.sessionId!==null&&ge.sessionId!==void 0,j?(Q=Ce(D,ge.sessionId),!Q&&A.length>0&&(Q=A.shift(),D.push(Q),Q.sessionId=ge.sessionId,R.trigger(m.KEY_SESSION_CREATED,{data:Q}))):A.length>0&&(Q=A.shift(),D.push(Q),A.length!==0&&d.error(new o.default(t.default.MEDIA_KEY_MESSAGE_ERROR_CODE,t.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),Q){var L=ArrayBuffer.isView(ge.message)?ge.message.buffer:ge.message;Q.keyMessage=L,R.trigger(m.INTERNAL_KEY_MESSAGE,{data:new i.default(Q,L,ge.defaultURL)})}else M.warn("No session token found for key message");break}}}}function Ce(Ee,ge){if(!ge||!Ee)return null;for(var Q=Ee.length,le=0;le<Q;le++)if(Ee[le].sessionId==ge)return Ee[le];return null}function ve(){n.removeEventListener(r.keyerror,$),n.removeEventListener(r.needkey,$),n.removeEventListener(r.keymessage,$),n.removeEventListener(r.keyadded,$)}return c={getAllInitData:k,getSessions:w,requestKeySystemAccess:N,selectKeySystem:H,setMediaElement:W,createKeySession:Z,updateKeySession:X,closeKeySession:te,setServerCertificate:fe,loadKeySession:J,removeKeySession:ue,stop:ee,reset:ee},z(),c}g.__dashjs_factory_name="ProtectionModel_01b";let C=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/protection/models/ProtectionModel_21Jan2015.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/streaming/protection/controllers/ProtectionKeyController.js"),l=e("./src/streaming/protection/vo/NeedKey.js"),o=e("./src/streaming/protection/errors/ProtectionErrors.js"),i=e("./src/streaming/vo/DashJSError.js"),E=e("./src/streaming/protection/vo/KeyMessage.js"),h=e("./src/streaming/protection/vo/KeySystemAccess.js"),t=e("./src/streaming/constants/ProtectionConstants.js"),g={};g[t.default.PLAYREADY_KEYSTEM_STRING]=[t.default.PLAYREADY_KEYSTEM_STRING,t.default.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],g[t.default.WIDEVINE_KEYSTEM_STRING]=[t.default.WIDEVINE_KEYSTEM_STRING],g[t.default.CLEARKEY_KEYSTEM_STRING]=[t.default.CLEARKEY_KEYSTEM_STRING];function C(P){P=P||{};var R=this.context,m=P.eventBus,f=P.events,r=P.debug,d,c,M,n,_,u,A,D;function j(){c=r.getLogger(d),M=null,n=null,_=null,u=[],D=(0,p.default)(R).getInstance(),A=Ee()}function $(){var Y=u.length,I;Y!==0?function(){for(var L=function(x){ge(x),u.length===0&&(n?(n.removeEventListener("encrypted",A),n.setMediaKeys(null).then(function(){m.trigger(f.TEARDOWN_COMPLETE)})):m.trigger(f.TEARDOWN_COMPLETE))},K=0;K<Y;K++)I=u[K],function(U){I.session.closed.then(function(){L(U)}),ve(I).catch(function(){L(U)})}(I)}():m.trigger(f.TEARDOWN_COMPLETE)}function z(){for(var Y,I=0;I<u.length;I++)Y=u[I],Y.getUsable()||ve(Y).catch(function(){ge(Y)})}function ee(){for(var Y=[],I=0;I<u.length;I++)u[I].initData&&Y.push(u[I].initData);return Y}function k(){return u}function w(Y){return new Promise(function(I,L){N(Y,0,I,L)})}function N(Y,I,L,K){if(navigator.requestMediaKeySystemAccess===void 0||typeof navigator.requestMediaKeySystemAccess!="function"){var U="Insecure origins are not allowed";m.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{error:U}),K({error:U});return}var x=Y[I].protData&&Y[I].protData.systemStringPriority?Y[I].protData.systemStringPriority:null,y=Y[I].configs,S=Y[I].ks,b=S.systemString,F=x||(g[b]?g[b]:[b]);H(F,y).then(function(oe){var ie=typeof oe.getConfiguration=="function"?oe.getConfiguration():null,q=new h.default(S,ie);q.mksa=oe,m.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{data:q}),L({data:q})}).catch(function(oe){if(I+1<Y.length)N(Y,I+1,L,K);else{var ie="Key system access denied! ";m.trigger(f.KEY_SYSTEM_ACCESS_COMPLETE,{error:ie+oe.message}),K({error:ie+oe.message})}})}function H(Y,I){return new Promise(function(L,K){W(Y,I,0,L,K)})}function W(Y,I,L,K,U){var x=Y[L];c.debug("Requesting key system access for system string ".concat(x)),navigator.requestMediaKeySystemAccess(x,I).then(function(y){y.selectedSystemString=x,K(y)}).catch(function(y){L+1<Y.length?W(Y,I,L+1,K,U):U(y)})}function Z(Y){return new Promise(function(I,L){Y.mksa.createMediaKeys().then(function(K){return M=Y.keySystem,_=K,n?n.setMediaKeys(_):Promise.resolve()}).then(function(){I(M)}).catch(function(){L({error:"Error selecting keys system ("+Y.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})})}function X(Y){n!==Y&&(n&&(n.removeEventListener("encrypted",A),n.setMediaKeys&&n.setMediaKeys(null)),n=Y,n&&(n.addEventListener("encrypted",A),n.setMediaKeys&&_&&n.setMediaKeys(_)))}function te(Y){if(!M||!_)throw new Error("Can not set server certificate until you have selected a key system");_.setServerCertificate(Y).then(function(){c.info("DRM: License server certificate successfully updated."),m.trigger(f.SERVER_CERTIFICATE_UPDATED)}).catch(function(I){m.trigger(f.SERVER_CERTIFICATE_UPDATED,{error:new i.default(o.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,o.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+I.name)})})}function fe(Y){if(!M||!_)throw new Error("Can not create sessions until you have selected a key system");var I=_.createSession(Y.sessionType),L=le(I,Y),K=M.systemString===t.default.CLEARKEY_KEYSTEM_STRING&&(Y.initData||Y.protData&&Y.protData.clearkeys)?t.default.INITIALIZATION_DATA_TYPE_KEYIDS:t.default.INITIALIZATION_DATA_TYPE_CENC;I.generateRequest(K,Y.initData).then(function(){c.debug("DRM: Session created.  SessionID = "+L.getSessionId()),m.trigger(f.KEY_SESSION_CREATED,{data:L})}).catch(function(U){ge(L),m.trigger(f.KEY_SESSION_CREATED,{data:null,error:new i.default(o.default.KEY_SESSION_CREATED_ERROR_CODE,o.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+U.name)})})}function J(Y,I){var L=Y.session;D.isClearKey(M)&&(I=I.toJWK()),L.update(I).then(function(){m.trigger(f.KEY_SESSION_UPDATED)}).catch(function(K){m.trigger(f.KEY_ERROR,{error:new i.default(o.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+K.name,Y)})})}function ue(Y){if(!M||!_)throw new Error("Can not load sessions until you have selected a key system");for(var I=Y.sessionId,L=0;L<u.length;L++)if(I===u[L].sessionId){c.warn("DRM: Ignoring session ID because we have already seen it!");return}var K=_.createSession(Y.sessionType),U=le(K,Y);K.load(I).then(function(x){x?(c.debug("DRM: Session loaded.  SessionID = "+U.getSessionId()),m.trigger(f.KEY_SESSION_CREATED,{data:U})):(ge(U),m.trigger(f.KEY_SESSION_CREATED,{data:null,error:new i.default(o.default.KEY_SESSION_CREATED_ERROR_CODE,o.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+I+")")}))}).catch(function(x){ge(U),m.trigger(f.KEY_SESSION_CREATED,{data:null,error:new i.default(o.default.KEY_SESSION_CREATED_ERROR_CODE,o.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+I+")! "+x.name)})})}function pe(Y){var I=Y.session;I.remove().then(function(){c.debug("DRM: Session removed.  SessionID = "+Y.getSessionId()),m.trigger(f.KEY_SESSION_REMOVED,{data:Y.getSessionId()})},function(L){m.trigger(f.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+Y.getSessionId()+"). "+L.name})})}function Ce(Y){ve(Y).catch(function(I){ge(Y),m.trigger(f.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+Y.getSessionId()+") "+I.name})})}function ve(Y){var I=Y.session;return I.removeEventListener("keystatuseschange",Y),I.removeEventListener("message",Y),I.close()}function Ee(){return{handleEvent:function(I){switch(I.type){case"encrypted":if(I.initData){var L=ArrayBuffer.isView(I.initData)?I.initData.buffer:I.initData;m.trigger(f.NEED_KEY,{key:new l.default(L,I.initDataType)})}break}}}}function ge(Y){for(var I=0;I<u.length;I++)if(u[I]===Y){u.splice(I,1);break}}function Q(Y){var I,L;return Y&&Y.length>0&&(Y[0]&&(typeof Y[0]=="string"?I=Y[0]:L=Y[0]),Y[1]&&(typeof Y[1]=="string"?I=Y[1]:L=Y[1])),{status:I,keyId:L}}function le(Y,I){var L={session:Y,keyId:I.keyId,initData:I.initData,sessionId:I.sessionId,sessionType:I.sessionType,handleEvent:function(U){switch(U.type){case"keystatuseschange":m.trigger(f.KEY_STATUSES_CHANGED,{data:this}),U.target.keyStatuses.forEach(function(){var y=Q(arguments);switch(y.status){case"expired":m.trigger(f.INTERNAL_KEY_STATUS_CHANGED,{error:new i.default(o.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,o.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:m.trigger(f.INTERNAL_KEY_STATUS_CHANGED,y);break}});break;case"message":var x=ArrayBuffer.isView(U.message)?U.message.buffer:U.message;m.trigger(f.INTERNAL_KEY_MESSAGE,{data:new E.default(this,x,void 0,U.messageType)});break}},getKeyId:function(){return this.keyId},getSessionId:function(){return Y.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return Y.expiration},getKeyStatuses:function(){return Y.keyStatuses},getUsable:function(){var U=!1;return Y.keyStatuses.forEach(function(){var x=Q(arguments);x.status==="usable"&&(U=!0)}),U}};return Y.addEventListener("keystatuseschange",L),Y.addEventListener("message",L),Y.closed.then(function(){ge(L),c.debug("DRM: Session closed.  SessionID = "+L.getSessionId()),m.trigger(f.KEY_SESSION_CLOSED,{data:L.getSessionId()})}),u.push(L),L}return d={getAllInitData:ee,getSessions:k,requestKeySystemAccess:w,selectKeySystem:Z,setMediaElement:X,setServerCertificate:te,createKeySession:fe,updateKeySession:J,loadKeySession:ue,removeKeySession:pe,closeKeySession:Ce,stop:z,reset:$},j(),d}C.__dashjs_factory_name="ProtectionModel_21Jan2015";let T=dashjs.FactoryMaker.getClassFactory(C)},"./src/streaming/protection/models/ProtectionModel_3Feb2014.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>C});var p=e("./src/streaming/protection/controllers/ProtectionKeyController.js"),l=e("./src/streaming/protection/vo/NeedKey.js"),o=e("./src/streaming/vo/DashJSError.js"),i=e("./src/streaming/protection/errors/ProtectionErrors.js"),E=e("./src/streaming/protection/vo/KeyMessage.js"),h=e("./src/streaming/protection/vo/KeySystemConfiguration.js"),t=e("./src/streaming/protection/vo/KeySystemAccess.js");function g(T){T=T||{};var P=this.context,R=T.eventBus,m=T.events,f=T.debug,r=T.api,d,c,M,n,_,u,A,D,j;function $(){c=f.getLogger(d),M=null,n=null,_=null,u=null,A=[],j=(0,p.default)(P).getInstance(),D=ue()}function z(){try{for(var ve=0;ve<A.length;ve++)X(A[ve]);M&&M.removeEventListener(r.needkey,D),R.trigger(m.TEARDOWN_COMPLETE)}catch(Ee){R.trigger(m.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+Ee.message})}}function ee(){for(var ve=[],Ee=0;Ee<A.length;Ee++)ve.push(A[Ee].initData);return ve}function k(){return A}function w(ve){return new Promise(function(Ee,ge){for(var Q=!1,le=0;le<ve.length;le++)for(var Y=ve[le].ks.systemString,I=ve[le].configs,L=null,K=null,U=0;U<I.length;U++){var x=I[U].audioCapabilities,y=I[U].videoCapabilities;if(x&&x.length!==0){L=[];for(var S=0;S<x.length;S++)window[r.MediaKeys].isTypeSupported(Y,x[S].contentType)&&L.push(x[S])}if(y&&y.length!==0){K=[];for(var b=0;b<y.length;b++)window[r.MediaKeys].isTypeSupported(Y,y[b].contentType)&&K.push(y[b])}if(!(!L&&!K||L&&L.length===0||K&&K.length===0)){Q=!0;var F=new h.default(L,K),oe=j.getKeySystemBySystemString(Y),ie=new t.default(oe,F);R.trigger(m.KEY_SYSTEM_ACCESS_COMPLETE,{data:ie}),Ee({data:ie});break}}if(!Q){var q="Key system access denied! -- No valid audio/video content configurations detected!";R.trigger(m.KEY_SYSTEM_ACCESS_COMPLETE,{error:q}),ge({error:q})}})}function N(ve){return new Promise(function(Ee,ge){try{_=ve.mediaKeys=new window[r.MediaKeys](ve.keySystem.systemString),n=ve.keySystem,u=ve,M&&pe(),Ee(n)}catch{ge({error:"Error selecting keys system ("+n.systemString+")! Could not create MediaKeys -- TODO"})}})}function H(ve){M!==ve&&(M&&M.removeEventListener(r.needkey,D),M=ve,M&&(M.addEventListener(r.needkey,D),_&&pe()))}function W(ve){if(!n||!_||!u)throw new Error("Can not create sessions until you have selected a key system");var Ee=null;if(u.ksConfiguration.videoCapabilities&&u.ksConfiguration.videoCapabilities.length>0&&(Ee=u.ksConfiguration.videoCapabilities[0]),Ee===null&&u.ksConfiguration.audioCapabilities&&u.ksConfiguration.audioCapabilities.length>0&&(Ee=u.ksConfiguration.audioCapabilities[0]),Ee===null)throw new Error("Can not create sessions for unknown content types.");var ge=Ee.contentType,Q=_.createSession(ge,new Uint8Array(ve.initData),ve.cdmData?new Uint8Array(ve.cdmData):null),le=Ce(Q,ve);Q.addEventListener(r.error,le),Q.addEventListener(r.message,le),Q.addEventListener(r.ready,le),Q.addEventListener(r.close,le),A.push(le),c.debug("DRM: Session created.  SessionID = "+le.getSessionId()),R.trigger(m.KEY_SESSION_CREATED,{data:le})}function Z(ve,Ee){var ge=ve.session;j.isClearKey(n)?ge.update(new Uint8Array(Ee.toJWK())):ge.update(new Uint8Array(Ee)),R.trigger(m.KEY_SESSION_UPDATED)}function X(ve){var Ee=ve.session;Ee.removeEventListener(r.error,ve),Ee.removeEventListener(r.message,ve),Ee.removeEventListener(r.ready,ve),Ee.removeEventListener(r.close,ve);for(var ge=0;ge<A.length;ge++)if(A[ge]===ve){A.splice(ge,1);break}Ee[r.release]()}function te(){}function fe(){}function J(){}function ue(){return{handleEvent:function(Ee){switch(Ee.type){case r.needkey:if(Ee.initData){var ge=ArrayBuffer.isView(Ee.initData)?Ee.initData.buffer:Ee.initData;R.trigger(m.NEED_KEY,{key:new l.default(ge,"cenc")})}break}}}}function pe(){var ve=null,Ee=function(){M.removeEventListener("loadedmetadata",ve),M[r.setMediaKeys](_),R.trigger(m.VIDEO_ELEMENT_SELECTED)};M.readyState>=1?Ee():(ve=Ee.bind(this),M.addEventListener("loadedmetadata",ve))}function Ce(ve,Ee){return{session:ve,keyId:Ee.keyId,initData:Ee.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(Q){switch(Q.type){case r.error:var le="KeyError";R.trigger(m.KEY_ERROR,{error:new o.default(i.default.MEDIA_KEYERR_CODE,le,this)});break;case r.message:var Y=ArrayBuffer.isView(Q.message)?Q.message.buffer:Q.message;R.trigger(m.INTERNAL_KEY_MESSAGE,{data:new E.default(this,Y,Q.destinationURL)});break;case r.ready:c.debug("DRM: Key added."),R.trigger(m.KEY_ADDED);break;case r.close:c.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),R.trigger(m.KEY_SESSION_CLOSED,{data:this.getSessionId()});break}}}}return d={getAllInitData:ee,getSessions:k,requestKeySystemAccess:w,selectKeySystem:N,setMediaElement:H,createKeySession:W,updateKeySession:Z,closeKeySession:X,setServerCertificate:te,loadKeySession:fe,removeKeySession:J,stop:z,reset:z},$(),d}g.__dashjs_factory_name="ProtectionModel_3Feb2014";let C=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/protection/servers/ClearKey.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/streaming/protection/vo/KeyPair.js"),l=e("./src/streaming/protection/vo/ClearKeyKeySet.js");function o(){var E;function h(P){return P}function t(){return"POST"}function g(){return"json"}function C(P){if(!P.hasOwnProperty("keys"))return null;for(var R=[],m=0;m<P.keys.length;m++){var f=P.keys[m],r=f.kid.replace(/=/g,""),d=f.k.replace(/=/g,"");R.push(new p.default(r,d))}return new l.default(R)}function T(P){return String.fromCharCode.apply(null,new Uint8Array(P))}return E={getServerURLFromMessage:h,getHTTPMethod:t,getResponseType:g,getLicenseMessage:C,getErrorResponse:T},E}o.__dashjs_factory_name="ClearKey";let i=dashjs.FactoryMaker.getSingletonFactory(o)},"./src/streaming/protection/servers/DRMToday.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/streaming/constants/ProtectionConstants.js");function l(i){i=i||{};var E=i.BASE64,h={};h[p.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(r){return E.decodeArray(r.license)},getErrorResponse:function(r){return r}},h[p.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(r){return r},getErrorResponse:function(r){return String.fromCharCode.apply(null,new Uint8Array(r))}};var t;function g(){if(!E||!E.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function C(f){return f}function T(){return"POST"}function P(f){return h[f].responseType}function R(f,r){return g(),h[r].getLicenseMessage(f)}function m(f,r){return h[r].getErrorResponse(f)}return t={getServerURLFromMessage:C,getHTTPMethod:T,getResponseType:P,getLicenseMessage:R,getErrorResponse:m},t}l.__dashjs_factory_name="DRMToday";let o=dashjs.FactoryMaker.getSingletonFactory(l)},"./src/streaming/protection/servers/PlayReady.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(){var i,E="http://schemas.xmlsoap.org/soap/envelope/";function h(f){var r=String.fromCharCode.apply(null,new Uint8Array(f)),d=decodeURIComponent(escape(r));return d}function t(f){if(window.DOMParser){var r=h(f),d=new window.DOMParser,c=d.parseFromString(r,"text/xml"),M=c?c.getElementsByTagNameNS(E,"Envelope")[0]:null,n=M?M.getElementsByTagNameNS(E,"Body")[0]:null,_=n?n.getElementsByTagNameNS(E,"Fault")[0]:null;if(_)return null}return f}function g(f){var r="",d="",c="",M=-1,n=-1;if(window.DOMParser){var _=h(f),u=new window.DOMParser,A=u.parseFromString(_,"text/xml"),D=A?A.getElementsByTagNameNS(E,"Envelope")[0]:null,j=D?D.getElementsByTagNameNS(E,"Body")[0]:null,$=j?j.getElementsByTagNameNS(E,"Fault")[0]:null,z=$?$.getElementsByTagName("detail")[0]:null,ee=z?z.getElementsByTagName("Exception")[0]:null,k=null;if($===null)return _;k=$.getElementsByTagName("faultstring")[0].firstChild,r=k?k.nodeValue:null,ee!==null&&(k=ee.getElementsByTagName("StatusCode")[0],d=k?k.firstChild.nodeValue:null,k=ee.getElementsByTagName("Message")[0],c=k?k.firstChild.nodeValue:null,M=c?c.lastIndexOf("[")+1:-1,n=c?c.indexOf("]"):-1,c=c?c.substring(M,n):"")}var w="code: ".concat(d,", name: ").concat(r);return c&&(w+=", message: ".concat(c)),w}function C(f){return f}function T(){return"POST"}function P(){return"arraybuffer"}function R(f){return t.call(this,f)}function m(f){return g.call(this,f)}return i={getServerURLFromMessage:C,getHTTPMethod:T,getResponseType:P,getLicenseMessage:R,getErrorResponse:m},i}l.__dashjs_factory_name="PlayReady";let o=p.default.getSingletonFactory(l)},"./src/streaming/protection/servers/Widevine.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>l});function p(){var o;function i(C){return C}function E(){return"POST"}function h(){return"arraybuffer"}function t(C){return C}function g(C){return String.fromCharCode.apply(null,new Uint8Array(C))}return o={getServerURLFromMessage:i,getHTTPMethod:E,getResponseType:h,getLicenseMessage:t,getErrorResponse:g},o}p.__dashjs_factory_name="Widevine";let l=dashjs.FactoryMaker.getSingletonFactory(p)},"./src/streaming/protection/vo/ClearKeyKeySet.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(t,g){if(p(this,h),g&&g!=="persistent"&&g!=="temporary")throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=g}return o(h,[{key:"toJWK",value:function(){var g,C=this.keyPairs.length,T={keys:[]};for(g=0;g<C;g++){var P={kty:"oct",alg:"A128KW",kid:this.keyPairs[g].keyID,k:this.keyPairs[g].key};T.keys.push(P)}this.type&&(T.type=this.type);var R=JSON.stringify(T),m=R.length,f=new ArrayBuffer(m),r=new Uint8Array(f);for(g=0;g<m;g++)r[g]=R.charCodeAt(g);return f}}]),h}();let E=i},"./src/streaming/protection/vo/KeyMessage.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h,t,g){p(this,i),this.sessionToken=E,this.message=h,this.defaultURL=t,this.messageType=g||"license-request"};let o=l},"./src/streaming/protection/vo/KeyPair.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h){p(this,i),this.keyID=E,this.key=h};let o=l},"./src/streaming/protection/vo/KeySystemAccess.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h){p(this,i),this.keySystem=E,this.ksConfiguration=h};let o=l},"./src/streaming/protection/vo/KeySystemConfiguration.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h,t,g,C){p(this,i),this.initDataTypes=["cenc"],E&&E.length&&(this.audioCapabilities=E),h&&h.length&&(this.videoCapabilities=h),this.distinctiveIdentifier=t,this.persistentState=g,this.sessionTypes=C};let o=l},"./src/streaming/protection/vo/LicenseRequest.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h,t,g,C,T,P,R){p(this,i),this.url=E,this.method=h,this.responseType=t,this.headers=g,this.withCredentials=C,this.messageType=T,this.sessionId=P,this.data=R};let o=l},"./src/streaming/protection/vo/LicenseResponse.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h,t){p(this,i),this.url=E,this.headers=h,this.data=t};let o=l},"./src/streaming/protection/vo/MediaCapability.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h){p(this,i),this.contentType=E,this.robustness=h};let o=l},"./src/streaming/protection/vo/NeedKey.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h){p(this,i),this.initData=E,this.initDataType=h};let o=l},"./src/streaming/rules/DroppedFramesHistory.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/core/FactoryMaker.js");function l(){var E={},h={},t={};function g(R,m,f){if(m){E[R]||(E[R]=[],h[R]=0,t[R]=0);var r=f&&f.droppedVideoFrames?f.droppedVideoFrames:0,d=f&&f.totalVideoFrames?f.totalVideoFrames:0,c=r-h[R];h[R]=r;var M=d-t[R];t[R]=d;var n=E[R];isNaN(m)||(n[m]?(n[m].droppedVideoFrames+=c,n[m].totalVideoFrames+=M):n[m]={droppedVideoFrames:c,totalVideoFrames:M})}}function C(R){return E[R]}function T(R){try{delete E[R],delete h[R],delete t[R]}catch{}}function P(){E={},h={},t={}}return{push:g,getFrameHistory:C,clearForStream:T,reset:P}}l.__dashjs_factory_name="DroppedFramesHistory";var o=p.default.getClassFactory(l);let i=o},"./src/streaming/rules/RulesContext.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(i){i=i||{};var E,h=i.abrController,t=i.switchHistory,g=i.droppedFramesHistory,C=i.currentRequest,T=i.useBufferOccupancyABR,P=i.useL2AABR,R=i.useLoLPABR,m=i.streamProcessor?i.streamProcessor.getScheduleController():null,f=i.streamProcessor?i.streamProcessor.getRepresentationInfo():null,r=i.videoModel?i.videoModel:null;function d(){var w=M();return w?w.type:null}function c(){var w=M();return w?w.streamInfo:null}function M(){return f?f.mediaInfo:null}function n(){return f}function _(){return m}function u(){return h}function A(){return t}function D(){return r}function j(){return g}function $(){return C}function z(){return T}function ee(){return P}function k(){return R}return E={getMediaType:d,getMediaInfo:M,getDroppedFramesHistory:j,getCurrentRequest:$,getSwitchHistory:A,getStreamInfo:c,getScheduleController:_,getAbrController:u,getRepresentationInfo:n,useBufferOccupancyABR:z,useL2AABR:ee,useLoLPABR:k,getVideoModel:D},E}l.__dashjs_factory_name="RulesContext";let o=p.default.getClassFactory(l)},"./src/streaming/rules/SwitchRequest.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/core/FactoryMaker.js"),l=-1,o={DEFAULT:.5,STRONG:1,WEAK:0};function i(t,g,C){var T,P,R,m;function f(r){var d=o.DEFAULT;return(r===o.DEFAULT||r===o.STRONG||r===o.WEAK)&&(d=r),d}return P=t===void 0?l:t,R=f(C),m=g===void 0?null:g,T={quality:P,reason:m,priority:R},T}i.__dashjs_factory_name="SwitchRequest";var E=p.default.getClassFactory(i);E.NO_CHANGE=l,E.PRIORITY=o,p.default.updateClassFactory(i.__dashjs_factory_name,E);let h=E},"./src/streaming/rules/SwitchRequestHistory.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/rules/SwitchRequest.js"),o=8;function i(){var t=[],g=[];function C(R){R.newValue===l.default.NO_CHANGE&&(R.newValue=R.oldValue),t[R.oldValue]||(t[R.oldValue]={noDrops:0,drops:0,dropSize:0});var m=R.newValue-R.oldValue,f=m<0?1:0,r=f?-m:0,d=f?0:1;if(t[R.oldValue].drops+=f,t[R.oldValue].dropSize+=r,t[R.oldValue].noDrops+=d,g.push({idx:R.oldValue,noDrop:d,drop:f,dropSize:r}),g.length>o){var c=g.shift();t[c.idx].drops-=c.drop,t[c.idx].dropSize-=c.dropSize,t[c.idx].noDrops-=c.noDrop}}function T(){return t}function P(){t=[],g=[]}return{push:C,getSwitchRequests:T,reset:P}}i.__dashjs_factory_name="SwitchRequestHistory";var E=p.default.getClassFactory(i);let h=E},"./src/streaming/rules/ThroughputHistory.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/core/EventBus.js"),i=e("./src/streaming/MediaPlayerEvents.js");function E(t){var g=this.context;t=t||{};var C=20,T=3,P=4,R=4,m=1.3,f=1.3,r=8,d=3,c=2,M=1,n=t.settings,_=(0,o.default)(g).getInstance(),u,A,D,j,$;function z(){$={throughputHalfLife:{fast:d,slow:r},latencyHalfLife:{fast:M,slow:c}},pe()}function ee(ve,Ee,ge){if(ve===p.default.VIDEO)return ge<n.get().streaming.cacheLoadThresholds[p.default.VIDEO];if(ve===p.default.AUDIO)return ge<n.get().streaming.cacheLoadThresholds[p.default.AUDIO]}function k(ve,Ee,ge){if(!(!Ee.trace||!Ee.trace.length)){var Q=Ee.tresponse.getTime()-Ee.trequest.getTime()||1,le=Ee._tfinish.getTime()-Ee.tresponse.getTime()||1,Y=Ee.trace.reduce(function(x,y){return x+y.b[0]},0),I=0,L=0;if(Ee._fileLoaderType&&Ee._fileLoaderType===p.default.FILE_LOADER_TYPES.FETCH?I=Ee.trace.reduce(function(x,y){return x+y.d},0):I=ge?le:Q+le,I!==0&&(L=Math.round(8*Y/I)),Ee.cmsd){var K=Ee.cmsd.dynamic&&Ee.cmsd.dynamic.etp?Ee.cmsd.dynamic.etp:null;if(K){var U=n.get().streaming.cmsd.abr.etpWeightRatio;U>0&&U<=1&&(L=L*(1-U)+K*U)}}if(J(ve),ee(ve,Q,le)){if(u[ve].length>0&&!u[ve].hasCachedEntries)return;u[ve].hasCachedEntries=!0}else u[ve]&&u[ve].hasCachedEntries&&ue(ve);u[ve].push(L),_.trigger(i.default.THROUGHPUT_MEASUREMENT_STORED,{throughput:L,mediaType:ve,httpRequest:Ee}),u[ve].length>C&&u[ve].shift(),A[ve].push(Q),A[ve].length>C&&A[ve].shift(),w(D[ve],L,.001*le,$.throughputHalfLife),w(j[ve],Q,1,$.latencyHalfLife)}}function w(ve,Ee,ge,Q){var le=Math.pow(.5,ge/Q.fast);ve.fastEstimate=(1-le)*Ee+le*ve.fastEstimate;var Y=Math.pow(.5,ge/Q.slow);ve.slowEstimate=(1-Y)*Ee+Y*ve.slowEstimate,ve.totalWeight+=ge}function N(ve,Ee,ge){var Q,le;if(ve?(Q=u[Ee],le=ge?T:P):(Q=A[Ee],le=R),!Q)le=0;else if(le>=Q.length)le=Q.length;else if(ve)for(var Y=1;Y<le;++Y){var I=Q[Q.length-Y]/Q[Q.length-Y-1];if((I>=f||I<=1/m)&&(le+=1,le===Q.length))break}return le}function H(ve,Ee,ge){return n.get().streaming.abr.movingAverageMethod!==p.default.MOVING_AVERAGE_SLIDING_WINDOW?Z(ve,Ee):W(ve,Ee,ge)}function W(ve,Ee,ge){var Q=N(ve,Ee,ge),le=ve?u:A,Y=le[Ee];return Q===0||!Y||Y.length===0?NaN:(Y=Y.slice(-Q),Y.reduce(function(I,L){return I+L})/Y.length)}function Z(ve,Ee){var ge=ve?$.throughputHalfLife:$.latencyHalfLife,Q=ve?D[Ee]:j[Ee];if(!Q||Q.totalWeight<=0)return NaN;var le=Q.fastEstimate/(1-Math.pow(.5,Q.totalWeight/ge.fast)),Y=Q.slowEstimate/(1-Math.pow(.5,Q.totalWeight/ge.slow));return ve?Math.min(le,Y):Math.max(le,Y)}function X(ve,Ee){return H(!0,ve,Ee)}function te(ve,Ee){var ge=X(ve,Ee);return isNaN(ge)||(ge*=n.get().streaming.abr.bandwidthSafetyFactor),ge}function fe(ve){return H(!1,ve)}function J(ve){u[ve]=u[ve]||[],A[ve]=A[ve]||[],D[ve]=D[ve]||{fastEstimate:0,slowEstimate:0,totalWeight:0},j[ve]=j[ve]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function ue(ve){delete u[ve],delete A[ve],delete D[ve],delete j[ve],J(ve)}function pe(){u={},A={},D={},j={}}var Ce={push:k,getAverageThroughput:X,getSafeAverageThroughput:te,getAverageLatency:fe,reset:pe};return z(),Ce}E.__dashjs_factory_name="ThroughputHistory";let h=l.default.getClassFactory(E)},"./src/streaming/rules/abr/ABRRulesCollection.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>d});var p=e("./src/streaming/rules/abr/ThroughputRule.js"),l=e("./src/streaming/rules/abr/InsufficientBufferRule.js"),o=e("./src/streaming/rules/abr/AbandonRequestsRule.js"),i=e("./src/streaming/rules/abr/DroppedFramesRule.js"),E=e("./src/streaming/rules/abr/SwitchHistoryRule.js"),h=e("./src/streaming/rules/abr/BolaRule.js"),t=e("./src/streaming/rules/abr/L2ARule.js"),g=e("./src/streaming/rules/abr/lolp/LoLpRule.js"),C=e("./src/core/FactoryMaker.js"),T=e("./src/streaming/rules/SwitchRequest.js"),P=e("./src/streaming/constants/Constants.js"),R="qualitySwitchRules",m="abandonFragmentRules";function f(c){c=c||{};var M=this.context,n=c.mediaPlayerModel,_=c.customParametersModel,u=c.dashMetrics,A=c.settings,D,j,$;function z(){j=[],$=[],A.get().streaming.abr.useDefaultABRRules&&(A.get().streaming.abr.ABRStrategy===P.default.ABR_STRATEGY_L2A?j.push((0,t.default)(M).create({dashMetrics:u,settings:A})):A.get().streaming.abr.ABRStrategy===P.default.ABR_STRATEGY_LoLP?j.push((0,g.default)(M).create({dashMetrics:u})):(j.push((0,h.default)(M).create({dashMetrics:u,mediaPlayerModel:n,settings:A})),j.push((0,p.default)(M).create({dashMetrics:u})),A.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&j.push((0,l.default)(M).create({dashMetrics:u,settings:A})),A.get().streaming.abr.additionalAbrRules.switchHistoryRule&&j.push((0,E.default)(M).create()),A.get().streaming.abr.additionalAbrRules.droppedFramesRule&&j.push((0,i.default)(M).create()),A.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&$.push((0,o.default)(M).create({dashMetrics:u,mediaPlayerModel:n,settings:A}))));var Z=_.getAbrCustomRules();Z.forEach(function(X){X.type===R&&j.push(X.rule(M).create()),X.type===m&&$.push(X.rule(M).create())})}function ee(Z){return Z.filter(function(X){return X.quality>T.default.NO_CHANGE})}function k(Z){var X={},te=null,fe,J,ue,pe,Ce;if(Z.length!==0){for(X[T.default.PRIORITY.STRONG]={quality:T.default.NO_CHANGE,reason:null},X[T.default.PRIORITY.WEAK]={quality:T.default.NO_CHANGE,reason:null},X[T.default.PRIORITY.DEFAULT]={quality:T.default.NO_CHANGE,reason:null},fe=0,J=Z.length;fe<J;fe+=1)ue=Z[fe],ue.quality!==T.default.NO_CHANGE&&(X[ue.priority].quality===T.default.NO_CHANGE||X[ue.priority].quality>ue.quality)&&(X[ue.priority].quality=ue.quality,X[ue.priority].reason=ue.reason||null);return X[T.default.PRIORITY.WEAK].quality!==T.default.NO_CHANGE&&(te=X[T.default.PRIORITY.WEAK]),X[T.default.PRIORITY.DEFAULT].quality!==T.default.NO_CHANGE&&(te=X[T.default.PRIORITY.DEFAULT]),X[T.default.PRIORITY.STRONG].quality!==T.default.NO_CHANGE&&(te=X[T.default.PRIORITY.STRONG]),te&&(pe=te.quality,Ce=te.reason),(0,T.default)(M).create(pe,Ce)}}function w(Z){var X=j.map(function(J){return J.getMaxIndex(Z)}),te=ee(X),fe=k(te);return fe||(0,T.default)(M).create()}function N(Z,X){var te=$.map(function(ue){return ue.shouldAbandon(Z,X)}),fe=ee(te),J=k(fe);return J||(0,T.default)(M).create()}function H(){[j,$].forEach(function(Z){Z&&Z.length&&Z.forEach(function(X){return X.reset&&X.reset()})}),j=[],$=[]}function W(){return j}return D={initialize:z,reset:H,getMaxQuality:w,getMinSwitchRequest:k,shouldAbandonFragment:N,getQualitySwitchRules:W},D}f.__dashjs_factory_name="ABRRulesCollection";var r=C.default.getClassFactory(f);r.QUALITY_SWITCH_RULES=R,r.ABANDON_FRAGMENT_RULES=m,C.default.updateSingletonFactory(f.__dashjs_factory_name,r);let d=r},"./src/streaming/rules/abr/AbandonRequestsRule.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/streaming/rules/SwitchRequest.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/core/Debug.js");function i(h){h=h||{};var t=1.8,g=500,C=5,T=this.context,P=h.mediaPlayerModel,R=h.dashMetrics,m=h.settings,f,r,d,c,M;function n(){r=(0,o.default)(T).getInstance().getLogger(f),D()}function _(j,$){d[j]=d[j]||{},d[j][$]=d[j][$]||{}}function u(j,$){M[j]=M[j]||[],M[j].push($)}function A(j){var $=(0,p.default)(T).create(p.default.NO_CHANGE,{name:i.__dashjs_factory_name});if(!j||!j.hasOwnProperty("getMediaInfo")||!j.hasOwnProperty("getMediaType")||!j.hasOwnProperty("getCurrentRequest")||!j.hasOwnProperty("getRepresentationInfo")||!j.hasOwnProperty("getAbrController"))return $;var z=j.getMediaInfo(),ee=j.getMediaType(),k=j.getStreamInfo(),w=k?k.id:null,N=j.getCurrentRequest();if(!isNaN(N.index)){_(ee,N.index);var H=P.getStableBufferTime(),W=R.getCurrentBufferLevel(ee);if(W>H)return $;var Z=d[ee][N.index];if(Z===null||N.firstByteDate===null||c.hasOwnProperty(Z.id))return $;if(Z.firstByteTime===void 0&&(M[ee]=[],Z.firstByteTime=N.firstByteDate.getTime(),Z.segmentDuration=N.duration,Z.bytesTotal=N.bytesTotal,Z.id=N.index),Z.bytesLoaded=N.bytesLoaded,Z.elapsedTime=new Date().getTime()-Z.firstByteTime,Z.bytesLoaded>0&&Z.elapsedTime>0&&u(ee,Math.round(Z.bytesLoaded*8/Z.elapsedTime)),M[ee].length>=C&&Z.elapsedTime>g&&Z.bytesLoaded<Z.bytesTotal){var X=M[ee].reduce(function(Ee,ge){return Ee+ge},0);if(Z.measuredBandwidthInKbps=Math.round(X/M[ee].length),Z.estimatedTimeOfDownload=+(Z.bytesTotal*8/Z.measuredBandwidthInKbps/1e3).toFixed(2),Z.estimatedTimeOfDownload<Z.segmentDuration*t||j.getRepresentationInfo().quality===0)return $;if(!c.hasOwnProperty(Z.id)){var te=j.getAbrController(),fe=Z.bytesTotal-Z.bytesLoaded,J=te.getBitrateList(z),ue=te.getQualityForBitrate(z,Z.measuredBandwidthInKbps*m.get().streaming.abr.bandwidthSafetyFactor,w),pe=te.getMinAllowedIndexFor(ee,w),Ce=pe!==void 0?Math.max(pe,ue):ue,ve=Z.bytesTotal*J[Ce].bitrate/J[te.getQualityFor(ee,w)].bitrate;fe>ve&&($.quality=Ce,$.reason.throughput=Z.measuredBandwidthInKbps,$.reason.fragmentID=Z.id,$.reason.rule=this.getClassName(),c[Z.id]=Z,r.debug("["+ee+"] frag id",Z.id," is asking to abandon and switch to quality to ",Ce," measured bandwidth was",Z.measuredBandwidthInKbps),delete d[ee][Z.id])}}else Z.bytesLoaded===Z.bytesTotal&&delete d[ee][Z.id]}return $}function D(){d={},c={},M=[]}return f={shouldAbandon:A,reset:D},n(),f}i.__dashjs_factory_name="AbandonRequestsRule";let E=l.default.getClassFactory(i)},"./src/streaming/rules/abr/BolaRule.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>c});var p=e("./src/streaming/constants/MetricsConstants.js"),l=e("./src/streaming/rules/SwitchRequest.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/streaming/vo/metrics/HTTPRequest.js"),E=e("./src/core/EventBus.js"),h=e("./src/core/events/Events.js"),t=e("./src/core/Debug.js"),g=e("./src/streaming/MediaPlayerEvents.js"),C=e("./src/streaming/constants/Constants.js"),T=0,P=1,R=2,m=10,f=2,r=.99;function d(M){M=M||{};var n=this.context,_=M.dashMetrics,u=M.mediaPlayerModel,A=(0,E.default)(n).getInstance(),D,j,$;function z(){j=(0,t.default)(n).getInstance().getLogger(D),le(),A.on(g.default.BUFFER_EMPTY,J,D),A.on(g.default.PLAYBACK_SEEKING,ue,D),A.on(g.default.METRIC_ADDED,Ce,D),A.on(g.default.QUALITY_CHANGE_REQUESTED,Ee,D),A.on(g.default.FRAGMENT_LOADING_ABANDONED,ge,D),A.on(h.default.MEDIA_FRAGMENT_LOADED,pe,D)}function ee(I){return I.map(function(L){return Math.log(L)})}function k(I,L,K){var U=K.reduce(function(b,F,oe){return F>K[b]?oe:b},0);if(U===0)return null;var x=Math.max(I,m+f*L.length),y=(K[U]-1)/(x/m-1),S=m/y;return{gp:y,Vp:S}}function w(I){var L={},K=I.getMediaInfo(),U=K.bitrateList.map(function(b){return b.bandwidth}),x=ee(U);x=x.map(function(b){return b-x[0]+1});var y=u.getStableBufferTime(),S=k(y,U,x);return S?(L.state=P,L.bitrates=U,L.utilities=x,L.stableBufferTime=y,L.Vp=S.Vp,L.gp=S.gp,L.lastQuality=0,N(L)):L.state=T,L}function N(I){I.placeholderBuffer=0,I.mostAdvancedSegmentStart=NaN,I.lastSegmentWasReplacement=!1,I.lastSegmentStart=NaN,I.lastSegmentDurationS=NaN,I.lastSegmentRequestTimeMs=NaN,I.lastSegmentFinishTimeMs=NaN}function H(I,L){var K=u.getStableBufferTime();if(I.stableBufferTime!==K){var U=k(K,I.bitrates,I.utilities);if(U.Vp!==I.Vp||U.gp!==I.gp){var x=_.getCurrentBufferLevel(L),y=x+I.placeholderBuffer;y-=m,y*=U.Vp/I.Vp,y+=m,I.stableBufferTime=K,I.Vp=U.Vp,I.gp=U.gp,I.placeholderBuffer=Math.max(0,y-x)}}}function W(I){var L=I.getMediaType(),K=$[L];return K?K.state!==T&&H(K,L):(K=w(I),$[L]=K),K}function Z(I,L){for(var K=I.bitrates.length,U=NaN,x=NaN,y=0;y<K;++y){var S=(I.Vp*(I.utilities[y]+I.gp)-L)/I.bitrates[y];(isNaN(x)||S>=x)&&(x=S,U=y)}return U}function X(I,L){return I.Vp*(I.utilities[L]+I.gp)}function te(I,L){for(var K=I.bitrates[L],U=I.utilities[L],x=0,y=L-1;y>=0;--y)if(I.utilities[y]<I.utilities[L]){var S=I.bitrates[y],b=I.utilities[y],F=I.Vp*(I.gp+(K*b-S*U)/(K-S));x=Math.max(x,F)}return x}function fe(I,L){var K=Date.now();if(isNaN(I.lastSegmentFinishTimeMs)){if(!isNaN(I.lastCallTimeMs)){var x=.001*(K-I.lastCallTimeMs);I.placeholderBuffer+=Math.max(0,x)}}else{var U=.001*(K-I.lastSegmentFinishTimeMs);I.placeholderBuffer+=Math.max(0,U)}I.lastCallTimeMs=K,I.lastSegmentStart=NaN,I.lastSegmentRequestTimeMs=NaN,I.lastSegmentFinishTimeMs=NaN,H(I,L)}function J(I){var L=I.mediaType,K=L===C.default.AUDIO?[C.default.AUDIO]:$;for(var U in K)$.hasOwnProperty(U)&&$[U].state===R&&($[U].placeholderBuffer=0)}function ue(){for(var I in $)if($.hasOwnProperty(I)){var L=$[I];L.state!==T&&(L.state=P,N(L))}}function pe(I){if(I&&I.chunk&&I.chunk.mediaInfo){var L=$[I.chunk.mediaInfo.type];if(L&&L.state!==T){var K=I.chunk.start;isNaN(L.mostAdvancedSegmentStart)||K>L.mostAdvancedSegmentStart?(L.mostAdvancedSegmentStart=K,L.lastSegmentWasReplacement=!1):L.lastSegmentWasReplacement=!0,L.lastSegmentStart=K,L.lastSegmentDurationS=I.chunk.duration,L.lastQuality=I.chunk.quality,ve(L,I.chunk.mediaInfo.type)}}}function Ce(I){if(I&&I.metric===p.default.HTTP_REQUEST&&I.value&&I.value.type===i.HTTPRequest.MEDIA_SEGMENT_TYPE&&I.value.trace&&I.value.trace.length){var L=$[I.mediaType];L&&L.state!==T&&(L.lastSegmentRequestTimeMs=I.value.trequest.getTime(),L.lastSegmentFinishTimeMs=I.value._tfinish.getTime(),ve(L,I.mediaType))}}function ve(I,L){if(!isNaN(I.lastSegmentStart)&&!isNaN(I.lastSegmentRequestTimeMs)&&!isNaN(I.placeholderBuffer)){if(I.placeholderBuffer*=r,!isNaN(I.lastSegmentFinishTimeMs)){var K=_.getCurrentBufferLevel(L),U=K+.001*(I.lastSegmentFinishTimeMs-I.lastSegmentRequestTimeMs),x=X(I,I.lastQuality),y=Math.max(0,x-U);I.placeholderBuffer=Math.min(y,I.placeholderBuffer)}I.lastSegmentWasReplacement&&!isNaN(I.lastSegmentDurationS)&&(I.placeholderBuffer+=I.lastSegmentDurationS),I.lastSegmentStart=NaN,I.lastSegmentRequestTimeMs=NaN}}function Ee(I){if(I){var L=$[I.mediaType];L&&L.state!==T&&(L.abrQuality=I.newQuality)}}function ge(I){if(I){var L=$[I.mediaType];if(L&&L.state!==T){var K=_.getCurrentBufferLevel(I.mediaType),U;L.abrQuality>0?U=te(L,L.abrQuality):U=m;var x=Math.max(0,U-K);L.placeholderBuffer=Math.min(L.placeholderBuffer,x)}}}function Q(I){var L=(0,l.default)(n).create();if(!I||!I.hasOwnProperty("getMediaInfo")||!I.hasOwnProperty("getMediaType")||!I.hasOwnProperty("getScheduleController")||!I.hasOwnProperty("getStreamInfo")||!I.hasOwnProperty("getAbrController")||!I.hasOwnProperty("useBufferOccupancyABR"))return L;var K=I.getMediaInfo(),U=I.getMediaType(),x=I.getScheduleController(),y=I.getStreamInfo(),S=I.getAbrController(),b=S.getThroughputHistory(),F=y?y.id:null,oe=y&&y.manifestInfo&&y.manifestInfo.isDynamic,ie=I.useBufferOccupancyABR();if(L.reason=L.reason||{},!ie)return L;x.setTimeToLoadDelay(0);var q=W(I);if(q.state===T)return L;var Ae=_.getCurrentBufferLevel(U),de=b.getAverageThroughput(U,oe),Me=b.getSafeAverageThroughput(U,oe),Ie=b.getAverageLatency(U),He;if(L.reason.state=q.state,L.reason.throughput=de,L.reason.latency=Ie,isNaN(de))return L;switch(q.state){case P:He=S.getQualityForBitrate(K,Me,F,Ie),L.quality=He,L.reason.throughput=Me,q.placeholderBuffer=Math.max(0,te(q,He)-Ae),q.lastQuality=He,!isNaN(q.lastSegmentDurationS)&&Ae>=q.lastSegmentDurationS&&(q.state=R);break;case R:fe(q,U),He=Z(q,Ae+q.placeholderBuffer);var Be=S.getQualityForBitrate(K,Me,F,Ie);He>q.lastQuality&&He>Be&&(He=Math.max(Be,q.lastQuality));var ze=Math.max(0,Ae+q.placeholderBuffer-X(q,He));ze<=q.placeholderBuffer?(q.placeholderBuffer-=ze,ze=0):(ze-=q.placeholderBuffer,q.placeholderBuffer=0,He<S.getMaxAllowedIndexFor(U,F)?x.setTimeToLoadDelay(1e3*ze):ze=0),L.quality=He,L.reason.throughput=de,L.reason.latency=Ie,L.reason.bufferLevel=Ae,L.reason.placeholderBuffer=q.placeholderBuffer,L.reason.delay=ze,q.lastQuality=He;break;default:j.debug("BOLA ABR rule invoked in bad state."),L.quality=S.getQualityForBitrate(K,Me,F,Ie),L.reason.state=q.state,L.reason.throughput=Me,L.reason.latency=Ie,q.state=P,N(q)}return L}function le(){$={}}function Y(){le(),A.off(g.default.BUFFER_EMPTY,J,D),A.off(g.default.PLAYBACK_SEEKING,ue,D),A.off(g.default.METRIC_ADDED,Ce,D),A.off(g.default.QUALITY_CHANGE_REQUESTED,Ee,D),A.off(g.default.FRAGMENT_LOADING_ABANDONED,ge,D),A.off(h.default.MEDIA_FRAGMENT_LOADED,pe,D)}return D={getMaxIndex:Q,reset:Y},z(),D}d.__dashjs_factory_name="BolaRule";let c=o.default.getClassFactory(d)},"./src/streaming/rules/abr/DroppedFramesRule.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/rules/SwitchRequest.js"),o=e("./src/core/Debug.js");function i(){var h=this.context,t,g,C=.15,T=375;function P(){g=(0,o.default)(h).getInstance().getLogger(t)}function R(m){var f=(0,l.default)(h).create();if(!m||!m.hasOwnProperty("getDroppedFramesHistory"))return f;var r=m.getDroppedFramesHistory(),d=m.getStreamInfo().id;if(r){var c=r.getFrameHistory(d);if(!c||c.length===0)return f;for(var M=0,n=0,_=l.default.NO_CHANGE,u=1;u<c.length;u++)if(c[u]&&(M=c[u].droppedVideoFrames,n=c[u].totalVideoFrames,n>T&&M/n>C)){_=u-1,g.debug("index: "+_+" Dropped Frames: "+M+" Total Frames: "+n);break}return(0,l.default)(h).create(_,{droppedFrames:M})}return f}return t={getMaxIndex:R},P(),t}i.__dashjs_factory_name="DroppedFramesRule";let E=p.default.getClassFactory(i)},"./src/streaming/rules/abr/InsufficientBufferRule.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/core/EventBus.js"),l=e("./src/core/events/Events.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/core/Debug.js"),E=e("./src/streaming/rules/SwitchRequest.js"),h=e("./src/streaming/constants/Constants.js"),t=e("./src/streaming/constants/MetricsConstants.js"),g=e("./src/streaming/MediaPlayerEvents.js");function C(P){P=P||{};var R=.5,m=2,f=this.context,r=(0,p.default)(f).getInstance(),d=P.dashMetrics,c,M,n;function _(){M=(0,i.default)(f).getInstance().getLogger(c),j(),r.on(g.default.PLAYBACK_SEEKING,$,c),r.on(l.default.BYTES_APPENDED_END_FRAGMENT,z,c)}function u(){if(!d||!d.hasOwnProperty("getCurrentBufferLevel")||!d.hasOwnProperty("getCurrentBufferState"))throw new Error(h.default.MISSING_CONFIG_ERROR)}function A(k){var w=(0,E.default)(f).create();if(!k||!k.hasOwnProperty("getMediaType"))return w;u();var N=k.getMediaType(),H=d.getCurrentBufferState(N),W=k.getRepresentationInfo(),Z=W.fragmentDuration,X=k.getStreamInfo(),te=X?X.id:null,fe=k.getScheduleController(),J=X&&X.manifestInfo&&X.manifestInfo.isDynamic,ue=fe.getPlaybackController(),pe=ue.getLowLatencyModeEnabled();if(D(pe,N)||!Z)return w;if(H&&H.state===t.default.BUFFER_EMPTY)M.debug("["+N+"] Switch to index 0; buffer is empty."),w.quality=0,w.reason="InsufficientBufferRule: Buffer is empty";else{var Ce=k.getMediaInfo(),ve=k.getAbrController(),Ee=ve.getThroughputHistory(),ge=d.getCurrentBufferLevel(N),Q=Ee.getAverageThroughput(N,J),le=Ee.getAverageLatency(N),Y=Q*(ge/Z)*R;w.quality=ve.getQualityForBitrate(Ce,Y,te,le),w.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return w}function D(k,w){return!k&&n[w].ignoreCount>0}function j(){n={},n[h.default.VIDEO]={ignoreCount:m},n[h.default.AUDIO]={ignoreCount:m}}function $(){j()}function z(k){!isNaN(k.startTime)&&(k.mediaType===h.default.AUDIO||k.mediaType===h.default.VIDEO)&&n[k.mediaType].ignoreCount>0&&n[k.mediaType].ignoreCount--}function ee(){j(),r.off(g.default.PLAYBACK_SEEKING,$,c),r.off(l.default.BYTES_APPENDED_END_FRAGMENT,z,c)}return c={getMaxIndex:A,reset:ee},_(),c}C.__dashjs_factory_name="InsufficientBufferRule";let T=o.default.getClassFactory(C)},"./src/streaming/rules/abr/L2ARule.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/streaming/constants/MetricsConstants.js"),l=e("./src/streaming/rules/SwitchRequest.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/streaming/vo/metrics/HTTPRequest.js"),E=e("./src/core/EventBus.js"),h=e("./src/core/events/Events.js"),t=e("./src/core/Debug.js"),g=e("./src/streaming/constants/Constants.js"),C=0,T=1,P=2;function R(f){f=f||{};var r=this.context,d=f.dashMetrics,c=(0,E.default)(r).getInstance(),M,n,_,u;function A(){u=(0,t.default)(r).getInstance().getLogger(M),te(),c.on(h.default.PLAYBACK_SEEKING,ee,M),c.on(h.default.MEDIA_FRAGMENT_LOADED,k,M),c.on(h.default.METRIC_ADDED,w,M),c.on(h.default.QUALITY_CHANGE_REQUESTED,H,M)}function D(J){var ue={},pe=J.getMediaInfo(),Ce=pe.bitrateList.map(function(ve){return ve.bandwidth/1e3});return ue.state=T,ue.bitrates=Ce,ue.lastQuality=0,j(pe),$(ue),ue}function j(J){!J||!J.type||(_[J.type]={},_[J.type].w=[],_[J.type].prev_w=[],_[J.type].Q=0,_[J.type].segment_request_start_s=0,_[J.type].segment_download_finish_s=0,_[J.type].B_target=1.5)}function $(J){J.placeholderBuffer=0,J.mostAdvancedSegmentStart=NaN,J.lastSegmentWasReplacement=!1,J.lastSegmentStart=NaN,J.lastSegmentDurationS=NaN,J.lastSegmentRequestTimeMs=NaN,J.lastSegmentFinishTimeMs=NaN,J.lastSegmentUrl=""}function z(J){var ue=J.getMediaType(),pe=n[ue];return pe||(pe=D(J),n[ue]=pe),pe}function ee(){for(var J in n)if(n.hasOwnProperty(J)){var ue=n[J];ue.state!==C&&(ue.state=T,$(ue))}}function k(J){if(J&&J.chunk&&J.chunk.mediaInfo){var ue=n[J.chunk.mediaInfo.type],pe=_[J.chunk.mediaInfo.type];if(ue&&ue.state!==C){var Ce=J.chunk.start;isNaN(ue.mostAdvancedSegmentStart)||Ce>ue.mostAdvancedSegmentStart?(ue.mostAdvancedSegmentStart=Ce,ue.lastSegmentWasReplacement=!1):ue.lastSegmentWasReplacement=!0,ue.lastSegmentStart=Ce,ue.lastSegmentDurationS=J.chunk.duration,ue.lastQuality=J.chunk.quality,N(ue,pe)}}}function w(J){if(J&&J.metric===p.default.HTTP_REQUEST&&J.value&&J.value.type===i.HTTPRequest.MEDIA_SEGMENT_TYPE&&J.value.trace&&J.value.trace.length){var ue=n[J.mediaType],pe=_[J.mediaType];ue&&ue.state!==C&&(ue.lastSegmentRequestTimeMs=J.value.trequest.getTime(),ue.lastSegmentFinishTimeMs=J.value._tfinish.getTime(),N(ue,pe))}}function N(J,ue){!isNaN(J.lastSegmentStart)&&!isNaN(J.lastSegmentRequestTimeMs)&&(ue.segment_request_start_s=.001*J.lastSegmentRequestTimeMs,ue.segment_download_finish_s=.001*J.lastSegmentFinishTimeMs,J.lastSegmentStart=NaN,J.lastSegmentRequestTimeMs=NaN)}function H(J){if(J&&J.mediaType){var ue=n[J.mediaType];ue&&ue.state!==C&&(ue.abrQuality=J.newQuality)}}function W(J,ue){if(J.length!==ue.length)return-1;for(var pe=0,Ce=0;Ce<J.length;Ce++)pe=pe+J[Ce]*ue[Ce];return pe}function Z(J){for(var ue=J.length,pe=!1,Ce=[],ve=0;ve<ue;++ve)Ce[ve]=J[ve];for(var Ee=J.sort(function(L,K){return K-L}),ge=0,Q=0,le=[],Y=0;Y<ue-1;++Y)if(ge=ge+Ee[Y],Q=(ge-1)/(Y+1),Q>=Ee[Y+1]){pe=!0;break}pe||(Q=(ge+Ee[ue-1]-1)/ue);for(var I=0;I<ue;++I)le[I]=Math.max(Ce[I]-Q,0);return le}function X(J){var ue=(0,l.default)(r).create(),pe=4,Ce=Math.pow(pe,.99),ve=Math.max(Math.pow(pe,1),Ce*Math.sqrt(pe)),Ee=J.getMediaInfo(),ge=J.getMediaType(),Q=Ee.bitrateList.map(function(xe){return xe.bandwidth}),le=Q.length,Y=J.getScheduleController(),I=J.getStreamInfo(),L=J.getAbrController(),K=L.getThroughputHistory(),U=I&&I.manifestInfo&&I.manifestInfo.isDynamic,x=J.useL2AABR(),y=d.getCurrentBufferLevel(ge,!0),S=K.getSafeAverageThroughput(ge,U),b=K.getAverageThroughput(ge,U),F=2,oe=K.getAverageLatency(ge),ie=J.getVideoModel(),q,Ae=ie.getPlaybackRate();if(!J||!J.hasOwnProperty("getMediaInfo")||!J.hasOwnProperty("getMediaType")||!J.hasOwnProperty("getScheduleController")||!J.hasOwnProperty("getStreamInfo")||!J.hasOwnProperty("getAbrController")||!J.hasOwnProperty("useL2AABR")||(ue.reason=ue.reason||{},!x||ge===g.default.AUDIO))return ue;Y.setTimeToLoadDelay(0);var de=z(J);if(de.state===C)return ue;var Me=_[ge];if(!Me||(ue.reason.state=de.state,ue.reason.throughput=b,ue.reason.latency=oe,isNaN(b)))return ue;switch(de.state){case T:if(q=L.getQualityForBitrate(Ee,S,I.id,oe),ue.quality=q,ue.reason.throughput=S,de.lastQuality=q,!isNaN(de.lastSegmentDurationS)&&y>=Me.B_target){de.state=P,Me.Q=Ce;for(var Ie=0;Ie<le;++Ie)Ie===de.lastQuality?Me.prev_w[Ie]=1:Me.prev_w[Ie]=0}break;case P:var He=[],Be=d.getCurrentHttpRequest(ge).trace.reduce(function(xe,we){return xe+we.d},0),ze=d.getCurrentHttpRequest(ge).trace.reduce(function(xe,we){return xe+we.b[0]},0),Ye=Math.round(8*ze/Be),Te=d.getCurrentHttpRequest(ge);if(Ye<1&&(Ye=1),Te.url===de.lastSegmentUrl||Te.type===i.HTTPRequest.INIT_SEGMENT_TYPE)q=de.lastQuality;else{for(var Fe=de.lastSegmentDurationS,ot=1,st=0;st<le;++st)Q[st]=Q[st]/1e3,Ae*Q[st]>Ye&&(ot=-1),Me.w[st]=Me.prev_w[st]+ot*(Fe/(2*ve))*((Me.Q+Ce)*(Ae*Q[st]/Ye));Me.w=Z(Me.w);for(var at=0;at<le;++at)He[at]=Me.w[at]-Me.prev_w[at],Me.prev_w[at]=Me.w[at];Me.Q=Math.max(0,Me.Q-Fe+Fe*Ae*((W(Q,Me.prev_w)+W(Q,He))/Ye));for(var ht=[],Tt=0;Tt<le;++Tt)ht[Tt]=Math.abs(Q[Tt]-W(Me.w,Q));q=ht.indexOf(Math.min.apply(Math,ht)),q>de.lastQuality&&Q[de.lastQuality+1]<=Ye&&(q=de.lastQuality+1),Q[q]>=Ye&&(Me.Q=F*Math.max(Ce,Me.Q)),de.lastSegment.url=Te.url}ue.quality=q,ue.reason.throughput=b,ue.reason.latency=oe,ue.reason.bufferLevel=y,de.lastQuality=ue.quality;break;default:u.debug("L2A ABR rule invoked in bad state."),ue.quality=L.getQualityForBitrate(Ee,S,I.id,oe),ue.reason.state=de.state,ue.reason.throughput=S,ue.reason.latency=oe,de.state=T,$(de)}return ue}function te(){n={},_={}}function fe(){te(),c.off(h.default.PLAYBACK_SEEKING,ee,M),c.off(h.default.MEDIA_FRAGMENT_LOADED,k,M),c.off(h.default.METRIC_ADDED,w,M),c.off(h.default.QUALITY_CHANGE_REQUESTED,H,M)}return M={getMaxIndex:X,reset:fe},A(),M}R.__dashjs_factory_name="L2ARule";let m=o.default.getClassFactory(R)},"./src/streaming/rules/abr/SwitchHistoryRule.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/streaming/rules/SwitchRequest.js");function i(){var h=this.context,t,g,C=.075,T=6;function P(){g=(0,l.default)(h).getInstance().getLogger(t)}function R(m){for(var f=m?m.getSwitchHistory():null,r=f?f.getSwitchRequests():[],d=0,c=0,M=0,n=(0,o.default)(h).create(),_=0;_<r.length;_++)if(r[_]!==void 0&&(d+=r[_].drops,c+=r[_].noDrops,M+=r[_].dropSize,d+c>=T&&d/c>C)){n.quality=_>0&&r[_].drops>0?_-1:_,n.reason={index:n.quality,drops:d,noDrops:c,dropSize:M},g.debug("Switch history rule index: "+n.quality+" samples: "+(d+c)+" drops: "+d);break}return n}return t={getMaxIndex:R},P(),t}i.__dashjs_factory_name="SwitchHistoryRule";let E=p.default.getClassFactory(i)},"./src/streaming/rules/abr/ThroughputRule.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/rules/SwitchRequest.js"),o=e("./src/streaming/constants/Constants.js"),i=e("./src/streaming/constants/MetricsConstants.js");function E(t){t=t||{};var g=this.context,C=t.dashMetrics,T;function P(){}function R(){if(!C||!C.hasOwnProperty("getCurrentBufferState"))throw new Error(o.default.MISSING_CONFIG_ERROR)}function m(r){var d=(0,l.default)(g).create();if(!r||!r.hasOwnProperty("getMediaInfo")||!r.hasOwnProperty("getMediaType")||!r.hasOwnProperty("useBufferOccupancyABR")||!r.hasOwnProperty("getAbrController")||!r.hasOwnProperty("getScheduleController"))return d;R();var c=r.getMediaInfo(),M=r.getMediaType(),n=C.getCurrentBufferState(M),_=r.getScheduleController(),u=r.getAbrController(),A=r.getStreamInfo(),D=A?A.id:null,j=A&&A.manifestInfo?A.manifestInfo.isDynamic:null,$=u.getThroughputHistory(),z=$.getSafeAverageThroughput(M,j),ee=$.getAverageLatency(M),k=r.useBufferOccupancyABR();return isNaN(z)||!n||k||u.getAbandonmentStateFor(D,M)!==i.default.ABANDON_LOAD&&(n.state===i.default.BUFFER_LOADED||j)&&(d.quality=u.getQualityForBitrate(c,z,D,ee),_.setTimeToLoadDelay(0),d.reason={throughput:z,latency:ee}),d}function f(){}return T={getMaxIndex:m,reset:f},T}E.__dashjs_factory_name="ThroughputRule";let h=p.default.getClassFactory(E)},"./src/streaming/rules/abr/lolp/LearningAbrController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o={MANUAL:"manual_weight_selection",RANDOM:"random_weight_selection",DYNAMIC:"dynamic_weight_selection"};function i(){var h=this.context,t,g,C,T,P,R,m,f,r;function d(){g=(0,l.default)(h).getInstance().getLogger(t),M()}function c(){M()}function M(){C=null,T=1,P=100,R=0,m=null,f=null,r=o.DYNAMIC}function n(){var X=0;if(C)for(var te=0;te<C.length;te++){var fe=C[te];fe.state.throughput>X&&(X=fe.state.throughput)}return X}function _(X){var te=X.map(function(fe){return Math.pow(fe,2)}).reduce(function(fe,J){return fe+J});return Math.sqrt(te)}function u(X,te,fe){var J=X.map(function(pe,Ce){return fe[Ce]*Math.pow(pe-te[Ce],2)}).reduce(function(pe,Ce){return pe+Ce}),ue=J<0?-1:1;return ue*Math.sqrt(Math.abs(J))}function A(X,te){var fe=[X.state.throughput,X.state.latency,X.state.rebuffer,X.state.switch],J=[te.state.throughput,te.state.latency,te.state.rebuffer,te.state.switch];return u(fe,J,[1,1,1,1])}function D(X,te,fe){for(var J=0;J<te.length;J++){var ue=te[J],pe=.1,Ce=A(ue,X),ve=Math.exp(-1*Math.pow(Ce,2)/(2*Math.pow(pe,2)));j(ue,fe,ve)}}function j(X,te,fe){var J=X.state,ue=[.01,.01,.01,.01];J.throughput=J.throughput+(te[0]-J.throughput)*ue[0]*fe,J.latency=J.latency+(te[1]-J.latency)*ue[1]*fe,J.rebuffer=J.rebuffer+(te[2]-J.rebuffer)*ue[2]*fe,J.switch=J.switch+(te[3]-J.switch)*ue[3]*fe}function $(X,te){var fe=0,J=X;if(C)for(var ue=0;ue<C.length;ue++){var pe=C[ue];pe.bitrate<X.bitrate&&pe.bitrate>fe&&te>pe.bitrate&&(fe=pe.bitrate,J=pe)}return J}function z(X,te,fe,J,ue,pe,Ce){var ve=fe,Ee=J,ge=te,Q=H(X),le=te/T;le>1&&(le=n()),fe=fe/P;var Y=0,I=0,L=0,K=1e4;g.debug("getNextQuality called throughput:".concat(le," latency:").concat(fe," bufferSize:").concat(J," currentQualityIndex:").concat(pe," playbackRate:").concat(ue));var U=Q[pe],x=U.bitrate*Ce.getSegmentDuration()/ge,y=Math.max(0,x-Ee);if(Ee-x<Ce.getMinBuffer())return g.debug("Buffer is low for bitrate= ".concat(U.bitrate," downloadTime=").concat(x," currentBuffer=").concat(Ee," rebuffer=").concat(y)),$(U,ge).qualityIndex;switch(r){case o.MANUAL:ee();break;case o.RANDOM:k(Q);break;case o.DYNAMIC:w(Ce,Q,ve,Ee,y,ge,ue);break;default:w(Ce,Q,ve,Ee,y,ge,ue)}for(var S=null,b=null,F=null,oe=0;oe<Q.length;oe++){var ie=Q[oe],q=ie.state,Ae=[q.throughput,q.latency,q.rebuffer,q.switch],de=m.slice(),Me=Ce.getNextBufferWithBitrate(ie.bitrate,Ee,ge),Ie=Me<Ce.getMinBuffer();Ie&&g.debug("Buffer is low for bitrate=".concat(ie.bitrate," downloadTime=").concat(x," currentBuffer=").concat(Ee," nextBuffer=").concat(Me)),(ie.bitrate>te-K||Ie)&&ie.bitrate!==R&&(de[0]=100);var He=u(Ae,[le,Y,I,L],de);(S===null||He<S)&&(S=He,b=ie.qualityIndex,F=ie)}var Be=Math.abs(U.bitrate-F.bitrate)/T;return D(U,Q,[le,fe,y,Be]),D(F,Q,[le,Y,I,Be]),b}function ee(){var X=.4,te=.4,fe=.4,J=.4;m=[X,te,fe,J]}function k(X){m=N(X.length,4)}function w(X,te,fe,J,ue,pe,Ce){m||(m=f[f.length-1]);var ve=X.findWeightVector(te,fe,J,ue,pe,Ce);ve!==null&&ve!==-1&&(m=ve)}function N(X,te){for(var fe=[],J=Math.sqrt(2/X),ue=0;ue<te;ue++)fe.push(Math.random()*J);return m=fe,m}function H(X){if(!C){C=[];var te=X.bitrateList,fe=[];R=te[0].bandwidth,te.forEach(function(pe){fe.push(pe.bandwidth),pe.bandwidth<R&&(R=pe.bandwidth)}),T=_(fe);for(var J=0;J<te.length;J++){var ue={qualityIndex:J,bitrate:te[J].bandwidth,state:{throughput:te[J].bandwidth/T,latency:0,rebuffer:0,switch:0}};C.push(ue)}f=Z(C)}return C}function W(X){for(var te=[],fe=0;fe<X;fe++){var J=[Math.random()*n(),Math.random(),Math.random(),Math.random()];te.push(J)}return te}function Z(X){var te=[],fe=W(Math.pow(X.length,2));te.push(fe[0]);for(var J=[1,1,1,1],ue=1;ue<X.length;ue++){for(var pe=null,Ce=null,ve=0;ve<fe.length;ve++){for(var Ee=fe[ve],ge=null,Q=0;Q<te.length;Q++){var le=u(Ee,te[Q],J);(ge===null||le<ge)&&(ge=le)}(Ce===null||ge>Ce)&&(pe=Ee,Ce=ge)}te.push(pe)}for(var Y=null,I=null,L=0;L<te.length;L++){for(var K=0,U=0;U<te.length;U++)L!==U&&(K+=u(te[L],te[U],J));(Y===null||K>Y)&&(Y=K,I=L)}var x=[];for(x.push(te[I]),te.splice(I,1);te.length>0;){for(var y=null,S=null,b=0;b<te.length;b++){var F=u(x[0],te[b],J);(y===null||F<y)&&(y=F,S=b)}x.push(te[S]),te.splice(S,1)}return x}return t={getNextQuality:z,reset:c},d(),t}i.__dashjs_factory_name="LearningAbrController";let E=p.default.getClassFactory(i)},"./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/rules/abr/lolp/QoeInfo.js");function o(){var E,h,t,g,C;function T(){P()}function P(){h=null,t=null,g=null,C=null}function R(n,_,u){h=m("segment",n,_,u),t=n,g=_,C=u}function m(n,_,u,A){var D=new l.default;return D.type=n,_?D.weights.bitrateReward=_:D.weights.bitrateReward=1,D.weights.bitrateSwitchPenalty=1,u?D.weights.rebufferPenalty=u:D.weights.rebufferPenalty=1e3,D.weights.latencyPenalty=[],D.weights.latencyPenalty.push({threshold:1.1,penalty:A*.05}),D.weights.latencyPenalty.push({threshold:1e8,penalty:u*.1}),A?D.weights.playbackSpeedPenalty=A:D.weights.playbackSpeedPenalty=200,D}function f(n,_,u,A){h&&r(n,_,u,A,h)}function r(n,_,u,A,D){D.bitrateWSum+=D.weights.bitrateReward*n,D.lastBitrate&&(D.bitrateSwitchWSum+=D.weights.bitrateSwitchPenalty*Math.abs(n-D.lastBitrate)),D.lastBitrate=n,D.rebufferWSum+=D.weights.rebufferPenalty*_;for(var j=0;j<D.weights.latencyPenalty.length;j++){var $=D.weights.latencyPenalty[j];if(u<=$.threshold){D.latencyWSum+=$.penalty*u;break}}D.playbackSpeedWSum+=D.weights.playbackSpeedPenalty*Math.abs(1-A),D.totalQoe=D.bitrateWSum-D.bitrateSwitchWSum-D.rebufferWSum-D.latencyWSum-D.playbackSpeedWSum}function d(){return h}function c(n,_,u,A){var D=null;return t&&g&&C&&(D=m("segment",t,g,C)),D?(r(n,_,u,A,D),D.totalQoe):0}function M(){P()}return E={setupPerSegmentQoe:R,logSegmentMetrics:f,getPerSegmentQoe:d,calculateSingleUseQoe:c,reset:M},T(),E}o.__dashjs_factory_name="LoLpQoeEvaluator";let i=p.default.getClassFactory(o)},"./src/streaming/rules/abr/lolp/LoLpRule.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/core/Debug.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/streaming/rules/abr/lolp/LearningAbrController.js"),i=e("./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js"),E=e("./src/streaming/rules/SwitchRequest.js"),h=e("./src/streaming/constants/MetricsConstants.js"),t=e("./src/streaming/rules/abr/lolp/LoLpWeightSelector.js"),g=e("./src/streaming/constants/Constants.js"),C=1.5,T=.3;function P(m){m=m||{};var f=m.dashMetrics,r=this.context,d,c,M,n;function _(){d=(0,p.default)(r).getInstance().getLogger(c),M=(0,o.default)(r).create(),n=(0,i.default)(r).create()}function u(j){try{var $=(0,E.default)(r).create(),z=j.getMediaInfo().type,ee=j.getAbrController(),k=j.getStreamInfo(),w=ee.getQualityFor(z,k.id),N=j.getMediaInfo(),H=f.getCurrentBufferState(z),W=j.getScheduleController(),Z=f.getCurrentBufferLevel(z,!0),X=k&&k.manifestInfo?k.manifestInfo.isDynamic:null,te=W.getPlaybackController(),fe=te.getCurrentLiveLatency();if(!j.useLoLPABR()||z===g.default.AUDIO)return $;fe||(fe=0);var J=te.getPlaybackRate(),ue=ee.getThroughputHistory(),pe=ue.getSafeAverageThroughput(z,X);if(d.debug("Throughput ".concat(Math.round(pe)," kbps")),isNaN(pe)||!H||ee.getAbandonmentStateFor(k.id,z)===h.default.ABANDON_LOAD)return $;for(var Ce=N.bitrateList,ve=j.getRepresentationInfo().fragmentDuration,Ee=Ce[0].bandwidth/1e3,ge=Ce[Ce.length-1].bandwidth/1e3,Q=0;Q<Ce.length;Q++){var le=Ce[Q].bandwidth/1e3;le>ge?ge=le:le<Ee&&(Ee=le)}var Y=Ce[w].bandwidth,I=Y/1e3,L=f.getCurrentHttpRequest(z,!0),K=(L.tresponse.getTime()-L.trequest.getTime())/1e3,U=K>ve?K-ve:0;n.setupPerSegmentQoe(ve,ge,Ee),n.logSegmentMetrics(I,U,fe,J);var x=(0,t.default)(r).create({targetLatency:C,bufferMin:T,segmentDuration:ve,qoeEvaluator:n});return $.quality=M.getNextQuality(N,pe*1e3,fe,Z,J,w,x),$.reason={throughput:pe,latency:fe},$.priority=E.default.PRIORITY.STRONG,W.setTimeToLoadDelay(0),$.quality!==w&&d.debug("[TgcLearningRule]["+z+"] requesting switch to index: ",$.quality,"Average throughput",Math.round(pe),"kbps"),$}catch(y){throw y}}function A(){M.reset(),n.reset()}function D(){A()}return c={getMaxIndex:u,reset:D},_(),c}P.__dashjs_factory_name="LoLPRule";let R=l.default.getClassFactory(P)},"./src/streaming/rules/abr/lolp/LoLpWeightSelector.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(i){var E=i.targetLatency,h=i.bufferMin,t=i.segmentDuration,g=i.qoeEvaluator,C,T,P,R,m;function f(){r()}function r(){T=[.2,.4,.6,.8,1],P=4,R=M(T,P),m=0}function d(D,j,$,z,ee,k){var w=null,N=null,H=null,W=Math.abs(j-m);return D.forEach(function(Z){R.forEach(function(X){var te={throughput:X[0],latency:X[1],buffer:X[2],switch:X[3]},fe=Z.bitrate*t/ee,J=A($,fe),ue=Math.max(1e-5,fe-J),pe;te.buffer===0?pe=10:pe=1/te.buffer;var Ce=pe*ue;te.latency===0?pe=10:pe=1/te.latency;var ve=pe*Z.state.latency,Ee=g.calculateSingleUseQoe(Z.bitrate,Ce,ve,k);(w===null||Ee>w)&&c(j,J,W)&&(w=Ee,N=X,H=Z.bitrate)})}),N===null&&H===null&&(N=-1),m=j,N}function c(D,j,$){return D>E+$?!1:j>=h}function M(D,j){var $=D.map(function(ee){return[ee]}),z=function ee(k,w,N){if(N===w)return k;for(var H=k.length,W=0;W<H;W++)for(var Z=k.shift(),X=0;X<D.length;X++)k.push(Z.concat(D[X]));return ee(k,w,N+1)};return z($,j,1)}function n(){return h}function _(){return t}function u(D,j,$){var z=D*t/$;return A(j,z)}function A(D,j){var $=_(),z;return j>$?z=D-$:z=D+$-j,z}return C={getMinBuffer:n,getSegmentDuration:_,getNextBufferWithBitrate:u,getNextBuffer:A,findWeightVector:d},f(),C}l.__dashjs_factory_name="LoLpWeightSelector";let o=p.default.getClassFactory(l)},"./src/streaming/rules/abr/lolp/QoeInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0};let o=l},"./src/streaming/text/EmbeddedTextHtmlRender.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(){var i=0,E;function h(m){for(var f="",r=0;r<m.length;++r){var d=m[r];f+=d.uchar}var c=f.length,M=f.replace(/^\s+/,"").length;return c-M}function t(m){return"left: "+m.x*3.125+"%; top: "+m.y1*6.66+"%; width: "+(100-m.x*3.125)+"%; height: "+Math.max(m.y2-1-m.y1,1)*6.66+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function g(m){return m==="red"?"rgb(255, 0, 0)":m==="green"?"rgb(0, 255, 0)":m==="blue"?"rgb(0, 0, 255)":m==="cyan"?"rgb(0, 255, 255)":m==="magenta"?"rgb(255, 0, 255)":m==="yellow"?"rgb(255, 255, 0)":m==="white"?"rgb(255, 255, 255)":m==="black"?"rgb(0, 0, 0)":m}function C(m,f){var r=m.videoHeight/15;return f?"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(f.foreground?g(f.foreground):"rgb(255, 255, 255)")+"; font-style: "+(f.italics?"italic":"normal")+"; text-decoration: "+(f.underline?"underline":"none")+"; white-space: pre; background-color: "+(f.background?g(f.background):"transparent")+";":"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function T(m){return m.replace(/^\s+/g,"")}function P(m){return m.replace(/\s+$/g,"")}function R(m,f,r,d){var c=null,M=null,n=!1,_=-1,u={start:f,end:r,spans:[]},A="style_cea608_white_black",D={},j={},$=[],z,ee;for(z=0;z<15;++z){var k=d.rows[z],w="",N=null;if(k.isEmpty()===!1){var H=h(k.chars);c===null&&(c={x:H,y1:z,y2:z+1,p:[]}),H!==_&&n&&(c.p.push(u),u={start:f,end:r,spans:[]},c.y2=z,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,D.hasOwnProperty(c.name)===!1?($.push(c),D[c.name]=c):(M=D[c.name],M.p.contat(c.p)),c={x:H,y1:z,y2:z+1,p:[]});for(var W=0;W<k.chars.length;++W){var Z=k.chars[W],X=Z.penState;if(N===null||!X.equals(N)){w.trim().length>0&&(u.spans.push({name:A,line:w,row:z}),w="");var te="style_cea608_"+X.foreground+"_"+X.background;X.underline&&(te+="_underline"),X.italics&&(te+="_italics"),j.hasOwnProperty(te)||(j[te]=JSON.parse(JSON.stringify(X))),N=X,A=te}w+=Z.uchar}w.trim().length>0&&u.spans.push({name:A,line:w,row:z}),n=!0,_=H}else n=!1,_=-1,c&&(c.p.push(u),u={start:f,end:r,spans:[]},c.y2=z,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,D.hasOwnProperty(c.name)===!1?($.push(c),D[c.name]=c):(M=D[c.name],M.p.contat(c.p)),c=null)}c&&(c.p.push(u),c.y2=z+1,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,D.hasOwnProperty(c.name)===!1?($.push(c),D[c.name]=c):(M=D[c.name],M.p.contat(c.p)),c=null);var fe=[];for(z=0;z<$.length;++z){var J=$[z],ue="sub_cea608_"+i++,pe=document.createElement("div");pe.id=ue;var Ce=t(J);pe.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+Ce;var ve=document.createElement("div");ve.className="paragraph bodyStyle",ve.style.cssText=C(m);var Ee=document.createElement("div");Ee.className="cueUniWrapper",Ee.style.cssText="unicode-bidi: normal; direction: ltr;";for(var ge=0;ge<J.p.length;++ge){var Q=J.p[ge],le=0;for(ee=0;ee<Q.spans.length;++ee){var Y=Q.spans[ee];if(Y.line.length>0){if(ee!==0&&le!=Y.row){var I=document.createElement("br");I.className="lineBreak",Ee.appendChild(I)}var L=!1;le===Y.row&&(L=!0),le=Y.row;var K=j[Y.name],U=document.createElement("span");U.className="spanPadding "+Y.name+" customSpanColor",U.style.cssText=C(m,K),ee!==0&&L?ee===Q.spans.length-1?U.textContent=P(Y.line):U.textContent=Y.line:Q.spans.length>1&&ee<Q.spans.length-1&&Y.row===Q.spans[ee+1].row?U.textContent=T(Y.line):U.textContent=Y.line.trim(),Ee.appendChild(U)}}}ve.appendChild(Ee),pe.appendChild(ve);var x={bodyStyle:["%",90]};for(var y in j)j.hasOwnProperty(y)&&(x[y]=["%",90]);fe.push({type:"html",start:f,end:r,cueHTMLElement:pe,cueID:ue,cellResolution:[32,15],isFromCEA608:!0,fontSize:x,lineHeight:{},linePadding:{}})}return fe}return E={createHTMLCaptionsFromScreen:R},E}l.__dashjs_factory_name="EmbeddedTextHtmlRender";let o=p.default.getSingletonFactory(l)},"./src/streaming/text/NotFragmentedTextBufferController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>T});var p=e("./src/core/EventBus.js"),l=e("./src/core/events/Events.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/streaming/utils/InitCache.js"),E=e("./src/streaming/SourceBufferSink.js"),h=e("./src/streaming/vo/DashJSError.js"),t=e("./src/core/errors/Errors.js"),g="NotFragmentedTextBufferController";function C(P){P=P||{};var R=this.context,m=(0,p.default)(R).getInstance(),f=P.textController,r=P.errHandler,d=P.streamInfo,c=P.type,M,n,_,u,A,D;function j(){_=!1,u=null,n=!1,D=(0,i.default)(R).getInstance(),m.on(l.default.INIT_FRAGMENT_LOADED,Ce,M)}function $(){return g}function z(F){H(F)}function ee(F){return new Promise(function(oe,ie){try{A=(0,E.default)(R).create({mediaSource:u,textController:f,eventBus:m}),A.initializeForFirstUse(d,F),_||(A.getBuffer()&&typeof A.getBuffer().initialize=="function"&&A.getBuffer().initialize(),_=!0),oe(A)}catch(q){r.error(new h.default(t.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,t.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+c)),ie(q)}})}function k(){return d.id}function w(){return c}function N(){return A}function H(F){u=F}function W(){return u}function Z(){return!1}function X(){}function te(){return 0}function fe(){return n}function J(F){n!==F&&(n=F,n&&b(l.default.BUFFERING_COMPLETED))}function ue(F){m.off(l.default.INIT_FRAGMENT_LOADED,Ce,M),!F&&A&&(A.abort(),A.reset(),A=null)}function pe(F){return D.extract(d.id,F)!==null}function Ce(F){!F.chunk.bytes||n||(D.save(F.chunk),A.append(F.chunk),J(!0))}function ve(){return null}function Ee(){return!0}function ge(){return[]}function Q(){return Number.POSITIVE_INFINITY}function le(){return Promise.resolve()}function Y(){}function I(){return Promise.resolve()}function L(){return Promise.resolve()}function K(){return n=!1,Promise.resolve()}function U(){return Promise.resolve()}function x(){}function y(){}function S(){return Promise.resolve()}function b(F,oe){var ie=oe||{};m.trigger(F,ie,{streamId:d.id,mediaType:c})}return M={initialize:z,getStreamId:k,getType:w,getBufferControllerType:$,createBufferSink:ee,dischargePreBuffer:X,getBuffer:N,getBufferLevel:te,getRangeAt:ve,pruneBuffer:Y,hasBufferAtTime:Ee,getAllRangesWithSafetyFactor:ge,getContinuousBufferTimeForTargetTime:Q,setMediaSource:H,getMediaSource:W,appendInitSegmentFromCache:pe,getIsBufferingCompleted:fe,setIsBufferingCompleted:J,getIsPruningInProgress:Z,reset:ue,clearBuffers:le,prepareForPlaybackSeek:L,prepareForReplacementTrackSwitch:K,setSeekTarget:x,updateAppendWindow:U,pruneAllSafely:S,updateBufferTimestampOffset:I,segmentRequestingCompleted:y},j(),M}C.__dashjs_factory_name=g;let T=o.default.getClassFactory(C)},"./src/streaming/text/TextController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/core/FactoryMaker.js"),o=e("./src/streaming/text/TextSourceBuffer.js"),i=e("./src/streaming/text/TextTracks.js"),E=e("./src/streaming/utils/VTTParser.js"),h=e("./src/streaming/utils/VttCustomRenderingParser.js"),t=e("./src/streaming/utils/TTMLParser.js"),g=e("./src/core/EventBus.js"),C=e("./src/core/events/Events.js"),T=e("./src/streaming/MediaPlayerEvents.js"),P=e("./src/streaming/utils/SupervisorTools.js");function R(f){var r=this.context,d=f.adapter,c=f.errHandler,M=f.manifestModel,n=f.mediaController,_=f.videoModel,u=f.settings,A,D,j,$,z,ee,k,w,N,H,W,Z;function X(){H=!1,W=!1,Z=!1,z=(0,E.default)(r).getInstance(),ee=(0,h.default)(r).getInstance(),k=(0,t.default)(r).getInstance(),w=(0,g.default)(r).getInstance(),S()}function te(){w.on(C.default.TEXT_TRACKS_QUEUE_INITIALIZED,Ee,A),u.get().streaming.text.webvtt.customRenderingEnabled&&(w.on(C.default.PLAYBACK_TIME_UPDATED,ge,A),w.on(C.default.PLAYBACK_SEEKING,Q,A))}function fe(F){var oe=F.id,ie=(0,i.default)(r).create({videoModel:_,settings:u,streamInfo:F});ie.initialize(),$[oe]=ie;var q=(0,o.default)(r).create({errHandler:c,adapter:d,manifestModel:M,mediaController:n,videoModel:_,textTracks:ie,vttParser:z,vttCustomRenderingParser:ee,ttmlParser:k,streamInfo:F,settings:u});q.initialize(),j[oe]=q,D[oe]={},D[oe].lastEnabledIndex=-1}function J(F){var oe=F.id;$[oe]&&$[oe].createTracks()}function ue(F,oe,ie){var q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,Ae=F.id;j[Ae]&&j[Ae].addMediaInfos(oe,ie,q)}function pe(F){var oe=F.id;if(j&&j[oe])return j[oe]}function Ce(){return N}function ve(F,oe){var ie=F.id;j[ie]&&j[ie].addEmbeddedTrack(oe)}function Ee(F){var oe=F.tracks,ie=F.index,q=F.streamId,Ae=u.get().streaming.text.defaultEnabled;if(Ae===!1&&!Y()||Z)L(q,-1);else{var de=n.getCurrentTrackFor(p.default.TEXT,q);if(de){var Me={lang:de.lang,role:de.roles[0],index:de.index,codec:de.codec,accessibility:de.accessibility[0]};oe.some(function(Ie,He){if(n.matchSettings(Me,Ie))return L(q,He),ie=He,!0})}N=!1}D[q].lastEnabledIndex=ie,w.trigger(T.default.TEXT_TRACKS_ADDED,{enabled:Y(),index:ie,tracks:oe,streamId:q}),W=!0}function ge(F){try{var oe=F.streamId;if(!$[oe]||isNaN(F.time))return;$[oe].manualCueProcessing(F.time)}catch{}}function Q(F){try{var oe=F.streamId;if(!$[oe])return;$[oe].disableManualTracks()}catch{}}function le(F,oe){return(0,P.checkParameterType)(oe,"boolean"),Y()!==oe&&(oe&&L(F,D[F].lastEnabledIndex),oe||(D[F].lastEnabledIndex=x(F),W?L(F,-1):Z=!0)),!0}function Y(){var F=!0;return N&&!H&&(F=!1),F}function I(F){return(0,P.checkParameterType)(F,"boolean"),H=F,!0}function L(F,oe){N=oe===-1,N&&n&&n.saveTextSettingsDisabled();var ie=x(F);if(!(ie===oe||!$[F])){$[F].disableManualTracks(),$[F].setModeForTrackIdx(ie,p.default.TEXT_HIDDEN),$[F].setCurrentTrackIdx(oe),$[F].setModeForTrackIdx(oe,p.default.TEXT_SHOWING);var q=$[F].getCurrentTrackInfo();q&&q.isFragmented&&!q.isEmbedded?K(F,q,ie):q&&!q.isFragmented&&U(F,q),n.setTrack(q)}}function K(F,oe,ie){if(j[F])for(var q=j[F].getConfig(),Ae=q.fragmentedTracks,de=0;de<Ae.length;de++){var Me=Ae[de];if(oe.lang===Me.lang&&(Me.id?oe.id===Me.id:oe.index===Me.index)){var Ie=n.getCurrentTrackFor(p.default.TEXT,F);(Me.id?Ie.id!==Me.id:Ie.index!==Me.index)?($[F].deleteCuesFromTrackIdx(ie),j[F].setCurrentFragmentedTrackIdx(de)):ie===-1&&w.trigger(C.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:F,mediaType:p.default.TEXT})}}}function U(F,oe){w.trigger(C.default.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:oe},{streamId:F,mediaType:p.default.TEXT})}function x(F){return $[F].getCurrentTrackIdx()}function y(F){if(F){var oe=F.id;j[oe]&&j[oe].resetMediaInfos(),$[oe]&&$[oe].deleteAllTextTracks()}}function S(){j={},$={},D={},N=!0,W=!1,Z=!1}function b(){S(),w.off(C.default.TEXT_TRACKS_QUEUE_INITIALIZED,Ee,A),u.get().streaming.text.webvtt.customRenderingEnabled&&(w.off(C.default.PLAYBACK_TIME_UPDATED,ge,A),w.off(C.default.PLAYBACK_SEEKING,Q,A)),Object.keys(j).forEach(function(F){j[F].resetEmbedded(),j[F].reset()})}return A={deactivateStream:y,initialize:te,initializeForStream:fe,createTracks:J,getTextSourceBuffer:pe,getAllTracksAreDisabled:Ce,addEmbeddedTrack:ve,enableText:le,isTextEnabled:Y,setTextTrack:L,getCurrentTrackIdx:x,enableForcedTextStreaming:I,addMediaInfosToBuffer:ue,reset:b},X(),A}R.__dashjs_factory_name="TextController";let m=l.default.getClassFactory(R)},"./src/streaming/text/TextSourceBuffer.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>c});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/vo/metrics/HTTPRequest.js"),o=e("./src/streaming/vo/TextTrackInfo.js"),i=e("./src/streaming/utils/BoxParser.js"),E=e("./src/streaming/utils/CustomTimeRanges.js"),h=e("./src/core/FactoryMaker.js"),t=e("./src/core/Debug.js"),g=e("./src/streaming/text/EmbeddedTextHtmlRender.js"),C=e("./node_modules/codem-isoboxer/dist/iso_boxer.js"),T=e("./externals/cea608-parser.js"),P=e.n(T),R=e("./src/core/EventBus.js"),m=e("./src/core/events/Events.js"),f=e("./src/streaming/vo/DashJSError.js"),r=e("./src/core/errors/Errors.js");function d(M){var n=M.errHandler,_=M.manifestModel,u=M.mediaController,A=M.videoModel,D=M.textTracks,j=M.vttParser,$=M.vttCustomRenderingParser,z=M.ttmlParser,ee=M.streamInfo,k=M.settings,w=this.context,N=(0,R.default)(w).getInstance(),H=!1,W,Z,X,te,fe,J,ue,pe,Ce,ve,Ee,ge,Q,le,Y,I;function L(){Z=(0,t.default)(w).getInstance().getLogger(W),X=(0,i.default)(w).getInstance(),x()}function K(){return ee.id}function U(){J=null,pe=NaN,Ce=[],ve=null,ue=!1}function x(){U(),fe=[],te=null}function y(){H||q()}function S(Xe,Re,ye){if(fe=fe.concat(Re),Xe===p.default.TEXT&&Re[0].isFragmented&&!Re[0].isEmbedded){J=ye,W.buffered=(0,E.default)(w).create(),Ce=u.getTracksFor(p.default.TEXT,ee.id).filter(function(Ve){return Ve.isFragmented});for(var be=u.getCurrentTrackFor(p.default.TEXT,ee.id),We=0;We<Ce.length;We++)if(Ce[We]===be){Ie(We);break}}for(var Qe=0;Qe<Re.length;Qe++)b(Re[Qe])}function b(Xe){var Re=new o.default,ye={subtitle:"subtitles",caption:"captions"};for(var be in Xe)Re[be]=Xe[be];Re.labels=Xe.labels,Re.defaultTrack=we(Xe),Re.isFragmented=Xe.isFragmented,Re.isEmbedded=!!Xe.isEmbedded,Re.isTTML=He(Xe),Re.kind=Be(Xe,ye),D.addTextTrack(Re)}function F(){}function oe(){x(),fe=[],X=null}function ie(Xe){var Re=Xe.chunk;Re.mediaInfo.embeddedCaptions&&ze(Re.bytes,Re)}function q(){ge=[],Ee=null,Q=0,Y=[],le=null,H=!0,I=(0,g.default)(w).getInstance(),N.on(m.default.VIDEO_CHUNK_RECEIVED,ie,W),N.on(m.default.BUFFER_CLEARED,qe,W)}function Ae(){N.off(m.default.VIDEO_CHUNK_RECEIVED,ie,W),N.off(m.default.BUFFER_CLEARED,qe,W),D&&D.deleteAllTextTracks(),H=!1,ge=[],Y=[null,null],le=null}function de(Xe){if(H&&Xe)if(Xe.id===p.default.CC1||Xe.id===p.default.CC3){for(var Re=0;Re<ge.length;Re++)if(ge[Re].id===Xe.id)return;ge.push(Xe)}else Z.warn("Embedded track "+Xe.id+" not supported!")}function Me(){var Xe={fragmentModel:J,fragmentedTracks:Ce,videoModel:A};return Xe}function Ie(Xe){Ee=Xe}function He(Xe){return Xe.codec&&Xe.codec.search(p.default.STPP)>=0||Xe.mimeType&&Xe.mimeType.search(p.default.TTML)>=0}function Be(Xe,Re){var ye=Xe.roles&&Xe.roles.length>0?Re[Xe.roles[0]]:Re.caption;return ye=ye===Re.caption||ye===Re.subtitle?ye:Re.caption,ye}function ze(Xe,Re){var ye=Re.mediaInfo,be=ye.type,We=ye.mimeType,Qe=ye.codec||We;if(!Qe){Z.error("No text type defined");return}ye.codec.indexOf("application/mp4")!==-1?Ye(Xe,Re,Qe):be===p.default.VIDEO?st(Xe,Re):ot(Xe,Re,Qe)}function Ye(Xe,Re,ye){var be,We;if(Re.segmentType==="InitializationSegment")ue=!0,pe=X.getMediaTimescaleFromMoov(Xe);else{if(!ue)return;We=X.getSamplesInfo(Xe),be=We.sampleList,be.length>0&&(ve=be[0].cts-Re.start*pe),ye.search(p.default.STPP)>=0?Te(Xe,be,ye):Fe(Xe,be)}}function Te(Xe,Re,ye){var be,We;for(te=te!==null?te:$e(ye),be=0;be<Re.length;be++){var Qe=Re[be],Ve=Qe.cts,rt=xe(),ft=rt+Ve/pe,Je=ft+Qe.duration/pe;W.buffered.add(ft,Je);var yt=new DataView(Xe,Qe.offset,Qe.subSizes[0]),At=C.Utils.dataViewToString(yt,p.default.UTF8),Le=[],Ue=Qe.offset+Qe.subSizes[0];for(We=1;We<Qe.subSizes.length;We++){var Ze=new Uint8Array(Xe,Ue,Qe.subSizes[We]),dt=String.fromCharCode.apply(null,Ze);Le.push(dt),Ue+=Qe.subSizes[We]}try{var vt=_.getValue(),mt=vt.ttmlTimeIsRelative?Ve/pe:0,Pt=te.parse(At,mt,Ve/pe,(Ve+Qe.duration)/pe,Le);D.addCaptions(Ee,rt,Pt)}catch(Ft){J.removeExecutedRequestsBeforeTime(),this.remove(),Z.error("TTML parser error: "+Ft.message)}}}function Fe(Xe,Re){var ye,be,We,Qe=[];for(ye=0;ye<Re.length;ye++){var Ve=Re[ye];Ve.cts-=ve;var rt=xe(),ft=rt+Ve.cts/pe,Je=ft+Ve.duration/pe;W.buffered.add(ft,Je);var yt=Xe.slice(Ve.offset,Ve.offset+Ve.size),At=C.parseBuffer(yt);for(be=0;be<At.boxes.length;be++){var Le=At.boxes[be];if(Z.debug("VTT box1: "+Le.type),Le.type!=="vtte"&&Le.type==="vttc"){Z.debug("VTT vttc boxes.length = "+Le.boxes.length);var Ue={styles:{}};for(We=0;We<Le.boxes.length;We++){var Ze=Le.boxes[We];if(Z.debug("VTT box2: "+Ze.type),Ze.type==="payl")Ue.start=Ve.cts/pe,Ue.end=(Ve.cts+Ve.duration)/pe,Ue.data=Ze.cue_text;else if(Ze.type==="sttg"&&Ze.settings&&Ze.settings!=="")try{var dt=Ze.settings.split(" ");Ue.styles=j.getCaptionStyles(dt)}catch{}}Ue&&Ue.data&&(Qe.push(Ue),Z.debug("VTT  ".concat(Ue.start," - ").concat(Ue.end," :  ").concat(Ue.data)))}}}Qe.length>0&&D.addCaptions(Ee,0,Qe)}function ot(Xe,Re,ye){var be,We,Qe=new DataView(Xe,0,Xe.byteLength);We=C.Utils.dataViewToString(Qe,p.default.UTF8);try{be=$e(ye).parse(We,0),D.addCaptions(D.getCurrentTrackIdx(),0,be),W.buffered&&W.buffered.add(Re.start,Re.end)}catch(Ve){n.error(new f.default(r.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,r.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+Ve.message,We))}}function st(Xe,Re){var ye,be;if(Re.segmentType===l.HTTPRequest.INIT_SEGMENT_TYPE)Q===0&&(Q=X.getMediaTimescaleFromMoov(Xe));else if(Re.segmentType===l.HTTPRequest.MEDIA_SEGMENT_TYPE){if(Q===0){Z.warn("CEA-608: No timescale for embeddedTextTrack yet");return}be=X.getSamplesInfo(Xe);var We=be.lastSequenceNumber;if(!Y[0]&&!Y[1]&&at(),Q){if(le!==null&&We!==le+be.numSequences)for(ye=0;ye<Y.length;ye++)Y[ye]&&Y[ye].reset();for(var Qe=Tt(Xe,be.sampleList),Ve=0;Ve<Y.length;Ve++){var rt=Qe.fields[Ve],ft=Y[Ve];if(ft)for(ye=0;ye<rt.length;ye++)ft.addData(rt[ye][0]/Q,rt[ye][1])}le=We}}}function at(){for(var Xe,Re=0;Re<ge.length;Re++){if(Xe=D.getTrackIdxForId(ge[Re].id),Xe===-1){Z.warn("CEA-608: data before track is ready.");return}var ye=ht(Xe);Y[Re]=new(P()).Cea608Parser(Re+1,{newCue:ye},null)}}function ht(Xe){function Re(ye,be,We){var Qe;if(A.getTTMLRenderingDiv())Qe=I.createHTMLCaptionsFromScreen(A.getElement(),ye,be,We);else{var Ve=We.getDisplayText();Qe=[{start:ye,end:be,data:Ve,styles:{}}]}Qe&&D.addCaptions(Xe,0,Qe)}return Re}function Tt(Xe,Re){if(Re.length===0)return null;for(var ye={splits:[],fields:[[],[]]},be=new DataView(Xe),We=0;We<Re.length;We++)for(var Qe=Re[We],Ve=P().findCea608Nalus(be,Qe.offset,Qe.size),rt=null,ft=0,Je=0;Je<Ve.length;Je++)for(var yt=P().extractCea608DataFromRange(be,Ve[Je]),At=0;At<2;At++)if(yt[At].length>0){Qe.cts!==rt?ft=0:ft+=1;var Le=xe();ye.fields[At].push([Qe.cts+Le*Q,yt[At],ft]),rt=Qe.cts}return ye.fields.forEach(function(Ze){Ze.sort(function(dt,vt){return dt[0]===vt[0]?dt[2]-vt[2]:dt[0]-vt[0]})}),ye}function xe(){return isNaN(W.timestampOffset)?0:W.timestampOffset}function we(Xe){var Re=!1;return ge.length>1&&Xe.isEmbedded?Re=Xe.id&&Xe.id===p.default.CC1:ge.length===1?Xe.id&&typeof Xe.id=="string"&&Xe.id.substring(0,2)==="CC"&&(Re=!0):ge.length===0&&(Re=Xe.index===fe[0].index),Re}function $e(Xe){var Re;return Xe.search(p.default.VTT)>=0?Re=k.get().streaming.text.webvtt.customRenderingEnabled&&$?$:j:(Xe.search(p.default.TTML)>=0||Xe.search(p.default.STPP)>=0)&&(Re=z),Re}function et(Xe,Re){Xe===void 0&&Xe===Re&&(Xe=W.buffered.start(0),Re=W.buffered.end(W.buffered.length-1)),W.buffered.remove(Xe,Re),D.deleteCuesFromTrackIdx(Ee,Xe,Re)}function qe(Xe){ge.forEach(function(Re){var ye=D.getTrackIdxForId(Re.id);ye>=0&&D.deleteCuesFromTrackIdx(ye,Xe.from,Xe.to)})}function _t(){fe=[]}return W={initialize:y,addMediaInfos:S,resetMediaInfos:_t,getStreamId:K,append:ze,abort:F,addEmbeddedTrack:de,resetEmbedded:Ae,getConfig:Me,setCurrentFragmentedTrackIdx:Ie,remove:et,reset:oe},L(),W}d.__dashjs_factory_name="TextSourceBuffer";let c=h.default.getClassFactory(d)},"./src/streaming/text/TextTracks.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/core/EventBus.js"),o=e("./src/core/events/Events.js"),i=e("./src/streaming/MediaPlayerEvents.js"),E=e("./src/core/FactoryMaker.js"),h=e("./src/core/Debug.js"),t=e("./node_modules/imsc/src/main/js/main.js");function g(f,r){var d;if(typeof Symbol>"u"||f[Symbol.iterator]==null){if(Array.isArray(f)||(d=C(f))||r&&f&&typeof f.length=="number"){d&&(f=d);var c=0,M=function(){};return{s:M,n:function(){return c>=f.length?{done:!0}:{done:!1,value:f[c++]}},e:function(D){throw D},f:M}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var n=!0,_=!1,u;return{s:function(){d=f[Symbol.iterator]()},n:function(){var D=d.next();return n=D.done,D},e:function(D){_=!0,u=D},f:function(){try{!n&&d.return!=null&&d.return()}finally{if(_)throw u}}}}function C(f,r){if(f){if(typeof f=="string")return T(f,r);var d=Object.prototype.toString.call(f).slice(8,-1);if(d==="Object"&&f.constructor&&(d=f.constructor.name),d==="Map"||d==="Set")return Array.from(f);if(d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d))return T(f,r)}}function T(f,r){(r==null||r>f.length)&&(r=f.length);for(var d=0,c=new Array(r);d<r;d++)c[d]=f[d];return c}var P=["text","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function R(f){var r=this.context,d=(0,l.default)(r).getInstance(),c=f.videoModel,M=f.streamInfo,n=f.settings,_,u,A,D,j,$,z,ee,k,w,N,H,W,Z,X,te,fe,J;function ue(){u=(0,h.default)(r).getInstance().getLogger(_)}function pe(){typeof window>"u"||typeof navigator>"u"||(A=window.VTTCue||window.TextTrackCue,D=[],j=[],$=-1,z=0,ee=0,k=0,w=0,N=null,H=null,W=null,X=!1,fe=2147483647,te=null,document.fullscreenElement!==void 0?Z="fullscreenElement":document.webkitIsFullScreen!==void 0?Z="webkitIsFullScreen":document.msFullscreenElement?Z="msFullscreenElement":document.mozFullScreen&&(Z="mozFullScreen"))}function Ce(){return M.id}function ve(xe){var we=xe.kind,$e=xe.id!==void 0?xe.id:xe.lang,et=xe.lang,qe=xe.isTTML,_t=xe.isEmbedded,Xe=c.addTextTrack(we,$e,et,qe,_t);return Xe}function Ee(xe){D.push(xe)}function ge(){D.sort(function(Re,ye){return Re.index-ye.index}),N=c.getTTMLRenderingDiv(),H=c.getVttRenderingDiv();for(var xe=-1,we=0;we<D.length;we++){var $e=ve(D[we]);j.push($e),D[we].defaultTrack&&($e.default=!0,xe=we);var et=q(we);et&&(et.mode=p.default.TEXT_SHOWING,N&&(D[we].isTTML||D[we].isEmbedded)?et.renderingType="html":et.renderingType="default"),y(we,0,D[we].captionData),d.trigger(i.default.TEXT_TRACK_ADDED)}if(Me.call(this,xe),xe>=0){var qe=function Re(){var ye=q(xe);ye&&ye.renderingType==="html"&&le.call(this,ye,!0),d.off(i.default.PLAYBACK_METADATA_LOADED,Re,this)};d.on(i.default.PLAYBACK_METADATA_LOADED,qe,this);for(var _t=0;_t<D.length;_t++){var Xe=q(_t);Xe&&(Xe.mode=_t===xe?p.default.TEXT_SHOWING:p.default.TEXT_HIDDEN,Xe.manualMode=_t===xe?p.default.TEXT_SHOWING:p.default.TEXT_HIDDEN)}}d.trigger(o.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:$,tracks:D,streamId:M.id})}function Q(xe,we,$e,et,qe,_t){var Xe=xe/we,Re=$e/et,ye=0,be=0;Xe>Re?(be=we,ye=be/et*$e):(ye=xe,be=ye/$e*et);var We=0,Qe=0,Ve=0,rt=0,ft=ye/be;return ft>qe?(rt=be,Ve=be*qe):(Ve=ye,rt=ye/qe),We=(xe-Ve)/2,Qe=(we-rt)/2,_t?{x:We+Ve*.1,y:Qe+rt*.1,w:Ve*.8,h:rt*.8}:{x:We,y:Qe,w:Ve,h:rt}}function le(xe,we){var $e=c.getClientWidth(),et=c.getClientHeight(),qe=c.getVideoWidth(),_t=c.getVideoHeight(),Xe=c.getVideoRelativeOffsetTop(),Re=c.getVideoRelativeOffsetLeft();if(qe!==0&&_t!==0){var ye=qe/_t,be=!1;xe.isFromCEA608&&(ye=1.1666666666666667,be=!0);var We=Q.call(this,$e,et,qe,_t,ye,be),Qe=We.w,Ve=We.h,rt=We.x,ft=We.y;if(Qe!=k||Ve!=w||rt!=z||ft!=ee||we){if(z=rt+Re,ee=ft+Xe,k=Qe,w=Ve,N){var Je=N.style;Je&&(Je.left=z+"px",Je.top=ee+"px",Je.width=k+"px",Je.height=w+"px",Je.zIndex=Z&&document[Z]||X?fe:null,d.trigger(i.default.CAPTION_CONTAINER_RESIZE))}var yt=xe.activeCues;if(yt)for(var At=yt.length,Le=0;Le<At;++Le){var Ue=yt[Le];Ue.scaleCue(Ue)}}}}function Y(xe){var we=k,$e=w,et,qe,_t,Xe,Re;if(xe.cellResolution){var ye=[we/xe.cellResolution[0],$e/xe.cellResolution[1]];if(xe.linePadding){for(et in xe.linePadding)if(xe.linePadding.hasOwnProperty(et)){var be=xe.linePadding[et];qe=(be*ye[0]).toString();for(var We=document.getElementsByClassName("spanPadding"),Qe=0;Qe<We.length;Qe++)We[Qe].style.cssText=We[Qe].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+qe),We[Qe].style.cssText=We[Qe].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+qe)}}if(xe.fontSize){for(et in xe.fontSize)if(xe.fontSize.hasOwnProperty(et)){xe.fontSize[et][0]==="%"?_t=xe.fontSize[et][1]/100:xe.fontSize[et][0]==="c"&&(_t=xe.fontSize[et][1]),qe=(_t*ye[1]).toString(),et!=="defaultFontSize"?Re=document.getElementsByClassName(et):Re=document.getElementsByClassName("paragraph");for(var Ve=0;Ve<Re.length;Ve++)Re[Ve].style.cssText=Re[Ve].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+qe)}if(xe.lineHeight){for(et in xe.lineHeight)if(xe.lineHeight.hasOwnProperty(et)){xe.lineHeight[et][0]==="%"?Xe=xe.lineHeight[et][1]/100:xe.fontSize[et][0]==="c"&&(Xe=xe.lineHeight[et][1]),qe=(Xe*ye[1]).toString(),Re=document.getElementsByClassName(et);for(var rt=0;rt<Re.length;rt++)Re[rt].style.cssText=Re[rt].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+qe)}}}}if(xe.isd){var ft=document.getElementById(xe.cueID);ft&&N.removeChild(ft),L(xe)}}function I(xe,we){var $e=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,et=/^#(.*)$/;if($e.test(we)){var qe=$e.exec(we),_t=parseInt(qe[4],10)-1,Xe=btoa(xe.images[_t]),Re="data:image/png;base64,"+Xe;return Re}else if(et.test(we)){var ye=et.exec(we),be=ye[1],We="data:image/png;base64,"+xe.embeddedImages[be];return We}else return we}function L(xe){if(N){var we=document.createElement("div");N.appendChild(we),te=(0,t.renderHTML)(xe.isd,we,function($e){return I(xe,$e)},N.clientHeight,N.clientWidth,!1,function($e){u.info("renderCaption :",$e)},te,!0),we.id=xe.cueID,d.trigger(i.default.CAPTION_RENDERED,{captionDiv:we,currentTrackIdx:$})}}function K(xe,we){if(!n.get().streaming.text.extendSegmentedCues||!we.cues||we.cues.length===0)return!1;var $e=we.cues[we.cues.length-1];return $e.endTime<xe.startTime||!U($e,xe,P)?!1:($e.endTime=Math.max($e.endTime,xe.endTime),!0)}function U(xe,we,$e){for(var et=0;et<$e.length;et++){var qe=$e[et];if(JSON.stringify(xe[qe])!==JSON.stringify(we[qe]))return!1}return!0}function x(xe,we){we&&we.forEach(function($e){$e.kind&&$e.kind==="image"&&($e.src=I(xe,$e.src)),x(xe,$e.contents)})}function y(xe,we,$e){var et=q(xe);if(et&&!(!Array.isArray($e)||$e.length===0))for(var qe=0;qe<$e.length;qe++){var _t=void 0,Xe=$e[qe];et.cellResolution=Xe.cellResolution,et.isFromCEA608=Xe.isFromCEA608,!isNaN(Xe.start)&&!isNaN(Xe.end)&&(_t=Xe.type==="html"&&N?S(Xe,we,et):Xe.data?b(Xe,we,et):null);try{_t?He(et,_t)||(n.get().streaming.text.webvtt.customRenderingEnabled?(et.manualCueList||(et.manualCueList=[]),et.manualCueList.push(_t)):K(_t,et)||et.addCue(_t)):u.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)")}catch(Re){throw ze(et),et.addCue(_t),Re}}}function S(xe,we,$e){var et=this,qe=new A(xe.start+we,xe.end+we,"");return qe.cueHTMLElement=xe.cueHTMLElement,qe.isd=xe.isd,qe.images=xe.images,qe.embeddedImages=xe.embeddedImages,qe.cueID=xe.cueID,qe.scaleCue=Y.bind(et),qe.cellResolution=xe.cellResolution,qe.lineHeight=xe.lineHeight,qe.linePadding=xe.linePadding,qe.fontSize=xe.fontSize,N.style.left=z+"px",N.style.top=ee+"px",N.style.width=k+"px",N.style.height=w+"px",qe.isd&&x(qe,qe.isd.contents),qe.onenter=function(){$e.mode===p.default.TEXT_SHOWING&&(this.isd?(L(this),u.debug("Cue enter id:"+this.cueID)):(N.appendChild(this.cueHTMLElement),Y.call(et,this),d.trigger(i.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:$})))},qe.onexit=function(){if(N)for(var _t=N.childNodes,Xe=0;Xe<_t.length;++Xe)_t[Xe].id===this.cueID&&(u.debug("Cue exit id:"+_t[Xe].id),N.removeChild(_t[Xe]),--Xe)},qe}function b(xe,we,$e){var et=new A(xe.start-we,xe.end-we,xe.data);if(et.cueID="".concat(et.startTime,"_").concat(et.endTime),et.isActive=!1,xe.styles)try{xe.styles.align!==void 0&&"align"in et&&(et.align=xe.styles.align),xe.styles.line!==void 0&&"line"in et&&(et.line=xe.styles.line),xe.styles.snapToLines!==void 0&&"snapToLines"in et&&(et.snapToLines=xe.styles.snapToLines),xe.styles.position!==void 0&&"position"in et&&(et.position=xe.styles.position),xe.styles.size!==void 0&&"size"in et&&(et.size=xe.styles.size)}catch(qe){u.error(qe)}return et.onenter=function(){$e.mode===p.default.TEXT_SHOWING&&d.trigger(i.default.CAPTION_RENDERED,{currentTrackIdx:$})},et}function F(xe){var we=ie();if(we&&we.length>0){var $e=we[0],et=$e.manualCueList;et&&et.length>0&&et.forEach(function(qe){if(qe.startTime<=xe&&qe.endTime>=xe&&!qe.isActive)qe.isActive=!0,WebVTT.processCues(window,[qe],H,qe.cueID);else if(qe.isActive&&(qe.startTime>xe||qe.endTime<xe)&&(qe.isActive=!1,H))for(var _t=H.childNodes,Xe=0;Xe<_t.length;++Xe)_t[Xe].id===qe.cueID&&(H.removeChild(_t[Xe]),--Xe)})}}function oe(){var xe=ie();if(xe&&xe.length>0){var we=xe[0],$e=we.manualCueList;$e&&$e.length>0&&$e.forEach(function(et){if(et.isActive&&(et.isActive=!1,H))for(var qe=H.childNodes,_t=0;_t<qe.length;++_t)qe[_t].id===et.cueID&&(H.removeChild(qe[_t]),--_t)})}}function ie(){var xe=c.getTextTracks(),we=[],$e=g(xe),et;try{for($e.s();!(et=$e.n()).done;){var qe=et.value;qe.manualMode===p.default.TEXT_SHOWING&&we.push(qe)}}catch(_t){$e.e(_t)}finally{$e.f()}return we}function q(xe){return xe>=0&&D[xe]?c.getTextTrack(D[xe].kind,D[xe].id,D[xe].lang,D[xe].isTTML,D[xe].isEmbedded):null}function Ae(){return $}function de(xe){for(var we=-1,$e=0;$e<D.length;$e++)if(D[$e].id===xe){we=$e;break}return we}function Me(xe){var we=this;if(xe!==$){$=xe;var $e=q($);Ie.call(this,$e),W&&(clearInterval(W),W=null),$e&&$e.renderingType==="html"&&(le.call(this,$e,!0),window.ResizeObserver?(J=new window.ResizeObserver(function(){le.call(we,$e,!0)}),J.observe(c.getElement())):W=setInterval(le.bind(this,$e),500))}}function Ie(xe){at.call(this),xe?xe.renderingType==="html"?ot.call(this):st.call(this):st.call(this)}function He(xe,we){if(!xe.cues)return!1;for(var $e=0;$e<xe.cues.length;$e++)if(xe.cues[$e].startTime===we.startTime&&xe.cues[$e].endTime===we.endTime)return!0;return!1}function Be(xe,we,$e){var et=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return(isNaN(we)||(et?xe.startTime:xe.endTime)>=we)&&(isNaN($e)||(et?xe.endTime:xe.startTime)<=$e)}function ze(xe,we,$e){var et=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;if(xe.cues)for(var qe=xe.cues,_t=qe.length-1,Xe=_t;Xe>=0;Xe--)Be(qe[Xe],we,$e,et)&&(qe[Xe].onexit&&qe[Xe].onexit(),xe.removeCue(qe[Xe]))}function Ye(xe,we,$e){var et=q(xe);et&&ze(et,we,$e)}function Te(){for(var xe=j?j.length:0,we=0;we<xe;we++){var $e=q(we);$e&&ze.call(this,$e,M.start,M.start+M.duration,!1)}j=[],D=[],W&&(clearInterval(W),W=null),J&&c&&(J.unobserve(c.getElement()),J=null),$=-1,at.call(this)}function Fe(xe){c.removeChild(j[xe]),j.splice(xe,1)}function ot(){var xe=document.getElementById("native-cue-style");if(!xe){xe=document.createElement("style"),xe.id="native-cue-style",document.head.appendChild(xe);var we=xe.sheet,$e=c.getElement();try{$e&&($e.id?we.insertRule("#"+$e.id+"::cue {background: transparent}",0):$e.classList.length!==0?we.insertRule("."+$e.className+"::cue {background: transparent}",0):we.insertRule("video::cue {background: transparent}",0))}catch(et){u.info(""+et.message)}}}function st(){var xe=document.getElementById("native-cue-style");xe&&document.head.removeChild(xe)}function at(){if(N)for(;N.firstChild;)N.removeChild(N.firstChild)}function ht(xe,we){var $e=q(xe);$e&&$e.mode!==we&&($e.mode=we),$e&&$e.manualMode!==we&&($e.manualMode=we)}function Tt(){return D[$]}return _={initialize:pe,getStreamId:Ce,addTextTrack:Ee,addCaptions:y,createTracks:ge,getCurrentTrackIdx:Ae,setCurrentTrackIdx:Me,getTrackIdxForId:de,getCurrentTrackInfo:Tt,setModeForTrackIdx:ht,deleteCuesFromTrackIdx:Ye,deleteAllTextTracks:Te,deleteTextTrack:Fe,manualCueProcessing:F,disableManualTracks:oe},ue(),_}R.__dashjs_factory_name="TextTracks";let m=E.default.getClassFactory(R)},"./src/streaming/thumbnail/ThumbnailController.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>g});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/constants/Constants.js"),o=e("./src/streaming/vo/Thumbnail.js"),i=e("./src/streaming/thumbnail/ThumbnailTracks.js"),E=e("./src/streaming/vo/BitrateInfo.js"),h=e("./src/dash/utils/SegmentsUtils.js");function t(C){var T=this.context,P=C.streamInfo,R,m;function f(){A(),m=(0,i.default)(T).create({streamInfo:P,adapter:C.adapter,baseURLController:C.baseURLController,timelineConverter:C.timelineConverter,debug:C.debug,eventBus:C.eventBus,events:C.events,dashConstants:C.dashConstants,dashMetrics:C.dashMetrics,segmentBaseController:C.segmentBaseController})}function r(){m.addTracks();var D=m.getTracks();D&&D.length>0&&n(0)}function d(){return P.id}function c(D,j){if(typeof j=="function"){var $=m.getCurrentTrack(),z,ee;if(!$||$.segmentDuration<=0||D===void 0||D===null){j(null);return}ee=m.getThumbnailRequestForTime(D),ee&&($.segmentDuration=ee.duration),z=D%$.segmentDuration;var k=Math.floor(z*$.tilesHor*$.tilesVert/$.segmentDuration),w=new o.default;if(w.width=Math.floor($.widthPerTile),w.height=Math.floor($.heightPerTile),w.x=Math.floor(k%$.tilesHor)*$.widthPerTile,w.y=Math.floor(k/$.tilesHor)*$.heightPerTile,"readThumbnail"in $)return $.readThumbnail(D,function(H){w.url=H,j(w)});if(ee)w.url=ee.url,$.segmentDuration=NaN;else{var N=Math.floor(D/$.segmentDuration);w.url=M($,N)}j(w)}}function M(D,j){var $=j+D.startNumber,z=(0,h.replaceTokenForTemplate)(D.templateUrl,"Number",$);return z=(0,h.replaceTokenForTemplate)(z,"Time",($-1)*D.segmentDuration*D.timescale),z=(0,h.replaceTokenForTemplate)(z,"Bandwidth",D.bandwidth),(0,h.unescapeDollarsInTemplate)(z)}function n(D){m.setTrackByIndex(D)}function _(){return m.getCurrentTrackIndex()}function u(){var D=m.getTracks(),j=0;return D.map(function($){var z=new E.default;return z.mediaType=l.default.IMAGE,z.qualityIndex=j++,z.bitrate=$.bitrate,z.width=$.width,z.height=$.height,z})}function A(){m&&m.reset()}return R={getStreamId:d,initialize:r,provide:c,setTrackByIndex:n,getCurrentTrackIndex:_,getBitrateList:u,reset:A},f(),R}t.__dashjs_factory_name="ThumbnailController";let g=p.default.getClassFactory(t)},"./src/streaming/thumbnail/ThumbnailTracks.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{THUMBNAILS_SCHEME_ID_URIS:()=>P,default:()=>m});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/dash/constants/DashConstants.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/streaming/vo/ThumbnailTrackInfo.js"),E=e("./src/streaming/utils/URLUtils.js"),h=e("./src/dash/utils/SegmentsUtils.js"),t=e("./src/streaming/utils/BoxParser.js"),g=e("./src/streaming/net/XHRLoader.js"),C=e("./src/dash/DashHandler.js"),T=e("./src/dash/controllers/SegmentsController.js"),P=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function R(f){var r=this.context,d=f.adapter,c=f.baseURLController,M=f.streamInfo,n=f.timelineConverter,_=f.debug,u=f.eventBus,A=f.events,D=f.dashConstants,j=(0,E.default)(r).getInstance(),$,z,ee,k,w,N,H,W;function Z(){Q(),H=(0,g.default)(r).create({}),W=(0,t.default)(r).getInstance(),N=(0,T.default)(r).create({events:A,eventBus:u,streamInfo:M,timelineConverter:n,dashConstants:D,dashMetrics:f.dashMetrics,segmentBaseController:f.segmentBaseController,type:p.default.IMAGE}),ee=(0,C.default)(r).create({streamInfo:M,type:p.default.IMAGE,timelineConverter:n,segmentsController:N,baseURLController:c,debug:_,eventBus:u,events:A,dashConstants:D,urlUtils:j}),ee.initialize(d?d.getIsDynamic():!1)}function X(){if(!(!M||!d)&&(w=d.getMediaInfoForType(M,p.default.IMAGE),!!w)){var le=d.getVoRepresentations(w);le&&le.length>0&&le.forEach(function(Y){(Y.segmentInfoType===l.default.SEGMENT_TEMPLATE&&Y.segmentDuration>0&&Y.media||Y.segmentInfoType===l.default.SEGMENT_TIMELINE)&&te(Y),Y.segmentInfoType===l.default.SEGMENT_BASE&&te(Y,!0)}),z.length>0&&z.sort(function(Y,I){return Y.bitrate-I.bitrate})}}function te(le,Y){var I=new i.default;I.id=le.id,I.bitrate=le.bandwidth,I.width=le.width,I.height=le.height,I.tilesHor=1,I.tilesVert=1,le.essentialProperties&&le.essentialProperties.forEach(function(L){if(P.indexOf(L.schemeIdUri)>=0&&L.value){var K=L.value.split("x");K.length===2&&!isNaN(K[0])&&!isNaN(K[1])&&(I.tilesHor=parseInt(K[0],10),I.tilesVert=parseInt(K[1],10))}}),Y?N.updateSegmentData(le).then(function(L){fe(I,le,L)}):(I.startNumber=le.startNumber,I.segmentDuration=le.segmentDuration,I.timescale=le.timescale,I.templateUrl=ue(le)),I.tilesHor>0&&I.tilesVert>0&&(I.widthPerTile=I.width/I.tilesHor,I.heightPerTile=I.height/I.tilesVert,z.push(I))}function fe(le,Y,I){var L=[],K=J(I,Y);Y.segments=K,le.segmentDuration=Y.segments[0].duration,le.readThumbnail=function(U,x){var y=null;L.some(function(S){if(S.start<=U&&S.end>U)return y=S.url,!0}),y?x(y):Y.segments.some(function(S){if(S.mediaStartTime<=U&&S.mediaStartTime+S.duration>U){var b=c.resolve(Y.path);return H.load({method:"get",url:b.url,request:{range:S.mediaRange,responseType:"arraybuffer"},onload:function(oe){var ie=W.getSamplesInfo(oe.target.response),q=new Blob([oe.target.response.slice(ie.sampleList[0].offset,ie.sampleList[0].offset+ie.sampleList[0].size)],{type:"image/jpeg"}),Ae=window.URL.createObjectURL(q);L.push({start:S.mediaStartTime,end:S.mediaStartTime+S.duration,url:Ae}),x&&x(Ae)}}),!0}})}}function J(le,Y){var I=[],L=0,K,U,x,y;for(K=0,U=le.segments.length;K<U;K++)x=le.segments[K],y=(0,h.getTimeBasedSegment)(n,d.getIsDynamic(),Y,x.startTime,x.duration,x.timescale,x.media,x.mediaRange,L),y&&(I.push(y),y=null,L++);return I}function ue(le){var Y=j.isRelative(le.media)?j.resolve(le.media,c.resolve(le.path).url):le.media;return Y?(0,h.replaceIDForTemplate)(Y,le.id):""}function pe(){return z}function Ce(){return k}function ve(){return k<0?null:z[k]}function Ee(le){!z||z.length===0||(le>=z.length&&(le=z.length-1),k=le)}function ge(le){for(var Y,I=d.getVoRepresentations(w),L=0;L<I.length;L++)if(z[k].id===I[L].id){Y=I[L];break}return ee.getSegmentRequestForTime(w,Y,le)}function Q(){z=[],k=-1,w=null}return $={getTracks:pe,addTracks:X,reset:Q,setTrackByIndex:Ee,getCurrentTrack:ve,getCurrentTrackIndex:Ce,getThumbnailRequestForTime:ge},Z(),$}R.__dashjs_factory_name="ThumbnailTracks";let m=o.default.getClassFactory(R)},"./src/streaming/utils/BaseURLSelector.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/core/errors/Errors.js"),l=e("./src/core/EventBus.js"),o=e("./src/core/events/Events.js"),i=e("./src/streaming/controllers/BlacklistController.js"),E=e("./src/streaming/utils/baseUrlResolution/DVBSelector.js"),h=e("./src/streaming/utils/baseUrlResolution/BasicSelector.js"),t=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/vo/DashJSError.js"),C=e("./src/streaming/utils/SupervisorTools.js"),T=e("./src/streaming/utils/baseUrlResolution/ContentSteeringSelector.js"),P=e("./src/core/Settings.js");function R(){var f=this.context,r=(0,l.default)(f).getInstance(),d=(0,P.default)(f).getInstance(),c,M,n,_,u,A;function D(){M=(0,i.default)(f).create({updateEventName:o.default.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,addBlacklistEventName:o.default.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD}),n=(0,h.default)(f).create({blacklistController:M}),_=(0,E.default)(f).create({blacklistController:M}),u=(0,T.default)(f).create(),u.setConfig({blacklistController:M}),A=n}function j(k){k.selector&&(A=k.selector),k.contentSteeringSelector&&(u=k.contentSteeringSelector)}function $(k){(0,C.checkParameterType)(k,"boolean"),A=k?_:n}function z(k){if(k){if(d.get().streaming.applyContentSteering){var w=u.selectBaseUrlIndex(k);!isNaN(w)&&w!==-1&&(k.selectedIdx=w)}if(!isNaN(k.selectedIdx))return k.baseUrls[k.selectedIdx];var N=A.select(k.baseUrls);if(!N){r.trigger(o.default.URL_RESOLUTION_FAILED,{error:new g.default(p.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,p.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),A===n&&ee();return}return k.selectedIdx=k.baseUrls.indexOf(N),N}}function ee(){M.reset()}return c={chooseSelector:$,select:z,reset:ee,setConfig:j},D(),c}R.__dashjs_factory_name="BaseURLSelector";let m=t.default.getClassFactory(R)},"./src/streaming/utils/BoxParser.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/core/Debug.js"),l=e("./src/streaming/utils/IsoFile.js"),o=e("./src/core/FactoryMaker.js"),i=e("./node_modules/codem-isoboxer/dist/iso_boxer.js"),E=e("./src/streaming/vo/IsoBoxSearchInfo.js");function h(){var g,C,T=this.context;function P(){g=(0,p.default)(T).getInstance().getLogger(C)}function R(_){if(!_)return null;_.fileStart===void 0&&(_.fileStart=0);var u=i.parseBuffer(_),A=(0,l.default)(T).create();return A.setData(u),A}function m(_,u,A){if(A===void 0&&(A=0),!u||A+8>=u.byteLength)return new E.default(0,!1);for(var D=u instanceof ArrayBuffer?new Uint8Array(u):u,j,$=0;A<D.byteLength;){var z=d(D,A),ee=c(D,A+4);if(z===0)break;A+z<=D.byteLength&&(_.indexOf(ee)>=0?j=new E.default(A,!0,z):$=A+z),A+=z}return j||new E.default($,!1)}function f(_){if(!_||_.byteLength===0)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var u=R(_),A=u.getBoxes("moof"),D=u.getBoxes("mfhd"),j,$,z,ee,k,w,N,H,W,Z,X,te,fe,J,ue,pe,Ce;pe=u.getBoxes("moof").length,ue=D[D.length-1].sequence_number,z=0,w=[];var ve=-1,Ee=-1;for(X=0;X<A.length;X++){var ge=A[X],Q=ge.getChildBoxes("traf");for(W=0;W<Q.length;W++){var le=Q[W],Y=le.getChildBox("tfhd"),I=le.getChildBox("tfdt");k=I.baseMediaDecodeTime;var L=le.getChildBoxes("trun"),K=le.getChildBoxes("subs");for(Z=0;Z<L.length;Z++){var U=L[Z];for(z=U.sample_count,J=(Y.base_data_offset||0)+(U.data_offset||0),H=0;H<z;H++){N=U.samples[H],j=N.sample_duration!==void 0?N.sample_duration:Y.default_sample_duration,ee=N.sample_size!==void 0?N.sample_size:Y.default_sample_size,$=N.sample_composition_time_offset!==void 0?N.sample_composition_time_offset:0;var x={dts:k,cts:k+$,duration:j,offset:ge.offset+J,size:ee,subSizes:[ee]};if(K)for(te=0;te<K.length;te++){var y=K[te];if(ve<y.entry_count-1&&H>Ee&&(ve++,Ee+=y.entries[ve].sample_delta),H==Ee){x.subSizes=[];var S=y.entries[ve];for(fe=0;fe<S.subsample_count;fe++)x.subSizes.push(S.subsamples[fe].subsample_size)}}w.push(x),J+=ee,k+=j}}Ce=k-I.baseMediaDecodeTime}}return{sampleList:w,lastSequenceNumber:ue,totalDuration:Ce,numSequences:pe}}function r(_){var u=R(_),A=u?u.getBox("mdhd"):void 0;return A?A.timescale:NaN}function d(_,u){return _[u+3]>>>0|_[u+2]<<8>>>0|_[u+1]<<16>>>0|_[u]<<24>>>0}function c(_,u){return String.fromCharCode(_[u++])+String.fromCharCode(_[u++])+String.fromCharCode(_[u++])+String.fromCharCode(_[u])}function M(_){var u=null,A,D,j=R(_);if(!j)return u;var $=j.getBox("ftyp"),z=j.getBox("moov");return g.debug("Searching for initialization."),z&&z.isComplete&&(A=$?$.offset:z.offset,D=z.offset+z.size-1,u=A+"-"+D,g.debug("Found the initialization.  Range: "+u)),u}function n(_,u,A){if(A===void 0&&(A=0),!u||A+8>=u.byteLength)return new E.default(0,!1);for(var D=u instanceof ArrayBuffer?new Uint8Array(u):u,j,$=0;A<D.byteLength;){var z=d(D,A),ee=c(D,A+4);if(z===0)break;A+z<=D.byteLength&&(_.indexOf(ee)>=0?j=new E.default(A,!0,z,ee):$=A+z),A+=z}return j||new E.default($,!1)}return C={parse:R,findLastTopIsoBoxCompleted:m,getMediaTimescaleFromMoov:r,getSamplesInfo:f,findInitRange:M,parsePayload:n},P(),C}h.__dashjs_factory_name="BoxParser";let t=o.default.getSingletonFactory(h)},"./src/streaming/utils/Capabilities.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t,supportsMediaSource:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/thumbnail/ThumbnailTracks.js"),o=e("./src/streaming/constants/Constants.js"),i=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function E(){var g="WebKitMediaSource"in window,C="MediaSource"in window;return g||C}function h(){var g,C,T;function P(){T=!1}function R(u){u&&u.settings&&(C=u.settings)}function m(){return T}function f(u){T=u}function r(u,A){return A!==o.default.AUDIO&&A!==o.default.VIDEO?Promise.resolve(!0):d(u,A)?M(u,A):c(u)}function d(u,A){return C.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(u.codec&&A===o.default.AUDIO||A===o.default.VIDEO&&u.codec&&u.width&&u.height&&u.bitrate&&u.framerate)}function c(u){return new Promise(function(A){if(!u||!u.codec){A(!1);return}var D=u.codec;if(u.width&&u.height&&(D+=';width="'+u.width+'";height="'+u.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(D)){A(!0);return}else if("WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(D)){A(!0);return}A(!1)})}function M(u,A){return new Promise(function(D){if(!u||!u.codec){D(!1);return}var j={type:"media-source"};j[A]={},j[A].contentType=u.codec,j[A].width=u.width,j[A].height=u.height,j[A].bitrate=parseInt(u.bitrate),j[A].framerate=parseFloat(u.framerate),navigator.mediaCapabilities.decodingInfo(j).then(function($){D($.supported)}).catch(function(){D(!1)})})}function n(u){try{return l.THUMBNAILS_SCHEME_ID_URIS.indexOf(u.schemeIdUri)!==-1}catch{return!0}}function _(u,A){for(var D=u.split(".")[0],j=A.indexOf(D)===0,$,z=0;z<i.length;z++)if(i[z].codec===D){$=i[z];break}return $?j||$.compatibleCodecs.some(function(ee){return A.indexOf(ee)===0}):j}return g={setConfig:R,supportsMediaSource:E,supportsEncryptedMedia:m,supportsCodec:r,setEncryptedMediaSupported:f,supportsEssentialProperty:n,codecRootCompatibleWithCodec:_},P(),g}h.__dashjs_factory_name="Capabilities";let t=p.default.getSingletonFactory(h)},"./src/streaming/utils/CapabilitiesFilter.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/streaming/constants/Constants.js"),i=e("./src/core/EventBus.js"),E=e("./src/core/events/Events.js");function h(){var g=this.context,C=(0,i.default)(g).getInstance(),T,P,R,m,f,r;function d(){r=(0,l.default)(g).getInstance().getLogger(T)}function c(ee){ee&&(ee.adapter&&(P=ee.adapter),ee.capabilities&&(R=ee.capabilities),ee.settings&&(m=ee.settings),ee.customParametersModel&&(f=ee.customParametersModel))}function M(ee){return new Promise(function(k){var w=[];w.push(n(o.default.VIDEO,ee)),w.push(n(o.default.AUDIO,ee)),Promise.all(w).then(function(){m.get().streaming.capabilities.filterUnsupportedEssentialProperties&&$(ee),z(ee),k()}).catch(function(){k()})})}function n(ee,k){if(!k||!k.Period_asArray||k.Period_asArray.length===0)return Promise.resolve();var w=[];return k.Period_asArray.forEach(function(N){w.push(_(N,ee))}),Promise.all(w)}function _(ee,k){return new Promise(function(w){if(!ee||!ee.AdaptationSet_asArray||ee.AdaptationSet_asArray.length===0){w();return}var N=[];ee.AdaptationSet_asArray.forEach(function(H){P.getIsTypeOf(H,k)&&N.push(u(H,k))}),Promise.all(N).then(function(){ee.AdaptationSet_asArray=ee.AdaptationSet_asArray.filter(function(H){var W=H.Representation_asArray&&H.Representation_asArray.length>0;return W||(C.trigger(E.default.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:H}),r.warn("AdaptationSet has been removed because of no supported Representation")),W}),w()}).catch(function(){w()})})}function u(ee,k){return new Promise(function(w){if(!ee.Representation_asArray||ee.Representation_asArray.length===0){w();return}var N=[],H=[];ee.Representation_asArray.forEach(function(W,Z){var X=P.getCodec(ee,Z,!1),te=A(k,W,X);H.push(te),N.push(R.supportsCodec(te,k))}),Promise.all(N).then(function(W){ee.Representation_asArray=ee.Representation_asArray.filter(function(Z,X){return W[X]||r.debug("[Stream] Codec ".concat(H[X].codec," not supported ")),W[X]}),w()}).catch(function(){w()})})}function A(ee,k,w){switch(ee){case o.default.VIDEO:return D(k,w);case o.default.AUDIO:return j(k,w);default:return null}}function D(ee,k){var w=ee.width||null,N=ee.height||null,H=ee.frameRate||null,W=ee.bandwidth||null;return{codec:k,width:w,height:N,framerate:H,bitrate:W}}function j(ee,k){var w=ee.audioSamplingRate||null,N=ee.bandwidth||null;return{codec:k,bitrate:N,samplerate:w}}function $(ee){!ee||!ee.Period_asArray||ee.Period_asArray.length===0||ee.Period_asArray.forEach(function(k){k.AdaptationSet_asArray=k.AdaptationSet_asArray.filter(function(w){return!w.Representation_asArray||w.Representation_asArray.length===0?!0:(w.Representation_asArray=w.Representation_asArray.filter(function(N){var H=P.getEssentialPropertiesForRepresentation(N);if(H&&H.length>0)for(var W=0;W<H.length;){if(!R.supportsEssentialProperty(H[W]))return r.debug("[Stream] EssentialProperty not supported: "+H[W].schemeIdUri),!1;W+=1}return!0}),w.Representation_asArray&&w.Representation_asArray.length>0)})})}function z(ee){var k=f.getCustomCapabilitiesFilters();!k||k.length===0||!ee||!ee.Period_asArray||ee.Period_asArray.length===0||ee.Period_asArray.forEach(function(w){w.AdaptationSet_asArray=w.AdaptationSet_asArray.filter(function(N){return!N.Representation_asArray||N.Representation_asArray.length===0?!0:(N.Representation_asArray=N.Representation_asArray.filter(function(H){return!k.some(function(W){return!W(H)})}),N.Representation_asArray&&N.Representation_asArray.length>0)})})}return T={setConfig:c,filterUnsupportedFeatures:M},d(),T}h.__dashjs_factory_name="CapabilitiesFilter";let t=p.default.getSingletonFactory(h)},"./src/streaming/utils/CustomTimeRanges.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/utils/SupervisorTools.js");function o(){var E=[],h=0;function t(m,f){var r;for(r=0;r<this.customTimeRangeArray.length&&m>this.customTimeRangeArray[r].start;r++);for(this.customTimeRangeArray.splice(r,0,{start:m,end:f}),r=0;r<this.customTimeRangeArray.length-1;r++)this.mergeRanges(r,r+1)&&r--;this.length=this.customTimeRangeArray.length}function g(){this.customTimeRangeArray=[],this.length=0}function C(m,f){for(var r=0;r<this.customTimeRangeArray.length;r++)if(m<=this.customTimeRangeArray[r].start&&f>=this.customTimeRangeArray[r].end)this.customTimeRangeArray.splice(r,1),r--;else if(m>this.customTimeRangeArray[r].start&&f<this.customTimeRangeArray[r].end){this.customTimeRangeArray.splice(r+1,0,{start:f,end:this.customTimeRangeArray[r].end}),this.customTimeRangeArray[r].end=m;break}else m>this.customTimeRangeArray[r].start&&m<this.customTimeRangeArray[r].end?this.customTimeRangeArray[r].end=m:f>this.customTimeRangeArray[r].start&&f<this.customTimeRangeArray[r].end&&(this.customTimeRangeArray[r].start=f);this.length=this.customTimeRangeArray.length}function T(m,f){var r=this.customTimeRangeArray[m],d=this.customTimeRangeArray[f];return r.start<=d.start&&d.start<=r.end&&r.end<=d.end?(r.end=d.end,this.customTimeRangeArray.splice(f,1),!0):d.start<=r.start&&r.start<=d.end&&d.end<=r.end?(r.start=d.start,this.customTimeRangeArray.splice(f,1),!0):d.start<=r.start&&r.start<=d.end&&r.end<=d.end?(this.customTimeRangeArray.splice(m,1),!0):r.start<=d.start&&d.start<=r.end&&d.end<=r.end?(this.customTimeRangeArray.splice(f,1),!0):!1}function P(m){return(0,l.checkInteger)(m),m>=this.customTimeRangeArray.length||m<0?NaN:this.customTimeRangeArray[m].start}function R(m){return(0,l.checkInteger)(m),m>=this.customTimeRangeArray.length||m<0?NaN:this.customTimeRangeArray[m].end}return{customTimeRangeArray:E,length:h,add:t,clear:g,remove:C,mergeRanges:T,start:P,end:R}}o.__dashjs_factory_name="CustomTimeRanges";let i=p.default.getClassFactory(o)},"./src/streaming/utils/DOMStorage.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/streaming/constants/Constants.js"),i=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],E="dashjs_?_bitrate",h="dashjs_?_settings",t="localStorage",g="sessionStorage",C="lastBitrate",T="lastMediaSettings";function P(f){f=f||{};var r=this.context,d=f.settings,c,M,n;function _(){M=(0,l.default)(r).getInstance().getLogger(c),A()}function u(N){if(n!==void 0)return n;n=!1;var H="1",W="1",Z;try{typeof window<"u"&&(Z=window[N])}catch(X){return M.warn("DOMStorage access denied: "+X.message),n}if(!Z||N!==t&&N!==g)return n;try{Z.setItem(H,W),Z.removeItem(H),n=!0}catch(X){M.warn("DOMStorage is supported, but cannot be used: "+X.message)}return n}function A(){u(t)&&i.forEach(function(N){var H=localStorage.getItem(N.oldKey);if(H){localStorage.removeItem(N.oldKey);try{localStorage.setItem(N.newKey,H)}catch(W){M.error(W.message)}}})}function D(){var N=6e5;return Math.round(new Date().getTime()/N)*N}function j(N,H){return u(N)&&d.get().streaming[H+"CachingInfo"].enabled}function $(){if(!d)throw new Error(o.default.MISSING_CONFIG_ERROR)}function z(N){if($(),!d.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var H=null;if(j(t,T)){var W=h.replace(/\?/,N);try{var Z=JSON.parse(localStorage.getItem(W))||{},X=new Date().getTime()-parseInt(Z.timestamp,10)>=d.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;H=Z.settings,X&&(localStorage.removeItem(W),H=null)}catch{return null}}return H}function ee(N){if($(),!d.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var H=NaN;if(j(t,C)){var W=E.replace(/\?/,N);try{var Z=JSON.parse(localStorage.getItem(W))||{},X=new Date().getTime()-parseInt(Z.timestamp,10)>=d.get().streaming.lastBitrateCachingInfo.ttl||!1,te=parseFloat(Z.bitrate);!isNaN(te)&&!X?(H=te,M.debug("Last saved bitrate for "+N+" was "+te)):X&&localStorage.removeItem(W)}catch{return null}}return H}function k(N,H){if(j(t,T)){var W=h.replace(/\?/,N);try{localStorage.setItem(W,JSON.stringify({settings:H,timestamp:D()}))}catch(Z){M.error(Z.message)}}}function w(N,H){if(j(t,C)&&H){var W=E.replace(/\?/,N);try{localStorage.setItem(W,JSON.stringify({bitrate:H.toFixed(3),timestamp:D()}))}catch(Z){M.error(Z.message)}}}return c={getSavedBitrateSettings:ee,setSavedBitrateSettings:w,getSavedMediaSettings:z,setSavedMediaSettings:k},_(),c}P.__dashjs_factory_name="DOMStorage";var R=p.default.getSingletonFactory(P);let m=R},"./src/streaming/utils/DefaultURLUtils.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(){var i,E=/^[a-z][a-z0-9+\-_.]*:/i,h=/^https?:\/\//i,t=/^https:\/\//i,g=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,C=function(j,$){try{return new window.URL(j,$).toString()}catch{return j}},T=function(j,$){var z=R;if(!$||!d(j))return j;c(j)&&(z=m),M(j)&&(z=r);var ee=z($),k=ee.charAt(ee.length-1)!=="/"&&j.charAt(0)!=="/"?"/":"";return[ee,j].join(k)};function P(){try{var D=new window.URL("x","http://y");i=C}catch{}finally{i=i||T}}function R(D){var j=D.indexOf("/"),$=D.lastIndexOf("/");return j!==-1?$===j+1?D:(D.indexOf("?")!==-1&&(D=D.substring(0,D.indexOf("?"))),D.substring(0,$+1)):""}function m(D){var j=D.match(g);return j?j[1]:""}function f(D){var j=/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(D);return j[2].substring(1)}function r(D){var j=D.match(E);return j?j[0]:""}function d(D){return!E.test(D)}function c(D){return d(D)&&D.charAt(0)==="/"}function M(D){return D.indexOf("//")===0}function n(D){return h.test(D)}function _(D){return t.test(D)}function u(D,j){return i(D,j)}P();var A={parseBaseUrl:R,parseOrigin:m,parseScheme:r,isRelative:d,isPathAbsolute:c,isSchemeRelative:M,isHTTPURL:n,isHTTPS:_,removeHostname:f,resolve:u};return A}l.__dashjs_factory_name="DefaultURLUtils";let o=p.default.getSingletonFactory(l)},"./src/streaming/utils/EBMLParser.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(i){i=i||{};var E,h=new DataView(i.data),t=0;function g(){return t}function C(n){t=n}function T(n,_){var u=!0,A=0,D,j;if(_===void 0&&(_=!1),n.tag>16777215?(h.getUint32(t)!==n.tag&&(u=!1),A=4):n.tag>65535?(D=h.getUint16(t),j=h.getUint8(t+2),D*256+j!==n.tag&&(u=!1),A=3):n.tag>255?(h.getUint16(t)!==n.tag&&(u=!1),A=2):(h.getUint8(t)!==n.tag&&(u=!1),A=1),!u&&n.required&&!_)throw new Error("required tag not found");return u&&(t+=A),u}function P(n,_){var u=T(n,_);return u&&f(),u}function R(n){var _;return T(n),_=f(),E[n.parse](_)}function m(n,_){var u=T(n,_),A;return u&&(A=f(),t+=A),u}function f(n){var _=1,u=128,A=8,D=-1,j=0,$=h.getUint8(t),z=0;for(z=0;z<A;z+=1){if(($&u)===u){j=n===void 0?$&~u:$,D=z;break}u>>=1}for(z=0;z<D;z+=1,_+=1)j=j<<8|255&h.getUint8(t+_);return t+=_,j}function r(n){var _;switch(n){case 4:_=h.getFloat32(t),t+=4;break;case 8:_=h.getFloat64(t),t+=8;break}return _}function d(n){if(n>4)return c(n);for(var _=0,u=0;u<n;u+=1)_<<=8,_|=h.getUint8(t+u)&255;return t+=n,_>>>0}function c(n){for(var _=Math.floor(Number.MAX_SAFE_INTEGER/256),u=0,A=0;A<n;A+=1){if(u>_)throw new Error("Value exceeds safe integer limit");u*=256;var D=h.getUint8(t+A);if(u>Number.MAX_SAFE_INTEGER-D)throw new Error("Value exceeds safe integer limit");u+=D}return t+=n,u}function M(){return t<h.byteLength}return E={getPos:g,setPos:C,consumeTag:T,consumeTagAndSize:P,parseTag:R,skipOverElement:m,getMatroskaCodedNum:f,getMatroskaFloat:r,getMatroskaUint:d,moreData:M},E}l.__dashjs_factory_name="EBMLParser";let o=p.default.getClassFactory(l)},"./src/streaming/utils/ErrorHandler.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/EventBus.js"),l=e("./src/core/events/Events.js"),o=e("./src/core/FactoryMaker.js");function i(){var h,t=this.context,g=(0,p.default)(t).getInstance();function C(T){g.trigger(l.default.ERROR,{error:T})}return h={error:C},h}i.__dashjs_factory_name="ErrorHandler";let E=o.default.getSingletonFactory(i)},"./src/streaming/utils/InitCache.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(){var i={};function E(C){var T=C.streamId,P=C.representationId;i[T]=i[T]||{},i[T][P]=C}function h(C,T){return i&&i[C]&&i[C][T]?i[C][T]:null}function t(){i={}}var g={save:E,extract:h,reset:t};return g}l.__dashjs_factory_name="InitCache";let o=p.default.getSingletonFactory(l)},"./src/streaming/utils/IsoFile.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/streaming/vo/IsoBox.js"),l=e("./src/core/FactoryMaker.js");function o(){var E,h;function t(R){return!R||!h||!h.boxes||h.boxes.length===0||typeof h.fetch!="function"?null:P(h.fetch(R))}function g(R){var m=[];if(!R||!h||typeof h.fetchAll!="function")return m;for(var f=h.fetchAll(R),r,d=0,c=f.length;d<c;d++)r=P(f[d]),r&&m.push(r);return m}function C(R){h=R}function T(){if(!h||!h.boxes||!h.boxes.length)return null;var R=h.boxes[h.boxes.length-1].type,m=g(R);return m.length>0?m[m.length-1]:null}function P(R){if(!R)return null;var m=new p.default(R);return R.hasOwnProperty("_incomplete")&&(m.isComplete=!R._incomplete),m}return E={getBox:t,getBoxes:g,setData:C,getLastBox:T},E}o.__dashjs_factory_name="IsoFile";let i=l.default.getClassFactory(o)},"./src/streaming/utils/LocationSelector.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>t});var p=e("./src/core/events/Events.js"),l=e("./src/streaming/controllers/BlacklistController.js"),o=e("./src/core/FactoryMaker.js"),i=e("./src/core/Settings.js"),E=e("./src/dash/controllers/ContentSteeringController.js");function h(){var g=this.context,C=(0,i.default)(g).getInstance(),T,P,R;function m(){P=(0,l.default)(g).create({updateEventName:p.default.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:p.default.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD}),R=(0,E.default)(g).getInstance()}function f(_){_.blacklistController&&(P=_.blacklistController),_.contentSteeringController&&(R=_.contentSteeringController)}function r(_){if(!_||_.length===0)return null;var u=null;return C.get().streaming.applyContentSteering&&(u=d(_)),u||(u=M(_)),u}function d(_){var u=R.getCurrentSteeringResponseData();return u&&u.pathwayPriority&&u.pathwayPriority.length>0?c(u.pathwayPriority,_):null}function c(){for(var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],A=0,D=null,j=function(){var ee=_[A],k=u.findIndex(function(w){return w.serviceLocation&&w.serviceLocation===ee});if(k!==-1&&!P.contains(u[k].serviceLocation))return D=u[k],"break";A+=1};A<_.length;){var $=j();if($==="break")break}return D}function M(_){return _[0]}function n(){P.reset()}return T={select:r,setConfig:f,reset:n},m(),T}h.__dashjs_factory_name="LocationSelector";let t=o.default.getClassFactory(h)},"./src/streaming/utils/ObjectUtils.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./node_modules/fast-deep-equal/index.js"),o=e.n(l);function i(){var h;function t(g,C){return o()(g,C)}return h={areEqual:t},h}i.__dashjs_factory_name="ObjectUtils";let E=p.default.getSingletonFactory(i)},"./src/streaming/utils/RequestModifier.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i,modifyRequest:()=>l});var p=e("./src/core/FactoryMaker.js");function l(E,h){var t={url:E.url,method:E.method,headers:Object.assign({},E.headers),credentials:E.withCredentials?"include":void 0};return Promise.resolve(h.modifyRequest(t)).then(function(){return Object.assign(E,t,{withCredentials:t.credentials==="include"})})}function o(){var E;function h(g){return g}function t(g,C){var T=C.url;return g}return E={modifyRequest:null,modifyRequestURL:h,modifyRequestHeader:t},E}o.__dashjs_factory_name="RequestModifier";let i=p.default.getSingletonFactory(o)},"./src/streaming/utils/SegmentResponseModifier.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(){var i;function E(h){return Promise.resolve(h)}return i={modifyResponseAsync:E},i}l.__dashjs_factory_name="SegmentResponseModifier";let o=p.default.getSingletonFactory(l)},"./src/streaming/utils/SupervisorTools.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{checkInteger:()=>i,checkIsVideoOrAudioType:()=>h,checkParameterType:()=>o,checkRange:()=>E});var p=e("./src/streaming/constants/Constants.js");function l(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(C){return typeof C}:l=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},l(t)}function o(t,g){if(l(t)!==g)throw p.default.BAD_ARGUMENT_ERROR}function i(t){var g=t!==null&&!isNaN(t)&&t%1===0;if(!g)throw p.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"}function E(t,g,C){if(t<g||t>C)throw p.default.BAD_ARGUMENT_ERROR+" : argument out of range"}function h(t){if(typeof t!="string"||t!==p.default.AUDIO&&t!==p.default.VIDEO)throw p.default.BAD_ARGUMENT_ERROR}},"./src/streaming/utils/TTMLParser.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>C});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o=e("./src/core/EventBus.js"),i=e("./src/core/events/Events.js"),E=e("./node_modules/imsc/src/main/js/main.js"),h=e("./src/streaming/MediaPlayerEvents.js"),t=e("./src/streaming/constants/ConformanceViolationConstants.js");function g(){var T=this.context,P=(0,o.default)(T).getInstance(),R,m,f=0;function r(){m=(0,l.default)(T).getInstance().getLogger(R)}function d(){var M="cue_TTML_"+f;return f++,M}function c(M,n,_,u,A){var D="",j=[],$,z,ee,k={},w={},N="",H="",W={onOpenTag:function(J,ue,pe){if(pe[" imagetype"]&&!pe[" imageType"]&&(P.trigger(h.default.CONFORMANCE_VIOLATION,{level:t.default.LEVELS.ERROR,event:t.default.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),pe[" imageType"]=pe[" imagetype"]),ue==="image"&&(J==="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"||J==="http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt")){if(!pe[" imageType"]||pe[" imageType"].value!=="PNG"){m.warn("smpte-tt imageType != PNG. Discarded");return}N=pe["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){N&&(w[N]=H.trim()),H="",N=""},onText:function(J){N&&(H=H+J)}};if(!M)throw D="no ttml data to parse",new Error(D);k.data=M,P.trigger(i.default.TTML_TO_PARSE,k);var Z=(0,E.fromXML)(k.data,function(fe){D=fe},W);P.trigger(i.default.TTML_PARSED,{ttmlString:k.data,ttmlDoc:Z});var X=Z.getMediaTimeEvents();for(ee=0;ee<X.length;ee++){var te=(0,E.generateISD)(Z,X[ee],function(fe){D=fe});te.contents.some(function(fe){return fe.contents.length})&&($=X[ee]+n,z=X[ee+1]+n,$<z&&j.push({start:$,end:z,type:"html",cueID:d(),isd:te,images:A,embeddedImages:w}))}if(D!=="")throw m.error(D),new Error(D);return j}return R={parse:c},r(),R}g.__dashjs_factory_name="TTMLParser";let C=p.default.getSingletonFactory(g)},"./src/streaming/utils/TimeUtils.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(){var i;function E(h){var t=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(t.getTime()+h).getTime()}return i={ntpToUTC:E},i}l.__dashjs_factory_name="TimeUtils";let o=p.default.getSingletonFactory(l)},"./src/streaming/utils/URLUtils.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/streaming/utils/DefaultURLUtils.js");function o(){var h,t,g=[],C=this.context;function T(j){var $;for($=0;$<g.length;$++){var z=g[$].regex;if(z.test(j))return g[$].utils}return t}function P(){t=(0,l.default)(C).getInstance()}function R(j,$){g.push({regex:j,utils:$})}function m(j,$,z){var ee=T(z||$);return ee&&typeof ee[j]=="function"?ee[j]($,z):t[j]($,z)}function f(j){return m("parseBaseUrl",j)}function r(j){return m("parseOrigin",j)}function d(j){return m("removeHostname",j)}function c(j){return m("parseScheme",j)}function M(j){return m("isRelative",j)}function n(j){return m("isPathAbsolute",j)}function _(j){return m("isSchemeRelative",j)}function u(j){return m("isHTTPURL",j)}function A(j){return m("isHTTPS",j)}function D(j,$){return m("resolve",j,$)}return P(),h={registerUrlRegex:R,parseBaseUrl:f,parseOrigin:r,parseScheme:c,isRelative:M,isPathAbsolute:n,isSchemeRelative:_,isHTTPURL:u,isHTTPS:A,removeHostname:d,resolve:D},h}o.__dashjs_factory_name="URLUtils";var i=p.default.getSingletonFactory(o);let E=i},"./src/streaming/utils/VTTParser.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});var p=e("./src/core/FactoryMaker.js"),l=e("./src/core/Debug.js"),o="WEBVTT";function i(){var h=this.context,t,g,C,T,P,R;function m(){g=(0,l.default)(h).getInstance().getLogger(t),C=/(?:\r\n|\r|\n)/gm,T=/-->/,P=/(^[\s]+|[\s]+$)/g,R=/\s\b/g}function f(n){var _=[],u,A;if(!n)return _;n=n.split(C),u=n.length,A=-1;for(var D=0;D<u;D++){var j=n[D];if(j.length>0&&j!==o&&j.match(T)){var $=d(j),z=$.cuePoints,ee=$.styles,k=M(n,D+1),w=r(z[0].replace(P,"")),N=r(z[1].replace(P,""));!isNaN(w)&&!isNaN(N)&&w>=A&&N>w?k!==""?(A=w,_.push({start:w,end:N,data:k,styles:ee})):g.error("Skipping cue due to empty/malformed cue text"):g.error("Skipping cue due to incorrect cue timing")}}return _}function r(n){var _=n.split(":"),u=_.length-1;return n=parseInt(_[u-1],10)*60+parseFloat(_[u]),u===2&&(n+=parseInt(_[0],10)*3600),n}function d(n){var _=n.split(T),u=_[1].split(R);return u.shift(),_[1]=u[0],u.shift(),{cuePoints:_,styles:c(u)}}function c(n){var _={};return n.forEach(function(u){if(u.split(/:/).length>1){var A=u.split(/:/)[1],D=!1;A&&A.search(/%/)!=-1&&(D=!0,A=parseInt(A.replace(/%/,""),10)),(u.match(/align/)||u.match(/A/))&&(_.align=A),(u.match(/line/)||u.match(/L/))&&(_.line=A==="auto"?A:parseInt(A,10),D&&(_.snapToLines=!1)),(u.match(/position/)||u.match(/P/))&&(_.position=A),(u.match(/size/)||u.match(/S/))&&(_.size=A)}}),_}function M(n,_){for(var u=_,A="",D="",j;n[u]!==""&&u<n.length;)u++;if(j=u-_,j>1)for(var $=0;$<j;$++)if(D=n[_+$],!D.match(T))A+=D,$!==j-1&&(A+=`
`);else{A="";break}else D=n[_],D.match(T)||(A=D);return A}return t={parse:f,getCaptionStyles:c},m(),t}i.__dashjs_factory_name="VTTParser";let E=p.default.getSingletonFactory(i)},"./src/streaming/utils/VttCustomRenderingParser.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(){var i,E;function h(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(E=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()))}catch{}}function t(g){var C=[];return E.oncue=function(T){T.start=T.startTime,T.end=T.endTime,T.data=T.text,T.styles={align:T.align,line:T.line,position:T.position,size:T.size},C.push(T)},E.parse(g),C}return i={parse:t},h(),i}l.__dashjs_factory_name="VttCustomRenderingParser";let o=p.default.getSingletonFactory(l)},"./src/streaming/utils/baseUrlResolution/BasicSelector.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(i){i=i||{};var E,h=i.blacklistController;function t(g){var C=0,T;return g&&g.some(function(P,R){return C=R,!h.contains(P.serviceLocation)})&&(T=g[C]),T}return E={select:t},E}l.__dashjs_factory_name="BasicSelector";let o=p.default.getClassFactory(l)},"./src/streaming/utils/baseUrlResolution/ContentSteeringSelector.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/core/FactoryMaker.js"),l=e("./src/dash/controllers/ContentSteeringController.js");function o(){var E=this.context,h,t,g;function C(){t=(0,l.default)(E).getInstance()}function T(m){m.blacklistController&&(g=m.blacklistController),m.contentSteeringController&&(t=m.contentSteeringController)}function P(m){var f=NaN;if(isNaN(m.selectedIdx)){var r=t.getSteeringDataFromManifest();r&&r.defaultServiceLocationArray.length>0&&(f=R(r.defaultServiceLocationArray,m.baseUrls))}var d=t.getCurrentSteeringResponseData();return m.baseUrls&&m.baseUrls.length&&d&&d.pathwayPriority&&d.pathwayPriority.length&&(f=R(d.pathwayPriority,m.baseUrls)),f}function R(){for(var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=0,d=NaN,c=function(){var _=m[r],u=f.findIndex(function(A){return A.serviceLocation&&A.serviceLocation===_});if(u!==-1&&!g.contains(f[u].serviceLocation))return d=u,"break";r+=1};r<m.length;){var M=c();if(M==="break")break}return d}return h={selectBaseUrlIndex:P,setConfig:T},C(),h}o.__dashjs_factory_name="ContentSteeringSelector";let i=p.default.getClassFactory(o)},"./src/streaming/utils/baseUrlResolution/DVBSelector.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});var p=e("./src/core/FactoryMaker.js");function l(i){i=i||{};var E,h=i.blacklistController;function t(T){var P=[],R=function(r){return!(P.length&&r.dvb_priority&&P.indexOf(r.dvb_priority)!==-1)},m=function(r){return h.contains(r.serviceLocation)?(r.dvb_priority&&P.push(r.dvb_priority),!1):!0};return T.filter(m).filter(R)}function g(T){var P=function(n,_){var u=n.dvb_priority-_.dvb_priority;return isNaN(u)?0:u},R=function(n,_,u){return!_||u[0].dvb_priority&&n.dvb_priority&&u[0].dvb_priority===n.dvb_priority},m=0,f=[],r=0,d,c;if(c=T.sort(P).filter(R),c.length)return c.length>1&&(c.forEach(function(M){m+=M.dvb_weight,f.push(m)}),d=Math.floor(Math.random()*(m-1)),f.every(function(M,n){return r=n,!(d<M)})),c[r]}function C(T){return T&&g(t(T))}return E={select:C},E}l.__dashjs_factory_name="DVBSelector";let o=p.default.getClassFactory(l)},"./src/streaming/vo/BitrateInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};let o=l},"./src/streaming/vo/DashJSError.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h,t){p(this,i),this.code=E||null,this.message=h||null,this.data=t||null};let o=l},"./src/streaming/vo/DataChunk.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};let o=l},"./src/streaming/vo/FragmentRequest.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>h});var p=e("./src/streaming/vo/metrics/HTTPRequest.js");function l(t,g){if(!(t instanceof g))throw new TypeError("Cannot call a class as a function")}function o(t,g){for(var C=0;C<g.length;C++){var T=g[C];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(t,T.key,T)}}function i(t,g,C){return g&&o(t.prototype,g),C&&o(t,C),t}var E=function(){function t(g){l(this,t),this.action=t.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=g||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return i(t,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===p.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(C){this.type=C&&C.init?p.HTTPRequest.INIT_SEGMENT_TYPE:p.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=C&&C.url?C.url:null,this.range=C&&C.range?C.range.start+"-"+C.range.end:null,this.mediaType=C&&C.mediaType?C.mediaType:null}}]),t}();E.ACTION_DOWNLOAD="download",E.ACTION_COMPLETE="complete";let h=E},"./src/streaming/vo/HeadRequest.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/streaming/vo/FragmentRequest.js");function l(m){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(r){return typeof r}:l=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},l(m)}function o(m,f){if(!(m instanceof f))throw new TypeError("Cannot call a class as a function")}function i(m,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(f&&f.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),f&&E(m,f)}function E(m,f){return E=Object.setPrototypeOf||function(d,c){return d.__proto__=c,d},E(m,f)}function h(m){var f=C();return function(){var d=T(m),c;if(f){var M=T(this).constructor;c=Reflect.construct(d,arguments,M)}else c=d.apply(this,arguments);return t(this,c)}}function t(m,f){return f&&(l(f)==="object"||typeof f=="function")?f:g(m)}function g(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(m){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},T(m)}var P=function(m){i(r,m);var f=h(r);function r(d){var c;return o(this,r),c=f.call(this,d),c.checkForExistenceOnly=!0,c}return r}(p.default);let R=P},"./src/streaming/vo/IsoBox.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>E});function p(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function")}function l(h,t){for(var g=0;g<t.length;g++){var C=t[g];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(h,C.key,C)}}function o(h,t,g){return t&&l(h.prototype,t),g&&l(h,g),h}var i=function(){function h(t){if(p(this,h),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var g=0;g<t.boxes.length;g++)this.boxes.push(new h(t.boxes[g]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var C=0;C<t.references.length;C++){var T={reference_type:t.references[C].reference_type,referenced_size:t.references[C].referenced_size,subsegment_duration:t.references[C].subsegment_duration};this.references.push(T)}}break;case"emsg":this.id=t.id,this.version=t.version===1?1:0,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=t.version===1?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var P=0,R=t.samples.length;P<R;P++){var m={sample_size:t.samples[P].sample_size,sample_duration:t.samples[P].sample_duration,sample_composition_time_offset:t.samples[P].sample_composition_time_offset};this.samples.push(m)}}break;case"prft":this.version=t.version,this.reference_track_ID=t.reference_track_ID,this.ntp_timestamp_sec=t.ntp_timestamp_sec,this.ntp_timestamp_frac=t.ntp_timestamp_frac,this.media_time=t.media_time,this.flags=t.flags;break}}return o(h,[{key:"getChildBox",value:function(g){for(var C=0;C<this.boxes.length;C++)if(this.boxes[C].type===g)return this.boxes[C]}},{key:"getChildBoxes",value:function(g){for(var C=[],T=0;T<this.boxes.length;T++)this.boxes[T].type===g&&C.push(this.boxes[T]);return C}}]),h}();let E=i},"./src/streaming/vo/IsoBoxSearchInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(E,h,t){p(this,i),this.lastCompletedOffset=E,this.found=h,this.size=t};let o=l},"./src/streaming/vo/MetricsList.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]};let o=l},"./src/streaming/vo/TextRequest.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>m});var p=e("./src/streaming/constants/Constants.js"),l=e("./src/streaming/vo/FragmentRequest.js");function o(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?o=function(d){return typeof d}:o=function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},o(f)}function i(f,r){if(!(f instanceof r))throw new TypeError("Cannot call a class as a function")}function E(f,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(r&&r.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),r&&h(f,r)}function h(f,r){return h=Object.setPrototypeOf||function(c,M){return c.__proto__=M,c},h(f,r)}function t(f){var r=T();return function(){var c=P(f),M;if(r){var n=P(this).constructor;M=Reflect.construct(c,arguments,n)}else M=c.apply(this,arguments);return g(this,M)}}function g(f,r){return r&&(o(r)==="object"||typeof r=="function")?r:C(f)}function C(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function P(f){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)},P(f)}var R=function(f){E(d,f);var r=t(d);function d(c,M){var n;return i(this,d),n=r.call(this),n.url=c||null,n.type=M||null,n.mediaType=p.default.STREAM,n.responseType="",n}return d}(l.default);let m=R},"./src/streaming/vo/TextTrackInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>R});var p=e("./src/dash/vo/MediaInfo.js");function l(m){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l=function(r){return typeof r}:l=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},l(m)}function o(m,f){if(!(m instanceof f))throw new TypeError("Cannot call a class as a function")}function i(m,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(f&&f.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),f&&E(m,f)}function E(m,f){return E=Object.setPrototypeOf||function(d,c){return d.__proto__=c,d},E(m,f)}function h(m){var f=C();return function(){var d=T(m),c;if(f){var M=T(this).constructor;c=Reflect.construct(d,arguments,M)}else c=d.apply(this,arguments);return t(this,c)}}function t(m,f){return f&&(l(f)==="object"||typeof f=="function")?f:g(m)}function g(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function T(m){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},T(m)}var P=function(m){i(r,m);var f=h(r);function r(){var d;return o(this,r),d=f.call(this),d.captionData=null,d.label=null,d.defaultTrack=!1,d.kind=null,d.isFragmented=!1,d.isEmbedded=!1,d.isTTML=null,d}return r}(p.default);let R=P},"./src/streaming/vo/Thumbnail.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null};let o=l},"./src/streaming/vo/ThumbnailTrackInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""};let o=l},"./src/streaming/vo/URIFragmentData.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};let o=l},"./src/streaming/vo/metrics/BufferLevel.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.t=null,this.level=null};let o=l},"./src/streaming/vo/metrics/BufferState.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>i});var p=e("./src/streaming/constants/MetricsConstants.js");function l(E,h){if(!(E instanceof h))throw new TypeError("Cannot call a class as a function")}var o=function E(){l(this,E),this.target=null,this.state=p.default.BUFFER_EMPTY};let i=o},"./src/streaming/vo/metrics/DVRInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.time=null,this.range=null,this.manifestInfo=null};let o=l},"./src/streaming/vo/metrics/DroppedFrames.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.time=null,this.droppedFrames=null};let o=l},"./src/streaming/vo/metrics/HTTPRequest.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{HTTPRequest:()=>l,HTTPRequestTrace:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null},o=function i(){p(this,i),this.s=null,this.d=null,this.b=[]};l.GET="GET",l.HEAD="HEAD",l.MPD_TYPE="MPD",l.XLINK_EXPANSION_TYPE="XLinkExpansion",l.INIT_SEGMENT_TYPE="InitializationSegment",l.INDEX_SEGMENT_TYPE="IndexSegment",l.MEDIA_SEGMENT_TYPE="MediaSegment",l.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",l.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",l.DVB_REPORTING_TYPE="DVBReporting",l.LICENSE="license",l.CONTENT_STEERING_TYPE="ContentSteering",l.OTHER_TYPE="other"},"./src/streaming/vo/metrics/ManifestUpdate.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{ManifestUpdate:()=>l,ManifestUpdateRepresentationInfo:()=>i,ManifestUpdateStreamInfo:()=>o});function p(E,h){if(!(E instanceof h))throw new TypeError("Cannot call a class as a function")}var l=function E(){p(this,E),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},o=function E(){p(this,E),this.id=null,this.index=null,this.start=null,this.duration=null},i=function E(){p(this,E),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},"./src/streaming/vo/metrics/PlayList.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{PlayList:()=>l,PlayListTrace:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};l.INITIAL_PLAYOUT_START_REASON="initial_playout",l.SEEK_START_REASON="seek",l.RESUME_FROM_PAUSE_START_REASON="resume",l.METRICS_COLLECTION_START_REASON="metrics_collection_start";var o=function i(){p(this,i),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};o.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",o.REBUFFERING_REASON="rebuffering",o.USER_REQUEST_STOP_REASON="user_request",o.END_OF_PERIOD_STOP_REASON="end_of_period",o.END_OF_CONTENT_STOP_REASON="end_of_content",o.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",o.FAILURE_STOP_REASON="failure"},"./src/streaming/vo/metrics/RepresentationSwitch.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.t=null,this.mt=null,this.to=null,this.lto=null};let o=l},"./src/streaming/vo/metrics/RequestsQueue.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.loadingRequests=[],this.executedRequests=[]};let o=l},"./src/streaming/vo/metrics/SchedulingInfo.js":(V,v,e)=>{"use strict";e.r(v),e.d(v,{default:()=>o});function p(i,E){if(!(i instanceof E))throw new TypeError("Cannot call a class as a function")}var l=function i(){p(this,i),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};let o=l},"./node_modules/bcp-47-match/index.js":(V,v)=>{"use strict";v.basicFilter=o(e,!0),v.extendedFilter=o(p,!0),v.lookup=o(l);function e(E,h){return h==="*"||E===h||E.indexOf(h+"-")>-1}function p(E,h){var t=E.split("-"),g=h.split("-"),C=0,T=0;if(g[T]!=="*"&&t[C]!==g[T])return!1;for(C++,T++;T<g.length;){if(g[T]==="*"){T++;continue}if(!t[C])return!1;if(t[C]===g[T]){C++,T++;continue}if(t[C].length===1)return!1;C++}return!0}function l(E,h){for(var t=h,g;;){if(t==="*"||E===t)return!0;if(g=t.lastIndexOf("-"),g<0)return!1;t.charAt(g-2)==="-"&&(g-=2),t=t.slice(0,g)}}function o(E,h){return t;function t(g,C){for(var T=i(g,"tag"),P=i(C??"*","range"),R=[],m=-1,f,r,d;++m<P.length;)if(f=P[m].toLowerCase(),!(!h&&f==="*")){for(r=-1,d=[];++r<T.length;)if(E(T[r].toLowerCase(),f)){if(!h)return T[r];R.push(T[r])}else d.push(T[r]);T=d}return h?R:void 0}}function i(E,h){var t=E&&typeof E=="string"?[E]:E;if(!t||typeof t!="object"||!("length"in t))throw new Error("Invalid "+h+" `"+t+"`, expected non-empty string");return t}},"./node_modules/bcp-47-normalize/index.js":(V,v,e)=>{"use strict";V.exports=e("./node_modules/bcp-47-normalize/lib/index.js")},"./node_modules/bcp-47-normalize/lib/index.js":(V,v,e)=>{"use strict";var p=e("./node_modules/bcp-47/index.js"),l=e("./node_modules/bcp-47-match/index.js"),o=e("./node_modules/bcp-47-normalize/lib/matches.json"),i=e("./node_modules/bcp-47-normalize/lib/fields.json"),E=e("./node_modules/bcp-47-normalize/lib/defaults.json"),h=e("./node_modules/bcp-47-normalize/lib/many.json");V.exports=T;var t={}.hasOwnProperty,g=new Intl.Collator,C={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function T(r,d){var c=d||{},M=p.parse(String(r||"").toLowerCase(),c),n=p.stringify(M),_=-1,u;if(!n)return n;for(;++_<o.length;)l.extendedFilter(n,o[_].from).length&&(P(M,o[_].from,o[_].to),n=p.stringify(M));for(_=-1;++_<i.length;)R(M,i[_].from.field,i[_].from.value)&&m(M,i[_].to.field,i[_].to.value);for(n=p.stringify(Object.assign({},M,C)),_=-1;++_<E.length;)n===E[_]&&(P(M,E[_],E[_].split("-").slice(0,-1).join("-")),n=p.stringify(Object.assign({},M,C)));if(M.extensions.sort(f),c.warning)for(u in h)t.call(h[u],M[u])&&c.warning("Deprecated "+u+" `"+M[u]+"`, expected one of `"+h[u][M[u]].join("`, `")+"`",null,7);return M.script&&(M.script=M.script.charAt(0).toUpperCase()+M.script.slice(1)),M.region&&(M.region=M.region.toUpperCase()),p.stringify(M)}function P(r,d,c){var M=p.parse(d),n=p.parse(c),_=[],u;for(u in M)M[u]&&M[u].length&&R(r,u,M[u])&&_.push(u);for(u in n)n[u]&&n[u].length&&(_.indexOf(u)>-1||!r[u]||!r[u].length)&&m(r,u,n[u])}function R(r,d,c){var M=!1,n,_,u,A;if(c){if(n=r[d],_=n,n&&typeof n=="object")for(_=[],u=-1;++u<n.length;)A=n[u],c.indexOf(A)<0?_.push(A):M=!0;else n===c&&(_=null,M=!0);r[d]=_}return M}function m(r,d,c){var M=r[d],n,_,u;if(M&&typeof M=="object")for(n=[].concat(c),_=-1;++_<n.length;)u=n[_],M.indexOf(u)<0&&M.push(u);else r[d]=c}function f(r,d){return g.compare(r.singleton,d.singleton)}},"./node_modules/bcp-47/index.js":(V,v,e)=>{"use strict";v.parse=e("./node_modules/bcp-47/lib/parse.js"),v.stringify=e("./node_modules/bcp-47/lib/stringify.js")},"./node_modules/bcp-47/lib/parse.js":(V,v,e)=>{"use strict";var p=e("./node_modules/is-alphanumerical/index.js"),l=e("./node_modules/is-alphabetical/index.js"),o=e("./node_modules/is-decimal/index.js"),i=e("./node_modules/bcp-47/lib/regular.json"),E=e("./node_modules/bcp-47/lib/normalize.json");V.exports=t;var h={}.hasOwnProperty;function t(C,T){var P=T||{},R=g(),m=String(C),f=m.toLowerCase(),r=0,d,c,M;if(C==null)throw new Error("Expected string, got `"+C+"`");if(h.call(E,f))return(P.normalize==null||P.normalize)&&E[f]?t(E[f]):(R[i.indexOf(f)===-1?"irregular":"regular"]=m,R);for(;l(f.charCodeAt(r))&&r<9;)r++;if(r>1&&r<9){if(R.language=m.slice(0,r),r<4)for(c=0;f.charCodeAt(r)===45&&l(f.charCodeAt(r+1))&&l(f.charCodeAt(r+2))&&l(f.charCodeAt(r+3))&&!l(f.charCodeAt(r+4));){if(c>2)return n(r,3,"Too many extended language subtags, expected at most 3 subtags");R.extendedLanguageSubtags.push(m.slice(r+1,r+4)),r+=4,c++}for(f.charCodeAt(r)===45&&l(f.charCodeAt(r+1))&&l(f.charCodeAt(r+2))&&l(f.charCodeAt(r+3))&&l(f.charCodeAt(r+4))&&!l(f.charCodeAt(r+5))&&(R.script=m.slice(r+1,r+5),r+=5),f.charCodeAt(r)===45&&(l(f.charCodeAt(r+1))&&l(f.charCodeAt(r+2))&&!l(f.charCodeAt(r+3))?(R.region=m.slice(r+1,r+3),r+=3):o(f.charCodeAt(r+1))&&o(f.charCodeAt(r+2))&&o(f.charCodeAt(r+3))&&!o(f.charCodeAt(r+4))&&(R.region=m.slice(r+1,r+4),r+=4));f.charCodeAt(r)===45;){for(M=d=r+1;p(f.charCodeAt(M));){if(M-d>7)return n(M,1,"Too long variant, expected at most 8 characters");M++}if(M-d>4||M-d>3&&o(f.charCodeAt(d)))R.variants.push(m.slice(d,M)),r=M;else break}for(;f.charCodeAt(r)===45&&!(f.charCodeAt(r+1)===120||!p(f.charCodeAt(r+1))||f.charCodeAt(r+2)!==45||!p(f.charCodeAt(r+3)));){for(M=r+2,c=0;f.charCodeAt(M)===45&&p(f.charCodeAt(M+1))&&p(f.charCodeAt(M+2));)for(d=M+1,M=d+2,c++;p(f.charCodeAt(M));){if(M-d>7)return n(M,2,"Too long extension, expected at most 8 characters");M++}if(!c)return n(M,4,"Empty extension, extensions must have at least 2 characters of content");R.extensions.push({singleton:m.charAt(r+1),extensions:m.slice(r+3,M).split("-")}),r=M}}else r=0;if(r===0&&f.charCodeAt(r)===120||f.charCodeAt(r)===45&&f.charCodeAt(r+1)===120)for(M=r=r?r+2:1;f.charCodeAt(M)===45&&p(f.charCodeAt(M+1));){for(M=d=r+1;p(f.charCodeAt(M));){if(M-d>7)return n(M,5,"Too long private-use area, expected at most 8 characters");M++}R.privateuse.push(m.slice(r+1,M)),r=M}if(r!==m.length)return n(r,6,"Found superfluous content after tag");return R;function n(_,u,A){return P.warning&&P.warning(A,u,_),P.forgiving?R:g()}}function g(){return{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}},"./node_modules/bcp-47/lib/stringify.js":V=>{"use strict";V.exports=v;function v(e){var p=e||{},l=[],o,i,E;if(p.irregular||p.regular)return p.irregular||p.regular;if(p.language)for(l=l.concat(p.language,p.extendedLanguageSubtags||[],p.script||[],p.region||[],p.variants||[]),o=p.extensions||[],i=-1;++i<o.length;)E=o[i],E.singleton&&E.extensions&&E.extensions.length&&(l=l.concat(E.singleton,E.extensions));return p.privateuse&&p.privateuse.length&&(l=l.concat("x",p.privateuse)),l.join("-")}},"./node_modules/buffer/index.js":(V,v,e)=>{"use strict";var p=e("./node_modules/buffer/node_modules/base64-js/index.js"),l=e("./node_modules/buffer/node_modules/ieee754/index.js"),o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;v.Buffer=t,v.SlowBuffer=M,v.INSPECT_MAX_BYTES=50;var i=2147483647;v.kMaxLength=i,t.TYPED_ARRAY_SUPPORT=E(),!t.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function E(){try{var y=new Uint8Array(1),S={foo:function(){return 42}};return Object.setPrototypeOf(S,Uint8Array.prototype),Object.setPrototypeOf(y,S),y.foo()===42}catch{return!1}}Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}});function h(y){if(y>i)throw new RangeError('The value "'+y+'" is invalid for option "size"');var S=new Uint8Array(y);return Object.setPrototypeOf(S,t.prototype),S}function t(y,S,b){if(typeof y=="number"){if(typeof S=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return P(y)}return g(y,S,b)}t.poolSize=8192;function g(y,S,b){if(typeof y=="string")return R(y,S);if(ArrayBuffer.isView(y))return f(y);if(y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y);if(K(y,ArrayBuffer)||y&&K(y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(K(y,SharedArrayBuffer)||y&&K(y.buffer,SharedArrayBuffer)))return r(y,S,b);if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var F=y.valueOf&&y.valueOf();if(F!=null&&F!==y)return t.from(F,S,b);var oe=d(y);if(oe)return oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return t.from(y[Symbol.toPrimitive]("string"),S,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y)}t.from=function(y,S,b){return g(y,S,b)},Object.setPrototypeOf(t.prototype,Uint8Array.prototype),Object.setPrototypeOf(t,Uint8Array);function C(y){if(typeof y!="number")throw new TypeError('"size" argument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is invalid for option "size"')}function T(y,S,b){return C(y),y<=0?h(y):S!==void 0?typeof b=="string"?h(y).fill(S,b):h(y).fill(S):h(y)}t.alloc=function(y,S,b){return T(y,S,b)};function P(y){return C(y),h(y<0?0:c(y)|0)}t.allocUnsafe=function(y){return P(y)},t.allocUnsafeSlow=function(y){return P(y)};function R(y,S){if((typeof S!="string"||S==="")&&(S="utf8"),!t.isEncoding(S))throw new TypeError("Unknown encoding: "+S);var b=n(y,S)|0,F=h(b),oe=F.write(y,S);return oe!==b&&(F=F.slice(0,oe)),F}function m(y){for(var S=y.length<0?0:c(y.length)|0,b=h(S),F=0;F<S;F+=1)b[F]=y[F]&255;return b}function f(y){if(K(y,Uint8Array)){var S=new Uint8Array(y);return r(S.buffer,S.byteOffset,S.byteLength)}return m(y)}function r(y,S,b){if(S<0||y.byteLength<S)throw new RangeError('"offset" is outside of buffer bounds');if(y.byteLength<S+(b||0))throw new RangeError('"length" is outside of buffer bounds');var F;return S===void 0&&b===void 0?F=new Uint8Array(y):b===void 0?F=new Uint8Array(y,S):F=new Uint8Array(y,S,b),Object.setPrototypeOf(F,t.prototype),F}function d(y){if(t.isBuffer(y)){var S=c(y.length)|0,b=h(S);return b.length===0||y.copy(b,0,0,S),b}if(y.length!==void 0)return typeof y.length!="number"||U(y.length)?h(0):m(y);if(y.type==="Buffer"&&Array.isArray(y.data))return m(y.data)}function c(y){if(y>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return y|0}function M(y){return+y!=y&&(y=0),t.alloc(+y)}t.isBuffer=function(S){return S!=null&&S._isBuffer===!0&&S!==t.prototype},t.compare=function(S,b){if(K(S,Uint8Array)&&(S=t.from(S,S.offset,S.byteLength)),K(b,Uint8Array)&&(b=t.from(b,b.offset,b.byteLength)),!t.isBuffer(S)||!t.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(S===b)return 0;for(var F=S.length,oe=b.length,ie=0,q=Math.min(F,oe);ie<q;++ie)if(S[ie]!==b[ie]){F=S[ie],oe=b[ie];break}return F<oe?-1:oe<F?1:0},t.isEncoding=function(S){switch(String(S).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(S,b){if(!Array.isArray(S))throw new TypeError('"list" argument must be an Array of Buffers');if(S.length===0)return t.alloc(0);var F;if(b===void 0)for(b=0,F=0;F<S.length;++F)b+=S[F].length;var oe=t.allocUnsafe(b),ie=0;for(F=0;F<S.length;++F){var q=S[F];if(K(q,Uint8Array))ie+q.length>oe.length?t.from(q).copy(oe,ie):Uint8Array.prototype.set.call(oe,q,ie);else if(t.isBuffer(q))q.copy(oe,ie);else throw new TypeError('"list" argument must be an Array of Buffers');ie+=q.length}return oe};function n(y,S){if(t.isBuffer(y))return y.length;if(ArrayBuffer.isView(y)||K(y,ArrayBuffer))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof y);var b=y.length,F=arguments.length>2&&arguments[2]===!0;if(!F&&b===0)return 0;for(var oe=!1;;)switch(S){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return Q(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b*2;case"hex":return b>>>1;case"base64":return I(y).length;default:if(oe)return F?-1:Q(y).length;S=(""+S).toLowerCase(),oe=!0}}t.byteLength=n;function _(y,S,b){var F=!1;if((S===void 0||S<0)&&(S=0),S>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0,S>>>=0,b<=S))return"";for(y||(y="utf8");;)switch(y){case"hex":return te(this,S,b);case"utf8":case"utf-8":return N(this,S,b);case"ascii":return Z(this,S,b);case"latin1":case"binary":return X(this,S,b);case"base64":return w(this,S,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,S,b);default:if(F)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),F=!0}}t.prototype._isBuffer=!0;function u(y,S,b){var F=y[S];y[S]=y[b],y[b]=F}t.prototype.swap16=function(){var S=this.length;if(S%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<S;b+=2)u(this,b,b+1);return this},t.prototype.swap32=function(){var S=this.length;if(S%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<S;b+=4)u(this,b,b+3),u(this,b+1,b+2);return this},t.prototype.swap64=function(){var S=this.length;if(S%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<S;b+=8)u(this,b,b+7),u(this,b+1,b+6),u(this,b+2,b+5),u(this,b+3,b+4);return this},t.prototype.toString=function(){var S=this.length;return S===0?"":arguments.length===0?N(this,0,S):_.apply(this,arguments)},t.prototype.toLocaleString=t.prototype.toString,t.prototype.equals=function(S){if(!t.isBuffer(S))throw new TypeError("Argument must be a Buffer");return this===S?!0:t.compare(this,S)===0},t.prototype.inspect=function(){var S="",b=v.INSPECT_MAX_BYTES;return S=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(S+=" ... "),"<Buffer "+S+">"},o&&(t.prototype[o]=t.prototype.inspect),t.prototype.compare=function(S,b,F,oe,ie){if(K(S,Uint8Array)&&(S=t.from(S,S.offset,S.byteLength)),!t.isBuffer(S))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof S);if(b===void 0&&(b=0),F===void 0&&(F=S?S.length:0),oe===void 0&&(oe=0),ie===void 0&&(ie=this.length),b<0||F>S.length||oe<0||ie>this.length)throw new RangeError("out of range index");if(oe>=ie&&b>=F)return 0;if(oe>=ie)return-1;if(b>=F)return 1;if(b>>>=0,F>>>=0,oe>>>=0,ie>>>=0,this===S)return 0;for(var q=ie-oe,Ae=F-b,de=Math.min(q,Ae),Me=this.slice(oe,ie),Ie=S.slice(b,F),He=0;He<de;++He)if(Me[He]!==Ie[He]){q=Me[He],Ae=Ie[He];break}return q<Ae?-1:Ae<q?1:0};function A(y,S,b,F,oe){if(y.length===0)return-1;if(typeof b=="string"?(F=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b=+b,U(b)&&(b=oe?0:y.length-1),b<0&&(b=y.length+b),b>=y.length){if(oe)return-1;b=y.length-1}else if(b<0)if(oe)b=0;else return-1;if(typeof S=="string"&&(S=t.from(S,F)),t.isBuffer(S))return S.length===0?-1:D(y,S,b,F,oe);if(typeof S=="number")return S=S&255,typeof Uint8Array.prototype.indexOf=="function"?oe?Uint8Array.prototype.indexOf.call(y,S,b):Uint8Array.prototype.lastIndexOf.call(y,S,b):D(y,[S],b,F,oe);throw new TypeError("val must be string, number or Buffer")}function D(y,S,b,F,oe){var ie=1,q=y.length,Ae=S.length;if(F!==void 0&&(F=String(F).toLowerCase(),F==="ucs2"||F==="ucs-2"||F==="utf16le"||F==="utf-16le")){if(y.length<2||S.length<2)return-1;ie=2,q/=2,Ae/=2,b/=2}function de(ze,Ye){return ie===1?ze[Ye]:ze.readUInt16BE(Ye*ie)}var Me;if(oe){var Ie=-1;for(Me=b;Me<q;Me++)if(de(y,Me)===de(S,Ie===-1?0:Me-Ie)){if(Ie===-1&&(Ie=Me),Me-Ie+1===Ae)return Ie*ie}else Ie!==-1&&(Me-=Me-Ie),Ie=-1}else for(b+Ae>q&&(b=q-Ae),Me=b;Me>=0;Me--){for(var He=!0,Be=0;Be<Ae;Be++)if(de(y,Me+Be)!==de(S,Be)){He=!1;break}if(He)return Me}return-1}t.prototype.includes=function(S,b,F){return this.indexOf(S,b,F)!==-1},t.prototype.indexOf=function(S,b,F){return A(this,S,b,F,!0)},t.prototype.lastIndexOf=function(S,b,F){return A(this,S,b,F,!1)};function j(y,S,b,F){b=Number(b)||0;var oe=y.length-b;F?(F=Number(F),F>oe&&(F=oe)):F=oe;var ie=S.length;F>ie/2&&(F=ie/2);for(var q=0;q<F;++q){var Ae=parseInt(S.substr(q*2,2),16);if(U(Ae))return q;y[b+q]=Ae}return q}function $(y,S,b,F){return L(Q(S,y.length-b),y,b,F)}function z(y,S,b,F){return L(le(S),y,b,F)}function ee(y,S,b,F){return L(I(S),y,b,F)}function k(y,S,b,F){return L(Y(S,y.length-b),y,b,F)}t.prototype.write=function(S,b,F,oe){if(b===void 0)oe="utf8",F=this.length,b=0;else if(F===void 0&&typeof b=="string")oe=b,F=this.length,b=0;else if(isFinite(b))b=b>>>0,isFinite(F)?(F=F>>>0,oe===void 0&&(oe="utf8")):(oe=F,F=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ie=this.length-b;if((F===void 0||F>ie)&&(F=ie),S.length>0&&(F<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");oe||(oe="utf8");for(var q=!1;;)switch(oe){case"hex":return j(this,S,b,F);case"utf8":case"utf-8":return $(this,S,b,F);case"ascii":case"latin1":case"binary":return z(this,S,b,F);case"base64":return ee(this,S,b,F);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,S,b,F);default:if(q)throw new TypeError("Unknown encoding: "+oe);oe=(""+oe).toLowerCase(),q=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function w(y,S,b){return S===0&&b===y.length?p.fromByteArray(y):p.fromByteArray(y.slice(S,b))}function N(y,S,b){b=Math.min(y.length,b);for(var F=[],oe=S;oe<b;){var ie=y[oe],q=null,Ae=ie>239?4:ie>223?3:ie>191?2:1;if(oe+Ae<=b){var de,Me,Ie,He;switch(Ae){case 1:ie<128&&(q=ie);break;case 2:de=y[oe+1],(de&192)===128&&(He=(ie&31)<<6|de&63,He>127&&(q=He));break;case 3:de=y[oe+1],Me=y[oe+2],(de&192)===128&&(Me&192)===128&&(He=(ie&15)<<12|(de&63)<<6|Me&63,He>2047&&(He<55296||He>57343)&&(q=He));break;case 4:de=y[oe+1],Me=y[oe+2],Ie=y[oe+3],(de&192)===128&&(Me&192)===128&&(Ie&192)===128&&(He=(ie&15)<<18|(de&63)<<12|(Me&63)<<6|Ie&63,He>65535&&He<1114112&&(q=He))}}q===null?(q=65533,Ae=1):q>65535&&(q-=65536,F.push(q>>>10&1023|55296),q=56320|q&1023),F.push(q),oe+=Ae}return W(F)}var H=4096;function W(y){var S=y.length;if(S<=H)return String.fromCharCode.apply(String,y);for(var b="",F=0;F<S;)b+=String.fromCharCode.apply(String,y.slice(F,F+=H));return b}function Z(y,S,b){var F="";b=Math.min(y.length,b);for(var oe=S;oe<b;++oe)F+=String.fromCharCode(y[oe]&127);return F}function X(y,S,b){var F="";b=Math.min(y.length,b);for(var oe=S;oe<b;++oe)F+=String.fromCharCode(y[oe]);return F}function te(y,S,b){var F=y.length;(!S||S<0)&&(S=0),(!b||b<0||b>F)&&(b=F);for(var oe="",ie=S;ie<b;++ie)oe+=x[y[ie]];return oe}function fe(y,S,b){for(var F=y.slice(S,b),oe="",ie=0;ie<F.length-1;ie+=2)oe+=String.fromCharCode(F[ie]+F[ie+1]*256);return oe}t.prototype.slice=function(S,b){var F=this.length;S=~~S,b=b===void 0?F:~~b,S<0?(S+=F,S<0&&(S=0)):S>F&&(S=F),b<0?(b+=F,b<0&&(b=0)):b>F&&(b=F),b<S&&(b=S);var oe=this.subarray(S,b);return Object.setPrototypeOf(oe,t.prototype),oe};function J(y,S,b){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+S>b)throw new RangeError("Trying to access beyond buffer length")}t.prototype.readUintLE=t.prototype.readUIntLE=function(S,b,F){S=S>>>0,b=b>>>0,F||J(S,b,this.length);for(var oe=this[S],ie=1,q=0;++q<b&&(ie*=256);)oe+=this[S+q]*ie;return oe},t.prototype.readUintBE=t.prototype.readUIntBE=function(S,b,F){S=S>>>0,b=b>>>0,F||J(S,b,this.length);for(var oe=this[S+--b],ie=1;b>0&&(ie*=256);)oe+=this[S+--b]*ie;return oe},t.prototype.readUint8=t.prototype.readUInt8=function(S,b){return S=S>>>0,b||J(S,1,this.length),this[S]},t.prototype.readUint16LE=t.prototype.readUInt16LE=function(S,b){return S=S>>>0,b||J(S,2,this.length),this[S]|this[S+1]<<8},t.prototype.readUint16BE=t.prototype.readUInt16BE=function(S,b){return S=S>>>0,b||J(S,2,this.length),this[S]<<8|this[S+1]},t.prototype.readUint32LE=t.prototype.readUInt32LE=function(S,b){return S=S>>>0,b||J(S,4,this.length),(this[S]|this[S+1]<<8|this[S+2]<<16)+this[S+3]*16777216},t.prototype.readUint32BE=t.prototype.readUInt32BE=function(S,b){return S=S>>>0,b||J(S,4,this.length),this[S]*16777216+(this[S+1]<<16|this[S+2]<<8|this[S+3])},t.prototype.readIntLE=function(S,b,F){S=S>>>0,b=b>>>0,F||J(S,b,this.length);for(var oe=this[S],ie=1,q=0;++q<b&&(ie*=256);)oe+=this[S+q]*ie;return ie*=128,oe>=ie&&(oe-=Math.pow(2,8*b)),oe},t.prototype.readIntBE=function(S,b,F){S=S>>>0,b=b>>>0,F||J(S,b,this.length);for(var oe=b,ie=1,q=this[S+--oe];oe>0&&(ie*=256);)q+=this[S+--oe]*ie;return ie*=128,q>=ie&&(q-=Math.pow(2,8*b)),q},t.prototype.readInt8=function(S,b){return S=S>>>0,b||J(S,1,this.length),this[S]&128?(255-this[S]+1)*-1:this[S]},t.prototype.readInt16LE=function(S,b){S=S>>>0,b||J(S,2,this.length);var F=this[S]|this[S+1]<<8;return F&32768?F|4294901760:F},t.prototype.readInt16BE=function(S,b){S=S>>>0,b||J(S,2,this.length);var F=this[S+1]|this[S]<<8;return F&32768?F|4294901760:F},t.prototype.readInt32LE=function(S,b){return S=S>>>0,b||J(S,4,this.length),this[S]|this[S+1]<<8|this[S+2]<<16|this[S+3]<<24},t.prototype.readInt32BE=function(S,b){return S=S>>>0,b||J(S,4,this.length),this[S]<<24|this[S+1]<<16|this[S+2]<<8|this[S+3]},t.prototype.readFloatLE=function(S,b){return S=S>>>0,b||J(S,4,this.length),l.read(this,S,!0,23,4)},t.prototype.readFloatBE=function(S,b){return S=S>>>0,b||J(S,4,this.length),l.read(this,S,!1,23,4)},t.prototype.readDoubleLE=function(S,b){return S=S>>>0,b||J(S,8,this.length),l.read(this,S,!0,52,8)},t.prototype.readDoubleBE=function(S,b){return S=S>>>0,b||J(S,8,this.length),l.read(this,S,!1,52,8)};function ue(y,S,b,F,oe,ie){if(!t.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(S>oe||S<ie)throw new RangeError('"value" argument is out of bounds');if(b+F>y.length)throw new RangeError("Index out of range")}t.prototype.writeUintLE=t.prototype.writeUIntLE=function(S,b,F,oe){if(S=+S,b=b>>>0,F=F>>>0,!oe){var ie=Math.pow(2,8*F)-1;ue(this,S,b,F,ie,0)}var q=1,Ae=0;for(this[b]=S&255;++Ae<F&&(q*=256);)this[b+Ae]=S/q&255;return b+F},t.prototype.writeUintBE=t.prototype.writeUIntBE=function(S,b,F,oe){if(S=+S,b=b>>>0,F=F>>>0,!oe){var ie=Math.pow(2,8*F)-1;ue(this,S,b,F,ie,0)}var q=F-1,Ae=1;for(this[b+q]=S&255;--q>=0&&(Ae*=256);)this[b+q]=S/Ae&255;return b+F},t.prototype.writeUint8=t.prototype.writeUInt8=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,1,255,0),this[b]=S&255,b+1},t.prototype.writeUint16LE=t.prototype.writeUInt16LE=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,2,65535,0),this[b]=S&255,this[b+1]=S>>>8,b+2},t.prototype.writeUint16BE=t.prototype.writeUInt16BE=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,2,65535,0),this[b]=S>>>8,this[b+1]=S&255,b+2},t.prototype.writeUint32LE=t.prototype.writeUInt32LE=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,4,4294967295,0),this[b+3]=S>>>24,this[b+2]=S>>>16,this[b+1]=S>>>8,this[b]=S&255,b+4},t.prototype.writeUint32BE=t.prototype.writeUInt32BE=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,4,4294967295,0),this[b]=S>>>24,this[b+1]=S>>>16,this[b+2]=S>>>8,this[b+3]=S&255,b+4},t.prototype.writeIntLE=function(S,b,F,oe){if(S=+S,b=b>>>0,!oe){var ie=Math.pow(2,8*F-1);ue(this,S,b,F,ie-1,-ie)}var q=0,Ae=1,de=0;for(this[b]=S&255;++q<F&&(Ae*=256);)S<0&&de===0&&this[b+q-1]!==0&&(de=1),this[b+q]=(S/Ae>>0)-de&255;return b+F},t.prototype.writeIntBE=function(S,b,F,oe){if(S=+S,b=b>>>0,!oe){var ie=Math.pow(2,8*F-1);ue(this,S,b,F,ie-1,-ie)}var q=F-1,Ae=1,de=0;for(this[b+q]=S&255;--q>=0&&(Ae*=256);)S<0&&de===0&&this[b+q+1]!==0&&(de=1),this[b+q]=(S/Ae>>0)-de&255;return b+F},t.prototype.writeInt8=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,1,127,-128),S<0&&(S=255+S+1),this[b]=S&255,b+1},t.prototype.writeInt16LE=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,2,32767,-32768),this[b]=S&255,this[b+1]=S>>>8,b+2},t.prototype.writeInt16BE=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,2,32767,-32768),this[b]=S>>>8,this[b+1]=S&255,b+2},t.prototype.writeInt32LE=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,4,2147483647,-2147483648),this[b]=S&255,this[b+1]=S>>>8,this[b+2]=S>>>16,this[b+3]=S>>>24,b+4},t.prototype.writeInt32BE=function(S,b,F){return S=+S,b=b>>>0,F||ue(this,S,b,4,2147483647,-2147483648),S<0&&(S=4294967295+S+1),this[b]=S>>>24,this[b+1]=S>>>16,this[b+2]=S>>>8,this[b+3]=S&255,b+4};function pe(y,S,b,F,oe,ie){if(b+F>y.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function Ce(y,S,b,F,oe){return S=+S,b=b>>>0,oe||pe(y,S,b,4,34028234663852886e22,-34028234663852886e22),l.write(y,S,b,F,23,4),b+4}t.prototype.writeFloatLE=function(S,b,F){return Ce(this,S,b,!0,F)},t.prototype.writeFloatBE=function(S,b,F){return Ce(this,S,b,!1,F)};function ve(y,S,b,F,oe){return S=+S,b=b>>>0,oe||pe(y,S,b,8,17976931348623157e292,-17976931348623157e292),l.write(y,S,b,F,52,8),b+8}t.prototype.writeDoubleLE=function(S,b,F){return ve(this,S,b,!0,F)},t.prototype.writeDoubleBE=function(S,b,F){return ve(this,S,b,!1,F)},t.prototype.copy=function(S,b,F,oe){if(!t.isBuffer(S))throw new TypeError("argument should be a Buffer");if(F||(F=0),!oe&&oe!==0&&(oe=this.length),b>=S.length&&(b=S.length),b||(b=0),oe>0&&oe<F&&(oe=F),oe===F||S.length===0||this.length===0)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if(F<0||F>=this.length)throw new RangeError("Index out of range");if(oe<0)throw new RangeError("sourceEnd out of bounds");oe>this.length&&(oe=this.length),S.length-b<oe-F&&(oe=S.length-b+F);var ie=oe-F;return this===S&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(b,F,oe):Uint8Array.prototype.set.call(S,this.subarray(F,oe),b),ie},t.prototype.fill=function(S,b,F,oe){if(typeof S=="string"){if(typeof b=="string"?(oe=b,b=0,F=this.length):typeof F=="string"&&(oe=F,F=this.length),oe!==void 0&&typeof oe!="string")throw new TypeError("encoding must be a string");if(typeof oe=="string"&&!t.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);if(S.length===1){var ie=S.charCodeAt(0);(oe==="utf8"&&ie<128||oe==="latin1")&&(S=ie)}}else typeof S=="number"?S=S&255:typeof S=="boolean"&&(S=Number(S));if(b<0||this.length<b||this.length<F)throw new RangeError("Out of range index");if(F<=b)return this;b=b>>>0,F=F===void 0?this.length:F>>>0,S||(S=0);var q;if(typeof S=="number")for(q=b;q<F;++q)this[q]=S;else{var Ae=t.isBuffer(S)?S:t.from(S,oe),de=Ae.length;if(de===0)throw new TypeError('The value "'+S+'" is invalid for argument "value"');for(q=0;q<F-b;++q)this[q+b]=Ae[q%de]}return this};var Ee=/[^+/0-9A-Za-z-_]/g;function ge(y){if(y=y.split("=")[0],y=y.trim().replace(Ee,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}function Q(y,S){S=S||1/0;for(var b,F=y.length,oe=null,ie=[],q=0;q<F;++q){if(b=y.charCodeAt(q),b>55295&&b<57344){if(!oe){if(b>56319){(S-=3)>-1&&ie.push(239,191,189);continue}else if(q+1===F){(S-=3)>-1&&ie.push(239,191,189);continue}oe=b;continue}if(b<56320){(S-=3)>-1&&ie.push(239,191,189),oe=b;continue}b=(oe-55296<<10|b-56320)+65536}else oe&&(S-=3)>-1&&ie.push(239,191,189);if(oe=null,b<128){if((S-=1)<0)break;ie.push(b)}else if(b<2048){if((S-=2)<0)break;ie.push(b>>6|192,b&63|128)}else if(b<65536){if((S-=3)<0)break;ie.push(b>>12|224,b>>6&63|128,b&63|128)}else if(b<1114112){if((S-=4)<0)break;ie.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw new Error("Invalid code point")}return ie}function le(y){for(var S=[],b=0;b<y.length;++b)S.push(y.charCodeAt(b)&255);return S}function Y(y,S){for(var b,F,oe,ie=[],q=0;q<y.length&&!((S-=2)<0);++q)b=y.charCodeAt(q),F=b>>8,oe=b%256,ie.push(oe),ie.push(F);return ie}function I(y){return p.toByteArray(ge(y))}function L(y,S,b,F){for(var oe=0;oe<F&&!(oe+b>=S.length||oe>=y.length);++oe)S[oe+b]=y[oe];return oe}function K(y,S){return y instanceof S||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===S.name}function U(y){return y!==y}var x=function(){for(var y="0123456789abcdef",S=new Array(256),b=0;b<16;++b)for(var F=b*16,oe=0;oe<16;++oe)S[F+oe]=y[b]+y[oe];return S}()},"./node_modules/buffer/node_modules/base64-js/index.js":(V,v)=>{"use strict";v.byteLength=t,v.toByteArray=C,v.fromByteArray=R;for(var e=[],p=[],l=typeof Uint8Array<"u"?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,E=o.length;i<E;++i)e[i]=o[i],p[o.charCodeAt(i)]=i;p["-".charCodeAt(0)]=62,p["_".charCodeAt(0)]=63;function h(m){var f=m.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=m.indexOf("=");r===-1&&(r=f);var d=r===f?0:4-r%4;return[r,d]}function t(m){var f=h(m),r=f[0],d=f[1];return(r+d)*3/4-d}function g(m,f,r){return(f+r)*3/4-r}function C(m){var f,r=h(m),d=r[0],c=r[1],M=new l(g(m,d,c)),n=0,_=c>0?d-4:d,u;for(u=0;u<_;u+=4)f=p[m.charCodeAt(u)]<<18|p[m.charCodeAt(u+1)]<<12|p[m.charCodeAt(u+2)]<<6|p[m.charCodeAt(u+3)],M[n++]=f>>16&255,M[n++]=f>>8&255,M[n++]=f&255;return c===2&&(f=p[m.charCodeAt(u)]<<2|p[m.charCodeAt(u+1)]>>4,M[n++]=f&255),c===1&&(f=p[m.charCodeAt(u)]<<10|p[m.charCodeAt(u+1)]<<4|p[m.charCodeAt(u+2)]>>2,M[n++]=f>>8&255,M[n++]=f&255),M}function T(m){return e[m>>18&63]+e[m>>12&63]+e[m>>6&63]+e[m&63]}function P(m,f,r){for(var d,c=[],M=f;M<r;M+=3)d=(m[M]<<16&16711680)+(m[M+1]<<8&65280)+(m[M+2]&255),c.push(T(d));return c.join("")}function R(m){for(var f,r=m.length,d=r%3,c=[],M=16383,n=0,_=r-d;n<_;n+=M)c.push(P(m,n,n+M>_?_:n+M));return d===1?(f=m[r-1],c.push(e[f>>2]+e[f<<4&63]+"==")):d===2&&(f=(m[r-2]<<8)+m[r-1],c.push(e[f>>10]+e[f>>4&63]+e[f<<2&63]+"=")),c.join("")}},"./node_modules/buffer/node_modules/ieee754/index.js":(V,v)=>{v.read=function(e,p,l,o,i){var E,h,t=i*8-o-1,g=(1<<t)-1,C=g>>1,T=-7,P=l?i-1:0,R=l?-1:1,m=e[p+P];for(P+=R,E=m&(1<<-T)-1,m>>=-T,T+=t;T>0;E=E*256+e[p+P],P+=R,T-=8);for(h=E&(1<<-T)-1,E>>=-T,T+=o;T>0;h=h*256+e[p+P],P+=R,T-=8);if(E===0)E=1-C;else{if(E===g)return h?NaN:(m?-1:1)*(1/0);h=h+Math.pow(2,o),E=E-C}return(m?-1:1)*h*Math.pow(2,E-o)},v.write=function(e,p,l,o,i,E){var h,t,g,C=E*8-i-1,T=(1<<C)-1,P=T>>1,R=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=o?0:E-1,f=o?1:-1,r=p<0||p===0&&1/p<0?1:0;for(p=Math.abs(p),isNaN(p)||p===1/0?(t=isNaN(p)?1:0,h=T):(h=Math.floor(Math.log(p)/Math.LN2),p*(g=Math.pow(2,-h))<1&&(h--,g*=2),h+P>=1?p+=R/g:p+=R*Math.pow(2,1-P),p*g>=2&&(h++,g/=2),h+P>=T?(t=0,h=T):h+P>=1?(t=(p*g-1)*Math.pow(2,i),h=h+P):(t=p*Math.pow(2,P-1)*Math.pow(2,i),h=0));i>=8;e[l+m]=t&255,m+=f,t/=256,i-=8);for(h=h<<i|t,C+=i;C>0;e[l+m]=h&255,m+=f,h/=256,C-=8);e[l+m-f]|=r*128}},"./node_modules/codem-isoboxer/dist/iso_boxer.js":(V,v)=>{var e={};e.parseBuffer=function(o){return new p(o).parse()},e.addBoxProcessor=function(o,i){typeof o!="string"||typeof i!="function"||(l.prototype._boxProcessors[o]=i)},e.createFile=function(){return new p},e.createBox=function(o,i,E){var h=l.create(o);return i&&i.append(h,E),h},e.createFullBox=function(o,i,E){var h=e.createBox(o,i,E);return h.version=0,h.flags=0,h},e.Utils={},e.Utils.dataViewToString=function(o,i){var E=i||"utf-8";if(typeof TextDecoder<"u")return new TextDecoder(E).decode(o);var h=[],t=0;if(E==="utf-8")for(;t<o.byteLength;){var g=o.getUint8(t++);g<128||(g<224?(g=(g&31)<<6,g|=o.getUint8(t++)&63):g<240?(g=(g&15)<<12,g|=(o.getUint8(t++)&63)<<6,g|=o.getUint8(t++)&63):(g=(g&7)<<18,g|=(o.getUint8(t++)&63)<<12,g|=(o.getUint8(t++)&63)<<6,g|=o.getUint8(t++)&63)),h.push(String.fromCharCode(g))}else for(;t<o.byteLength;)h.push(String.fromCharCode(o.getUint8(t++)));return h.join("")},e.Utils.utf8ToByteArray=function(o){var i,E;if(typeof TextEncoder<"u")i=new TextEncoder().encode(o);else for(i=[],E=0;E<o.length;++E){var h=o.charCodeAt(E);h<128?i.push(h):h<2048?(i.push(192|h>>6),i.push(128|63&h)):h<65536?(i.push(224|h>>12),i.push(128|63&h>>6),i.push(128|63&h)):(i.push(240|h>>18),i.push(128|63&h>>12),i.push(128|63&h>>6),i.push(128|63&h))}return i},e.Utils.appendBox=function(o,i,E){if(i._offset=o._cursor.offset,i._root=o._root?o._root:o,i._raw=o._raw,i._parent=o,E!==-1){if(E==null){o.boxes.push(i);return}var h=-1,t;if(typeof E=="number")h=E;else{if(typeof E=="string")t=E;else if(typeof E=="object"&&E.type)t=E.type;else{o.boxes.push(i);return}for(var g=0;g<o.boxes.length;g++)if(t===o.boxes[g].type){h=g+1;break}}o.boxes.splice(h,0,i)}},v.parseBuffer=e.parseBuffer,v.addBoxProcessor=e.addBoxProcessor,v.createFile=e.createFile,v.createBox=e.createBox,v.createFullBox=e.createFullBox,v.Utils=e.Utils,e.Cursor=function(o){this.offset=typeof o>"u"?0:o};var p=function(o){this._cursor=new e.Cursor,this.boxes=[],o&&(this._raw=new DataView(o))};p.prototype.fetch=function(o){var i=this.fetchAll(o,!0);return i.length?i[0]:null},p.prototype.fetchAll=function(o,i){var E=[];return p._sweep.call(this,o,E,i),E},p.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var o=l.parse(this);if(typeof o.type>"u")break;this.boxes.push(o)}return this},p._sweep=function(o,i,E){this.type&&this.type==o&&i.push(this);for(var h in this.boxes){if(i.length&&E)return;p._sweep.call(this.boxes[h],o,i,E)}},p.prototype.write=function(){var o=0,i;for(i=0;i<this.boxes.length;i++)o+=this.boxes[i].getLength(!1);var E=new Uint8Array(o);for(this._rawo=new DataView(E.buffer),this.bytes=E,this._cursor.offset=0,i=0;i<this.boxes.length;i++)this.boxes[i].write();return E.buffer},p.prototype.append=function(o,i){e.Utils.appendBox(this,o,i)};var l=function(){this._cursor=new e.Cursor};l.parse=function(o){var i=new l;return i._offset=o._cursor.offset,i._root=o._root?o._root:o,i._raw=o._raw,i._parent=o,i._parseBox(),o._cursor.offset=i._raw.byteOffset+i._raw.byteLength,i},l.create=function(o){var i=new l;return i.type=o,i.boxes=[],i},l.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],l.prototype._boxProcessors={},l.prototype._procField=function(o,i,E){this._parsing?this[o]=this._readField(i,E):this._writeField(i,E,this[o])},l.prototype._procFieldArray=function(o,i,E,h){var t;if(this._parsing)for(this[o]=[],t=0;t<i;t++)this[o][t]=this._readField(E,h);else for(t=0;t<this[o].length;t++)this._writeField(E,h,this[o][t])},l.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},l.prototype._procEntries=function(o,i,E){var h;if(this._parsing)for(this[o]=[],h=0;h<i;h++)this[o].push({}),E.call(this,this[o][h]);else for(h=0;h<i;h++)E.call(this,this[o][h])},l.prototype._procSubEntries=function(o,i,E,h){var t;if(this._parsing)for(o[i]=[],t=0;t<E;t++)o[i].push({}),h.call(this,o[i][t]);else for(t=0;t<E;t++)h.call(this,o[i][t])},l.prototype._procEntryField=function(o,i,E,h){this._parsing?o[i]=this._readField(E,h):this._writeField(E,h,o[i])},l.prototype._procSubBoxes=function(o,i){var E;if(this._parsing)for(this[o]=[],E=0;E<i;E++)this[o].push(l.parse(this));else for(E=0;E<i;E++)this._rawo?this[o][E].write():this.size+=this[o][E].getLength()},l.prototype._readField=function(o,i){switch(o){case"uint":return this._readUint(i);case"int":return this._readInt(i);case"template":return this._readTemplate(i);case"string":return i===-1?this._readTerminatedString():this._readString(i);case"data":return this._readData(i);case"utf8":return this._readUTF8String();default:return-1}},l.prototype._readInt=function(o){var i=null,E=this._cursor.offset-this._raw.byteOffset;switch(o){case 8:i=this._raw.getInt8(E);break;case 16:i=this._raw.getInt16(E);break;case 32:i=this._raw.getInt32(E);break;case 64:var h=this._raw.getInt32(E),t=this._raw.getInt32(E+4);i=h*Math.pow(2,32)+t;break}return this._cursor.offset+=o>>3,i},l.prototype._readUint=function(o){var i=null,E=this._cursor.offset-this._raw.byteOffset,h,t;switch(o){case 8:i=this._raw.getUint8(E);break;case 16:i=this._raw.getUint16(E);break;case 24:h=this._raw.getUint16(E),t=this._raw.getUint8(E+2),i=(h<<8)+t;break;case 32:i=this._raw.getUint32(E);break;case 64:h=this._raw.getUint32(E),t=this._raw.getUint32(E+4),i=h*Math.pow(2,32)+t;break}return this._cursor.offset+=o>>3,i},l.prototype._readString=function(o){for(var i="",E=0;E<o;E++){var h=this._readUint(8);i+=String.fromCharCode(h)}return i},l.prototype._readTemplate=function(o){var i=this._readUint(o/2),E=this._readUint(o/2);return i+E/Math.pow(2,o/2)},l.prototype._readTerminatedString=function(){for(var o="";this._cursor.offset-this._offset<this._raw.byteLength;){var i=this._readUint(8);if(i===0)break;o+=String.fromCharCode(i)}return o},l.prototype._readData=function(o){var i=o>0?o:this._raw.byteLength-(this._cursor.offset-this._offset);if(i>0){var E=new Uint8Array(this._raw.buffer,this._cursor.offset,i);return this._cursor.offset+=i,E}else return null},l.prototype._readUTF8String=function(){var o=this._raw.byteLength-(this._cursor.offset-this._offset),i=null;return o>0&&(i=new DataView(this._raw.buffer,this._cursor.offset,o),this._cursor.offset+=o),i&&e.Utils.dataViewToString(i)},l.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength){this._root._incomplete=!0;return}switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())},l.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},l.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(l.parse(this))},l.prototype.append=function(o,i){e.Utils.appendBox(this,o,i)},l.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var o=0;o<this.boxes.length;o++)this.size+=this.boxes[o].getLength();return this._data&&this._writeData(this._data),this.size},l.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var o=0;o<this.boxes.length;o++)this.boxes[o].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},l.prototype._writeInt=function(o,i){if(this._rawo){var E=this._cursor.offset-this._rawo.byteOffset;switch(o){case 8:this._rawo.setInt8(E,i);break;case 16:this._rawo.setInt16(E,i);break;case 32:this._rawo.setInt32(E,i);break;case 64:var h=Math.floor(i/Math.pow(2,32)),t=i-h*Math.pow(2,32);this._rawo.setUint32(E,h),this._rawo.setUint32(E+4,t);break}this._cursor.offset+=o>>3}else this.size+=o>>3},l.prototype._writeUint=function(o,i){if(this._rawo){var E=this._cursor.offset-this._rawo.byteOffset,h,t;switch(o){case 8:this._rawo.setUint8(E,i);break;case 16:this._rawo.setUint16(E,i);break;case 24:h=(i&16776960)>>8,t=i&255,this._rawo.setUint16(E,h),this._rawo.setUint8(E+2,t);break;case 32:this._rawo.setUint32(E,i);break;case 64:h=Math.floor(i/Math.pow(2,32)),t=i-h*Math.pow(2,32),this._rawo.setUint32(E,h),this._rawo.setUint32(E+4,t);break}this._cursor.offset+=o>>3}else this.size+=o>>3},l.prototype._writeString=function(o,i){for(var E=0;E<o;E++)this._writeUint(8,i.charCodeAt(E))},l.prototype._writeTerminatedString=function(o){if(o.length!==0){for(var i=0;i<o.length;i++)this._writeUint(8,o.charCodeAt(i));this._writeUint(8,0)}},l.prototype._writeTemplate=function(o,i){var E=Math.floor(i),h=(i-E)*Math.pow(2,o/2);this._writeUint(o/2,E),this._writeUint(o/2,h)},l.prototype._writeData=function(o){var i;if(o)if(this._rawo){if(o instanceof Array){for(var E=this._cursor.offset-this._rawo.byteOffset,i=0;i<o.length;i++)this._rawo.setInt8(E+i,o[i]);this._cursor.offset+=o.length}o instanceof Uint8Array&&(this._root.bytes.set(o,this._cursor.offset),this._cursor.offset+=o.length)}else this.size+=o.length},l.prototype._writeUTF8String=function(o){var i=e.Utils.utf8ToByteArray(o);if(this._rawo)for(var E=new DataView(this._rawo.buffer,this._cursor.offset,i.length),h=0;h<i.length;h++)E.setUint8(h,i[h]);else this.size+=i.length},l.prototype._writeField=function(o,i,E){switch(o){case"uint":this._writeUint(i,E);break;case"int":this._writeInt(i,E);break;case"template":this._writeTemplate(i,E);break;case"string":i==-1?this._writeTerminatedString(E):this._writeString(i,E);break;case"data":this._writeData(E);break;case"utf8":this._writeUTF8String(E);break;default:break}},l.prototype._boxProcessors.avc1=l.prototype._boxProcessors.avc2=l.prototype._boxProcessors.avc3=l.prototype._boxProcessors.avc4=l.prototype._boxProcessors.hvc1=l.prototype._boxProcessors.hev1=l.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},l.prototype._boxProcessors.ctts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(o){this._procEntryField(o,"sample_count","uint",32),this._procEntryField(o,"sample_offset",this.version===1?"int":"uint",32)})},l.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},l.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(o){this._procEntryField(o,"segment_duration","uint",this.version===1?64:32),this._procEntryField(o,"media_time","int",this.version===1?64:32),this._procEntryField(o,"media_rate_integer","int",16),this._procEntryField(o,"media_rate_fraction","int",16)})},l.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},l.prototype._boxProcessors.free=l.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},l.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},l.prototype._boxProcessors.ftyp=l.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var o=-1;this._parsing&&(o=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",o,"string",4)},l.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},l.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},l.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),!this._parsing&&typeof this.language=="string"&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode((this.language>>10&31)+96,(this.language>>5&31)+96,(this.language&31)+96)),this._procField("pre_defined","uint",16)},l.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)},l.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},l.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},l.prototype._boxProcessors.mp4a=l.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},l.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},l.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},l.prototype._boxProcessors.prft=function(){this._procFullBox(),this._procField("reference_track_ID","uint",32),this._procField("ntp_timestamp_sec","uint",32),this._procField("ntp_timestamp_frac","uint",32),this._procField("media_time","uint",this.version==1?64:32)},l.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},l.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),this.flags&1&&this._procField("scheme_uri","string",-1)},l.prototype._boxProcessors.sdtp=function(){this._procFullBox();var o=-1;this._parsing&&(o=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",o,"uint",8)},l.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(o){this._parsing||(o.reference=(o.reference_type&1)<<31,o.reference|=o.referenced_size&2147483647,o.sap=(o.starts_with_SAP&1)<<31,o.sap|=(o.SAP_type&3)<<28,o.sap|=o.SAP_delta_time&268435455),this._procEntryField(o,"reference","uint",32),this._procEntryField(o,"subsegment_duration","uint",32),this._procEntryField(o,"sap","uint",32),this._parsing&&(o.reference_type=o.reference>>31&1,o.referenced_size=o.reference&2147483647,o.starts_with_SAP=o.sap>>31&1,o.SAP_type=o.sap>>28&7,o.SAP_delta_time=o.sap&268435455)})},l.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},l.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(o){this._procEntryField(o,"ranges_count","uint",32),this._procSubEntries(o,"ranges",o.ranges_count,function(i){this._procEntryField(i,"level","uint",8),this._procEntryField(i,"range_size","uint",24)})})},l.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},l.prototype._boxProcessors.sttg=function(){this._procField("settings","utf8")},l.prototype._boxProcessors.stts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(o){this._procEntryField(o,"sample_count","uint",32),this._procEntryField(o,"sample_delta","uint",32)})},l.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(o){this._procEntryField(o,"sample_delta","uint",32),this._procEntryField(o,"subsample_count","uint",16),this._procSubEntries(o,"subsamples",o.subsample_count,function(i){this._procEntryField(i,"subsample_size","uint",this.version===1?32:16),this._procEntryField(i,"subsample_priority","uint",8),this._procEntryField(i,"discardable","uint",8),this._procEntryField(i,"codec_specific_parameters","uint",32)})})},l.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},l.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)},l.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),this.flags&1&&this._procField("base_data_offset","uint",64),this.flags&2&&this._procField("sample_description_offset","uint",32),this.flags&8&&this._procField("default_sample_duration","uint",32),this.flags&16&&this._procField("default_sample_size","uint",32),this.flags&32&&this._procField("default_sample_flags","uint",32)},l.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(this.length_size_of_traf_num&48)<<4,this.reserved|=(this.length_size_of_trun_num&12)<<2,this.reserved|=this.length_size_of_sample_num&3),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(this.reserved&48)>>4,this.length_size_of_trun_num=(this.reserved&12)>>2,this.length_size_of_sample_num=this.reserved&3),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(o){this._procEntryField(o,"time","uint",this.version===1?64:32),this._procEntryField(o,"moof_offset","uint",this.version===1?64:32),this._procEntryField(o,"traf_number","uint",(this.length_size_of_traf_num+1)*8),this._procEntryField(o,"trun_number","uint",(this.length_size_of_trun_num+1)*8),this._procEntryField(o,"sample_number","uint",(this.length_size_of_sample_num+1)*8)})},l.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},l.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},l.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),this.flags&1&&this._procField("data_offset","int",32),this.flags&4&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(o){this.flags&256&&this._procEntryField(o,"sample_duration","uint",32),this.flags&512&&this._procEntryField(o,"sample_size","uint",32),this.flags&1024&&this._procEntryField(o,"sample_flags","uint",32),this.flags&2048&&this._procEntryField(o,"sample_composition_time_offset",this.version===1?"int":"uint",32)})},l.prototype._boxProcessors["url "]=l.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)},l.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},l.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},l.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},l.prototype._boxProcessors.vtte=function(){}},"./node_modules/es6-promise/auto.js":(V,v,e)=>{"use strict";V.exports=e("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},"./node_modules/es6-promise/dist/es6-promise.js":function(V,v,e){(function(p,l){V.exports=l()})(this,function(){"use strict";function p(q){var Ae=typeof q;return q!==null&&(Ae==="object"||Ae==="function")}function l(q){return typeof q=="function"}var o=void 0;Array.isArray?o=Array.isArray:o=function(q){return Object.prototype.toString.call(q)==="[object Array]"};var i=o,E=0,h=void 0,t=void 0,g=function(Ae,de){u[E]=Ae,u[E+1]=de,E+=2,E===2&&(t?t(A):j())};function C(q){t=q}function T(q){g=q}var P=typeof window<"u"?window:void 0,R=P||{},m=R.MutationObserver||R.WebKitMutationObserver,f=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",r=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function d(){return function(){return process.nextTick(A)}}function c(){return typeof h<"u"?function(){h(A)}:_()}function M(){var q=0,Ae=new m(A),de=document.createTextNode("");return Ae.observe(de,{characterData:!0}),function(){de.data=q=++q%2}}function n(){var q=new MessageChannel;return q.port1.onmessage=A,function(){return q.port2.postMessage(0)}}function _(){var q=setTimeout;return function(){return q(A,1)}}var u=new Array(1e3);function A(){for(var q=0;q<E;q+=2){var Ae=u[q],de=u[q+1];Ae(de),u[q]=void 0,u[q+1]=void 0}E=0}function D(){try{var q=Function("return this")().require("vertx");return h=q.runOnLoop||q.runOnContext,c()}catch{return _()}}var j=void 0;f?j=d():m?j=M():r?j=n():P===void 0?j=D():j=_();function $(q,Ae){var de=this,Me=new this.constructor(k);Me[ee]===void 0&&L(Me);var Ie=de._state;if(Ie){var He=arguments[Ie-1];g(function(){return Q(Ie,Me,He,de._result)})}else Ee(de,Me,q,Ae);return Me}function z(q){var Ae=this;if(q&&typeof q=="object"&&q.constructor===Ae)return q;var de=new Ae(k);return ue(de,q),de}var ee=Math.random().toString(36).substring(2);function k(){}var w=void 0,N=1,H=2;function W(){return new TypeError("You cannot resolve a promise with itself")}function Z(){return new TypeError("A promises callback cannot return that same promise.")}function X(q,Ae,de,Me){try{q.call(Ae,de,Me)}catch(Ie){return Ie}}function te(q,Ae,de){g(function(Me){var Ie=!1,He=X(de,Ae,function(Be){Ie||(Ie=!0,Ae!==Be?ue(Me,Be):Ce(Me,Be))},function(Be){Ie||(Ie=!0,ve(Me,Be))},"Settle: "+(Me._label||" unknown promise"));!Ie&&He&&(Ie=!0,ve(Me,He))},q)}function fe(q,Ae){Ae._state===N?Ce(q,Ae._result):Ae._state===H?ve(q,Ae._result):Ee(Ae,void 0,function(de){return ue(q,de)},function(de){return ve(q,de)})}function J(q,Ae,de){Ae.constructor===q.constructor&&de===$&&Ae.constructor.resolve===z?fe(q,Ae):de===void 0?Ce(q,Ae):l(de)?te(q,Ae,de):Ce(q,Ae)}function ue(q,Ae){if(q===Ae)ve(q,W());else if(p(Ae)){var de=void 0;try{de=Ae.then}catch(Me){ve(q,Me);return}J(q,Ae,de)}else Ce(q,Ae)}function pe(q){q._onerror&&q._onerror(q._result),ge(q)}function Ce(q,Ae){q._state===w&&(q._result=Ae,q._state=N,q._subscribers.length!==0&&g(ge,q))}function ve(q,Ae){q._state===w&&(q._state=H,q._result=Ae,g(pe,q))}function Ee(q,Ae,de,Me){var Ie=q._subscribers,He=Ie.length;q._onerror=null,Ie[He]=Ae,Ie[He+N]=de,Ie[He+H]=Me,He===0&&q._state&&g(ge,q)}function ge(q){var Ae=q._subscribers,de=q._state;if(Ae.length!==0){for(var Me=void 0,Ie=void 0,He=q._result,Be=0;Be<Ae.length;Be+=3)Me=Ae[Be],Ie=Ae[Be+de],Me?Q(de,Me,Ie,He):Ie(He);q._subscribers.length=0}}function Q(q,Ae,de,Me){var Ie=l(de),He=void 0,Be=void 0,ze=!0;if(Ie){try{He=de(Me)}catch(Ye){ze=!1,Be=Ye}if(Ae===He){ve(Ae,Z());return}}else He=Me;Ae._state!==w||(Ie&&ze?ue(Ae,He):ze===!1?ve(Ae,Be):q===N?Ce(Ae,He):q===H&&ve(Ae,He))}function le(q,Ae){try{Ae(function(Me){ue(q,Me)},function(Me){ve(q,Me)})}catch(de){ve(q,de)}}var Y=0;function I(){return Y++}function L(q){q[ee]=Y++,q._state=void 0,q._result=void 0,q._subscribers=[]}function K(){return new Error("Array Methods must be provided an Array")}var U=function(){function q(Ae,de){this._instanceConstructor=Ae,this.promise=new Ae(k),this.promise[ee]||L(this.promise),i(de)?(this.length=de.length,this._remaining=de.length,this._result=new Array(this.length),this.length===0?Ce(this.promise,this._result):(this.length=this.length||0,this._enumerate(de),this._remaining===0&&Ce(this.promise,this._result))):ve(this.promise,K())}return q.prototype._enumerate=function(de){for(var Me=0;this._state===w&&Me<de.length;Me++)this._eachEntry(de[Me],Me)},q.prototype._eachEntry=function(de,Me){var Ie=this._instanceConstructor,He=Ie.resolve;if(He===z){var Be=void 0,ze=void 0,Ye=!1;try{Be=de.then}catch(Fe){Ye=!0,ze=Fe}if(Be===$&&de._state!==w)this._settledAt(de._state,Me,de._result);else if(typeof Be!="function")this._remaining--,this._result[Me]=de;else if(Ie===oe){var Te=new Ie(k);Ye?ve(Te,ze):J(Te,de,Be),this._willSettleAt(Te,Me)}else this._willSettleAt(new Ie(function(Fe){return Fe(de)}),Me)}else this._willSettleAt(He(de),Me)},q.prototype._settledAt=function(de,Me,Ie){var He=this.promise;He._state===w&&(this._remaining--,de===H?ve(He,Ie):this._result[Me]=Ie),this._remaining===0&&Ce(He,this._result)},q.prototype._willSettleAt=function(de,Me){var Ie=this;Ee(de,void 0,function(He){return Ie._settledAt(N,Me,He)},function(He){return Ie._settledAt(H,Me,He)})},q}();function x(q){return new U(this,q).promise}function y(q){var Ae=this;return i(q)?new Ae(function(de,Me){for(var Ie=q.length,He=0;He<Ie;He++)Ae.resolve(q[He]).then(de,Me)}):new Ae(function(de,Me){return Me(new TypeError("You must pass an array to race."))})}function S(q){var Ae=this,de=new Ae(k);return ve(de,q),de}function b(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var oe=function(){function q(Ae){this[ee]=I(),this._result=this._state=void 0,this._subscribers=[],k!==Ae&&(typeof Ae!="function"&&b(),this instanceof q?le(this,Ae):F())}return q.prototype.catch=function(de){return this.then(null,de)},q.prototype.finally=function(de){var Me=this,Ie=Me.constructor;return l(de)?Me.then(function(He){return Ie.resolve(de()).then(function(){return He})},function(He){return Ie.resolve(de()).then(function(){throw He})}):Me.then(de,de)},q}();oe.prototype.then=$,oe.all=x,oe.race=y,oe.resolve=z,oe.reject=S,oe._setScheduler=C,oe._setAsap=T,oe._asap=g;function ie(){var q=void 0;if(typeof e.g<"u")q=e.g;else if(typeof self<"u")q=self;else try{q=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var Ae=q.Promise;if(Ae){var de=null;try{de=Object.prototype.toString.call(Ae.resolve())}catch{}if(de==="[object Promise]"&&!Ae.cast)return}q.Promise=oe}return oe.polyfill=ie,oe.Promise=oe,oe})},"./node_modules/events/events.js":V=>{"use strict";var v=typeof Reflect=="object"?Reflect:null,e=v&&typeof v.apply=="function"?v.apply:function(_,u,A){return Function.prototype.apply.call(_,u,A)},p;v&&typeof v.ownKeys=="function"?p=v.ownKeys:Object.getOwnPropertySymbols?p=function(_){return Object.getOwnPropertyNames(_).concat(Object.getOwnPropertySymbols(_))}:p=function(_){return Object.getOwnPropertyNames(_)};function l(n){console&&console.warn&&console.warn(n)}var o=Number.isNaN||function(_){return _!==_};function i(){i.init.call(this)}V.exports=i,V.exports.once=d,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var E=10;function h(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return E},set:function(n){if(typeof n!="number"||n<0||o(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");E=n}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(_){if(typeof _!="number"||_<0||o(_))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_+".");return this._maxListeners=_,this};function t(n){return n._maxListeners===void 0?i.defaultMaxListeners:n._maxListeners}i.prototype.getMaxListeners=function(){return t(this)},i.prototype.emit=function(_){for(var u=[],A=1;A<arguments.length;A++)u.push(arguments[A]);var D=_==="error",j=this._events;if(j!==void 0)D=D&&j.error===void 0;else if(!D)return!1;if(D){var $;if(u.length>0&&($=u[0]),$ instanceof Error)throw $;var z=new Error("Unhandled error."+($?" ("+$.message+")":""));throw z.context=$,z}var ee=j[_];if(ee===void 0)return!1;if(typeof ee=="function")e(ee,this,u);else for(var k=ee.length,w=m(ee,k),A=0;A<k;++A)e(w[A],this,u);return!0};function g(n,_,u,A){var D,j,$;if(h(u),j=n._events,j===void 0?(j=n._events=Object.create(null),n._eventsCount=0):(j.newListener!==void 0&&(n.emit("newListener",_,u.listener?u.listener:u),j=n._events),$=j[_]),$===void 0)$=j[_]=u,++n._eventsCount;else if(typeof $=="function"?$=j[_]=A?[u,$]:[$,u]:A?$.unshift(u):$.push(u),D=t(n),D>0&&$.length>D&&!$.warned){$.warned=!0;var z=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(_)+" listeners added. Use emitter.setMaxListeners() to increase limit");z.name="MaxListenersExceededWarning",z.emitter=n,z.type=_,z.count=$.length,l(z)}return n}i.prototype.addListener=function(_,u){return g(this,_,u,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(_,u){return g(this,_,u,!0)};function C(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function T(n,_,u){var A={fired:!1,wrapFn:void 0,target:n,type:_,listener:u},D=C.bind(A);return D.listener=u,A.wrapFn=D,D}i.prototype.once=function(_,u){return h(u),this.on(_,T(this,_,u)),this},i.prototype.prependOnceListener=function(_,u){return h(u),this.prependListener(_,T(this,_,u)),this},i.prototype.removeListener=function(_,u){var A,D,j,$,z;if(h(u),D=this._events,D===void 0)return this;if(A=D[_],A===void 0)return this;if(A===u||A.listener===u)--this._eventsCount===0?this._events=Object.create(null):(delete D[_],D.removeListener&&this.emit("removeListener",_,A.listener||u));else if(typeof A!="function"){for(j=-1,$=A.length-1;$>=0;$--)if(A[$]===u||A[$].listener===u){z=A[$].listener,j=$;break}if(j<0)return this;j===0?A.shift():f(A,j),A.length===1&&(D[_]=A[0]),D.removeListener!==void 0&&this.emit("removeListener",_,z||u)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(_){var u,A,D;if(A=this._events,A===void 0)return this;if(A.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):A[_]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete A[_]),this;if(arguments.length===0){var j=Object.keys(A),$;for(D=0;D<j.length;++D)$=j[D],$!=="removeListener"&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(u=A[_],typeof u=="function")this.removeListener(_,u);else if(u!==void 0)for(D=u.length-1;D>=0;D--)this.removeListener(_,u[D]);return this};function P(n,_,u){var A=n._events;if(A===void 0)return[];var D=A[_];return D===void 0?[]:typeof D=="function"?u?[D.listener||D]:[D]:u?r(D):m(D,D.length)}i.prototype.listeners=function(_){return P(this,_,!0)},i.prototype.rawListeners=function(_){return P(this,_,!1)},i.listenerCount=function(n,_){return typeof n.listenerCount=="function"?n.listenerCount(_):R.call(n,_)},i.prototype.listenerCount=R;function R(n){var _=this._events;if(_!==void 0){var u=_[n];if(typeof u=="function")return 1;if(u!==void 0)return u.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]};function m(n,_){for(var u=new Array(_),A=0;A<_;++A)u[A]=n[A];return u}function f(n,_){for(;_+1<n.length;_++)n[_]=n[_+1];n.pop()}function r(n){for(var _=new Array(n.length),u=0;u<_.length;++u)_[u]=n[u].listener||n[u];return _}function d(n,_){return new Promise(function(u,A){function D($){n.removeListener(_,j),A($)}function j(){typeof n.removeListener=="function"&&n.removeListener("error",D),u([].slice.call(arguments))}M(n,_,j,{once:!0}),_!=="error"&&c(n,D,{once:!0})})}function c(n,_,u){typeof n.on=="function"&&M(n,"error",_,u)}function M(n,_,u,A){if(typeof n.on=="function")A.once?n.once(_,u):n.on(_,u);else if(typeof n.addEventListener=="function")n.addEventListener(_,function D(j){A.once&&n.removeEventListener(_,D),u(j)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}},"./node_modules/fast-deep-equal/index.js":V=>{"use strict";var v=Array.isArray,e=Object.keys,p=Object.prototype.hasOwnProperty;V.exports=function l(o,i){if(o===i)return!0;if(o&&i&&typeof o=="object"&&typeof i=="object"){var E=v(o),h=v(i),t,g,C;if(E&&h){if(g=o.length,g!=i.length)return!1;for(t=g;t--!==0;)if(!l(o[t],i[t]))return!1;return!0}if(E!=h)return!1;var T=o instanceof Date,P=i instanceof Date;if(T!=P)return!1;if(T&&P)return o.getTime()==i.getTime();var R=o instanceof RegExp,m=i instanceof RegExp;if(R!=m)return!1;if(R&&m)return o.toString()==i.toString();var f=e(o);if(g=f.length,g!==e(i).length)return!1;for(t=g;t--!==0;)if(!p.call(i,f[t]))return!1;for(t=g;t--!==0;)if(C=f[t],!l(o[C],i[C]))return!1;return!0}return o!==o&&i!==i}},"./node_modules/imsc/src/main/js/doc.js":(V,v,e)=>{(function(p,l,o,i,E){p.fromXML=function(x,y,S){var b=l.parser(!0,{xmlns:!0}),F=[],oe=[],ie=[],q=0,Ae=null;b.onclosetag=function(Be){if(F[0]instanceof w)Ae.head!==null&&Ae.head.styling!==null&&Q(Ae.head.styling,F[0].styleRefs,F[0].styleAttrs,y),delete F[0].styleRefs;else if(F[0]instanceof P)for(var ze in F[0].styles)F[0].styles.hasOwnProperty(ze)&&ge(F[0],F[0].styles[ze],y);else if(F[0]instanceof $||F[0]instanceof z){if(F[0].contents.length>1){var Ye=[F[0].contents[0]],Te;for(Te=1;Te<F[0].contents.length;Te++)F[0].contents[Te]instanceof ee&&Ye[Ye.length-1]instanceof ee?Ye[Ye.length-1].text+=F[0].contents[Te].text:Ye.push(F[0].contents[Te]);F[0].contents=Ye}F[0]instanceof z&&F[0].contents.length===1&&F[0].contents[0]instanceof ee&&(F[0].text=F[0].contents[0].text,delete F[0].contents)}else F[0]instanceof g&&(F[0].node.uri===o.ns_tt&&F[0].node.local==="metadata"?q--:q>0&&S&&"onCloseTag"in S&&S.onCloseTag());ie.shift(),oe.shift(),F.shift()},b.ontext=function(Be){if(F[0]!==void 0)if(F[0]instanceof z||F[0]instanceof $){if(F[0]instanceof z){var ze=F[0].styleAttrs[i.byName.ruby.qname];if(ze==="container"||ze==="textContainer"||ze==="baseContainer")return}var Ye=new ee;Ye.initFromText(Ae,F[0],Be,oe[0],ie[0],y),F[0].contents.push(Ye)}else F[0]instanceof g&&q>0&&S&&"onText"in S&&S.onText(Be)},b.onopentag=function(Be){var ze=Be.attributes["xml:space"];ze?ie.unshift(ze.value):ie.length===0?ie.unshift("default"):ie.unshift(ie[0]);var Ye=Be.attributes["xml:lang"];if(Ye?oe.unshift(Ye.value):oe.length===0?oe.unshift(""):oe.unshift(oe[0]),Be.uri===o.ns_tt)if(Be.local==="tt")Ae!==null&&K(y,"Two <tt> elements at ("+this.line+","+this.column+")"),Ae=new C,Ae.initFromNode(Be,oe[0],y),F.unshift(Ae);else if(Be.local==="head")F[0]instanceof C||K(y,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),F.unshift(Ae.head);else if(Be.local==="styling")F[0]instanceof T||K(y,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),F.unshift(Ae.head.styling);else if(Be.local==="style"){var Te;F[0]instanceof P?(Te=new R,Te.initFromNode(Be,y),Te.id?Ae.head.styling.styles[Te.id]=Te:L(y,"<style> element missing @id attribute"),F.unshift(Te)):F[0]instanceof w?(Te=new R,Te.initFromNode(Be,y),le(Te.styleAttrs,F[0].styleAttrs),F.unshift(Te)):K(y,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if(Be.local==="initial"){var Fe;if(F[0]instanceof P){Fe=new m,Fe.initFromNode(Be,y);for(var ot in Fe.styleAttrs)Fe.styleAttrs.hasOwnProperty(ot)&&(Ae.head.styling.initials[ot]=Fe.styleAttrs[ot]);F.unshift(Fe)}else K(y,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if(Be.local==="layout")F[0]instanceof T||K(y,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),F.unshift(Ae.head.layout);else if(Be.local==="region"){F[0]instanceof f||K(y,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var st=new w;st.initFromNode(Ae,Be,oe[0],y),!st.id||st.id in Ae.head.layout.regions?L(y,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):Ae.head.layout.regions[st.id]=st,F.unshift(st)}else if(Be.local==="body"){F[0]instanceof C||K(y,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),Ae.body!==null&&K(y,"Second <body> element at "+this.line+","+this.column+")");var at=new D;at.initFromNode(Ae,Be,oe[0],y),Ae.body=at,F.unshift(at)}else if(Be.local==="div"){F[0]instanceof j||F[0]instanceof D||K(y,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var ht=new j;ht.initFromNode(Ae,F[0],Be,oe[0],y);var Tt=ht.styleAttrs[i.byName.backgroundImage.qname];Tt&&(ht.contents.push(new r(Tt)),delete ht.styleAttrs[i.byName.backgroundImage.qname]),F[0].contents.push(ht),F.unshift(ht)}else if(Be.local==="image"){F[0]instanceof j||K(y,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var xe=new r;xe.initFromNode(Ae,F[0],Be,oe[0],y),F[0].contents.push(xe),F.unshift(xe)}else if(Be.local==="p"){F[0]instanceof j||K(y,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var we=new $;we.initFromNode(Ae,F[0],Be,oe[0],y),F[0].contents.push(we),F.unshift(we)}else if(Be.local==="span"){F[0]instanceof z||F[0]instanceof $||K(y,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var $e=new z;$e.initFromNode(Ae,F[0],Be,oe[0],ie[0],y),F[0].contents.push($e),F.unshift($e)}else if(Be.local==="br"){F[0]instanceof z||F[0]instanceof $||K(y,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var et=new k;et.initFromNode(Ae,F[0],Be,oe[0],y),F[0].contents.push(et),F.unshift(et)}else if(Be.local==="set"){F[0]instanceof z||F[0]instanceof $||F[0]instanceof j||F[0]instanceof D||F[0]instanceof w||F[0]instanceof k||K(y,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var qe=new N;qe.initFromNode(Ae,F[0],Be,y),F[0].sets.push(qe),F.unshift(qe)}else F.unshift(new g(Be));else F.unshift(new g(Be));if(F[0]instanceof g){if(Be.uri===o.ns_tt&&Be.local==="metadata")q++;else if(q>0&&S&&"onOpenTag"in S){var _t=[];for(var Xe in Be.attributes)_t[Be.attributes[Xe].uri+" "+Be.attributes[Xe].local]={uri:Be.attributes[Xe].uri,local:Be.attributes[Xe].local,value:Be.attributes[Xe].value};S.onOpenTag(Be.uri,Be.local,_t)}}},b.write(x).close(),delete Ae.head.styling.styles;var de=!1;for(var Me in Ae.head.layout.regions)if(Ae.head.layout.regions.hasOwnProperty(Me)){de=!0;break}if(!de){var Ie=w.prototype.createDefaultRegion(Ae.lang);Ae.head.layout.regions[Ie.id]=Ie}for(var He in Ae.head.layout.regions)Ae.head.layout.regions.hasOwnProperty(He)&&t(Ae,Ae.head.layout.regions[He],null,null);return Ae.body&&t(Ae,Ae.body,null,null),Ae.body&&h(Ae.body),Ae};function h(x){if("contents"in x)for(var y=("styleAttrs"in x)?x.styleAttrs[i.byName.ruby.qname]:null,S=x.kind==="span"&&(y==="container"||y==="textContainer"||y==="baseContainer"),b=x.contents.length-1;b>=0;b--)S&&!("styleAttrs"in x.contents[b]&&i.byName.ruby.qname in x.contents[b].styleAttrs)?delete x.contents[b]:h(x.contents[b])}function t(x,y,S,b){var F=b&&b.timeContainer==="seq",oe=0;b&&(F&&S?oe=S.end:oe=b.begin),y.begin=y.explicit_begin?y.explicit_begin+oe:oe;var ie=y.begin,q=null;if("sets"in y)for(var Ae=0;Ae<y.sets.length;Ae++)t(x,y.sets[Ae],q,y),y.timeContainer==="seq"?ie=y.sets[Ae].end:ie=Math.max(ie,y.sets[Ae].end),q=y.sets[Ae];if(!("contents"in y))F?ie=y.begin:ie=Number.POSITIVE_INFINITY;else if("contents"in y)for(var de=0;de<y.contents.length;de++)t(x,y.contents[de],q,y),y.timeContainer==="seq"?ie=y.contents[de].end:ie=Math.max(ie,y.contents[de].end),q=y.contents[de];y.explicit_end!==null&&y.explicit_dur!==null?y.end=Math.min(y.begin+y.explicit_dur,oe+y.explicit_end):y.explicit_end===null&&y.explicit_dur!==null?y.end=y.begin+y.explicit_dur:y.explicit_end!==null&&y.explicit_dur===null?y.end=oe+y.explicit_end:y.end=ie,delete y.explicit_begin,delete y.explicit_dur,delete y.explicit_end,x._registerEvent(y)}function g(x){this.node=x}function C(){this.events=[],this.head=new T,this.body=null}C.prototype.initFromNode=function(x,y,S){var b=ue(x,S);this.cellLength={h:new E.ComputedLength(0,1/b.h),w:new E.ComputedLength(1/b.w,0)};var F=pe(x,S);this.effectiveFrameRate=F.effectiveFrameRate,this.tickRate=F.tickRate,this.aspectRatio=J(x,S);var oe=fe(x,o.ns_ttp,"timeBase");oe!==null&&oe!=="media"&&K(S,"Unsupported time base");var ie=Ce(x,S);ie===null?this.pxLength={h:null,w:null}:((ie.h.unit!=="px"||ie.w.unit!=="px")&&K(S,"Extent on TT must be in px or absent"),this.pxLength={h:new E.ComputedLength(0,1/ie.h.value),w:new E.ComputedLength(1/ie.w.value,0)}),this.dimensions={h:new E.ComputedLength(0,1),w:new E.ComputedLength(1,0)},this.lang=y},C.prototype._registerEvent=function(x){if(!(x.end<=x.begin)){var y=U(this.events,x.begin);if(y.found||this.events.splice(y.index,0,x.begin),x.end!==Number.POSITIVE_INFINITY){var S=U(this.events,x.end);S.found||this.events.splice(S.index,0,x.end)}}},C.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},C.prototype.getMediaTimeEvents=function(){return this.events};function T(){this.styling=new P,this.layout=new f}function P(){this.styles={},this.initials={}}function R(){this.id=null,this.styleAttrs=null,this.styleRefs=null}R.prototype.initFromNode=function(x,y){this.id=H(x),this.styleAttrs=te(x,y),this.styleRefs=X(x)};function m(){this.styleAttrs=null}m.prototype.initFromNode=function(x,y){this.styleAttrs={};for(var S in x.attributes)if(x.attributes[S].uri===o.ns_itts||x.attributes[S].uri===o.ns_ebutts||x.attributes[S].uri===o.ns_tts){var b=x.attributes[S].uri+" "+x.attributes[S].local;this.styleAttrs[b]=x.attributes[S].value}};function f(){this.regions={}}function r(x,y){d.call(this,"image"),this.src=x,this.type=y}r.prototype.initFromNode=function(x,y,S,b,F){this.src="src"in S.attributes?S.attributes.src.value:null,this.src||L(F,"Invalid image@src attribute"),this.type="type"in S.attributes?S.attributes.type.value:null,this.type||L(F,"Invalid image@type attribute"),n.prototype.initFromNode.call(this,x,y,S,F),A.prototype.initFromNode.call(this,x,y,S,F),_.prototype.initFromNode.call(this,x,y,S,F),M.prototype.initFromNode.call(this,x,y,S,F),this.lang=b};function d(x){this.kind=x}function c(x){this.id=x}c.prototype.initFromNode=function(x,y,S,b){this.id=H(S)};function M(x){this.regionID=x}M.prototype.initFromNode=function(x,y,S,b){this.regionID=W(S)};function n(x){this.styleAttrs=x}n.prototype.initFromNode=function(x,y,S,b){this.styleAttrs=te(S,b),x.head!==null&&x.head.styling!==null&&Q(x.head.styling,X(S),this.styleAttrs,b)};function _(x){this.sets=x}_.prototype.initFromNode=function(x,y,S,b){this.sets=[]};function u(x){this.contents=x}u.prototype.initFromNode=function(x,y,S,b){this.contents=[]};function A(x,y,S){this.explicit_begin=x,this.explicit_end=y,this.explicit_dur=S}A.prototype.initFromNode=function(x,y,S,b){var F=Ee(x,y,S,b);this.explicit_begin=F.explicit_begin,this.explicit_end=F.explicit_end,this.explicit_dur=F.explicit_dur,this.timeContainer=Z(S,b)};function D(){d.call(this,"body")}D.prototype.initFromNode=function(x,y,S,b){n.prototype.initFromNode.call(this,x,null,y,b),A.prototype.initFromNode.call(this,x,null,y,b),_.prototype.initFromNode.call(this,x,null,y,b),M.prototype.initFromNode.call(this,x,null,y,b),u.prototype.initFromNode.call(this,x,null,y,b),this.lang=S};function j(){d.call(this,"div")}j.prototype.initFromNode=function(x,y,S,b,F){n.prototype.initFromNode.call(this,x,y,S,F),A.prototype.initFromNode.call(this,x,y,S,F),_.prototype.initFromNode.call(this,x,y,S,F),M.prototype.initFromNode.call(this,x,y,S,F),u.prototype.initFromNode.call(this,x,y,S,F),this.lang=b};function $(){d.call(this,"p")}$.prototype.initFromNode=function(x,y,S,b,F){n.prototype.initFromNode.call(this,x,y,S,F),A.prototype.initFromNode.call(this,x,y,S,F),_.prototype.initFromNode.call(this,x,y,S,F),M.prototype.initFromNode.call(this,x,y,S,F),u.prototype.initFromNode.call(this,x,y,S,F),this.lang=b};function z(){d.call(this,"span")}z.prototype.initFromNode=function(x,y,S,b,F,oe){n.prototype.initFromNode.call(this,x,y,S,oe),A.prototype.initFromNode.call(this,x,y,S,oe),_.prototype.initFromNode.call(this,x,y,S,oe),M.prototype.initFromNode.call(this,x,y,S,oe),u.prototype.initFromNode.call(this,x,y,S,oe),this.space=F,this.lang=b};function ee(){d.call(this,"span")}ee.prototype.initFromText=function(x,y,S,b,F,oe){A.prototype.initFromNode.call(this,x,y,null,oe),this.text=S,this.space=F,this.lang=b};function k(){d.call(this,"br")}k.prototype.initFromNode=function(x,y,S,b,F){M.prototype.initFromNode.call(this,x,y,S,F),A.prototype.initFromNode.call(this,x,y,S,F),this.lang=b};function w(){}w.prototype.createDefaultRegion=function(x){var y=new w;return c.call(y,""),n.call(y,{}),_.call(y,[]),A.call(y,0,Number.POSITIVE_INFINITY,null),this.lang=x,y},w.prototype.initFromNode=function(x,y,S,b){c.prototype.initFromNode.call(this,x,null,y,b),A.prototype.initFromNode.call(this,x,null,y,b),_.prototype.initFromNode.call(this,x,null,y,b),this.styleAttrs=te(y,b),this.styleRefs=X(y),this.lang=S};function N(){}N.prototype.initFromNode=function(x,y,S,b){A.prototype.initFromNode.call(this,x,y,S,b);var F=te(S,b);this.qname=null,this.value=null;for(var oe in F)if(F.hasOwnProperty(oe)){if(this.qname){L(b,"More than one style specified on set");break}this.qname=oe,this.value=F[oe]}};function H(x){return x&&"xml:id"in x.attributes&&x.attributes["xml:id"].value||null}function W(x){return x&&"region"in x.attributes?x.attributes.region.value:""}function Z(x,y){var S=x&&"timeContainer"in x.attributes?x.attributes.timeContainer.value:null;return!S||S==="par"?"par":S==="seq"?"seq":(L(y,"Illegal value of timeContainer (assuming 'par')"),"par")}function X(x){return x&&"style"in x.attributes?x.attributes.style.value.split(" "):[]}function te(x,y){var S={};if(x!==null)for(var b in x.attributes){var F=x.attributes[b].uri+" "+x.attributes[b].local,oe=i.byQName[F];if(oe!==void 0){var ie=oe.parse(x.attributes[b].value);ie!==null?(S[F]=ie,oe===i.byName.zIndex&&I(y,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):L(y,"Cannot parse styling attribute "+F+" --> "+x.attributes[b].value)}}return S}function fe(x,y,S){for(var b in x.attributes)if(x.attributes[b].uri===y&&x.attributes[b].local===S)return x.attributes[b].value;return null}function J(x,y){var S=fe(x,o.ns_ittp,"aspectRatio");S===null&&(S=fe(x,o.ns_ttp,"displayAspectRatio"));var b=null;if(S!==null){var F=/(\d+)\s+(\d+)/,oe=F.exec(S);if(oe!==null){var ie=parseInt(oe[1]),q=parseInt(oe[2]);ie!==0&&q!==0?b=ie/q:L(y,"Illegal aspectRatio values (ignoring)")}else L(y,"Malformed aspectRatio attribute (ignoring)")}return b}function ue(x,y){var S=fe(x,o.ns_ttp,"cellResolution"),b=15,F=32;if(S!==null){var oe=/(\d+) (\d+)/,ie=oe.exec(S);ie!==null?(F=parseInt(ie[1]),b=parseInt(ie[2])):I(y,"Malformed cellResolution value (using initial value instead)")}return{w:F,h:b}}function pe(x,y){var S=fe(x,o.ns_ttp,"frameRate"),b=30,F;if(S!==null){var oe=/(\d+)/;F=oe.exec(S),F!==null?b=parseInt(F[1]):I(y,"Malformed frame rate attribute (using initial value instead)")}var ie=fe(x,o.ns_ttp,"frameRateMultiplier"),q=1;if(ie!==null){var Ae=/(\d+) (\d+)/;F=Ae.exec(ie),F!==null?q=parseInt(F[1])/parseInt(F[2]):I(y,"Malformed frame rate multiplier attribute (using initial value instead)")}var de=q*b,Me=1,Ie=fe(x,o.ns_ttp,"tickRate");if(Ie===null)S!==null&&(Me=de);else{var He=/(\d+)/;F=He.exec(Ie),F!==null?Me=parseInt(F[1]):I(y,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:de,tickRate:Me}}function Ce(x,y){var S=fe(x,o.ns_tts,"extent");if(S===null)return null;var b=S.split(" ");if(b.length!==2)return I(y,"Malformed extent (ignoring)"),null;var F=E.parseLength(b[0]),oe=E.parseLength(b[1]);return!oe||!F?(I(y,"Malformed extent values (ignoring)"),null):{h:oe,w:F}}function ve(x,y,S){var b=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,F=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/,oe=/^(\d+(?:\.\d+)?)f$/,ie=/^(\d+(?:\.\d+)?)t$/,q=/^(\d+(?:\.\d+)?)ms$/,Ae=/^(\d+(?:\.\d+)?)s$/,de=/^(\d+(?:\.\d+)?)h$/,Me=/^(\d+(?:\.\d+)?)m$/,Ie,He=null;return(Ie=oe.exec(S))!==null?y!==null&&(He=parseFloat(Ie[1])/y):(Ie=ie.exec(S))!==null?x!==null&&(He=parseFloat(Ie[1])/x):(Ie=q.exec(S))!==null?He=parseFloat(Ie[1])/1e3:(Ie=Ae.exec(S))!==null?He=parseFloat(Ie[1]):(Ie=de.exec(S))!==null?He=parseFloat(Ie[1])*3600:(Ie=Me.exec(S))!==null?He=parseFloat(Ie[1])*60:(Ie=b.exec(S))!==null?He=parseInt(Ie[1])*3600+parseInt(Ie[2])*60+parseFloat(Ie[3]):(Ie=F.exec(S))!==null&&y!==null&&(He=parseInt(Ie[1])*3600+parseInt(Ie[2])*60+parseInt(Ie[3])+(Ie[4]===null?0:parseInt(Ie[4])/y)),He}function Ee(x,y,S,b){var F=null;S&&"begin"in S.attributes&&(F=ve(x.tickRate,x.effectiveFrameRate,S.attributes.begin.value),F===null&&I(b,"Malformed begin value "+S.attributes.begin.value+" (using 0)"));var oe=null;S&&"dur"in S.attributes&&(oe=ve(x.tickRate,x.effectiveFrameRate,S.attributes.dur.value),oe===null&&I(b,"Malformed dur value "+S.attributes.dur.value+" (ignoring)"));var ie=null;return S&&"end"in S.attributes&&(ie=ve(x.tickRate,x.effectiveFrameRate,S.attributes.end.value),ie===null&&I(b,"Malformed end value (ignoring)")),{explicit_begin:F,explicit_end:ie,explicit_dur:oe}}function ge(x,y,S){for(;y.styleRefs.length>0;){var b=y.styleRefs.pop();if(!(b in x.styles)){L(S,"Non-existant style id referenced");continue}ge(x,x.styles[b],S),le(x.styles[b].styleAttrs,y.styleAttrs)}}function Q(x,y,S,b){for(var F=y.length-1;F>=0;F--){var oe=y[F];if(!(oe in x.styles)){L(b,"Non-existant style id referenced");continue}le(x.styles[oe].styleAttrs,S)}}function le(x,y){for(var S in x)x.hasOwnProperty(S)&&(S in y||(y[S]=x[S]))}function Y(x,y){if(x&&x.info&&x.info(y))throw y}function I(x,y){if(x&&x.warn&&x.warn(y))throw y}function L(x,y){if(x&&x.error&&x.error(y))throw y}function K(x,y){throw x&&x.fatal&&x.fatal(y),y}function U(x,y){for(var S=0,b=x.length-1,F;S<=b;){F=Math.floor((S+b)/2);var oe=x[F];if(oe<y)S=F+1;else if(oe>y)b=F-1;else return{found:!0,index:F}}return{found:!1,index:S}}})(v,typeof sax>"u"?e("./node_modules/sax/lib/sax.js"):sax,typeof imscNames>"u"?e("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?e("./node_modules/imsc/src/main/js/styles.js"):imscStyles,typeof imscUtils>"u"?e("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/html.js":(V,v,e)=>{(function(p,l,o){p.render=function(k,w,N,H,W,Z,X,te,fe){var J=H||w.clientHeight,ue=W||w.clientWidth;if(k.aspectRatio!==null){var pe=J*k.aspectRatio;pe>ue?J=Math.round(ue/k.aspectRatio):ue=pe}var Ce=document.createElement("div");Ce.style.position="relative",Ce.style.width=ue+"px",Ce.style.height=J+"px",Ce.style.margin="auto",Ce.style.top=0,Ce.style.bottom=0,Ce.style.left=0,Ce.style.right=0,Ce.style.zIndex=0;var ve={h:J,w:ue,regionH:null,regionW:null,imgResolver:N,displayForcedOnlyMode:Z||!1,isd:k,errorHandler:X,previousISDState:te,enableRollUp:fe||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};if(w.appendChild(Ce),"contents"in k)for(var Ee=0;Ee<k.contents.length;Ee++)i(ve,Ce,k.contents[Ee],k);return ve.currentISDState};function i(k,w,N,H){var W;if(N.kind==="region")W=document.createElement("div"),W.style.position="absolute";else if(N.kind==="body")W=document.createElement("div");else if(N.kind==="div")W=document.createElement("div");else if(N.kind==="image"){if(W=document.createElement("img"),k.imgResolver!==null&&N.src!==null){var Z=k.imgResolver(N.src,W);Z&&(W.src=Z),W.height=k.regionH,W.width=k.regionW}}else if(N.kind==="p")W=document.createElement("p");else if(N.kind==="span")if(N.styleAttrs[o.byName.ruby.qname]==="container")W=document.createElement("ruby"),k.ruby=!0;else if(N.styleAttrs[o.byName.ruby.qname]==="base")W=document.createElement("rb");else if(N.styleAttrs[o.byName.ruby.qname]==="text")W=document.createElement("rt");else if(N.styleAttrs[o.byName.ruby.qname]==="baseContainer")W=document.createElement("rbc");else if(N.styleAttrs[o.byName.ruby.qname]==="textContainer")W=document.createElement("rtc");else{if(N.styleAttrs[o.byName.ruby.qname]==="delimiter")return;W=document.createElement("span")}else N.kind==="br"&&(W=document.createElement("br"));if(!W){ee(k.errorHandler,"Error processing ISD element kind: "+N.kind);return}if(N.lang&&(N.kind==="region"||N.lang!==H.lang)&&(W.lang=N.lang),w.appendChild(W),W.style.margin="0",N.kind==="region"){var X=N.styleAttrs[o.byName.writingMode.qname];X==="lrtb"||X==="lr"?(k.ipd="lr",k.bpd="tb"):X==="rltb"||X==="rl"?(k.ipd="rl",k.bpd="tb"):X==="tblr"?(k.ipd="tb",k.bpd="lr"):(X==="tbrl"||X==="tb")&&(k.ipd="tb",k.bpd="rl")}else if(N.kind==="p"&&k.bpd==="tb"){var te=N.styleAttrs[o.byName.direction.qname];k.ipd=te==="ltr"?"lr":"rl"}for(var fe=0;fe<_.length;fe++){var J=_[fe],ue=N.styleAttrs[J.qname];ue!==void 0&&J.map!==null&&J.map(k,W,N,ue)}var pe=W,Ce=N.styleAttrs[o.byName.linePadding.qname];if(Ce&&!Ce.isZero()){var ve=Ce.toUsedLength(k.w,k.h);if(ve>0){var Ee=Math.ceil(ve)+"px";k.bpd==="tb"?(pe.style.paddingLeft=Ee,pe.style.paddingRight=Ee):(pe.style.paddingTop=Ee,pe.style.paddingBottom=Ee),k.lp=Ce}}var ge=N.styleAttrs[o.byName.multiRowAlign.qname];if(ge&&ge!=="auto"){var Q=document.createElement("span");Q.style.display="inline-block",Q.style.textAlign=ge,W.appendChild(Q),pe=Q,k.mra=ge}var le=N.styleAttrs[o.byName.rubyReserve.qname];if(le&&le[0]!=="none"&&(k.rubyReserve=le),N.styleAttrs[o.byName.fillLineGap.qname]&&(k.flg=!0),N.kind==="span"&&N.text){var Y=N.styleAttrs[o.byName.textEmphasis.qname];if(Y&&Y.style!=="none"&&(k.textEmphasis=!0),o.byName.textCombine.qname in N.styleAttrs&&N.styleAttrs[o.byName.textCombine.qname]==="all")W.textContent=N.text,Y&&M(k,W,N,Y);else for(var I="",L=0;L<N.text.length;L++){I+=N.text.charAt(L);var K=N.text.charCodeAt(L);if(K<55296||K>56319||L===N.text.length-1){var U=document.createElement("span");U.textContent=I,Y&&M(k,U,N,Y),W.appendChild(U),I="",U._isd_element=N}}}if("contents"in N)for(var x=0;x<N.contents.length;x++)i(k,pe,N.contents[x],N);var y=[];if(N.kind==="p"&&(d(k,pe,y,null),k.rubyReserve&&(R(y,k),k.rubyReserve=null),(k.ruby||k.rubyReserve)&&(P(y,k),k.ruby=null),k.textEmphasis&&(T(y,k),k.textEmphasis=null),k.mra&&(C(y),k.mra=null),k.lp&&(g(y,k.lp.toUsedLength(k.w,k.h),k),k.lp=null),E(y),k.flg)){var S=r(pe.getBoundingClientRect(),k);m(y,S.before,S.after,k,pe),k.flg=null}if(N.kind==="region"&&k.bpd==="tb"&&k.enableRollUp&&N.contents.length>0&&N.styleAttrs[o.byName.displayAlign.qname]==="after"){d(k,pe,y,null);var b=N.id===""?"_":N.id,F=new f(b,y);if(k.currentISDState[F.id]=F,k.previousISDState&&F.id in k.previousISDState&&k.previousISDState[F.id].plist.length>0&&F.plist.length>1&&F.plist[F.plist.length-2].text===k.previousISDState[F.id].plist[k.previousISDState[F.id].plist.length-1].text){var oe=W.firstElementChild,ie=F.plist[F.plist.length-1].after-F.plist[F.plist.length-1].before;oe.style.bottom="-"+ie+"px",oe.style.transition="transform 0.4s",oe.style.position="relative",oe.style.transform="translateY(-"+ie+"px)"}}}function E(k){for(var w=0;w<k.length;w++)for(var N=k[w],H=1;H<N.elements.length;){var W=N.elements[H-1],Z=N.elements[H];if(t(W.node,Z.node)){N.elements.splice(H,1);continue}else H++}for(var X,te,fe=[],J=0;J<k.length;J++)for(var ue=0;ue<k[J].elements.length;ue++)X=k[J].elements[ue].node,te=h(X,fe,!1),te&&(X.style.backgroundColor=te);for(var pe=0;pe<fe.length;pe++)fe[pe].style.backgroundColor=""}function h(k,w,N){if(k.style.backgroundColor)return N&&!w.includes(k)&&w.push(k),k.style.backgroundColor;if(k.parentElement.nodeName==="SPAN")return h(k.parentElement,w,!0)}function t(k,w){if(k.tagName==="SPAN"&&w.tagName==="SPAN"&&k._isd_element===w._isd_element){k.textContent+=w.textContent;for(var N=0;N<w.style.length;N++){var H=w.style[N];(H.indexOf("border")>=0||H.indexOf("padding")>=0||H.indexOf("margin")>=0)&&(k.style[H]=w.style[H])}return w.parentElement.removeChild(w),!0}return!1}function g(k,w,N){if(k!==null)for(var H=0;H<k.length;H++){var W=k[H].elements.length,Z=Math.ceil(w)+"px",X="-"+Math.ceil(w)+"px";if(W!==0){var te=k[H].elements[k[H].start_elem],fe=k[H].elements[k[H].end_elem];if(te===fe&&(elementBoundingRect=te.node.getBoundingClientRect(),elementBoundingRect.width==0||elementBoundingRect.height==0))continue;N.ipd==="lr"?(te.node.style.marginLeft=X,te.node.style.paddingLeft=Z):N.ipd==="rl"?(te.node.style.paddingRight=Z,te.node.style.marginRight=X):N.ipd==="tb"&&(te.node.style.paddingTop=Z,te.node.style.marginTop=X),N.ipd==="lr"?(fe.node.style.marginRight=X,fe.node.style.paddingRight=Z):N.ipd==="rl"?(fe.node.style.paddingLeft=Z,fe.node.style.marginLeft=X):N.ipd==="tb"&&(fe.node.style.paddingBottom=Z,fe.node.style.marginBottom=X)}}}function C(k){for(var w=0;w<k.length-1;w++){var N=k[w].elements.length;if(N!==0&&k[w].br===!1){var H=document.createElement("br"),W=k[w].elements[N-1].node;W.parentElement.insertBefore(H,W.nextSibling)}}}function T(k,w){for(var N=0;N<k.length;N++)for(var H=0;H<k[N].te.length;H++)if(!(k[N].te[H].style[z]&&k[N].te[H].style[z]!=="none")){var W;w.bpd==="tb"?W=N===0?"left over":"left under":w.bpd==="rl"?W=N===0?"right under":"left under":W=N===0?"left under":"right under",k[N].te[H].style[z]=W}}function P(k,w){for(var N=0;N<k.length;N++)for(var H=0;H<k[N].rbc.length;H++)if(!k[N].rbc[H].style[j]){var W;D?W=N===0?"before":"after":w.bpd==="tb"||w.bpd==="rl"?W=N===0?"over":"under":W=N===0?"under":"over",k[N].rbc[H].style[j]=W}}function R(k,w){for(var N=0;N<k.length;N++){var H=document.createElement("ruby"),W=document.createElement("rb");W.textContent="\u200B",H.appendChild(W);var Z,X,te=w.rubyReserve[1].toUsedLength(w.w,w.h)+"px";if(w.rubyReserve[0]==="both"||w.rubyReserve[0]==="outside"&&k.length==1)Z=document.createElement("rtc"),Z.style[j]=D?"after":"under",Z.textContent="\u200B",Z.style.fontSize=te,X=document.createElement("rtc"),X.style[j]=D?"before":"over",X.textContent="\u200B",X.style.fontSize=te,H.appendChild(Z),H.appendChild(X);else{Z=document.createElement("rtc"),Z.textContent="\u200B",Z.style.fontSize=te;var fe;w.rubyReserve[0]==="after"||w.rubyReserve[0]==="outside"&&N>0?fe=D?"after":w.bpd==="tb"||w.bpd==="rl"?"under":"over":fe=D?"before":w.bpd==="tb"||w.bpd==="rl"?"over":"under",Z.style[j]=fe,H.appendChild(Z)}for(var J=null,ue=0;ue<k[N].rbc.length;ue++)if(k[N].rbc[ue].localName==="ruby"){J=k[N].rbc[ue];for(var pe=0;pe<J.style.length;pe++)H.style.setProperty(J.style.item(pe),J.style.getPropertyValue(J.style.item(pe)));break}J=J||k[N].elements[0].node,J.parentElement.insertBefore(H,J)}}function m(k,w,N,H,W){for(var Z=Math.sign(N-w),X=0;X<=k.length;X++){var te;X===0?te=Math.round(w):X===k.length?te=Math.round(N):te=Math.round((k[X-1].after+k[X].before)/2);var fe,J,ue;if(X>0&&k[X-1])for(J=0;J<k[X-1].elements.length;J++)ue=k[X-1].elements[J],fe=Z*(te-ue.after)+"px",H.bpd==="lr"?ue.node.style.paddingRight=fe:H.bpd==="rl"?ue.node.style.paddingLeft=fe:H.bpd==="tb"&&(ue.node.style.paddingBottom=fe);if(X<k.length)for(J=0;J<k[X].elements.length;J++)ue=k[X].elements[J],fe=Z*(ue.before-te)+"px",H.bpd==="lr"?ue.node.style.paddingLeft=fe:H.bpd==="rl"?ue.node.style.paddingRight=fe:H.bpd==="tb"&&(ue.node.style.paddingTop=fe)}}function f(k,w){this.id=k,this.plist=w}function r(k,w){var N={before:null,after:null,start:null,end:null};return w.bpd==="tb"?(N.before=k.top,N.after=k.bottom,w.ipd==="lr"?(N.start=k.left,N.end=k.right):(N.start=k.right,N.end=k.left)):w.bpd==="lr"?(N.before=k.left,N.after=k.right,N.start=k.top,N.end=k.bottom):w.bpd==="rl"&&(N.before=k.right,N.after=k.left,N.start=k.top,N.end=k.bottom),N}function d(k,w,N,H){if(!(w.localName==="rt"||w.localName==="rtc")){var W=w.style.backgroundColor||H;if(w.childElementCount===0)if(w.localName==="span"||w.localName==="rb"){var Z=w.getBoundingClientRect(),X=r(Z,k);if(N.length===0||!c(X.before,X.after,N[N.length-1].before,N[N.length-1].after))N.push({before:X.before,after:X.after,start:X.start,end:X.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});else{var te=Math.sign(X.after-X.before),fe=Math.sign(X.end-X.start);te*(X.before-N[N.length-1].before)<0&&(N[N.length-1].before=X.before),te*(X.after-N[N.length-1].after)>0&&(N[N.length-1].after=X.after),fe*(X.start-N[N.length-1].start)<0&&(N[N.length-1].start=X.start,N[N.length-1].start_elem=N[N.length-1].elements.length),fe*(X.end-N[N.length-1].end)>0&&(N[N.length-1].end=X.end,N[N.length-1].end_elem=N[N.length-1].elements.length)}N[N.length-1].text+=w.textContent,N[N.length-1].elements.push({node:w,bgcolor:W,before:X.before,after:X.after})}else w.localName==="br"&&N.length!==0&&(N[N.length-1].br=!0);else for(var J=w.firstChild;J;)J.nodeType===Node.ELEMENT_NODE&&(d(k,J,N,W),J.localName==="ruby"||J.localName==="rtc"?N.length>0&&N[N.length-1].rbc.push(J):J.localName==="span"&&J.style[$]&&J.style[$]!=="none"&&N.length>0&&N[N.length-1].te.push(J)),J=J.nextSibling}}function c(k,w,N,H){return w<H&&k>N||H<=w&&N>=k}function M(k,w,N,H){if(H.style!=="none"&&(H.style==="auto"?w.style[$]="filled":w.style[$]=H.style+" "+H.symbol,H.position==="before"||H.position==="after")){var W;k.bpd==="tb"?W=H.position==="before"?"left over":"left under":k.bpd==="rl"?W=H.position==="before"?"right under":"left under":W=H.position==="before"?"left under":"right under",w.style[z]=W}}function n(k,w){this.qname=k,this.map=w}for(var _=[new n("http://www.w3.org/ns/ttml#styling backgroundColor",function(k,w,N,H){H[3]!==0&&(w.style.backgroundColor="rgba("+H[0].toString()+","+H[1].toString()+","+H[2].toString()+","+(H[3]/255).toString()+")")}),new n("http://www.w3.org/ns/ttml#styling color",function(k,w,N,H){w.style.color="rgba("+H[0].toString()+","+H[1].toString()+","+H[2].toString()+","+(H[3]/255).toString()+")"}),new n("http://www.w3.org/ns/ttml#styling direction",function(k,w,N,H){w.style.direction=H}),new n("http://www.w3.org/ns/ttml#styling display",function(k,w,N,H){}),new n("http://www.w3.org/ns/ttml#styling displayAlign",function(k,w,N,H){w.style.display="flex",w.style.flexDirection="column",H==="before"?w.style.justifyContent="flex-start":H==="center"?w.style.justifyContent="center":H==="after"&&(w.style.justifyContent="flex-end")}),new n("http://www.w3.org/ns/ttml#styling extent",function(k,w,N,H){k.regionH=H.h.toUsedLength(k.w,k.h),k.regionW=H.w.toUsedLength(k.w,k.h);var W=0,Z=0,X=N.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];X&&(W=X[0].toUsedLength(k.w,k.h)+X[2].toUsedLength(k.w,k.h),Z=X[1].toUsedLength(k.w,k.h)+X[3].toUsedLength(k.w,k.h)),w.style.height=k.regionH-W+"px",w.style.width=k.regionW-Z+"px"}),new n("http://www.w3.org/ns/ttml#styling fontFamily",function(k,w,N,H){for(var W=[],Z=0;Z<H.length;Z++)H[Z]==="monospaceSerif"?(W.push("Courier New"),W.push('"Liberation Mono"'),W.push("Courier"),W.push("monospace")):H[Z]==="proportionalSansSerif"?(W.push("Arial"),W.push("Helvetica"),W.push('"Liberation Sans"'),W.push("sans-serif")):H[Z]==="monospace"?W.push("monospace"):H[Z]==="sansSerif"?W.push("sans-serif"):H[Z]==="serif"?W.push("serif"):H[Z]==="monospaceSansSerif"?(W.push("Consolas"),W.push("monospace")):H[Z]==="proportionalSerif"?W.push("serif"):W.push(H[Z]);if(W.length>0){for(var X=[W[0]],te=1;te<W.length;te++)X.indexOf(W[te])==-1&&X.push(W[te]);W=X}w.style.fontFamily=W.join(",")}),new n("http://www.w3.org/ns/ttml#styling shear",function(k,w,N,H){if(H!==0){var W=H*-.9;k.bpd==="tb"?w.style.transform="skewX("+W+"deg)":w.style.transform="skewY("+W+"deg)"}}),new n("http://www.w3.org/ns/ttml#styling fontSize",function(k,w,N,H){w.style.fontSize=H.toUsedLength(k.w,k.h)+"px"}),new n("http://www.w3.org/ns/ttml#styling fontStyle",function(k,w,N,H){w.style.fontStyle=H}),new n("http://www.w3.org/ns/ttml#styling fontWeight",function(k,w,N,H){w.style.fontWeight=H}),new n("http://www.w3.org/ns/ttml#styling lineHeight",function(k,w,N,H){H==="normal"?w.style.lineHeight="normal":w.style.lineHeight=H.toUsedLength(k.w,k.h)+"px"}),new n("http://www.w3.org/ns/ttml#styling opacity",function(k,w,N,H){w.style.opacity=H}),new n("http://www.w3.org/ns/ttml#styling origin",function(k,w,N,H){w.style.top=H.h.toUsedLength(k.w,k.h)+"px",w.style.left=H.w.toUsedLength(k.w,k.h)+"px"}),new n("http://www.w3.org/ns/ttml#styling overflow",function(k,w,N,H){w.style.overflow=H}),new n("http://www.w3.org/ns/ttml#styling padding",function(k,w,N,H){var W=[];W[0]=H[0].toUsedLength(k.w,k.h)+"px",W[1]=H[3].toUsedLength(k.w,k.h)+"px",W[2]=H[2].toUsedLength(k.w,k.h)+"px",W[3]=H[1].toUsedLength(k.w,k.h)+"px",w.style.padding=W.join(" ")}),new n("http://www.w3.org/ns/ttml#styling position",function(k,w,N,H){w.style.top=H.h.toUsedLength(k.w,k.h)+"px",w.style.left=H.w.toUsedLength(k.w,k.h)+"px"}),new n("http://www.w3.org/ns/ttml#styling rubyAlign",function(k,w,N,H){w.style.rubyAlign=H==="spaceAround"?"space-around":"center"}),new n("http://www.w3.org/ns/ttml#styling rubyPosition",function(k,w,N,H){if(H==="before"||H==="after"){var W;D?W=H:k.bpd==="tb"||k.bpd==="rl"?W=H==="before"?"over":"under":W=H==="before"?"under":"over",w.parentElement.style[j]=W}}),new n("http://www.w3.org/ns/ttml#styling showBackground",null),new n("http://www.w3.org/ns/ttml#styling textAlign",function(k,w,N,H){var W;H==="start"?W=k.ipd==="rl"?"right":"left":H==="end"?W=k.ipd==="rl"?"left":"right":W=H,w.style.textAlign=W}),new n("http://www.w3.org/ns/ttml#styling textDecoration",function(k,w,N,H){w.style.textDecoration=H.join(" ").replace("lineThrough","line-through")}),new n("http://www.w3.org/ns/ttml#styling textOutline",function(k,w,N,H){}),new n("http://www.w3.org/ns/ttml#styling textShadow",function(k,w,N,H){var W=N.styleAttrs[o.byName.textOutline.qname];if(H==="none"&&W==="none")w.style.textShadow="";else{var Z=[];if(W!=="none"){var X="rgba("+W.color[0].toString()+","+W.color[1].toString()+","+W.color[2].toString()+","+(W.color[3]/255).toString()+")";Z.push("1px 1px 1px "+X),Z.push("-1px 1px 1px "+X),Z.push("1px -1px 1px "+X),Z.push("-1px -1px 1px "+X)}if(H!=="none")for(var te=0;te<H.length;te++)Z.push(H[te].x_off.toUsedLength(k.w,k.h)+"px "+H[te].y_off.toUsedLength(k.w,k.h)+"px "+H[te].b_radius.toUsedLength(k.w,k.h)+"px rgba("+H[te].color[0].toString()+","+H[te].color[1].toString()+","+H[te].color[2].toString()+","+(H[te].color[3]/255).toString()+")");w.style.textShadow=Z.join(",")}}),new n("http://www.w3.org/ns/ttml#styling textCombine",function(k,w,N,H){w.style.textCombineUpright=H}),new n("http://www.w3.org/ns/ttml#styling textEmphasis",function(k,w,N,H){}),new n("http://www.w3.org/ns/ttml#styling unicodeBidi",function(k,w,N,H){var W;H==="bidiOverride"?W="bidi-override":W=H,w.style.unicodeBidi=W}),new n("http://www.w3.org/ns/ttml#styling visibility",function(k,w,N,H){w.style.visibility=H}),new n("http://www.w3.org/ns/ttml#styling wrapOption",function(k,w,N,H){H==="wrap"?N.space==="preserve"?w.style.whiteSpace="pre-wrap":w.style.whiteSpace="normal":N.space==="preserve"?w.style.whiteSpace="pre":w.style.whiteSpace="noWrap"}),new n("http://www.w3.org/ns/ttml#styling writingMode",function(k,w,N,H){var W;H==="lrtb"||H==="lr"||H==="rltb"||H==="rl"?w.style.writingMode="horizontal-tb":H==="tblr"?w.style.writingMode="vertical-lr":(H==="tbrl"||H==="tb")&&(w.style.writingMode="vertical-rl")}),new n("http://www.w3.org/ns/ttml#styling zIndex",function(k,w,N,H){w.style.zIndex=H}),new n("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(k,w,N,H){k.displayForcedOnlyMode&&H===!1&&(w.style.visibility="hidden")})],u={},A=0;A<_.length;A++)u[_[A].qname]=_[A];var D="webkitRubyPosition"in window.getComputedStyle(document.documentElement),j=D?"webkitRubyPosition":"rubyPosition",$="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",z="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition";function ee(k,w){if(k&&k.error&&k.error(w))throw w}})(v,typeof imscNames>"u"?e("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?e("./node_modules/imsc/src/main/js/styles.js"):imscStyles,typeof imscUtils>"u"?e("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/isd.js":(V,v,e)=>{(function(p,l,o,i){p.generateISD=function(d,c,M){var n=new T(d),_={},u={},A={},D=d.head.styling.initials[o.byName.showBackground.qname],j=d.head.styling.initials[o.byName.backgroundColor.qname];for(var $ in d.head.layout.regions)if(d.head.layout.regions.hasOwnProperty($)){var z=d.head.layout.regions[$],ee=z.styleAttrs[o.byName.showBackground.qname]||D,k=z.styleAttrs[o.byName.backgroundColor.qname]||j;A[z.id]=(ee==="always"||ee===void 0)&&k!==void 0&&!(c<z.begin||c>=z.end)}d.body&&d.body.regionID&&(A[d.body.regionID]=!0);function w(W,Z){function X(J){return!(W<J.begin||W>=J.end)}if(Z.contents){var te={};for(var fe in Z)Z.hasOwnProperty(fe)&&(te[fe]=Z[fe]);return te.contents=[],Z.contents.filter(X).forEach(function(J){var ue=w(W,J);ue.regionID&&(A[ue.regionID]=!0),ue!==null&&te.contents.push(ue)}),te}else return Z}d.body!==null?u=w(c,d.body):u=null,A[""]!==void 0&&(A[""]=!0);for(var N in A)if(A[N]){var H=h(d,c,d.head.layout.regions[N],u,null,"",d.head.layout.regions[N],M,_);H!==null&&n.contents.push(H.element)}return n};var E=[o.byName.color.qname,o.byName.textCombine.qname,o.byName.textDecoration.qname,o.byName.textEmphasis.qname,o.byName.textOutline.qname,o.byName.textShadow.qname];function h(d,c,M,n,_,u,A,D,j){if(c<A.begin||c>=A.end)return null;var $="regionID"in A&&A.regionID!==""?A.regionID:u;if(_!==null&&$!==M.id&&(!("contents"in A)||"contents"in A&&A.contents.length===0||$!==""))return null;var z=new P(A);if("sets"in A)for(var ee=0;ee<A.sets.length;ee++)c<A.sets[ee].begin||c>=A.sets[ee].end||(z.styleAttrs[A.sets[ee].qname]=A.sets[ee].value);var k={};for(var w in z.styleAttrs)if(z.styleAttrs.hasOwnProperty(w)&&(k[w]=!0,z.kind==="region"&&w===o.byName.writingMode.qname&&!(o.byName.direction.qname in z.styleAttrs))){var N=z.styleAttrs[w];N==="lrtb"||N==="lr"?z.styleAttrs[o.byName.direction.qname]="ltr":(N==="rltb"||N==="rl")&&(z.styleAttrs[o.byName.direction.qname]="rtl")}if(_!==null)for(var H=0;H<o.all.length;H++){var W=o.all[H];if(W.qname===o.byName.textDecoration.qname){var Z=_.styleAttrs[W.qname],X=z.styleAttrs[W.qname],te=[];X===void 0?te=Z:X.indexOf("none")===-1?((X.indexOf("noUnderline")===-1&&Z.indexOf("underline")!==-1||X.indexOf("underline")!==-1)&&te.push("underline"),(X.indexOf("noLineThrough")===-1&&Z.indexOf("lineThrough")!==-1||X.indexOf("lineThrough")!==-1)&&te.push("lineThrough"),(X.indexOf("noOverline")===-1&&Z.indexOf("overline")!==-1||X.indexOf("overline")!==-1)&&te.push("overline")):te.push("none"),z.styleAttrs[W.qname]=te}else if(W.qname===o.byName.fontSize.qname&&!(W.qname in z.styleAttrs)&&z.kind==="span"&&z.styleAttrs[o.byName.ruby.qname]==="textContainer"){var fe=_.styleAttrs[o.byName.fontSize.qname];z.styleAttrs[W.qname]=new i.ComputedLength(.5*fe.rw,.5*fe.rh)}else if(W.qname===o.byName.fontSize.qname&&!(W.qname in z.styleAttrs)&&z.kind==="span"&&z.styleAttrs[o.byName.ruby.qname]==="text"){var J=_.styleAttrs[o.byName.fontSize.qname];_.styleAttrs[o.byName.ruby.qname]==="textContainer"?z.styleAttrs[W.qname]=J:z.styleAttrs[W.qname]=new i.ComputedLength(.5*J.rw,.5*J.rh)}else W.inherit&&W.qname in _.styleAttrs&&!(W.qname in z.styleAttrs)&&(z.styleAttrs[W.qname]=_.styleAttrs[W.qname])}for(var ue=0;ue<o.all.length;ue++){var pe=o.all[ue];if(!(pe.qname in z.styleAttrs)&&!(pe.qname===o.byName.position.qname&&o.byName.origin.qname in z.styleAttrs)&&!(pe.qname===o.byName.origin.qname&&o.byName.position.qname in z.styleAttrs)){var Ce=d.head.styling.initials[pe.qname]||pe.initial;if(Ce!==null&&(z.kind==="region"||pe.inherit===!1&&Ce!==null)){var ve=pe.parse(Ce);ve!==null?(z.styleAttrs[pe.qname]=ve,k[pe.qname]=!0):f(D,"Invalid initial value for '"+pe.qname+"' on element '"+z.kind)}}}for(var Ee=0;Ee<o.all.length;Ee++){var ge=o.all[Ee];if(ge.qname in k&&ge.compute!==null){var Q=ge.compute(d,_,z,z.styleAttrs[ge.qname],j);Q!==null?z.styleAttrs[ge.qname]=Q:(z.styleAttrs[ge.qname]=ge.compute(d,_,z,ge.parse(ge.initial),j),f(D,"Style '"+ge.qname+"' on element '"+z.kind+"' cannot be computed"))}}if(z.styleAttrs[o.byName.display.qname]==="none")return null;var le=null;_===null?n===null?le=[]:le=[n]:"contents"in A&&(le=A.contents);for(var Y=0;le!==null&&Y<le.length;Y++){var I=h(d,c,M,n,z,$,le[Y],D,j);I!==null&&z.contents.push(I.element)}for(var L in z.styleAttrs)if(z.styleAttrs.hasOwnProperty(L)){var K=!1;if(z.kind==="span"){var U=z.styleAttrs[o.byName.ruby.qname];K=(U==="container"||U==="textContainer"||U==="baseContainer")&&E.indexOf(L)!==-1,K||(K=U!=="container"&&L===o.byName.rubyAlign.qname),K||(K=!(U==="textContainer"||U==="text")&&L===o.byName.rubyPosition.qname)}if(!K){var x=o.byQName[L];"applies"in x&&(K=x.applies.indexOf(z.kind)===-1)}K&&delete z.styleAttrs[L]}var y=z.styleAttrs[o.byName.ruby.qname];if(z.kind==="p"||z.kind==="span"&&(y==="textContainer"||y==="text")){var S=[];g(z,S),t(S),C(z)}return z.kind==="div"&&o.byName.backgroundImage.qname in z.styleAttrs||z.kind==="br"||z.kind==="image"||"contents"in z&&z.contents.length>0||z.kind==="span"&&z.text!==null||z.kind==="region"&&z.styleAttrs[o.byName.showBackground.qname]==="always"?{region_id:$,element:z}:null}function t(d){function c(A){return A.kind==="br"||/[\r\n\t ]$/.test(A.text)}function M(A){return A.kind==="br"||A.space==="preserve"&&/^[\r\n]/.test(A.text)}for(var n,_=0;_<d.length;){if(n=d[_],n.kind==="br"||n.space==="preserve"){_++;continue}var u=n.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(u)&&(_===0||c(d[_-1]))&&(u=u.substring(1)),n.text=u,u.length===0?d.splice(_,1):_++}for(_=0;_<d.length;_++){if(n=d[_],n.kind==="br"||n.space==="preserve"){_++;continue}/[ ]$/.test(n.text)&&(_===d.length-1||M(d[_+1]))&&(n.text=n.text.slice(0,-1))}}function g(d,c){if("contents"in d)for(var M=0;M<d.contents.length;M++){var n=d.contents[M],_=n.styleAttrs[o.byName.ruby.qname];n.kind==="span"&&(_==="textContainer"||_==="text")||("contents"in n?g(n,c):(n.kind==="span"&&n.text.length!==0||n.kind==="br")&&c.push(n))}}function C(d){if(d.kind==="br")return!1;if("text"in d)return d.text.length===0;if("contents"in d){for(var c=d.contents.length;c--;)C(d.contents[c])&&d.contents.splice(c,1);return d.contents.length===0}}function T(d){this.contents=[],this.aspectRatio=d.aspectRatio,this.lang=d.lang}function P(d){this.kind=d.kind||"region",this.lang=d.lang,d.id&&(this.id=d.id),this.styleAttrs={};for(var c in d.styleAttrs)d.styleAttrs.hasOwnProperty(c)&&(this.styleAttrs[c]=d.styleAttrs[c]);"src"in d&&(this.src=d.src),"type"in d&&(this.type=d.type),"text"in d?this.text=d.text:(this.kind==="region"||"contents"in d)&&(this.contents=[]),"space"in d&&(this.space=d.space)}function R(d,c){if(d&&d.info&&d.info(c))throw c}function m(d,c){if(d&&d.warn&&d.warn(c))throw c}function f(d,c){if(d&&d.error&&d.error(c))throw c}function r(d,c){throw d&&d.fatal&&d.fatal(c),c}})(v,typeof imscNames>"u"?e("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?e("./node_modules/imsc/src/main/js/styles.js"):imscStyles,typeof imscUtils>"u"?e("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/main.js":(V,v,e)=>{v.generateISD=e("./node_modules/imsc/src/main/js/isd.js").generateISD,v.fromXML=e("./node_modules/imsc/src/main/js/doc.js").fromXML,v.renderHTML=e("./node_modules/imsc/src/main/js/html.js").render},"./node_modules/imsc/src/main/js/names.js":(V,v)=>{(function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"})(v)},"./node_modules/imsc/src/main/js/styles.js":(V,v,e)=>{(function(p,l,o){function i(t,g,C,T,P,R,m,f){this.name=g,this.ns=t,this.qname=t+" "+g,this.inherit=P,this.animatable=R,this.initial=C,this.applies=T,this.parse=m,this.compute=f}p.all=[new i(l.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,o.parseColor,null),new i(l.ns_tts,"color","white",["span"],!0,!0,o.parseColor,null),new i(l.ns_tts,"direction","ltr",["p","span"],!0,!0,function(t){return t},null),new i(l.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(t){return t},null),new i(l.ns_tts,"displayAlign","before",["region"],!1,!0,function(t){return t},null),new i(l.ns_tts,"extent","auto",["tt","region"],!1,!0,function(t){if(t==="auto")return t;var g=t.split(" ");if(g.length!==2)return null;var C=o.parseLength(g[0]),T=o.parseLength(g[1]);return!T||!C?null:{h:T,w:C}},function(t,g,C,T,P){var R,m;if(T==="auto")R=new o.ComputedLength(0,1);else if(R=o.toComputedLength(T.h.value,T.h.unit,null,t.dimensions.h,null,t.pxLength.h),R===null)return null;if(T==="auto")m=new o.ComputedLength(1,0);else if(m=o.toComputedLength(T.w.value,T.w.unit,null,t.dimensions.w,null,t.pxLength.w),m===null)return null;return{h:R,w:m}}),new i(l.ns_tts,"fontFamily","default",["span","p"],!0,!0,function(t){for(var g=t.split(","),C=[],T=0;T<g.length;T++)g[T].charAt(0)!=="'"&&g[T].charAt(0)!=='"'&&g[T]==="default"?C.push("monospaceSerif"):C.push(g[T]);return C},null),new i(l.ns_tts,"shear","0%",["p"],!0,!0,o.parseLength,function(t,g,C,T){var P;if(T.unit==="%")P=Math.abs(T.value)>100?Math.sign(T.value)*100:T.value;else return null;return P}),new i(l.ns_tts,"fontSize","1c",["span","p"],!0,!0,o.parseLength,function(t,g,C,T,P){var R;return R=o.toComputedLength(T.value,T.unit,g!==null?g.styleAttrs[p.byName.fontSize.qname]:t.cellLength.h,g!==null?g.styleAttrs[p.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h),R}),new i(l.ns_tts,"fontStyle","normal",["span","p"],!0,!0,function(t){return t},null),new i(l.ns_tts,"fontWeight","normal",["span","p"],!0,!0,function(t){return t},null),new i(l.ns_tts,"lineHeight","normal",["p"],!0,!0,function(t){return t==="normal"?t:o.parseLength(t)},function(t,g,C,T,P){var R;if(T==="normal")R=T;else if(R=o.toComputedLength(T.value,T.unit,C.styleAttrs[p.byName.fontSize.qname],C.styleAttrs[p.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),R===null)return null;return R}),new i(l.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new i(l.ns_tts,"origin","auto",["region"],!1,!0,function(t){if(t==="auto")return t;var g=t.split(" ");if(g.length!==2)return null;var C=o.parseLength(g[0]),T=o.parseLength(g[1]);return!T||!C?null:{h:T,w:C}},function(t,g,C,T,P){var R,m;if(T==="auto")R=new o.ComputedLength(0,0);else if(R=o.toComputedLength(T.h.value,T.h.unit,null,t.dimensions.h,null,t.pxLength.h),R===null)return null;if(T==="auto")m=new o.ComputedLength(0,0);else if(m=o.toComputedLength(T.w.value,T.w.unit,null,t.dimensions.w,null,t.pxLength.w),m===null)return null;return{h:R,w:m}}),new i(l.ns_tts,"overflow","hidden",["region"],!1,!0,function(t){return t},null),new i(l.ns_tts,"padding","0px",["region"],!1,!0,function(t){var g=t.split(" ");if(g.length>4)return null;for(var C=[],T=0;T<g.length;T++){var P=o.parseLength(g[T]);if(!P)return null;C.push(P)}return C},function(t,g,C,T,P){var R;if(T.length===1)R=[T[0],T[0],T[0],T[0]];else if(T.length===2)R=[T[0],T[1],T[0],T[1]];else if(T.length===3)R=[T[0],T[1],T[2],T[1]];else if(T.length===4)R=[T[0],T[1],T[2],T[3]];else return null;var m=C.styleAttrs[p.byName.writingMode.qname];if(m==="lrtb"||m==="lr")R=[R[0],R[3],R[2],R[1]];else if(m==="rltb"||m==="rl")R=[R[0],R[1],R[2],R[3]];else if(m==="tblr")R=[R[3],R[0],R[1],R[2]];else if(m==="tbrl"||m==="tb")R=[R[3],R[2],R[1],R[0]];else return null;for(var f=[],r=0;r<R.length;r++)if(R[r].value===0)f[r]=new o.ComputedLength(0,0);else if(f[r]=o.toComputedLength(R[r].value,R[r].unit,C.styleAttrs[p.byName.fontSize.qname],r===0||r===2?C.styleAttrs[p.byName.extent.qname].h:C.styleAttrs[p.byName.extent.qname].w,r===0||r===2?t.cellLength.h:t.cellLength.w,r===0||r===2?t.pxLength.h:t.pxLength.w),f[r]===null)return null;return f}),new i(l.ns_tts,"position","top left",["region"],!1,!0,function(t){return o.parsePosition(t)},function(t,g,C,T){var P,R;return P=o.toComputedLength(T.v.offset.value,T.v.offset.unit,null,new o.ComputedLength(-C.styleAttrs[p.byName.extent.qname].h.rw,t.dimensions.h.rh-C.styleAttrs[p.byName.extent.qname].h.rh),null,t.pxLength.h),P===null||(T.v.edge==="bottom"&&(P=new o.ComputedLength(-P.rw-C.styleAttrs[p.byName.extent.qname].h.rw,t.dimensions.h.rh-P.rh-C.styleAttrs[p.byName.extent.qname].h.rh)),R=o.toComputedLength(T.h.offset.value,T.h.offset.unit,null,new o.ComputedLength(t.dimensions.w.rw-C.styleAttrs[p.byName.extent.qname].w.rw,-C.styleAttrs[p.byName.extent.qname].w.rh),null,t.pxLength.w),P===null)?null:(T.h.edge==="right"&&(R=new o.ComputedLength(t.dimensions.w.rw-R.rw-C.styleAttrs[p.byName.extent.qname].w.rw,-R.rh-C.styleAttrs[p.byName.extent.qname].w.rh)),{h:P,w:R})}),new i(l.ns_tts,"ruby","none",["span"],!1,!0,function(t){return t},null),new i(l.ns_tts,"rubyAlign","center",["span"],!0,!0,function(t){return t==="center"||t==="spaceAround"?t:null},null),new i(l.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(t){return t},null),new i(l.ns_tts,"rubyReserve","none",["p"],!0,!0,function(t){var g=t.split(" "),C=[null,null];if(g.length===0||g.length>2)return null;if(g[0]==="none"||g[0]==="both"||g[0]==="after"||g[0]==="before"||g[0]==="outside")C[0]=g[0];else return null;if(g.length===2&&g[0]!=="none"){var T=o.parseLength(g[1]);if(T)C[1]=T;else return null}return C},function(t,g,C,T,P){if(T[0]==="none")return T;var R=null;return T[1]===null?R=new o.ComputedLength(C.styleAttrs[p.byName.fontSize.qname].rw*.5,C.styleAttrs[p.byName.fontSize.qname].rh*.5):R=o.toComputedLength(T[1].value,T[1].unit,C.styleAttrs[p.byName.fontSize.qname],C.styleAttrs[p.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),R===null?null:[T[0],R]}),new i(l.ns_tts,"showBackground","always",["region"],!1,!0,function(t){return t},null),new i(l.ns_tts,"textAlign","start",["p"],!0,!0,function(t){return t},function(t,g,C,T,P){return T==="left"?"start":T==="right"?"end":T}),new i(l.ns_tts,"textCombine","none",["span"],!0,!0,function(t){return t==="none"||t==="all"?t:null},null),new i(l.ns_tts,"textDecoration","none",["span"],!0,!0,function(t){return t.split(" ")},null),new i(l.ns_tts,"textEmphasis","none",["span"],!0,!0,function(t){for(var g=t.split(" "),C={style:null,symbol:null,color:null,position:null},T=0;T<g.length;T++)if(g[T]==="none"||g[T]==="auto")C.style=g[T];else if(g[T]==="filled"||g[T]==="open")C.style=g[T];else if(g[T]==="circle"||g[T]==="dot"||g[T]==="sesame")C.symbol=g[T];else if(g[T]==="current")C.color=g[T];else if(g[T]==="outside"||g[T]==="before"||g[T]==="after")C.position=g[T];else if(C.color=o.parseColor(g[T]),C.color===null)return null;return C.style==null&&C.symbol==null?C.style="auto":(C.symbol=C.symbol||"circle",C.style=C.style||"filled"),C.position=C.position||"outside",C.color=C.color||"current",C},null),new i(l.ns_tts,"textOutline","none",["span"],!0,!0,function(t){if(t==="none")return t;var g={},C=t.split(" ");if(C.length===0||C.length>2)return null;var T=o.parseColor(C[0]);if(g.color=T,T!==null&&C.shift(),C.length!==1)return null;var P=o.parseLength(C[0]);return P?(g.thickness=P,g):null},function(t,g,C,T,P){if(T==="none")return T;var R={};return T.color===null?R.color=C.styleAttrs[p.byName.color.qname]:R.color=T.color,R.thickness=o.toComputedLength(T.thickness.value,T.thickness.unit,C.styleAttrs[p.byName.fontSize.qname],C.styleAttrs[p.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),R.thickness===null?null:R}),new i(l.ns_tts,"textShadow","none",["span"],!0,!0,o.parseTextShadow,function(t,g,C,T){if(T==="none")return T;for(var P=[],R=0;R<T.length;R++){var m={};if(m.x_off=o.toComputedLength(T[R][0].value,T[R][0].unit,null,C.styleAttrs[p.byName.fontSize.qname],null,t.pxLength.w),m.x_off===null||(m.y_off=o.toComputedLength(T[R][1].value,T[R][1].unit,null,C.styleAttrs[p.byName.fontSize.qname],null,t.pxLength.h),m.y_off===null))return null;if(T[R][2]===null)m.b_radius=0;else if(m.b_radius=o.toComputedLength(T[R][2].value,T[R][2].unit,null,C.styleAttrs[p.byName.fontSize.qname],null,t.pxLength.h),m.b_radius===null)return null;T[R][3]===null?m.color=C.styleAttrs[p.byName.color.qname]:m.color=T[R][3],P.push(m)}return P}),new i(l.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(t){return t},null),new i(l.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(t){return t},null),new i(l.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(t){return t},null),new i(l.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(t){return t},null),new i(l.ns_tts,"zIndex","auto",["region"],!1,!0,function(t){var g;return t==="auto"?g=t:(g=parseInt(t),isNaN(g)&&(g=null)),g},null),new i(l.ns_ebutts,"linePadding","0c",["p"],!0,!1,o.parseLength,function(t,g,C,T,P){return o.toComputedLength(T.value,T.unit,null,null,t.cellLength.w,null)}),new i(l.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(t){return t},null),new i(l.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(t){return t},null),new i(l.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(t){return t==="true"},null),new i(l.ns_itts,"fillLineGap","false",["p"],!0,!0,function(t){return t==="true"},null)],p.byQName={};for(var E in p.all)p.byQName[p.all[E].qname]=p.all[E];p.byName={};for(var h in p.all)p.byName[p.all[h].name]=p.all[h]})(v,typeof imscNames>"u"?e("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscUtils>"u"?e("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/utils.js":(V,v)=>{(function(e){var p=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,l=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,o=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(h){var t,g=null,C=i[h.toLowerCase()];return C!==void 0?g=C:(t=p.exec(h))!==null?g=[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),t[4]!==void 0?parseInt(t[4],16):255]:(t=l.exec(h))!==null?g=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),255]:(t=o.exec(h))!==null&&(g=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseInt(t[4])]),g};var E=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(h){var t,g=null;return(t=E.exec(h))!==null&&(g={value:parseFloat(t[1]),unit:t[2]}),g},e.parseTextShadow=function(h){for(var t=h.match(/([^\(,\)]|\([^\)]+\))+/g),g=[],C=0;C<t.length;C++){var T=t[C].split(" ");if(T.length===1&&T[0]==="none")return"none";if(T.length>1&&T.length<5){var P=[null,null,null,null],R=e.parseLength(T.shift());if(R===null||(P[0]=R,R=e.parseLength(T.shift()),R===null))return null;if(P[1]=R,T.length===0){g.push(P);continue}if(R=e.parseLength(T[0]),R!==null&&(P[2]=R,T.shift()),T.length===0){g.push(P);continue}var m=e.parseColor(T[0]);if(m===null)return null;P[3]=m,g.push(P)}}return g},e.parsePosition=function(h){var t=h.split(" "),g=function(r){return r==="center"||r==="left"||r==="top"||r==="bottom"||r==="right"};if(t.length>4)return null;for(var C=0;C<t.length;C++)if(!g(t[C])){var T=e.parseLength(t[C]);if(T===null)return null;t[C]=T}for(var P={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},R=0;R<t.length;){var m=t[R++];if(g(m)){var f={value:0,unit:"%"};t.length!==2&&R<t.length&&!g(t[R])&&(f=t[R++]),m==="right"?(P.h.edge=m,P.h.offset=f):m==="bottom"?(P.v.edge=m,P.v.offset=f):m==="left"?P.h.offset=f:m==="top"&&(P.v.offset=f)}else if(t.length===1||t.length===2)R===1?P.h.offset=m:P.v.offset=m;else return null}return P},e.ComputedLength=function(h,t){this.rw=h,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(h,t){return h*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return this.rw===0&&this.rh===0},e.toComputedLength=function(h,t,g,C,T,P){return t==="%"&&C?new e.ComputedLength(C.rw*h/100,C.rh*h/100):t==="em"&&g?new e.ComputedLength(g.rw*h,g.rh*h):t==="c"&&T?new e.ComputedLength(h*T.rw,h*T.rh):t==="px"&&P?new e.ComputedLength(h*P.rw,h*P.rh):t==="rh"?new e.ComputedLength(0,h/100):t==="rw"?new e.ComputedLength(h/100,0):null}})(v)},"./node_modules/is-alphabetical/index.js":V=>{"use strict";V.exports=v;function v(e){var p=typeof e=="string"?e.charCodeAt(0):e;return p>=97&&p<=122||p>=65&&p<=90}},"./node_modules/is-alphanumerical/index.js":(V,v,e)=>{"use strict";var p=e("./node_modules/is-alphabetical/index.js"),l=e("./node_modules/is-decimal/index.js");V.exports=o;function o(i){return p(i)||l(i)}},"./node_modules/is-decimal/index.js":V=>{"use strict";V.exports=v;function v(e){var p=typeof e=="string"?e.charCodeAt(0):e;return p>=48&&p<=57}},"./node_modules/path-browserify/index.js":V=>{"use strict";function v(o){if(typeof o!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(o))}function e(o,i){for(var E="",h=0,t=-1,g=0,C,T=0;T<=o.length;++T){if(T<o.length)C=o.charCodeAt(T);else{if(C===47)break;C=47}if(C===47){if(!(t===T-1||g===1))if(t!==T-1&&g===2){if(E.length<2||h!==2||E.charCodeAt(E.length-1)!==46||E.charCodeAt(E.length-2)!==46){if(E.length>2){var P=E.lastIndexOf("/");if(P!==E.length-1){P===-1?(E="",h=0):(E=E.slice(0,P),h=E.length-1-E.lastIndexOf("/")),t=T,g=0;continue}}else if(E.length===2||E.length===1){E="",h=0,t=T,g=0;continue}}i&&(E.length>0?E+="/..":E="..",h=2)}else E.length>0?E+="/"+o.slice(t+1,T):E=o.slice(t+1,T),h=T-t-1;t=T,g=0}else C===46&&g!==-1?++g:g=-1}return E}function p(o,i){var E=i.dir||i.root,h=i.base||(i.name||"")+(i.ext||"");return E?E===i.root?E+h:E+o+h:h}var l={resolve:function(){for(var i="",E=!1,h,t=arguments.length-1;t>=-1&&!E;t--){var g;t>=0?g=arguments[t]:(h===void 0&&(h=process.cwd()),g=h),v(g),g.length!==0&&(i=g+"/"+i,E=g.charCodeAt(0)===47)}return i=e(i,!E),E?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(v(i),i.length===0)return".";var E=i.charCodeAt(0)===47,h=i.charCodeAt(i.length-1)===47;return i=e(i,!E),i.length===0&&!E&&(i="."),i.length>0&&h&&(i+="/"),E?"/"+i:i},isAbsolute:function(i){return v(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,E=0;E<arguments.length;++E){var h=arguments[E];v(h),h.length>0&&(i===void 0?i=h:i+="/"+h)}return i===void 0?".":l.normalize(i)},relative:function(i,E){if(v(i),v(E),i===E||(i=l.resolve(i),E=l.resolve(E),i===E))return"";for(var h=1;h<i.length&&i.charCodeAt(h)===47;++h);for(var t=i.length,g=t-h,C=1;C<E.length&&E.charCodeAt(C)===47;++C);for(var T=E.length,P=T-C,R=g<P?g:P,m=-1,f=0;f<=R;++f){if(f===R){if(P>R){if(E.charCodeAt(C+f)===47)return E.slice(C+f+1);if(f===0)return E.slice(C+f)}else g>R&&(i.charCodeAt(h+f)===47?m=f:f===0&&(m=0));break}var r=i.charCodeAt(h+f),d=E.charCodeAt(C+f);if(r!==d)break;r===47&&(m=f)}var c="";for(f=h+m+1;f<=t;++f)(f===t||i.charCodeAt(f)===47)&&(c.length===0?c+="..":c+="/..");return c.length>0?c+E.slice(C+m):(C+=m,E.charCodeAt(C)===47&&++C,E.slice(C))},_makeLong:function(i){return i},dirname:function(i){if(v(i),i.length===0)return".";for(var E=i.charCodeAt(0),h=E===47,t=-1,g=!0,C=i.length-1;C>=1;--C)if(E=i.charCodeAt(C),E===47){if(!g){t=C;break}}else g=!1;return t===-1?h?"/":".":h&&t===1?"//":i.slice(0,t)},basename:function(i,E){if(E!==void 0&&typeof E!="string")throw new TypeError('"ext" argument must be a string');v(i);var h=0,t=-1,g=!0,C;if(E!==void 0&&E.length>0&&E.length<=i.length){if(E.length===i.length&&E===i)return"";var T=E.length-1,P=-1;for(C=i.length-1;C>=0;--C){var R=i.charCodeAt(C);if(R===47){if(!g){h=C+1;break}}else P===-1&&(g=!1,P=C+1),T>=0&&(R===E.charCodeAt(T)?--T===-1&&(t=C):(T=-1,t=P))}return h===t?t=P:t===-1&&(t=i.length),i.slice(h,t)}else{for(C=i.length-1;C>=0;--C)if(i.charCodeAt(C)===47){if(!g){h=C+1;break}}else t===-1&&(g=!1,t=C+1);return t===-1?"":i.slice(h,t)}},extname:function(i){v(i);for(var E=-1,h=0,t=-1,g=!0,C=0,T=i.length-1;T>=0;--T){var P=i.charCodeAt(T);if(P===47){if(!g){h=T+1;break}continue}t===-1&&(g=!1,t=T+1),P===46?E===-1?E=T:C!==1&&(C=1):E!==-1&&(C=-1)}return E===-1||t===-1||C===0||C===1&&E===t-1&&E===h+1?"":i.slice(E,t)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return p("/",i)},parse:function(i){v(i);var E={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return E;var h=i.charCodeAt(0),t=h===47,g;t?(E.root="/",g=1):g=0;for(var C=-1,T=0,P=-1,R=!0,m=i.length-1,f=0;m>=g;--m){if(h=i.charCodeAt(m),h===47){if(!R){T=m+1;break}continue}P===-1&&(R=!1,P=m+1),h===46?C===-1?C=m:f!==1&&(f=1):C!==-1&&(f=-1)}return C===-1||P===-1||f===0||f===1&&C===P-1&&C===T+1?P!==-1&&(T===0&&t?E.base=E.name=i.slice(1,P):E.base=E.name=i.slice(T,P)):(T===0&&t?(E.name=i.slice(1,C),E.base=i.slice(1,P)):(E.name=i.slice(T,C),E.base=i.slice(T,P)),E.ext=i.slice(C,P)),T>0?E.dir=i.slice(0,T-1):t&&(E.dir="/"),E},sep:"/",delimiter:":",win32:null,posix:null};l.posix=l,V.exports=l},"./node_modules/safe-buffer/index.js":(V,v,e)=>{var p=e("./node_modules/buffer/index.js"),l=p.Buffer;function o(E,h){for(var t in E)h[t]=E[t]}l.from&&l.alloc&&l.allocUnsafe&&l.allocUnsafeSlow?V.exports=p:(o(p,v),v.Buffer=i);function i(E,h,t){return l(E,h,t)}o(l,i),i.from=function(E,h,t){if(typeof E=="number")throw new TypeError("Argument must not be a number");return l(E,h,t)},i.alloc=function(E,h,t){if(typeof E!="number")throw new TypeError("Argument must be a number");var g=l(E);return h!==void 0?typeof t=="string"?g.fill(h,t):g.fill(h):g.fill(0),g},i.allocUnsafe=function(E){if(typeof E!="number")throw new TypeError("Argument must be a number");return l(E)},i.allocUnsafeSlow=function(E){if(typeof E!="number")throw new TypeError("Argument must be a number");return p.SlowBuffer(E)}},"./node_modules/sax/lib/sax.js":(V,v,e)=>{(function(p){p.parser=function(I,L){return new o(I,L)},p.SAXParser=o,p.SAXStream=T,p.createStream=C,p.MAX_BUFFER_LENGTH=65536;var l=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];p.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function o(I,L){if(!(this instanceof o))return new o(I,L);var K=this;E(K),K.q=K.c="",K.bufferCheckPosition=p.MAX_BUFFER_LENGTH,K.opt=L||{},K.opt.lowercase=K.opt.lowercase||K.opt.lowercasetags,K.looseCase=K.opt.lowercase?"toLowerCase":"toUpperCase",K.tags=[],K.closed=K.closedRoot=K.sawRoot=!1,K.tag=K.error=null,K.strict=!!I,K.noscript=!!(I||K.opt.noscript),K.state=w.BEGIN,K.strictEntities=K.opt.strictEntities,K.ENTITIES=K.strictEntities?Object.create(p.XML_ENTITIES):Object.create(p.ENTITIES),K.attribList=[],K.opt.xmlns&&(K.ns=Object.create(_)),K.trackPosition=K.opt.position!==!1,K.trackPosition&&(K.position=K.line=K.column=0),H(K,"onready")}Object.create||(Object.create=function(I){function L(){}L.prototype=I;var K=new L;return K}),Object.keys||(Object.keys=function(I){var L=[];for(var K in I)I.hasOwnProperty(K)&&L.push(K);return L});function i(I){for(var L=Math.max(p.MAX_BUFFER_LENGTH,10),K=0,U=0,x=l.length;U<x;U++){var y=I[l[U]].length;if(y>L)switch(l[U]){case"textNode":Z(I);break;case"cdata":W(I,"oncdata",I.cdata),I.cdata="";break;case"script":W(I,"onscript",I.script),I.script="";break;default:te(I,"Max buffer length exceeded: "+l[U])}K=Math.max(K,y)}var S=p.MAX_BUFFER_LENGTH-K;I.bufferCheckPosition=S+I.position}function E(I){for(var L=0,K=l.length;L<K;L++)I[l[L]]=""}function h(I){Z(I),I.cdata!==""&&(W(I,"oncdata",I.cdata),I.cdata=""),I.script!==""&&(W(I,"onscript",I.script),I.script="")}o.prototype={end:function(){fe(this)},write:Y,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){h(this)}};var t;try{t=e("./node_modules/stream-browserify/index.js").Stream}catch{t=function(){}}var g=p.EVENTS.filter(function(I){return I!=="error"&&I!=="end"});function C(I,L){return new T(I,L)}function T(I,L){if(!(this instanceof T))return new T(I,L);t.apply(this),this._parser=new o(I,L),this.writable=!0,this.readable=!0;var K=this;this._parser.onend=function(){K.emit("end")},this._parser.onerror=function(U){K.emit("error",U),K._parser.error=null},this._decoder=null,g.forEach(function(U){Object.defineProperty(K,"on"+U,{get:function(){return K._parser["on"+U]},set:function(x){if(!x)return K.removeAllListeners(U),K._parser["on"+U]=x,x;K.on(U,x)},enumerable:!0,configurable:!1})})}T.prototype=Object.create(t.prototype,{constructor:{value:T}}),T.prototype.write=function(I){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(I)){if(!this._decoder){var L=e("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder;this._decoder=new L("utf8")}I=this._decoder.write(I)}return this._parser.write(I.toString()),this.emit("data",I),!0},T.prototype.end=function(I){return I&&I.length&&this.write(I),this._parser.end(),!0},T.prototype.on=function(I,L){var K=this;return!K._parser["on"+I]&&g.indexOf(I)!==-1&&(K._parser["on"+I]=function(){var U=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);U.splice(0,0,I),K.emit.apply(K,U)}),t.prototype.on.call(K,I,L)};var P=`\r
	 `,R="0124356789",m="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",f=`'"`,r=P+">",d="[CDATA[",c="DOCTYPE",M="http://www.w3.org/XML/1998/namespace",n="http://www.w3.org/2000/xmlns/",_={xml:M,xmlns:n};P=$(P),R=$(R),m=$(m);var u=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,A=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,D=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,j=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;f=$(f),r=$(r);function $(I){return I.split("").reduce(function(L,K){return L[K]=!0,L},{})}function z(I){return Object.prototype.toString.call(I)==="[object RegExp]"}function ee(I,L){return z(I)?!!L.match(I):I[L]}function k(I,L){return!ee(I,L)}var w=0;p.STATE={BEGIN:w++,BEGIN_WHITESPACE:w++,TEXT:w++,TEXT_ENTITY:w++,OPEN_WAKA:w++,SGML_DECL:w++,SGML_DECL_QUOTED:w++,DOCTYPE:w++,DOCTYPE_QUOTED:w++,DOCTYPE_DTD:w++,DOCTYPE_DTD_QUOTED:w++,COMMENT_STARTING:w++,COMMENT:w++,COMMENT_ENDING:w++,COMMENT_ENDED:w++,CDATA:w++,CDATA_ENDING:w++,CDATA_ENDING_2:w++,PROC_INST:w++,PROC_INST_BODY:w++,PROC_INST_ENDING:w++,OPEN_TAG:w++,OPEN_TAG_SLASH:w++,ATTRIB:w++,ATTRIB_NAME:w++,ATTRIB_NAME_SAW_WHITE:w++,ATTRIB_VALUE:w++,ATTRIB_VALUE_QUOTED:w++,ATTRIB_VALUE_CLOSED:w++,ATTRIB_VALUE_UNQUOTED:w++,ATTRIB_VALUE_ENTITY_Q:w++,ATTRIB_VALUE_ENTITY_U:w++,CLOSE_TAG:w++,CLOSE_TAG_SAW_WHITE:w++,SCRIPT:w++,SCRIPT_ENDING:w++},p.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},p.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(p.ENTITIES).forEach(function(I){var L=p.ENTITIES[I],K=typeof L=="number"?String.fromCharCode(L):L;p.ENTITIES[I]=K});for(var N in p.STATE)p.STATE[p.STATE[N]]=N;w=p.STATE;function H(I,L,K){I[L]&&I[L](K)}function W(I,L,K){I.textNode&&Z(I),H(I,L,K)}function Z(I){I.textNode=X(I.opt,I.textNode),I.textNode&&H(I,"ontext",I.textNode),I.textNode=""}function X(I,L){return I.trim&&(L=L.trim()),I.normalize&&(L=L.replace(/\s+/g," ")),L}function te(I,L){return Z(I),I.trackPosition&&(L+=`
Line: `+I.line+`
Column: `+I.column+`
Char: `+I.c),L=new Error(L),I.error=L,H(I,"onerror",L),I}function fe(I){return I.sawRoot&&!I.closedRoot&&J(I,"Unclosed root tag"),I.state!==w.BEGIN&&I.state!==w.BEGIN_WHITESPACE&&I.state!==w.TEXT&&te(I,"Unexpected end"),Z(I),I.c="",I.closed=!0,H(I,"onend"),o.call(I,I.strict,I.opt),I}function J(I,L){if(typeof I!="object"||!(I instanceof o))throw new Error("bad call to strictFail");I.strict&&te(I,L)}function ue(I){I.strict||(I.tagName=I.tagName[I.looseCase]());var L=I.tags[I.tags.length-1]||I,K=I.tag={name:I.tagName,attributes:{}};I.opt.xmlns&&(K.ns=L.ns),I.attribList.length=0,W(I,"onopentagstart",K)}function pe(I,L){var K=I.indexOf(":"),U=K<0?["",I]:I.split(":"),x=U[0],y=U[1];return L&&I==="xmlns"&&(x="xmlns",y=""),{prefix:x,local:y}}function Ce(I){if(I.strict||(I.attribName=I.attribName[I.looseCase]()),I.attribList.indexOf(I.attribName)!==-1||I.tag.attributes.hasOwnProperty(I.attribName)){I.attribName=I.attribValue="";return}if(I.opt.xmlns){var L=pe(I.attribName,!0),K=L.prefix,U=L.local;if(K==="xmlns")if(U==="xml"&&I.attribValue!==M)J(I,"xml: prefix must be bound to "+M+`
Actual: `+I.attribValue);else if(U==="xmlns"&&I.attribValue!==n)J(I,"xmlns: prefix must be bound to "+n+`
Actual: `+I.attribValue);else{var x=I.tag,y=I.tags[I.tags.length-1]||I;x.ns===y.ns&&(x.ns=Object.create(y.ns)),x.ns[U]=I.attribValue}I.attribList.push([I.attribName,I.attribValue])}else I.tag.attributes[I.attribName]=I.attribValue,W(I,"onattribute",{name:I.attribName,value:I.attribValue});I.attribName=I.attribValue=""}function ve(I,L){if(I.opt.xmlns){var K=I.tag,U=pe(I.tagName);K.prefix=U.prefix,K.local=U.local,K.uri=K.ns[U.prefix]||"",K.prefix&&!K.uri&&(J(I,"Unbound namespace prefix: "+JSON.stringify(I.tagName)),K.uri=U.prefix);var x=I.tags[I.tags.length-1]||I;K.ns&&x.ns!==K.ns&&Object.keys(K.ns).forEach(function(Ie){W(I,"onopennamespace",{prefix:Ie,uri:K.ns[Ie]})});for(var y=0,S=I.attribList.length;y<S;y++){var b=I.attribList[y],F=b[0],oe=b[1],ie=pe(F,!0),q=ie.prefix,Ae=ie.local,de=q===""?"":K.ns[q]||"",Me={name:F,value:oe,prefix:q,local:Ae,uri:de};q&&q!=="xmlns"&&!de&&(J(I,"Unbound namespace prefix: "+JSON.stringify(q)),Me.uri=q),I.tag.attributes[F]=Me,W(I,"onattribute",Me)}I.attribList.length=0}I.tag.isSelfClosing=!!L,I.sawRoot=!0,I.tags.push(I.tag),W(I,"onopentag",I.tag),L||(!I.noscript&&I.tagName.toLowerCase()==="script"?I.state=w.SCRIPT:I.state=w.TEXT,I.tag=null,I.tagName=""),I.attribName=I.attribValue="",I.attribList.length=0}function Ee(I){if(!I.tagName){J(I,"Weird empty close tag."),I.textNode+="</>",I.state=w.TEXT;return}if(I.script){if(I.tagName!=="script"){I.script+="</"+I.tagName+">",I.tagName="",I.state=w.SCRIPT;return}W(I,"onscript",I.script),I.script=""}var L=I.tags.length,K=I.tagName;I.strict||(K=K[I.looseCase]());for(var U=K;L--;){var x=I.tags[L];if(x.name!==U)J(I,"Unexpected close tag");else break}if(L<0){J(I,"Unmatched closing tag: "+I.tagName),I.textNode+="</"+I.tagName+">",I.state=w.TEXT;return}I.tagName=K;for(var y=I.tags.length;y-- >L;){var S=I.tag=I.tags.pop();I.tagName=I.tag.name,W(I,"onclosetag",I.tagName);var b={};for(var F in S.ns)b[F]=S.ns[F];var oe=I.tags[I.tags.length-1]||I;I.opt.xmlns&&S.ns!==oe.ns&&Object.keys(S.ns).forEach(function(ie){var q=S.ns[ie];W(I,"onclosenamespace",{prefix:ie,uri:q})})}L===0&&(I.closedRoot=!0),I.tagName=I.attribValue=I.attribName="",I.attribList.length=0,I.state=w.TEXT}function ge(I){var L=I.entity,K=L.toLowerCase(),U,x="";return I.ENTITIES[L]?I.ENTITIES[L]:I.ENTITIES[K]?I.ENTITIES[K]:(L=K,L.charAt(0)==="#"&&(L.charAt(1)==="x"?(L=L.slice(2),U=parseInt(L,16),x=U.toString(16)):(L=L.slice(1),U=parseInt(L,10),x=U.toString(10))),L=L.replace(/^0+/,""),x.toLowerCase()!==L?(J(I,"Invalid character entity"),"&"+I.entity+";"):String.fromCodePoint(U))}function Q(I,L){L==="<"?(I.state=w.OPEN_WAKA,I.startTagPosition=I.position):k(P,L)&&(J(I,"Non-whitespace before first tag."),I.textNode=L,I.state=w.TEXT)}function le(I,L){var K="";return L<I.length&&(K=I.charAt(L)),K}function Y(I){var L=this;if(this.error)throw this.error;if(L.closed)return te(L,"Cannot write after close. Assign an onready handler.");if(I===null)return fe(L);typeof I=="object"&&(I=I.toString());for(var K=0,U="";U=le(I,K++),L.c=U,!!U;)switch(L.trackPosition&&(L.position++,U===`
`?(L.line++,L.column=0):L.column++),L.state){case w.BEGIN:if(L.state=w.BEGIN_WHITESPACE,U==="\uFEFF")continue;Q(L,U);continue;case w.BEGIN_WHITESPACE:Q(L,U);continue;case w.TEXT:if(L.sawRoot&&!L.closedRoot){for(var x=K-1;U&&U!=="<"&&U!=="&";)U=le(I,K++),U&&L.trackPosition&&(L.position++,U===`
`?(L.line++,L.column=0):L.column++);L.textNode+=I.substring(x,K-1)}U==="<"&&!(L.sawRoot&&L.closedRoot&&!L.strict)?(L.state=w.OPEN_WAKA,L.startTagPosition=L.position):(k(P,U)&&(!L.sawRoot||L.closedRoot)&&J(L,"Text data outside of root node."),U==="&"?L.state=w.TEXT_ENTITY:L.textNode+=U);continue;case w.SCRIPT:U==="<"?L.state=w.SCRIPT_ENDING:L.script+=U;continue;case w.SCRIPT_ENDING:U==="/"?L.state=w.CLOSE_TAG:(L.script+="<"+U,L.state=w.SCRIPT);continue;case w.OPEN_WAKA:if(U==="!")L.state=w.SGML_DECL,L.sgmlDecl="";else if(!ee(P,U))if(ee(u,U))L.state=w.OPEN_TAG,L.tagName=U;else if(U==="/")L.state=w.CLOSE_TAG,L.tagName="";else if(U==="?")L.state=w.PROC_INST,L.procInstName=L.procInstBody="";else{if(J(L,"Unencoded <"),L.startTagPosition+1<L.position){var y=L.position-L.startTagPosition;U=new Array(y).join(" ")+U}L.textNode+="<"+U,L.state=w.TEXT}continue;case w.SGML_DECL:(L.sgmlDecl+U).toUpperCase()===d?(W(L,"onopencdata"),L.state=w.CDATA,L.sgmlDecl="",L.cdata=""):L.sgmlDecl+U==="--"?(L.state=w.COMMENT,L.comment="",L.sgmlDecl=""):(L.sgmlDecl+U).toUpperCase()===c?(L.state=w.DOCTYPE,(L.doctype||L.sawRoot)&&J(L,"Inappropriately located doctype declaration"),L.doctype="",L.sgmlDecl=""):U===">"?(W(L,"onsgmldeclaration",L.sgmlDecl),L.sgmlDecl="",L.state=w.TEXT):(ee(f,U)&&(L.state=w.SGML_DECL_QUOTED),L.sgmlDecl+=U);continue;case w.SGML_DECL_QUOTED:U===L.q&&(L.state=w.SGML_DECL,L.q=""),L.sgmlDecl+=U;continue;case w.DOCTYPE:U===">"?(L.state=w.TEXT,W(L,"ondoctype",L.doctype),L.doctype=!0):(L.doctype+=U,U==="["?L.state=w.DOCTYPE_DTD:ee(f,U)&&(L.state=w.DOCTYPE_QUOTED,L.q=U));continue;case w.DOCTYPE_QUOTED:L.doctype+=U,U===L.q&&(L.q="",L.state=w.DOCTYPE);continue;case w.DOCTYPE_DTD:L.doctype+=U,U==="]"?L.state=w.DOCTYPE:ee(f,U)&&(L.state=w.DOCTYPE_DTD_QUOTED,L.q=U);continue;case w.DOCTYPE_DTD_QUOTED:L.doctype+=U,U===L.q&&(L.state=w.DOCTYPE_DTD,L.q="");continue;case w.COMMENT:U==="-"?L.state=w.COMMENT_ENDING:L.comment+=U;continue;case w.COMMENT_ENDING:U==="-"?(L.state=w.COMMENT_ENDED,L.comment=X(L.opt,L.comment),L.comment&&W(L,"oncomment",L.comment),L.comment=""):(L.comment+="-"+U,L.state=w.COMMENT);continue;case w.COMMENT_ENDED:U!==">"?(J(L,"Malformed comment"),L.comment+="--"+U,L.state=w.COMMENT):L.state=w.TEXT;continue;case w.CDATA:U==="]"?L.state=w.CDATA_ENDING:L.cdata+=U;continue;case w.CDATA_ENDING:U==="]"?L.state=w.CDATA_ENDING_2:(L.cdata+="]"+U,L.state=w.CDATA);continue;case w.CDATA_ENDING_2:U===">"?(L.cdata&&W(L,"oncdata",L.cdata),W(L,"onclosecdata"),L.cdata="",L.state=w.TEXT):U==="]"?L.cdata+="]":(L.cdata+="]]"+U,L.state=w.CDATA);continue;case w.PROC_INST:U==="?"?L.state=w.PROC_INST_ENDING:ee(P,U)?L.state=w.PROC_INST_BODY:L.procInstName+=U;continue;case w.PROC_INST_BODY:if(!L.procInstBody&&ee(P,U))continue;U==="?"?L.state=w.PROC_INST_ENDING:L.procInstBody+=U;continue;case w.PROC_INST_ENDING:U===">"?(W(L,"onprocessinginstruction",{name:L.procInstName,body:L.procInstBody}),L.procInstName=L.procInstBody="",L.state=w.TEXT):(L.procInstBody+="?"+U,L.state=w.PROC_INST_BODY);continue;case w.OPEN_TAG:ee(A,U)?L.tagName+=U:(ue(L),U===">"?ve(L):U==="/"?L.state=w.OPEN_TAG_SLASH:(k(P,U)&&J(L,"Invalid character in tag name"),L.state=w.ATTRIB));continue;case w.OPEN_TAG_SLASH:U===">"?(ve(L,!0),Ee(L)):(J(L,"Forward-slash in opening tag not followed by >"),L.state=w.ATTRIB);continue;case w.ATTRIB:if(ee(P,U))continue;U===">"?ve(L):U==="/"?L.state=w.OPEN_TAG_SLASH:ee(u,U)?(L.attribName=U,L.attribValue="",L.state=w.ATTRIB_NAME):J(L,"Invalid attribute name");continue;case w.ATTRIB_NAME:U==="="?L.state=w.ATTRIB_VALUE:U===">"?(J(L,"Attribute without value"),L.attribValue=L.attribName,Ce(L),ve(L)):ee(P,U)?L.state=w.ATTRIB_NAME_SAW_WHITE:ee(A,U)?L.attribName+=U:J(L,"Invalid attribute name");continue;case w.ATTRIB_NAME_SAW_WHITE:if(U==="=")L.state=w.ATTRIB_VALUE;else{if(ee(P,U))continue;J(L,"Attribute without value"),L.tag.attributes[L.attribName]="",L.attribValue="",W(L,"onattribute",{name:L.attribName,value:""}),L.attribName="",U===">"?ve(L):ee(u,U)?(L.attribName=U,L.state=w.ATTRIB_NAME):(J(L,"Invalid attribute name"),L.state=w.ATTRIB)}continue;case w.ATTRIB_VALUE:if(ee(P,U))continue;ee(f,U)?(L.q=U,L.state=w.ATTRIB_VALUE_QUOTED):(J(L,"Unquoted attribute value"),L.state=w.ATTRIB_VALUE_UNQUOTED,L.attribValue=U);continue;case w.ATTRIB_VALUE_QUOTED:if(U!==L.q){U==="&"?L.state=w.ATTRIB_VALUE_ENTITY_Q:L.attribValue+=U;continue}Ce(L),L.q="",L.state=w.ATTRIB_VALUE_CLOSED;continue;case w.ATTRIB_VALUE_CLOSED:ee(P,U)?L.state=w.ATTRIB:U===">"?ve(L):U==="/"?L.state=w.OPEN_TAG_SLASH:ee(u,U)?(J(L,"No whitespace between attributes"),L.attribName=U,L.attribValue="",L.state=w.ATTRIB_NAME):J(L,"Invalid attribute name");continue;case w.ATTRIB_VALUE_UNQUOTED:if(k(r,U)){U==="&"?L.state=w.ATTRIB_VALUE_ENTITY_U:L.attribValue+=U;continue}Ce(L),U===">"?ve(L):L.state=w.ATTRIB;continue;case w.CLOSE_TAG:if(L.tagName)U===">"?Ee(L):ee(A,U)?L.tagName+=U:L.script?(L.script+="</"+L.tagName,L.tagName="",L.state=w.SCRIPT):(k(P,U)&&J(L,"Invalid tagname in closing tag"),L.state=w.CLOSE_TAG_SAW_WHITE);else{if(ee(P,U))continue;k(u,U)?L.script?(L.script+="</"+U,L.state=w.SCRIPT):J(L,"Invalid tagname in closing tag."):L.tagName=U}continue;case w.CLOSE_TAG_SAW_WHITE:if(ee(P,U))continue;U===">"?Ee(L):J(L,"Invalid characters in closing tag");continue;case w.TEXT_ENTITY:case w.ATTRIB_VALUE_ENTITY_Q:case w.ATTRIB_VALUE_ENTITY_U:var S,b;switch(L.state){case w.TEXT_ENTITY:S=w.TEXT,b="textNode";break;case w.ATTRIB_VALUE_ENTITY_Q:S=w.ATTRIB_VALUE_QUOTED,b="attribValue";break;case w.ATTRIB_VALUE_ENTITY_U:S=w.ATTRIB_VALUE_UNQUOTED,b="attribValue";break}U===";"?(L[b]+=ge(L),L.entity="",L.state=S):ee(L.entity.length?j:D,U)?L.entity+=U:(J(L,"Invalid character in entity name"),L[b]+="&"+L.entity+U,L.entity="",L.state=S);continue;default:throw new Error(L,"Unknown state: "+L.state)}return L.position>=L.bufferCheckPosition&&i(L),L}String.fromCodePoint||function(){var I=String.fromCharCode,L=Math.floor,K=function(){var U=16384,x=[],y,S,b=-1,F=arguments.length;if(!F)return"";for(var oe="";++b<F;){var ie=Number(arguments[b]);if(!isFinite(ie)||ie<0||ie>1114111||L(ie)!==ie)throw RangeError("Invalid code point: "+ie);ie<=65535?x.push(ie):(ie-=65536,y=(ie>>10)+55296,S=ie%1024+56320,x.push(y,S)),(b+1===F||x.length>U)&&(oe+=I.apply(null,x),x.length=0)}return oe};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:K,configurable:!0,writable:!0}):String.fromCodePoint=K}()})(v)},"./node_modules/stream-browserify/index.js":(V,v,e)=>{V.exports=o;var p=e("./node_modules/events/events.js").EventEmitter,l=e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js");l(o,p),o.Readable=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js"),o.Writable=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js"),o.Duplex=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),o.Transform=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js"),o.PassThrough=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_passthrough.js"),o.finished=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"),o.pipeline=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/pipeline.js"),o.Stream=o;function o(){p.call(this)}o.prototype.pipe=function(i,E){var h=this;function t(f){i.writable&&i.write(f)===!1&&h.pause&&h.pause()}h.on("data",t);function g(){h.readable&&h.resume&&h.resume()}i.on("drain",g),!i._isStdio&&(!E||E.end!==!1)&&(h.on("end",T),h.on("close",P));var C=!1;function T(){C||(C=!0,i.end())}function P(){C||(C=!0,typeof i.destroy=="function"&&i.destroy())}function R(f){if(m(),p.listenerCount(this,"error")===0)throw f}h.on("error",R),i.on("error",R);function m(){h.removeListener("data",t),i.removeListener("drain",g),h.removeListener("end",T),h.removeListener("close",P),h.removeListener("error",R),i.removeListener("error",R),h.removeListener("end",m),h.removeListener("close",m),i.removeListener("close",m)}return h.on("end",m),h.on("close",m),i.on("close",m),i.emit("pipe",h),i}},"./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js":V=>{typeof Object.create=="function"?V.exports=function(e,p){p&&(e.super_=p,e.prototype=Object.create(p.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:V.exports=function(e,p){if(p){e.super_=p;var l=function(){};l.prototype=p.prototype,e.prototype=new l,e.prototype.constructor=e}}},"./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js":V=>{"use strict";function v(h,t){h.prototype=Object.create(t.prototype),h.prototype.constructor=h,h.__proto__=t}var e={};function p(h,t,g){g||(g=Error);function C(P,R,m){return typeof t=="string"?t:t(P,R,m)}var T=function(P){v(R,P);function R(m,f,r){return P.call(this,C(m,f,r))||this}return R}(g);T.prototype.name=g.name,T.prototype.code=h,e[h]=T}function l(h,t){if(Array.isArray(h)){var g=h.length;return h=h.map(function(C){return String(C)}),g>2?"one of ".concat(t," ").concat(h.slice(0,g-1).join(", "),", or ")+h[g-1]:g===2?"one of ".concat(t," ").concat(h[0]," or ").concat(h[1]):"of ".concat(t," ").concat(h[0])}else return"of ".concat(t," ").concat(String(h))}function o(h,t,g){return h.substr(!g||g<0?0:+g,t.length)===t}function i(h,t,g){return(g===void 0||g>h.length)&&(g=h.length),h.substring(g-t.length,g)===t}function E(h,t,g){return typeof g!="number"&&(g=0),g+t.length>h.length?!1:h.indexOf(t,g)!==-1}p("ERR_INVALID_OPT_VALUE",function(h,t){return'The value "'+t+'" is invalid for option "'+h+'"'},TypeError),p("ERR_INVALID_ARG_TYPE",function(h,t,g){var C;typeof t=="string"&&o(t,"not ")?(C="must not be",t=t.replace(/^not /,"")):C="must be";var T;if(i(h," argument"))T="The ".concat(h," ").concat(C," ").concat(l(t,"type"));else{var P=E(h,".")?"property":"argument";T='The "'.concat(h,'" ').concat(P," ").concat(C," ").concat(l(t,"type"))}return T+=". Received type ".concat(typeof g),T},TypeError),p("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),p("ERR_METHOD_NOT_IMPLEMENTED",function(h){return"The "+h+" method is not implemented"}),p("ERR_STREAM_PREMATURE_CLOSE","Premature close"),p("ERR_STREAM_DESTROYED",function(h){return"Cannot call "+h+" after a stream was destroyed"}),p("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),p("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),p("ERR_STREAM_WRITE_AFTER_END","write after end"),p("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),p("ERR_UNKNOWN_ENCODING",function(h){return"Unknown encoding: "+h},TypeError),p("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),V.exports.codes=e},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js":(V,v,e)=>{"use strict";var p=Object.keys||function(T){var P=[];for(var R in T)P.push(R);return P};V.exports=t;var l=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js"),o=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js");e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(t,l);for(var i=p(o.prototype),E=0;E<i.length;E++){var h=i[E];t.prototype[h]||(t.prototype[h]=o.prototype[h])}function t(T){if(!(this instanceof t))return new t(T);l.call(this,T),o.call(this,T),this.allowHalfOpen=!0,T&&(T.readable===!1&&(this.readable=!1),T.writable===!1&&(this.writable=!1),T.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",g)))}Object.defineProperty(t.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(t.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(t.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function g(){this._writableState.ended||process.nextTick(C,this)}function C(T){T.end()}Object.defineProperty(t.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(P){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=P,this._writableState.destroyed=P)}})},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_passthrough.js":(V,v,e)=>{"use strict";V.exports=l;var p=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js");e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(l,p);function l(o){if(!(this instanceof l))return new l(o);p.call(this,o)}l.prototype._transform=function(o,i,E){E(null,o)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js":(V,v,e)=>{"use strict";V.exports=ee;var p;ee.ReadableState=z;var l=e("./node_modules/events/events.js").EventEmitter,o=function(U,x){return U.listeners(x).length},i=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js"),E=e("./node_modules/buffer/index.js").Buffer,h=e.g.Uint8Array||function(){};function t(K){return E.from(K)}function g(K){return E.isBuffer(K)||K instanceof h}var C=e("?19e6"),T;C&&C.debuglog?T=C.debuglog("stream"):T=function(){};var P=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/buffer_list.js"),R=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js"),m=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js"),f=m.getHighWaterMark,r=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,d=r.ERR_INVALID_ARG_TYPE,c=r.ERR_STREAM_PUSH_AFTER_EOF,M=r.ERR_METHOD_NOT_IMPLEMENTED,n=r.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,_,u,A;e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(ee,i);var D=R.errorOrDestroy,j=["error","close","destroy","pause","resume"];function $(K,U,x){if(typeof K.prependListener=="function")return K.prependListener(U,x);!K._events||!K._events[U]?K.on(U,x):Array.isArray(K._events[U])?K._events[U].unshift(x):K._events[U]=[x,K._events[U]]}function z(K,U,x){p=p||e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),K=K||{},typeof x!="boolean"&&(x=U instanceof p),this.objectMode=!!K.objectMode,x&&(this.objectMode=this.objectMode||!!K.readableObjectMode),this.highWaterMark=f(this,K,"readableHighWaterMark",x),this.buffer=new P,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=K.emitClose!==!1,this.autoDestroy=!!K.autoDestroy,this.destroyed=!1,this.defaultEncoding=K.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,K.encoding&&(_||(_=e("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this.decoder=new _(K.encoding),this.encoding=K.encoding)}function ee(K){if(p=p||e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),!(this instanceof ee))return new ee(K);var U=this instanceof p;this._readableState=new z(K,this,U),this.readable=!0,K&&(typeof K.read=="function"&&(this._read=K.read),typeof K.destroy=="function"&&(this._destroy=K.destroy)),i.call(this)}Object.defineProperty(ee.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(U){this._readableState&&(this._readableState.destroyed=U)}}),ee.prototype.destroy=R.destroy,ee.prototype._undestroy=R.undestroy,ee.prototype._destroy=function(K,U){U(K)},ee.prototype.push=function(K,U){var x=this._readableState,y;return x.objectMode?y=!0:typeof K=="string"&&(U=U||x.defaultEncoding,U!==x.encoding&&(K=E.from(K,U),U=""),y=!0),k(this,K,U,!1,y)},ee.prototype.unshift=function(K){return k(this,K,null,!0,!1)};function k(K,U,x,y,S){T("readableAddChunk",U);var b=K._readableState;if(U===null)b.reading=!1,X(K,b);else{var F;if(S||(F=N(b,U)),F)D(K,F);else if(b.objectMode||U&&U.length>0)if(typeof U!="string"&&!b.objectMode&&Object.getPrototypeOf(U)!==E.prototype&&(U=t(U)),y)b.endEmitted?D(K,new n):w(K,b,U,!0);else if(b.ended)D(K,new c);else{if(b.destroyed)return!1;b.reading=!1,b.decoder&&!x?(U=b.decoder.write(U),b.objectMode||U.length!==0?w(K,b,U,!1):J(K,b)):w(K,b,U,!1)}else y||(b.reading=!1,J(K,b))}return!b.ended&&(b.length<b.highWaterMark||b.length===0)}function w(K,U,x,y){U.flowing&&U.length===0&&!U.sync?(U.awaitDrain=0,K.emit("data",x)):(U.length+=U.objectMode?1:x.length,y?U.buffer.unshift(x):U.buffer.push(x),U.needReadable&&te(K)),J(K,U)}function N(K,U){var x;return!g(U)&&typeof U!="string"&&U!==void 0&&!K.objectMode&&(x=new d("chunk",["string","Buffer","Uint8Array"],U)),x}ee.prototype.isPaused=function(){return this._readableState.flowing===!1},ee.prototype.setEncoding=function(K){_||(_=e("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder);var U=new _(K);this._readableState.decoder=U,this._readableState.encoding=this._readableState.decoder.encoding;for(var x=this._readableState.buffer.head,y="";x!==null;)y+=U.write(x.data),x=x.next;return this._readableState.buffer.clear(),y!==""&&this._readableState.buffer.push(y),this._readableState.length=y.length,this};var H=1073741824;function W(K){return K>=H?K=H:(K--,K|=K>>>1,K|=K>>>2,K|=K>>>4,K|=K>>>8,K|=K>>>16,K++),K}function Z(K,U){return K<=0||U.length===0&&U.ended?0:U.objectMode?1:K!==K?U.flowing&&U.length?U.buffer.head.data.length:U.length:(K>U.highWaterMark&&(U.highWaterMark=W(K)),K<=U.length?K:U.ended?U.length:(U.needReadable=!0,0))}ee.prototype.read=function(K){T("read",K),K=parseInt(K,10);var U=this._readableState,x=K;if(K!==0&&(U.emittedReadable=!1),K===0&&U.needReadable&&((U.highWaterMark!==0?U.length>=U.highWaterMark:U.length>0)||U.ended))return T("read: emitReadable",U.length,U.ended),U.length===0&&U.ended?Y(this):te(this),null;if(K=Z(K,U),K===0&&U.ended)return U.length===0&&Y(this),null;var y=U.needReadable;T("need readable",y),(U.length===0||U.length-K<U.highWaterMark)&&(y=!0,T("length less than watermark",y)),U.ended||U.reading?(y=!1,T("reading or ended",y)):y&&(T("do read"),U.reading=!0,U.sync=!0,U.length===0&&(U.needReadable=!0),this._read(U.highWaterMark),U.sync=!1,U.reading||(K=Z(x,U)));var S;return K>0?S=le(K,U):S=null,S===null?(U.needReadable=U.length<=U.highWaterMark,K=0):(U.length-=K,U.awaitDrain=0),U.length===0&&(U.ended||(U.needReadable=!0),x!==K&&U.ended&&Y(this)),S!==null&&this.emit("data",S),S};function X(K,U){if(T("onEofChunk"),!U.ended){if(U.decoder){var x=U.decoder.end();x&&x.length&&(U.buffer.push(x),U.length+=U.objectMode?1:x.length)}U.ended=!0,U.sync?te(K):(U.needReadable=!1,U.emittedReadable||(U.emittedReadable=!0,fe(K)))}}function te(K){var U=K._readableState;T("emitReadable",U.needReadable,U.emittedReadable),U.needReadable=!1,U.emittedReadable||(T("emitReadable",U.flowing),U.emittedReadable=!0,process.nextTick(fe,K))}function fe(K){var U=K._readableState;T("emitReadable_",U.destroyed,U.length,U.ended),!U.destroyed&&(U.length||U.ended)&&(K.emit("readable"),U.emittedReadable=!1),U.needReadable=!U.flowing&&!U.ended&&U.length<=U.highWaterMark,Q(K)}function J(K,U){U.readingMore||(U.readingMore=!0,process.nextTick(ue,K,U))}function ue(K,U){for(;!U.reading&&!U.ended&&(U.length<U.highWaterMark||U.flowing&&U.length===0);){var x=U.length;if(T("maybeReadMore read 0"),K.read(0),x===U.length)break}U.readingMore=!1}ee.prototype._read=function(K){D(this,new M("_read()"))},ee.prototype.pipe=function(K,U){var x=this,y=this._readableState;switch(y.pipesCount){case 0:y.pipes=K;break;case 1:y.pipes=[y.pipes,K];break;default:y.pipes.push(K);break}y.pipesCount+=1,T("pipe count=%d opts=%j",y.pipesCount,U);var S=(!U||U.end!==!1)&&K!==process.stdout&&K!==process.stderr,b=S?oe:Be;y.endEmitted?process.nextTick(b):x.once("end",b),K.on("unpipe",F);function F(ze,Ye){T("onunpipe"),ze===x&&Ye&&Ye.hasUnpiped===!1&&(Ye.hasUnpiped=!0,Ae())}function oe(){T("onend"),K.end()}var ie=pe(x);K.on("drain",ie);var q=!1;function Ae(){T("cleanup"),K.removeListener("close",Ie),K.removeListener("finish",He),K.removeListener("drain",ie),K.removeListener("error",Me),K.removeListener("unpipe",F),x.removeListener("end",oe),x.removeListener("end",Be),x.removeListener("data",de),q=!0,y.awaitDrain&&(!K._writableState||K._writableState.needDrain)&&ie()}x.on("data",de);function de(ze){T("ondata");var Ye=K.write(ze);T("dest.write",Ye),Ye===!1&&((y.pipesCount===1&&y.pipes===K||y.pipesCount>1&&L(y.pipes,K)!==-1)&&!q&&(T("false write response, pause",y.awaitDrain),y.awaitDrain++),x.pause())}function Me(ze){T("onerror",ze),Be(),K.removeListener("error",Me),o(K,"error")===0&&D(K,ze)}$(K,"error",Me);function Ie(){K.removeListener("finish",He),Be()}K.once("close",Ie);function He(){T("onfinish"),K.removeListener("close",Ie),Be()}K.once("finish",He);function Be(){T("unpipe"),x.unpipe(K)}return K.emit("pipe",x),y.flowing||(T("pipe resume"),x.resume()),K};function pe(K){return function(){var x=K._readableState;T("pipeOnDrain",x.awaitDrain),x.awaitDrain&&x.awaitDrain--,x.awaitDrain===0&&o(K,"data")&&(x.flowing=!0,Q(K))}}ee.prototype.unpipe=function(K){var U=this._readableState,x={hasUnpiped:!1};if(U.pipesCount===0)return this;if(U.pipesCount===1)return K&&K!==U.pipes?this:(K||(K=U.pipes),U.pipes=null,U.pipesCount=0,U.flowing=!1,K&&K.emit("unpipe",this,x),this);if(!K){var y=U.pipes,S=U.pipesCount;U.pipes=null,U.pipesCount=0,U.flowing=!1;for(var b=0;b<S;b++)y[b].emit("unpipe",this,{hasUnpiped:!1});return this}var F=L(U.pipes,K);return F===-1?this:(U.pipes.splice(F,1),U.pipesCount-=1,U.pipesCount===1&&(U.pipes=U.pipes[0]),K.emit("unpipe",this,x),this)},ee.prototype.on=function(K,U){var x=i.prototype.on.call(this,K,U),y=this._readableState;return K==="data"?(y.readableListening=this.listenerCount("readable")>0,y.flowing!==!1&&this.resume()):K==="readable"&&!y.endEmitted&&!y.readableListening&&(y.readableListening=y.needReadable=!0,y.flowing=!1,y.emittedReadable=!1,T("on readable",y.length,y.reading),y.length?te(this):y.reading||process.nextTick(ve,this)),x},ee.prototype.addListener=ee.prototype.on,ee.prototype.removeListener=function(K,U){var x=i.prototype.removeListener.call(this,K,U);return K==="readable"&&process.nextTick(Ce,this),x},ee.prototype.removeAllListeners=function(K){var U=i.prototype.removeAllListeners.apply(this,arguments);return(K==="readable"||K===void 0)&&process.nextTick(Ce,this),U};function Ce(K){var U=K._readableState;U.readableListening=K.listenerCount("readable")>0,U.resumeScheduled&&!U.paused?U.flowing=!0:K.listenerCount("data")>0&&K.resume()}function ve(K){T("readable nexttick read 0"),K.read(0)}ee.prototype.resume=function(){var K=this._readableState;return K.flowing||(T("resume"),K.flowing=!K.readableListening,Ee(this,K)),K.paused=!1,this};function Ee(K,U){U.resumeScheduled||(U.resumeScheduled=!0,process.nextTick(ge,K,U))}function ge(K,U){T("resume",U.reading),U.reading||K.read(0),U.resumeScheduled=!1,K.emit("resume"),Q(K),U.flowing&&!U.reading&&K.read(0)}ee.prototype.pause=function(){return T("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(T("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Q(K){var U=K._readableState;for(T("flow",U.flowing);U.flowing&&K.read()!==null;);}ee.prototype.wrap=function(K){var U=this,x=this._readableState,y=!1;K.on("end",function(){if(T("wrapped end"),x.decoder&&!x.ended){var F=x.decoder.end();F&&F.length&&U.push(F)}U.push(null)}),K.on("data",function(F){if(T("wrapped data"),x.decoder&&(F=x.decoder.write(F)),!(x.objectMode&&F==null)&&!(!x.objectMode&&(!F||!F.length))){var oe=U.push(F);oe||(y=!0,K.pause())}});for(var S in K)this[S]===void 0&&typeof K[S]=="function"&&(this[S]=function(oe){return function(){return K[oe].apply(K,arguments)}}(S));for(var b=0;b<j.length;b++)K.on(j[b],this.emit.bind(this,j[b]));return this._read=function(F){T("wrapped _read",F),y&&(y=!1,K.resume())},this},typeof Symbol=="function"&&(ee.prototype[Symbol.asyncIterator]=function(){return u===void 0&&(u=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/async_iterator.js")),u(this)}),Object.defineProperty(ee.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ee.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ee.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(U){this._readableState&&(this._readableState.flowing=U)}}),ee._fromList=le,Object.defineProperty(ee.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function le(K,U){if(U.length===0)return null;var x;return U.objectMode?x=U.buffer.shift():!K||K>=U.length?(U.decoder?x=U.buffer.join(""):U.buffer.length===1?x=U.buffer.first():x=U.buffer.concat(U.length),U.buffer.clear()):x=U.buffer.consume(K,U.decoder),x}function Y(K){var U=K._readableState;T("endReadable",U.endEmitted),U.endEmitted||(U.ended=!0,process.nextTick(I,U,K))}function I(K,U){if(T("endReadableNT",K.endEmitted,K.length),!K.endEmitted&&K.length===0&&(K.endEmitted=!0,U.readable=!1,U.emit("end"),K.autoDestroy)){var x=U._writableState;(!x||x.autoDestroy&&x.finished)&&U.destroy()}}typeof Symbol=="function"&&(ee.from=function(K,U){return A===void 0&&(A=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/from-browser.js")),A(ee,K,U)});function L(K,U){for(var x=0,y=K.length;x<y;x++)if(K[x]===U)return x;return-1}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js":(V,v,e)=>{"use strict";V.exports=g;var p=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,l=p.ERR_METHOD_NOT_IMPLEMENTED,o=p.ERR_MULTIPLE_CALLBACK,i=p.ERR_TRANSFORM_ALREADY_TRANSFORMING,E=p.ERR_TRANSFORM_WITH_LENGTH_0,h=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js");e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(g,h);function t(P,R){var m=this._transformState;m.transforming=!1;var f=m.writecb;if(f===null)return this.emit("error",new o);m.writechunk=null,m.writecb=null,R!=null&&this.push(R),f(P);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function g(P){if(!(this instanceof g))return new g(P);h.call(this,P),this._transformState={afterTransform:t.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,P&&(typeof P.transform=="function"&&(this._transform=P.transform),typeof P.flush=="function"&&(this._flush=P.flush)),this.on("prefinish",C)}function C(){var P=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(R,m){T(P,R,m)}):T(this,null,null)}g.prototype.push=function(P,R){return this._transformState.needTransform=!1,h.prototype.push.call(this,P,R)},g.prototype._transform=function(P,R,m){m(new l("_transform()"))},g.prototype._write=function(P,R,m){var f=this._transformState;if(f.writecb=m,f.writechunk=P,f.writeencoding=R,!f.transforming){var r=this._readableState;(f.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},g.prototype._read=function(P){var R=this._transformState;R.writechunk!==null&&!R.transforming?(R.transforming=!0,this._transform(R.writechunk,R.writeencoding,R.afterTransform)):R.needTransform=!0},g.prototype._destroy=function(P,R){h.prototype._destroy.call(this,P,function(m){R(m)})};function T(P,R,m){if(R)return P.emit("error",R);if(m!=null&&P.push(m),P._writableState.length)throw new E;if(P._transformState.transforming)throw new i;return P.push(null)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js":(V,v,e)=>{"use strict";V.exports=z;function p(Q,le,Y){this.chunk=Q,this.encoding=le,this.callback=Y,this.next=null}function l(Q){var le=this;this.next=null,this.entry=null,this.finish=function(){ge(le,Q)}}var o;z.WritableState=j;var i={deprecate:e("./node_modules/util-deprecate/browser.js")},E=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js"),h=e("./node_modules/buffer/index.js").Buffer,t=e.g.Uint8Array||function(){};function g(Q){return h.from(Q)}function C(Q){return h.isBuffer(Q)||Q instanceof t}var T=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js"),P=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js"),R=P.getHighWaterMark,m=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,f=m.ERR_INVALID_ARG_TYPE,r=m.ERR_METHOD_NOT_IMPLEMENTED,d=m.ERR_MULTIPLE_CALLBACK,c=m.ERR_STREAM_CANNOT_PIPE,M=m.ERR_STREAM_DESTROYED,n=m.ERR_STREAM_NULL_VALUES,_=m.ERR_STREAM_WRITE_AFTER_END,u=m.ERR_UNKNOWN_ENCODING,A=T.errorOrDestroy;e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(z,E);function D(){}function j(Q,le,Y){o=o||e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),Q=Q||{},typeof Y!="boolean"&&(Y=le instanceof o),this.objectMode=!!Q.objectMode,Y&&(this.objectMode=this.objectMode||!!Q.writableObjectMode),this.highWaterMark=R(this,Q,"writableHighWaterMark",Y),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var I=Q.decodeStrings===!1;this.decodeStrings=!I,this.defaultEncoding=Q.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(L){X(le,L)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Q.emitClose!==!1,this.autoDestroy=!!Q.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}j.prototype.getBuffer=function(){for(var le=this.bufferedRequest,Y=[];le;)Y.push(le),le=le.next;return Y},function(){try{Object.defineProperty(j.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var $;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?($=Function.prototype[Symbol.hasInstance],Object.defineProperty(z,Symbol.hasInstance,{value:function(le){return $.call(this,le)?!0:this!==z?!1:le&&le._writableState instanceof j}})):$=function(le){return le instanceof this};function z(Q){o=o||e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js");var le=this instanceof o;if(!le&&!$.call(z,this))return new z(Q);this._writableState=new j(Q,this,le),this.writable=!0,Q&&(typeof Q.write=="function"&&(this._write=Q.write),typeof Q.writev=="function"&&(this._writev=Q.writev),typeof Q.destroy=="function"&&(this._destroy=Q.destroy),typeof Q.final=="function"&&(this._final=Q.final)),E.call(this)}z.prototype.pipe=function(){A(this,new c)};function ee(Q,le){var Y=new _;A(Q,Y),process.nextTick(le,Y)}function k(Q,le,Y,I){var L;return Y===null?L=new n:typeof Y!="string"&&!le.objectMode&&(L=new f("chunk",["string","Buffer"],Y)),L?(A(Q,L),process.nextTick(I,L),!1):!0}z.prototype.write=function(Q,le,Y){var I=this._writableState,L=!1,K=!I.objectMode&&C(Q);return K&&!h.isBuffer(Q)&&(Q=g(Q)),typeof le=="function"&&(Y=le,le=null),K?le="buffer":le||(le=I.defaultEncoding),typeof Y!="function"&&(Y=D),I.ending?ee(this,Y):(K||k(this,I,Q,Y))&&(I.pendingcb++,L=N(this,I,K,Q,le,Y)),L},z.prototype.cork=function(){this._writableState.corked++},z.prototype.uncork=function(){var Q=this._writableState;Q.corked&&(Q.corked--,!Q.writing&&!Q.corked&&!Q.bufferProcessing&&Q.bufferedRequest&&J(this,Q))},z.prototype.setDefaultEncoding=function(le){if(typeof le=="string"&&(le=le.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((le+"").toLowerCase())>-1))throw new u(le);return this._writableState.defaultEncoding=le,this},Object.defineProperty(z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function w(Q,le,Y){return!Q.objectMode&&Q.decodeStrings!==!1&&typeof le=="string"&&(le=h.from(le,Y)),le}Object.defineProperty(z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function N(Q,le,Y,I,L,K){if(!Y){var U=w(le,I,L);I!==U&&(Y=!0,L="buffer",I=U)}var x=le.objectMode?1:I.length;le.length+=x;var y=le.length<le.highWaterMark;if(y||(le.needDrain=!0),le.writing||le.corked){var S=le.lastBufferedRequest;le.lastBufferedRequest={chunk:I,encoding:L,isBuf:Y,callback:K,next:null},S?S.next=le.lastBufferedRequest:le.bufferedRequest=le.lastBufferedRequest,le.bufferedRequestCount+=1}else H(Q,le,!1,x,I,L,K);return y}function H(Q,le,Y,I,L,K,U){le.writelen=I,le.writecb=U,le.writing=!0,le.sync=!0,le.destroyed?le.onwrite(new M("write")):Y?Q._writev(L,le.onwrite):Q._write(L,K,le.onwrite),le.sync=!1}function W(Q,le,Y,I,L){--le.pendingcb,Y?(process.nextTick(L,I),process.nextTick(ve,Q,le),Q._writableState.errorEmitted=!0,A(Q,I)):(L(I),Q._writableState.errorEmitted=!0,A(Q,I),ve(Q,le))}function Z(Q){Q.writing=!1,Q.writecb=null,Q.length-=Q.writelen,Q.writelen=0}function X(Q,le){var Y=Q._writableState,I=Y.sync,L=Y.writecb;if(typeof L!="function")throw new d;if(Z(Y),le)W(Q,Y,I,le,L);else{var K=ue(Y)||Q.destroyed;!K&&!Y.corked&&!Y.bufferProcessing&&Y.bufferedRequest&&J(Q,Y),I?process.nextTick(te,Q,Y,K,L):te(Q,Y,K,L)}}function te(Q,le,Y,I){Y||fe(Q,le),le.pendingcb--,I(),ve(Q,le)}function fe(Q,le){le.length===0&&le.needDrain&&(le.needDrain=!1,Q.emit("drain"))}function J(Q,le){le.bufferProcessing=!0;var Y=le.bufferedRequest;if(Q._writev&&Y&&Y.next){var I=le.bufferedRequestCount,L=new Array(I),K=le.corkedRequestsFree;K.entry=Y;for(var U=0,x=!0;Y;)L[U]=Y,Y.isBuf||(x=!1),Y=Y.next,U+=1;L.allBuffers=x,H(Q,le,!0,le.length,L,"",K.finish),le.pendingcb++,le.lastBufferedRequest=null,K.next?(le.corkedRequestsFree=K.next,K.next=null):le.corkedRequestsFree=new l(le),le.bufferedRequestCount=0}else{for(;Y;){var y=Y.chunk,S=Y.encoding,b=Y.callback,F=le.objectMode?1:y.length;if(H(Q,le,!1,F,y,S,b),Y=Y.next,le.bufferedRequestCount--,le.writing)break}Y===null&&(le.lastBufferedRequest=null)}le.bufferedRequest=Y,le.bufferProcessing=!1}z.prototype._write=function(Q,le,Y){Y(new r("_write()"))},z.prototype._writev=null,z.prototype.end=function(Q,le,Y){var I=this._writableState;return typeof Q=="function"?(Y=Q,Q=null,le=null):typeof le=="function"&&(Y=le,le=null),Q!=null&&this.write(Q,le),I.corked&&(I.corked=1,this.uncork()),I.ending||Ee(this,I,Y),this},Object.defineProperty(z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ue(Q){return Q.ending&&Q.length===0&&Q.bufferedRequest===null&&!Q.finished&&!Q.writing}function pe(Q,le){Q._final(function(Y){le.pendingcb--,Y&&A(Q,Y),le.prefinished=!0,Q.emit("prefinish"),ve(Q,le)})}function Ce(Q,le){!le.prefinished&&!le.finalCalled&&(typeof Q._final=="function"&&!le.destroyed?(le.pendingcb++,le.finalCalled=!0,process.nextTick(pe,Q,le)):(le.prefinished=!0,Q.emit("prefinish")))}function ve(Q,le){var Y=ue(le);if(Y&&(Ce(Q,le),le.pendingcb===0&&(le.finished=!0,Q.emit("finish"),le.autoDestroy))){var I=Q._readableState;(!I||I.autoDestroy&&I.endEmitted)&&Q.destroy()}return Y}function Ee(Q,le,Y){le.ending=!0,ve(Q,le),Y&&(le.finished?process.nextTick(Y):Q.once("finish",Y)),le.ended=!0,Q.writable=!1}function ge(Q,le,Y){var I=Q.entry;for(Q.entry=null;I;){var L=I.callback;le.pendingcb--,L(Y),I=I.next}le.corkedRequestsFree.next=Q}Object.defineProperty(z.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(le){this._writableState&&(this._writableState.destroyed=le)}}),z.prototype.destroy=T.destroy,z.prototype._undestroy=T.undestroy,z.prototype._destroy=function(Q,le){le(Q)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/async_iterator.js":(V,v,e)=>{"use strict";var p;function l(M,n,_){return n in M?Object.defineProperty(M,n,{value:_,enumerable:!0,configurable:!0,writable:!0}):M[n]=_,M}var o=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"),i=Symbol("lastResolve"),E=Symbol("lastReject"),h=Symbol("error"),t=Symbol("ended"),g=Symbol("lastPromise"),C=Symbol("handlePromise"),T=Symbol("stream");function P(M,n){return{value:M,done:n}}function R(M){var n=M[i];if(n!==null){var _=M[T].read();_!==null&&(M[g]=null,M[i]=null,M[E]=null,n(P(_,!1)))}}function m(M){process.nextTick(R,M)}function f(M,n){return function(_,u){M.then(function(){if(n[t]){_(P(void 0,!0));return}n[C](_,u)},u)}}var r=Object.getPrototypeOf(function(){}),d=Object.setPrototypeOf((p={get stream(){return this[T]},next:function(){var n=this,_=this[h];if(_!==null)return Promise.reject(_);if(this[t])return Promise.resolve(P(void 0,!0));if(this[T].destroyed)return new Promise(function(j,$){process.nextTick(function(){n[h]?$(n[h]):j(P(void 0,!0))})});var u=this[g],A;if(u)A=new Promise(f(u,this));else{var D=this[T].read();if(D!==null)return Promise.resolve(P(D,!1));A=new Promise(this[C])}return this[g]=A,A}},l(p,Symbol.asyncIterator,function(){return this}),l(p,"return",function(){var n=this;return new Promise(function(_,u){n[T].destroy(null,function(A){if(A){u(A);return}_(P(void 0,!0))})})}),p),r),c=function(n){var _,u=Object.create(d,(_={},l(_,T,{value:n,writable:!0}),l(_,i,{value:null,writable:!0}),l(_,E,{value:null,writable:!0}),l(_,h,{value:null,writable:!0}),l(_,t,{value:n._readableState.endEmitted,writable:!0}),l(_,C,{value:function(D,j){var $=u[T].read();$?(u[g]=null,u[i]=null,u[E]=null,D(P($,!1))):(u[i]=D,u[E]=j)},writable:!0}),_));return u[g]=null,o(n,function(A){if(A&&A.code!=="ERR_STREAM_PREMATURE_CLOSE"){var D=u[E];D!==null&&(u[g]=null,u[i]=null,u[E]=null,D(A)),u[h]=A;return}var j=u[i];j!==null&&(u[g]=null,u[i]=null,u[E]=null,j(P(void 0,!0))),u[t]=!0}),n.on("readable",m.bind(null,u)),u};V.exports=c},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/buffer_list.js":(V,v,e)=>{"use strict";function p(m,f){var r=Object.keys(m);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(m);f&&(d=d.filter(function(c){return Object.getOwnPropertyDescriptor(m,c).enumerable})),r.push.apply(r,d)}return r}function l(m){for(var f=1;f<arguments.length;f++){var r=arguments[f]!=null?arguments[f]:{};f%2?p(Object(r),!0).forEach(function(d){o(m,d,r[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(d){Object.defineProperty(m,d,Object.getOwnPropertyDescriptor(r,d))})}return m}function o(m,f,r){return f in m?Object.defineProperty(m,f,{value:r,enumerable:!0,configurable:!0,writable:!0}):m[f]=r,m}function i(m,f){if(!(m instanceof f))throw new TypeError("Cannot call a class as a function")}function E(m,f){for(var r=0;r<f.length;r++){var d=f[r];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(m,d.key,d)}}function h(m,f,r){return f&&E(m.prototype,f),r&&E(m,r),m}var t=e("./node_modules/buffer/index.js"),g=t.Buffer,C=e("?3e83"),T=C.inspect,P=T&&T.custom||"inspect";function R(m,f,r){g.prototype.copy.call(m,f,r)}V.exports=function(){function m(){i(this,m),this.head=null,this.tail=null,this.length=0}return h(m,[{key:"push",value:function(r){var d={data:r,next:null};this.length>0?this.tail.next=d:this.head=d,this.tail=d,++this.length}},{key:"unshift",value:function(r){var d={data:r,next:this.head};this.length===0&&(this.tail=d),this.head=d,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var d=this.head,c=""+d.data;d=d.next;)c+=r+d.data;return c}},{key:"concat",value:function(r){if(this.length===0)return g.alloc(0);for(var d=g.allocUnsafe(r>>>0),c=this.head,M=0;c;)R(c.data,d,M),M+=c.data.length,c=c.next;return d}},{key:"consume",value:function(r,d){var c;return r<this.head.data.length?(c=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?c=this.shift():c=d?this._getString(r):this._getBuffer(r),c}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var d=this.head,c=1,M=d.data;for(r-=M.length;d=d.next;){var n=d.data,_=r>n.length?n.length:r;if(_===n.length?M+=n:M+=n.slice(0,r),r-=_,r===0){_===n.length?(++c,d.next?this.head=d.next:this.head=this.tail=null):(this.head=d,d.data=n.slice(_));break}++c}return this.length-=c,M}},{key:"_getBuffer",value:function(r){var d=g.allocUnsafe(r),c=this.head,M=1;for(c.data.copy(d),r-=c.data.length;c=c.next;){var n=c.data,_=r>n.length?n.length:r;if(n.copy(d,d.length-r,0,_),r-=_,r===0){_===n.length?(++M,c.next?this.head=c.next:this.head=this.tail=null):(this.head=c,c.data=n.slice(_));break}++M}return this.length-=M,d}},{key:P,value:function(r,d){return T(this,l({},d,{depth:0,customInspect:!1}))}}]),m}()},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js":V=>{"use strict";function v(E,h){var t=this,g=this._readableState&&this._readableState.destroyed,C=this._writableState&&this._writableState.destroyed;return g||C?(h?h(E):E&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(o,this,E)):process.nextTick(o,this,E)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(E||null,function(T){!h&&T?t._writableState?t._writableState.errorEmitted?process.nextTick(p,t):(t._writableState.errorEmitted=!0,process.nextTick(e,t,T)):process.nextTick(e,t,T):h?(process.nextTick(p,t),h(T)):process.nextTick(p,t)}),this)}function e(E,h){o(E,h),p(E)}function p(E){E._writableState&&!E._writableState.emitClose||E._readableState&&!E._readableState.emitClose||E.emit("close")}function l(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function o(E,h){E.emit("error",h)}function i(E,h){var t=E._readableState,g=E._writableState;t&&t.autoDestroy||g&&g.autoDestroy?E.destroy(h):E.emit("error",h)}V.exports={destroy:v,undestroy:l,errorOrDestroy:i}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js":(V,v,e)=>{"use strict";var p=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes.ERR_STREAM_PREMATURE_CLOSE;function l(h){var t=!1;return function(){if(!t){t=!0;for(var g=arguments.length,C=new Array(g),T=0;T<g;T++)C[T]=arguments[T];h.apply(this,C)}}}function o(){}function i(h){return h.setHeader&&typeof h.abort=="function"}function E(h,t,g){if(typeof t=="function")return E(h,null,t);t||(t={}),g=l(g||o);var C=t.readable||t.readable!==!1&&h.readable,T=t.writable||t.writable!==!1&&h.writable,P=function(){h.writable||m()},R=h._writableState&&h._writableState.finished,m=function(){T=!1,R=!0,C||g.call(h)},f=h._readableState&&h._readableState.endEmitted,r=function(){C=!1,f=!0,T||g.call(h)},d=function(_){g.call(h,_)},c=function(){var _;if(C&&!f)return(!h._readableState||!h._readableState.ended)&&(_=new p),g.call(h,_);if(T&&!R)return(!h._writableState||!h._writableState.ended)&&(_=new p),g.call(h,_)},M=function(){h.req.on("finish",m)};return i(h)?(h.on("complete",m),h.on("abort",c),h.req?M():h.on("request",M)):T&&!h._writableState&&(h.on("end",P),h.on("close",P)),h.on("end",r),h.on("finish",m),t.error!==!1&&h.on("error",d),h.on("close",c),function(){h.removeListener("complete",m),h.removeListener("abort",c),h.removeListener("request",M),h.req&&h.req.removeListener("finish",m),h.removeListener("end",P),h.removeListener("close",P),h.removeListener("finish",m),h.removeListener("end",r),h.removeListener("error",d),h.removeListener("close",c)}}V.exports=E},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/from-browser.js":V=>{V.exports=function(){throw new Error("Readable.from is not available in the browser")}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/pipeline.js":(V,v,e)=>{"use strict";var p;function l(m){var f=!1;return function(){f||(f=!0,m.apply(void 0,arguments))}}var o=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,i=o.ERR_MISSING_ARGS,E=o.ERR_STREAM_DESTROYED;function h(m){if(m)throw m}function t(m){return m.setHeader&&typeof m.abort=="function"}function g(m,f,r,d){d=l(d);var c=!1;m.on("close",function(){c=!0}),p===void 0&&(p=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js")),p(m,{readable:f,writable:r},function(n){if(n)return d(n);c=!0,d()});var M=!1;return function(n){if(!c&&!M){if(M=!0,t(m))return m.abort();if(typeof m.destroy=="function")return m.destroy();d(n||new E("pipe"))}}}function C(m){m()}function T(m,f){return m.pipe(f)}function P(m){return!m.length||typeof m[m.length-1]!="function"?h:m.pop()}function R(){for(var m=arguments.length,f=new Array(m),r=0;r<m;r++)f[r]=arguments[r];var d=P(f);if(Array.isArray(f[0])&&(f=f[0]),f.length<2)throw new i("streams");var c,M=f.map(function(n,_){var u=_<f.length-1,A=_>0;return g(n,u,A,function(D){c||(c=D),D&&M.forEach(C),!u&&(M.forEach(C),d(c))})});return f.reduce(T)}V.exports=R},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js":(V,v,e)=>{"use strict";var p=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes.ERR_INVALID_OPT_VALUE;function l(i,E,h){return i.highWaterMark!=null?i.highWaterMark:E?i[h]:null}function o(i,E,h,t){var g=l(E,t,h);if(g!=null){if(!(isFinite(g)&&Math.floor(g)===g)||g<0){var C=t?h:"highWaterMark";throw new p(C,g)}return Math.floor(g)}return i.objectMode?16:16384}V.exports={getHighWaterMark:o}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js":(V,v,e)=>{V.exports=e("./node_modules/events/events.js").EventEmitter},"./node_modules/string_decoder/lib/string_decoder.js":(V,v,e)=>{"use strict";var p=e("./node_modules/safe-buffer/index.js").Buffer,l=p.isEncoding||function(M){switch(M=""+M,M&&M.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(M){if(!M)return"utf8";for(var n;;)switch(M){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return M;default:if(n)return;M=(""+M).toLowerCase(),n=!0}}function i(M){var n=o(M);if(typeof n!="string"&&(p.isEncoding===l||!l(M)))throw new Error("Unknown encoding: "+M);return n||M}v.StringDecoder=E;function E(M){this.encoding=i(M);var n;switch(this.encoding){case"utf16le":this.text=R,this.end=m,n=4;break;case"utf8":this.fillLast=C,n=4;break;case"base64":this.text=f,this.end=r,n=3;break;default:this.write=d,this.end=c;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=p.allocUnsafe(n)}E.prototype.write=function(M){if(M.length===0)return"";var n,_;if(this.lastNeed){if(n=this.fillLast(M),n===void 0)return"";_=this.lastNeed,this.lastNeed=0}else _=0;return _<M.length?n?n+this.text(M,_):this.text(M,_):n||""},E.prototype.end=P,E.prototype.text=T,E.prototype.fillLast=function(M){if(this.lastNeed<=M.length)return M.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);M.copy(this.lastChar,this.lastTotal-this.lastNeed,0,M.length),this.lastNeed-=M.length};function h(M){return M<=127?0:M>>5===6?2:M>>4===14?3:M>>3===30?4:M>>6===2?-1:-2}function t(M,n,_){var u=n.length-1;if(u<_)return 0;var A=h(n[u]);return A>=0?(A>0&&(M.lastNeed=A-1),A):--u<_||A===-2?0:(A=h(n[u]),A>=0?(A>0&&(M.lastNeed=A-2),A):--u<_||A===-2?0:(A=h(n[u]),A>=0?(A>0&&(A===2?A=0:M.lastNeed=A-3),A):0))}function g(M,n,_){if((n[0]&192)!==128)return M.lastNeed=0,"\uFFFD";if(M.lastNeed>1&&n.length>1){if((n[1]&192)!==128)return M.lastNeed=1,"\uFFFD";if(M.lastNeed>2&&n.length>2&&(n[2]&192)!==128)return M.lastNeed=2,"\uFFFD"}}function C(M){var n=this.lastTotal-this.lastNeed,_=g(this,M,n);if(_!==void 0)return _;if(this.lastNeed<=M.length)return M.copy(this.lastChar,n,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);M.copy(this.lastChar,n,0,M.length),this.lastNeed-=M.length}function T(M,n){var _=t(this,M,n);if(!this.lastNeed)return M.toString("utf8",n);this.lastTotal=_;var u=M.length-(_-this.lastNeed);return M.copy(this.lastChar,0,u),M.toString("utf8",n,u)}function P(M){var n=M&&M.length?this.write(M):"";return this.lastNeed?n+"\uFFFD":n}function R(M,n){if((M.length-n)%2===0){var _=M.toString("utf16le",n);if(_){var u=_.charCodeAt(_.length-1);if(u>=55296&&u<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=M[M.length-2],this.lastChar[1]=M[M.length-1],_.slice(0,-1)}return _}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=M[M.length-1],M.toString("utf16le",n,M.length-1)}function m(M){var n=M&&M.length?this.write(M):"";if(this.lastNeed){var _=this.lastTotal-this.lastNeed;return n+this.lastChar.toString("utf16le",0,_)}return n}function f(M,n){var _=(M.length-n)%3;return _===0?M.toString("base64",n):(this.lastNeed=3-_,this.lastTotal=3,_===1?this.lastChar[0]=M[M.length-1]:(this.lastChar[0]=M[M.length-2],this.lastChar[1]=M[M.length-1]),M.toString("base64",n,M.length-_))}function r(M){var n=M&&M.length?this.write(M):"";return this.lastNeed?n+this.lastChar.toString("base64",0,3-this.lastNeed):n}function d(M){return M.toString(this.encoding)}function c(M){return M&&M.length?this.write(M):""}},"./node_modules/ua-parser-js/src/ua-parser.js":function(V,v,e){var p;(function(l,o){"use strict";var i="1.0.2",E="",h="?",t="function",g="undefined",C="object",T="string",P="major",R="model",m="name",f="type",r="vendor",d="version",c="architecture",M="console",n="mobile",_="tablet",u="smarttv",A="wearable",D="embedded",j=255,$="Amazon",z="Apple",ee="ASUS",k="BlackBerry",w="Browser",N="Chrome",H="Edge",W="Firefox",Z="Google",X="Huawei",te="LG",fe="Microsoft",J="Motorola",ue="Opera",pe="Samsung",Ce="Sony",ve="Xiaomi",Ee="Zebra",ge="Facebook",Q=function(q,Ae){var de={};for(var Me in q)Ae[Me]&&Ae[Me].length%2===0?de[Me]=Ae[Me].concat(q[Me]):de[Me]=q[Me];return de},le=function(q){for(var Ae={},de=0;de<q.length;de++)Ae[q[de].toUpperCase()]=q[de];return Ae},Y=function(q,Ae){return typeof q===T?I(Ae).indexOf(I(q))!==-1:!1},I=function(q){return q.toLowerCase()},L=function(q){return typeof q===T?q.replace(/[^\d\.]/g,E).split(".")[0]:o},K=function(q,Ae){if(typeof q===T)return q=q.replace(/^\s\s*/,E).replace(/\s\s*$/,E),typeof Ae===g?q:q.substring(0,j)},U=function(q,Ae){for(var de=0,Me,Ie,He,Be,ze,Ye;de<Ae.length&&!ze;){var Te=Ae[de],Fe=Ae[de+1];for(Me=Ie=0;Me<Te.length&&!ze;)if(ze=Te[Me++].exec(q),ze)for(He=0;He<Fe.length;He++)Ye=ze[++Ie],Be=Fe[He],typeof Be===C&&Be.length>0?Be.length===2?typeof Be[1]==t?this[Be[0]]=Be[1].call(this,Ye):this[Be[0]]=Be[1]:Be.length===3?typeof Be[1]===t&&!(Be[1].exec&&Be[1].test)?this[Be[0]]=Ye?Be[1].call(this,Ye,Be[2]):o:this[Be[0]]=Ye?Ye.replace(Be[1],Be[2]):o:Be.length===4&&(this[Be[0]]=Ye?Be[3].call(this,Ye.replace(Be[1],Be[2])):o):this[Be]=Ye||o;de+=2}},x=function(q,Ae){for(var de in Ae)if(typeof Ae[de]===C&&Ae[de].length>0){for(var Me=0;Me<Ae[de].length;Me++)if(Y(Ae[de][Me],q))return de===h?o:de}else if(Y(Ae[de],q))return de===h?o:de;return q},y={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},S={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},b={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[m,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[m,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[m,d],[/opios[\/ ]+([\w\.]+)/i],[d,[m,ue+" Mini"]],[/\bopr\/([\w\.]+)/i],[d,[m,ue]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[m,d],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[d,[m,"UC"+w]],[/\bqbcore\/([\w\.]+)/i],[d,[m,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[m,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[m,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[d,[m,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[m,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[m,/(.+)/,"$1 Secure "+w],d],[/\bfocus\/([\w\.]+)/i],[d,[m,W+" Focus"]],[/\bopt\/([\w\.]+)/i],[d,[m,ue+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[d,[m,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[m,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[m,ue+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[d,[m,"MIUI "+w]],[/fxios\/([-\w\.]+)/i],[d,[m,W]],[/\bqihu|(qi?ho?o?|360)browser/i],[[m,"360 "+w]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[m,/(.+)/,"$1 "+w],d],[/(comodo_dragon)\/([\w\.]+)/i],[[m,/_/g," "],d],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[m,d],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[m],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[m,ge],d],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[m,d],[/\bgsa\/([\w\.]+) .*safari\//i],[d,[m,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[d,[m,N+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[m,N+" WebView"],d],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[d,[m,"Android "+w]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[m,d],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[d,[m,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[d,m],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[m,[d,x,y]],[/(webkit|khtml)\/([\w\.]+)/i],[m,d],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[m,"Netscape"],d],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[d,[m,W+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[m,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[c,"amd64"]],[/(ia32(?=;))/i],[[c,I]],[/((?:i[346]|x)86)[;\)]/i],[[c,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[c,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[c,"armhf"]],[/windows (ce|mobile); ppc;/i],[[c,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[c,/ower/,E,I]],[/(sun4\w)[;\)]/i],[[c,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[c,I]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[R,[r,pe],[f,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[R,[r,pe],[f,n]],[/\((ip(?:hone|od)[\w ]*);/i],[R,[r,z],[f,n]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[R,[r,z],[f,_]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[R,[r,X],[f,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[R,[r,X],[f,n]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[R,/_/g," "],[r,ve],[f,n]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[R,/_/g," "],[r,ve],[f,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[R,[r,"OPPO"],[f,n]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[R,[r,"Vivo"],[f,n]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[R,[r,"Realme"],[f,n]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[R,[r,J],[f,n]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[R,[r,J],[f,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[R,[r,te],[f,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[R,[r,te],[f,n]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[R,[r,"Lenovo"],[f,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[R,/_/g," "],[r,"Nokia"],[f,n]],[/(pixel c)\b/i],[R,[r,Z],[f,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[R,[r,Z],[f,n]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[R,[r,Ce],[f,n]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[R,"Xperia Tablet"],[r,Ce],[f,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[R,[r,"OnePlus"],[f,n]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[R,[r,$],[f,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[R,/(.+)/g,"Fire Phone $1"],[r,$],[f,n]],[/(playbook);[-\w\),; ]+(rim)/i],[R,r,[f,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[R,[r,k],[f,n]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[R,[r,ee],[f,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[R,[r,ee],[f,n]],[/(nexus 9)/i],[R,[r,"HTC"],[f,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[r,[R,/_/g," "],[f,n]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[R,[r,"Acer"],[f,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[R,[r,"Meizu"],[f,n]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[R,[r,"Sharp"],[f,n]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[r,R,[f,n]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[r,R,[f,_]],[/(surface duo)/i],[R,[r,fe],[f,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[R,[r,"Fairphone"],[f,n]],[/(u304aa)/i],[R,[r,"AT&T"],[f,n]],[/\bsie-(\w*)/i],[R,[r,"Siemens"],[f,n]],[/\b(rct\w+) b/i],[R,[r,"RCA"],[f,_]],[/\b(venue[\d ]{2,7}) b/i],[R,[r,"Dell"],[f,_]],[/\b(q(?:mv|ta)\w+) b/i],[R,[r,"Verizon"],[f,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[R,[r,"Barnes & Noble"],[f,_]],[/\b(tm\d{3}\w+) b/i],[R,[r,"NuVision"],[f,_]],[/\b(k88) b/i],[R,[r,"ZTE"],[f,_]],[/\b(nx\d{3}j) b/i],[R,[r,"ZTE"],[f,n]],[/\b(gen\d{3}) b.+49h/i],[R,[r,"Swiss"],[f,n]],[/\b(zur\d{3}) b/i],[R,[r,"Swiss"],[f,_]],[/\b((zeki)?tb.*\b) b/i],[R,[r,"Zeki"],[f,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[r,"Dragon Touch"],R,[f,_]],[/\b(ns-?\w{0,9}) b/i],[R,[r,"Insignia"],[f,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[R,[r,"NextBook"],[f,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[r,"Voice"],R,[f,n]],[/\b(lvtel\-)?(v1[12]) b/i],[[r,"LvTel"],R,[f,n]],[/\b(ph-1) /i],[R,[r,"Essential"],[f,n]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[R,[r,"Envizen"],[f,_]],[/\b(trio[-\w\. ]+) b/i],[R,[r,"MachSpeed"],[f,_]],[/\btu_(1491) b/i],[R,[r,"Rotor"],[f,_]],[/(shield[\w ]+) b/i],[R,[r,"Nvidia"],[f,_]],[/(sprint) (\w+)/i],[r,R,[f,n]],[/(kin\.[onetw]{3})/i],[[R,/\./g," "],[r,fe],[f,n]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[R,[r,Ee],[f,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[R,[r,Ee],[f,n]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[r,R,[f,M]],[/droid.+; (shield) bui/i],[R,[r,"Nvidia"],[f,M]],[/(playstation [345portablevi]+)/i],[R,[r,Ce],[f,M]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[R,[r,fe],[f,M]],[/smart-tv.+(samsung)/i],[r,[f,u]],[/hbbtv.+maple;(\d+)/i],[[R,/^/,"SmartTV"],[r,pe],[f,u]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[r,te],[f,u]],[/(apple) ?tv/i],[r,[R,z+" TV"],[f,u]],[/crkey/i],[[R,N+"cast"],[r,Z],[f,u]],[/droid.+aft(\w)( bui|\))/i],[R,[r,$],[f,u]],[/\(dtv[\);].+(aquos)/i],[R,[r,"Sharp"],[f,u]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[r,K],[R,K],[f,u]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,u]],[/((pebble))app/i],[r,R,[f,A]],[/droid.+; (glass) \d/i],[R,[r,Z],[f,A]],[/droid.+; (wt63?0{2,3})\)/i],[R,[r,Ee],[f,A]],[/(quest( 2)?)/i],[R,[r,ge],[f,A]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[r,[f,D]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[R,[f,n]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[R,[f,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,_]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[f,n]],[/(android[-\w\. ]{0,9});.+buil/i],[R,[r,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[d,[m,H+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[m,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[m,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,m]],os:[[/microsoft (windows) (vista|xp)/i],[m,d],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[m,[d,x,S]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,"Windows"],[d,x,S]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[m,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[m,"Mac OS"],[d,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[d,m],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[m,d],[/\(bb(10);/i],[d,[m,k]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[d,[m,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[d,[m,W+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[m,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[m,N+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[m,"Chromium OS"],d],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[m,d],[/(sunos) ?([\w\.\d]*)/i],[[m,"Solaris"],d],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[m,d]]},F=function(q,Ae){if(typeof q===C&&(Ae=q,q=o),!(this instanceof F))return new F(q,Ae).getResult();var de=q||(typeof l!==g&&l.navigator&&l.navigator.userAgent?l.navigator.userAgent:E),Me=Ae?Q(b,Ae):b;return this.getBrowser=function(){var Ie={};return Ie[m]=o,Ie[d]=o,U.call(Ie,de,Me.browser),Ie.major=L(Ie.version),Ie},this.getCPU=function(){var Ie={};return Ie[c]=o,U.call(Ie,de,Me.cpu),Ie},this.getDevice=function(){var Ie={};return Ie[r]=o,Ie[R]=o,Ie[f]=o,U.call(Ie,de,Me.device),Ie},this.getEngine=function(){var Ie={};return Ie[m]=o,Ie[d]=o,U.call(Ie,de,Me.engine),Ie},this.getOS=function(){var Ie={};return Ie[m]=o,Ie[d]=o,U.call(Ie,de,Me.os),Ie},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return de},this.setUA=function(Ie){return de=typeof Ie===T&&Ie.length>j?K(Ie,j):Ie,this},this.setUA(de),this};F.VERSION=i,F.BROWSER=le([m,d,P]),F.CPU=le([c]),F.DEVICE=le([R,r,f,M,n,u,_,A,D]),F.ENGINE=F.OS=le([m,d]),typeof v!==g?(g!=="object"&&V.exports&&(v=V.exports=F),v.UAParser=F):t==="function"&&e.amdO?(p=function(){return F}.call(v,e,v,V),p!==o&&(V.exports=p)):typeof l!==g&&(l.UAParser=F);var oe=typeof l!==g&&(l.jQuery||l.Zepto);if(oe&&!oe.ua){var ie=new F;oe.ua=ie.getResult(),oe.ua.get=function(){return ie.getUA()},oe.ua.set=function(q){ie.setUA(q);var Ae=ie.getResult();for(var de in Ae)oe.ua[de]=Ae[de]}}})(typeof window=="object"?window:this)},"./node_modules/util-deprecate/browser.js":(V,v,e)=>{V.exports=p;function p(o,i){if(l("noDeprecation"))return o;var E=!1;function h(){if(!E){if(l("throwDeprecation"))throw new Error(i);l("traceDeprecation")?console.trace(i):console.warn(i),E=!0}return o.apply(this,arguments)}return h}function l(o){try{if(!e.g.localStorage)return!1}catch{return!1}var i=e.g.localStorage[o];return i==null?!1:String(i).toLowerCase()==="true"}},"?3e83":()=>{},"?19e6":()=>{},"./node_modules/bcp-47-normalize/lib/defaults.json":V=>{"use strict";V.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]')},"./node_modules/bcp-47-normalize/lib/fields.json":V=>{"use strict";V.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]')},"./node_modules/bcp-47-normalize/lib/many.json":V=>{"use strict";V.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}')},"./node_modules/bcp-47-normalize/lib/matches.json":V=>{"use strict";V.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]')},"./node_modules/bcp-47/lib/normalize.json":V=>{"use strict";V.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}')},"./node_modules/bcp-47/lib/regular.json":V=>{"use strict";V.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]')}},he={};function re(V){var v=he[V];if(v!==void 0)return v.exports;var e=he[V]={exports:{}};return ne[V].call(e.exports,e,e.exports,re),e.exports}re.amdO={},re.n=V=>{var v=V&&V.__esModule?()=>V.default:()=>V;return re.d(v,{a:v}),v},re.d=(V,v)=>{for(var e in v)re.o(v,e)&&!re.o(V,e)&&Object.defineProperty(V,e,{enumerable:!0,get:v[e]})},re.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),re.o=(V,v)=>Object.prototype.hasOwnProperty.call(V,v),re.r=V=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(V,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(V,"__esModule",{value:!0})};var ce={};return(()=>{"use strict";re.r(ce),re.d(ce,{Debug:()=>o.default,MediaPlayer:()=>V.MediaPlayer,MediaPlayerFactory:()=>l.default,MetricsReporting:()=>e.default,Protection:()=>p.default,default:()=>i,supportsMediaSource:()=>v.supportsMediaSource});var V=re("./index_mediaplayerOnly.js"),v=re("./src/streaming/utils/Capabilities.js"),e=re("./src/streaming/metrics/MetricsReporting.js"),p=re("./src/streaming/protection/Protection.js"),l=re("./src/streaming/MediaPlayerFactory.js"),o=re("./src/core/Debug.js");dashjs.Protection=p.default,dashjs.MetricsReporting=e.default,dashjs.MediaPlayerFactory=l.default,dashjs.Debug=o.default,dashjs.supportsMediaSource=v.supportsMediaSource;let i=dashjs})(),ce=ce.default,ce})())});var Xa=rr((bn,Ln)=>{typeof navigator=="object"&&function(ne,he){typeof bn=="object"&&typeof Ln<"u"?Ln.exports=he():typeof define=="function"&&define.amd?define("Plyr",he):(ne=typeof globalThis<"u"?globalThis:ne||self).Plyr=he()}(bn,function(){"use strict";function ne(O,ae,G){return(ae=function(B){var se=function(_e,me){if(typeof _e!="object"||_e===null)return _e;var Se=_e[Symbol.toPrimitive];if(Se!==void 0){var Pe=Se.call(_e,me||"default");if(typeof Pe!="object")return Pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(me==="string"?String:Number)(_e)}(B,"string");return typeof se=="symbol"?se:String(se)}(ae))in O?Object.defineProperty(O,ae,{value:G,enumerable:!0,configurable:!0,writable:!0}):O[ae]=G,O}function he(O,ae){for(var G=0;G<ae.length;G++){var B=ae[G];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(O,B.key,B)}}function re(O,ae,G){return ae in O?Object.defineProperty(O,ae,{value:G,enumerable:!0,configurable:!0,writable:!0}):O[ae]=G,O}function ce(O,ae){var G=Object.keys(O);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(O);ae&&(B=B.filter(function(se){return Object.getOwnPropertyDescriptor(O,se).enumerable})),G.push.apply(G,B)}return G}function V(O){for(var ae=1;ae<arguments.length;ae++){var G=arguments[ae]!=null?arguments[ae]:{};ae%2?ce(Object(G),!0).forEach(function(B){re(O,B,G[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(G)):ce(Object(G)).forEach(function(B){Object.defineProperty(O,B,Object.getOwnPropertyDescriptor(G,B))})}return O}var v={addCSS:!0,thumbWidth:15,watch:!0},e=function(O){return O!=null?O.constructor:null},p=function(O,ae){return!!(O&&ae&&O instanceof ae)},l=function(O){return O==null},o=function(O){return e(O)===Object},i=function(O){return e(O)===String},E=function(O){return Array.isArray(O)},h=function(O){return p(O,NodeList)},t={nullOrUndefined:l,object:o,number:function(O){return e(O)===Number&&!Number.isNaN(O)},string:i,boolean:function(O){return e(O)===Boolean},function:function(O){return e(O)===Function},array:E,nodeList:h,element:function(O){return p(O,Element)},event:function(O){return p(O,Event)},empty:function(O){return l(O)||(i(O)||E(O)||h(O))&&!O.length||o(O)&&!Object.keys(O).length}};function g(O,ae){if(1>ae){var G=function(B){var se="".concat(B).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return se?Math.max(0,(se[1]?se[1].length:0)-(se[2]?+se[2]:0)):0}(ae);return parseFloat(O.toFixed(G))}return Math.round(O/ae)*ae}var C=function(){function O(ae,G){(function(B,se){if(!(B instanceof se))throw new TypeError("Cannot call a class as a function")})(this,O),t.element(ae)?this.element=ae:t.string(ae)&&(this.element=document.querySelector(ae)),t.element(this.element)&&t.empty(this.element.rangeTouch)&&(this.config=V({},v,{},G),this.init())}return function(ae,G,B){G&&he(ae.prototype,G),B&&he(ae,B)}(O,[{key:"init",value:function(){O.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){O.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(ae){var G=this,B=ae?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach(function(se){G.element[B](se,function(_e){return G.set(_e)},!1)})}},{key:"get",value:function(ae){if(!O.enabled||!t.event(ae))return null;var G,B=ae.target,se=ae.changedTouches[0],_e=parseFloat(B.getAttribute("min"))||0,me=parseFloat(B.getAttribute("max"))||100,Se=parseFloat(B.getAttribute("step"))||1,Pe=B.getBoundingClientRect(),ke=100/Pe.width*(this.config.thumbWidth/2)/100;return 0>(G=100/Pe.width*(se.clientX-Pe.left))?G=0:100<G&&(G=100),50>G?G-=(100-2*G)*ke:50<G&&(G+=2*(G-50)*ke),_e+g(G/100*(me-_e),Se)}},{key:"set",value:function(ae){O.enabled&&t.event(ae)&&!ae.target.disabled&&(ae.preventDefault(),ae.target.value=this.get(ae),function(G,B){if(G&&B){var se=new Event(B,{bubbles:!0});G.dispatchEvent(se)}}(ae.target,ae.type==="touchend"?"change":"input"))}}],[{key:"setup",value:function(ae){var G=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},B=null;if(t.empty(ae)||t.string(ae)?B=Array.from(document.querySelectorAll(t.string(ae)?ae:'input[type="range"]')):t.element(ae)?B=[ae]:t.nodeList(ae)?B=Array.from(ae):t.array(ae)&&(B=ae.filter(t.element)),t.empty(B))return null;var se=V({},v,{},G);if(t.string(ae)&&se.watch){var _e=new MutationObserver(function(me){Array.from(me).forEach(function(Se){Array.from(Se.addedNodes).forEach(function(Pe){t.element(Pe)&&function(ke,De){return function(){return Array.from(document.querySelectorAll(De)).includes(this)}.call(ke,De)}(Pe,ae)&&new O(Pe,se)})})});_e.observe(document.body,{childList:!0,subtree:!0})}return B.map(function(me){return new O(me,G)})}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),O}();let T=O=>O!=null?O.constructor:null,P=(O,ae)=>Boolean(O&&ae&&O instanceof ae),R=O=>O==null,m=O=>T(O)===Object,f=O=>T(O)===String,r=O=>typeof O=="function",d=O=>Array.isArray(O),c=O=>P(O,NodeList),M=O=>R(O)||(f(O)||d(O)||c(O))&&!O.length||m(O)&&!Object.keys(O).length;var n={nullOrUndefined:R,object:m,number:O=>T(O)===Number&&!Number.isNaN(O),string:f,boolean:O=>T(O)===Boolean,function:r,array:d,weakMap:O=>P(O,WeakMap),nodeList:c,element:O=>O!==null&&typeof O=="object"&&O.nodeType===1&&typeof O.style=="object"&&typeof O.ownerDocument=="object",textNode:O=>T(O)===Text,event:O=>P(O,Event),keyboardEvent:O=>P(O,KeyboardEvent),cue:O=>P(O,window.TextTrackCue)||P(O,window.VTTCue),track:O=>P(O,TextTrack)||!R(O)&&f(O.kind),promise:O=>P(O,Promise)&&r(O.then),url:O=>{if(P(O,window.URL))return!0;if(!f(O))return!1;let ae=O;O.startsWith("http://")&&O.startsWith("https://")||(ae=`http://${O}`);try{return!M(new URL(ae).hostname)}catch{return!1}},empty:M};let _=(()=>{let O=document.createElement("span"),ae={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},G=Object.keys(ae).find(B=>O.style[B]!==void 0);return!!n.string(G)&&ae[G]})();function u(O,ae){setTimeout(()=>{try{O.hidden=!0,O.offsetHeight,O.hidden=!1}catch{}},ae)}var A={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebKit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIPadOS:navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function D(O,ae){return ae.split(".").reduce((G,B)=>G&&G[B],O)}function j(O={},...ae){if(!ae.length)return O;let G=ae.shift();return n.object(G)?(Object.keys(G).forEach(B=>{n.object(G[B])?(Object.keys(O).includes(B)||Object.assign(O,{[B]:{}}),j(O[B],G[B])):Object.assign(O,{[B]:G[B]})}),j(O,...ae)):O}function $(O,ae){let G=O.length?O:[O];Array.from(G).reverse().forEach((B,se)=>{let _e=se>0?ae.cloneNode(!0):ae,me=B.parentNode,Se=B.nextSibling;_e.appendChild(B),Se?me.insertBefore(_e,Se):me.appendChild(_e)})}function z(O,ae){n.element(O)&&!n.empty(ae)&&Object.entries(ae).filter(([,G])=>!n.nullOrUndefined(G)).forEach(([G,B])=>O.setAttribute(G,B))}function ee(O,ae,G){let B=document.createElement(O);return n.object(ae)&&z(B,ae),n.string(G)&&(B.innerText=G),B}function k(O,ae,G,B){n.element(ae)&&ae.appendChild(ee(O,G,B))}function w(O){n.nodeList(O)||n.array(O)?Array.from(O).forEach(w):n.element(O)&&n.element(O.parentNode)&&O.parentNode.removeChild(O)}function N(O){if(!n.element(O))return;let{length:ae}=O.childNodes;for(;ae>0;)O.removeChild(O.lastChild),ae-=1}function H(O,ae){return n.element(ae)&&n.element(ae.parentNode)&&n.element(O)?(ae.parentNode.replaceChild(O,ae),O):null}function W(O,ae){if(!n.string(O)||n.empty(O))return{};let G={},B=j({},ae);return O.split(",").forEach(se=>{let _e=se.trim(),me=_e.replace(".",""),Se=_e.replace(/[[\]]/g,"").split("="),[Pe]=Se,ke=Se.length>1?Se[1].replace(/["']/g,""):"";switch(_e.charAt(0)){case".":n.string(B.class)?G.class=`${B.class} ${me}`:G.class=me;break;case"#":G.id=_e.replace("#","");break;case"[":G[Pe]=ke}}),j(B,G)}function Z(O,ae){if(!n.element(O))return;let G=ae;n.boolean(G)||(G=!O.hidden),O.hidden=G}function X(O,ae,G){if(n.nodeList(O))return Array.from(O).map(B=>X(B,ae,G));if(n.element(O)){let B="toggle";return G!==void 0&&(B=G?"add":"remove"),O.classList[B](ae),O.classList.contains(ae)}return!1}function te(O,ae){return n.element(O)&&O.classList.contains(ae)}function fe(O,ae){let{prototype:G}=Element;return(G.matches||G.webkitMatchesSelector||G.mozMatchesSelector||G.msMatchesSelector||function(){return Array.from(document.querySelectorAll(ae)).includes(this)}).call(O,ae)}function J(O){return this.elements.container.querySelectorAll(O)}function ue(O){return this.elements.container.querySelector(O)}function pe(O=null,ae=!1){n.element(O)&&O.focus({preventScroll:!0,focusVisible:ae})}let Ce={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},ve={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(O,ae){let G=ve[O]||ae!=="html5";return{api:G,ui:G&&ve.rangeInput}},pip:!(A.isIPhone||!n.function(ee("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||ee("video").disablePictureInPicture)),airplay:n.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(O){if(n.empty(O))return!1;let[ae]=O.split("/"),G=O;if(!this.isHTML5||ae!==this.type)return!1;Object.keys(Ce).includes(G)&&(G+=`; codecs="${Ce[O]}"`);try{return Boolean(G&&this.media.canPlayType(G).replace(/no/,""))}catch{return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{let O=document.createElement("input");return O.type="range",O.type==="range"})(),touch:"ontouchstart"in document.documentElement,transitions:_!==!1,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},Ee=(()=>{let O=!1;try{let ae=Object.defineProperty({},"passive",{get:()=>(O=!0,null)});window.addEventListener("test",null,ae),window.removeEventListener("test",null,ae)}catch{}return O})();function ge(O,ae,G,B=!1,se=!0,_e=!1){if(!O||!("addEventListener"in O)||n.empty(ae)||!n.function(G))return;let me=ae.split(" "),Se=_e;Ee&&(Se={passive:se,capture:_e}),me.forEach(Pe=>{this&&this.eventListeners&&B&&this.eventListeners.push({element:O,type:Pe,callback:G,options:Se}),O[B?"addEventListener":"removeEventListener"](Pe,G,Se)})}function Q(O,ae="",G,B=!0,se=!1){ge.call(this,O,ae,G,!0,B,se)}function le(O,ae="",G,B=!0,se=!1){ge.call(this,O,ae,G,!1,B,se)}function Y(O,ae="",G,B=!0,se=!1){let _e=(...me)=>{le(O,ae,_e,B,se),G.apply(this,me)};ge.call(this,O,ae,_e,!0,B,se)}function I(O,ae="",G=!1,B={}){if(!n.element(O)||n.empty(ae))return;let se=new CustomEvent(ae,{bubbles:G,detail:{...B,plyr:this}});O.dispatchEvent(se)}function L(){this&&this.eventListeners&&(this.eventListeners.forEach(O=>{let{element:ae,type:G,callback:B,options:se}=O;ae.removeEventListener(G,B,se)}),this.eventListeners=[])}function K(){return new Promise(O=>this.ready?setTimeout(O,0):Q.call(this,this.elements.container,"ready",O)).then(()=>{})}function U(O){n.promise(O)&&O.then(null,()=>{})}function x(O){return n.array(O)?O.filter((ae,G)=>O.indexOf(ae)===G):O}function y(O,ae){return n.array(O)&&O.length?O.reduce((G,B)=>Math.abs(B-ae)<Math.abs(G-ae)?B:G):null}function S(O){return!(!window||!window.CSS)&&window.CSS.supports(O)}let b=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce((O,[ae,G])=>({...O,[ae/G]:[ae,G]}),{});function F(O){return n.array(O)||n.string(O)&&O.includes(":")?(n.array(O)?O:O.split(":")).map(Number).every(n.number):!1}function oe(O){if(!n.array(O)||!O.every(n.number))return null;let[ae,G]=O,B=(_e,me)=>me===0?_e:B(me,_e%me),se=B(ae,G);return[ae/se,G/se]}function ie(O){let ae=B=>F(B)?B.split(":").map(Number):null,G=ae(O);if(G===null&&(G=ae(this.config.ratio)),G===null&&!n.empty(this.embed)&&n.array(this.embed.ratio)&&({ratio:G}=this.embed),G===null&&this.isHTML5){let{videoWidth:B,videoHeight:se}=this.media;G=[B,se]}return oe(G)}function q(O){if(!this.isVideo)return{};let{wrapper:ae}=this.elements,G=ie.call(this,O);if(!n.array(G))return{};let[B,se]=oe(G),_e=100/B*se;if(S(`aspect-ratio: ${B}/${se}`)?ae.style.aspectRatio=`${B}/${se}`:ae.style.paddingBottom=`${_e}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){let me=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),Se=(me-_e)/(me/50);this.fullscreen.active?ae.style.paddingBottom=null:this.media.style.transform=`translateY(-${Se}%)`}else this.isHTML5&&ae.classList.add(this.config.classNames.videoFixedRatio);return{padding:_e,ratio:G}}function Ae(O,ae,G=.05){let B=O/ae,se=y(Object.keys(b),B);return Math.abs(se-B)<=G?b[se]:[O,ae]}let de={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter(O=>{let ae=O.getAttribute("type");return!!n.empty(ae)||ve.mime.call(this,ae)}):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:de.getSources.call(this).map(O=>Number(O.getAttribute("size"))).filter(Boolean)},setup(){if(!this.isHTML5)return;let O=this;O.options.speed=O.config.speed.options,n.empty(this.config.ratio)||q.call(O),Object.defineProperty(O.media,"quality",{get(){let ae=de.getSources.call(O).find(G=>G.getAttribute("src")===O.source);return ae&&Number(ae.getAttribute("size"))},set(ae){if(O.quality!==ae){if(O.config.quality.forced&&n.function(O.config.quality.onChange))O.config.quality.onChange(ae);else{let G=de.getSources.call(O).find(Pe=>Number(Pe.getAttribute("size"))===ae);if(!G)return;let{currentTime:B,paused:se,preload:_e,readyState:me,playbackRate:Se}=O.media;O.media.src=G.getAttribute("src"),(_e!=="none"||me)&&(O.once("loadedmetadata",()=>{O.speed=Se,O.currentTime=B,se||U(O.play())}),O.media.load())}I.call(O,O.media,"qualitychange",!1,{quality:ae})}}})},cancelRequests(){this.isHTML5&&(w(de.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function Me(O,...ae){return n.empty(O)?O:O.toString().replace(/{(\d+)}/g,(G,B)=>ae[B].toString())}let Ie=(O="",ae="",G="")=>O.replace(new RegExp(ae.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),G.toString()),He=(O="")=>O.toString().replace(/\w\S*/g,ae=>ae.charAt(0).toUpperCase()+ae.slice(1).toLowerCase());function Be(O=""){let ae=O.toString();return ae=function(G=""){let B=G.toString();return B=Ie(B,"-"," "),B=Ie(B,"_"," "),B=He(B),Ie(B," ","")}(ae),ae.charAt(0).toLowerCase()+ae.slice(1)}function ze(O){let ae=document.createElement("div");return ae.appendChild(O),ae.innerHTML}let Ye={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},Te={get(O="",ae={}){if(n.empty(O)||n.empty(ae))return"";let G=D(ae.i18n,O);if(n.empty(G))return Object.keys(Ye).includes(O)?Ye[O]:"";let B={"{seektime}":ae.seekTime,"{title}":ae.title};return Object.entries(B).forEach(([se,_e])=>{G=Ie(G,se,_e)}),G}};class Fe{constructor(ae){ne(this,"get",G=>{if(!Fe.supported||!this.enabled)return null;let B=window.localStorage.getItem(this.key);if(n.empty(B))return null;let se=JSON.parse(B);return n.string(G)&&G.length?se[G]:se}),ne(this,"set",G=>{if(!Fe.supported||!this.enabled||!n.object(G))return;let B=this.get();n.empty(B)&&(B={}),j(B,G);try{window.localStorage.setItem(this.key,JSON.stringify(B))}catch{}}),this.enabled=ae.config.storage.enabled,this.key=ae.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;let ae="___test";return window.localStorage.setItem(ae,ae),window.localStorage.removeItem(ae),!0}catch{return!1}}}function ot(O,ae="text"){return new Promise((G,B)=>{try{let se=new XMLHttpRequest;if(!("withCredentials"in se))return;se.addEventListener("load",()=>{if(ae==="text")try{G(JSON.parse(se.responseText))}catch{G(se.responseText)}else G(se.response)}),se.addEventListener("error",()=>{throw new Error(se.status)}),se.open("GET",O,!0),se.responseType=ae,se.send()}catch(se){B(se)}})}function st(O,ae){if(!n.string(O))return;let G="cache",B=n.string(ae),se=!1,_e=()=>document.getElementById(ae)!==null,me=(Se,Pe)=>{Se.innerHTML=Pe,B&&_e()||document.body.insertAdjacentElement("afterbegin",Se)};if(!B||!_e()){let Se=Fe.supported,Pe=document.createElement("div");if(Pe.setAttribute("hidden",""),B&&Pe.setAttribute("id",ae),Se){let ke=window.localStorage.getItem(`${G}-${ae}`);if(se=ke!==null,se){let De=JSON.parse(ke);me(Pe,De.content)}}ot(O).then(ke=>{if(!n.empty(ke)){if(Se)try{window.localStorage.setItem(`${G}-${ae}`,JSON.stringify({content:ke}))}catch{}me(Pe,ke)}}).catch(()=>{})}}let at=O=>Math.trunc(O/60/60%60,10),ht=O=>Math.trunc(O/60%60,10),Tt=O=>Math.trunc(O%60,10);function xe(O=0,ae=!1,G=!1){if(!n.number(O))return xe(void 0,ae,G);let B=Se=>`0${Se}`.slice(-2),se=at(O),_e=ht(O),me=Tt(O);return se=ae||se>0?`${se}:`:"",`${G&&O>0?"-":""}${se}${B(_e)}:${B(me)}`}let we={getIconUrl(){let O=new URL(this.config.iconUrl,window.location),ae=window.location.host?window.location.host:window.top.location.host,G=O.host!==ae||A.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:G}},findElements(){try{return this.elements.controls=ue.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:J.call(this,this.config.selectors.buttons.play),pause:ue.call(this,this.config.selectors.buttons.pause),restart:ue.call(this,this.config.selectors.buttons.restart),rewind:ue.call(this,this.config.selectors.buttons.rewind),fastForward:ue.call(this,this.config.selectors.buttons.fastForward),mute:ue.call(this,this.config.selectors.buttons.mute),pip:ue.call(this,this.config.selectors.buttons.pip),airplay:ue.call(this,this.config.selectors.buttons.airplay),settings:ue.call(this,this.config.selectors.buttons.settings),captions:ue.call(this,this.config.selectors.buttons.captions),fullscreen:ue.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=ue.call(this,this.config.selectors.progress),this.elements.inputs={seek:ue.call(this,this.config.selectors.inputs.seek),volume:ue.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:ue.call(this,this.config.selectors.display.buffer),currentTime:ue.call(this,this.config.selectors.display.currentTime),duration:ue.call(this,this.config.selectors.display.duration)},n.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(O){return this.debug.warn("It looks like there is a problem with your custom controls HTML",O),this.toggleNativeControls(!0),!1}},createIcon(O,ae){let G="http://www.w3.org/2000/svg",B=we.getIconUrl.call(this),se=`${B.cors?"":B.url}#${this.config.iconPrefix}`,_e=document.createElementNS(G,"svg");z(_e,j(ae,{"aria-hidden":"true",focusable:"false"}));let me=document.createElementNS(G,"use"),Se=`${se}-${O}`;return"href"in me&&me.setAttributeNS("http://www.w3.org/1999/xlink","href",Se),me.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Se),_e.appendChild(me),_e},createLabel(O,ae={}){let G=Te.get(O,this.config);return ee("span",{...ae,class:[ae.class,this.config.classNames.hidden].filter(Boolean).join(" ")},G)},createBadge(O){if(n.empty(O))return null;let ae=ee("span",{class:this.config.classNames.menu.value});return ae.appendChild(ee("span",{class:this.config.classNames.menu.badge},O)),ae},createButton(O,ae){let G=j({},ae),B=Be(O),se={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach(me=>{Object.keys(G).includes(me)&&(se[me]=G[me],delete G[me])}),se.element!=="button"||Object.keys(G).includes("type")||(G.type="button"),Object.keys(G).includes("class")?G.class.split(" ").some(me=>me===this.config.classNames.control)||j(G,{class:`${G.class} ${this.config.classNames.control}`}):G.class=this.config.classNames.control,O){case"play":se.toggle=!0,se.label="play",se.labelPressed="pause",se.icon="play",se.iconPressed="pause";break;case"mute":se.toggle=!0,se.label="mute",se.labelPressed="unmute",se.icon="volume",se.iconPressed="muted";break;case"captions":se.toggle=!0,se.label="enableCaptions",se.labelPressed="disableCaptions",se.icon="captions-off",se.iconPressed="captions-on";break;case"fullscreen":se.toggle=!0,se.label="enterFullscreen",se.labelPressed="exitFullscreen",se.icon="enter-fullscreen",se.iconPressed="exit-fullscreen";break;case"play-large":G.class+=` ${this.config.classNames.control}--overlaid`,B="play",se.label="play",se.icon="play";break;default:n.empty(se.label)&&(se.label=B),n.empty(se.icon)&&(se.icon=O)}let _e=ee(se.element);return se.toggle?(_e.appendChild(we.createIcon.call(this,se.iconPressed,{class:"icon--pressed"})),_e.appendChild(we.createIcon.call(this,se.icon,{class:"icon--not-pressed"})),_e.appendChild(we.createLabel.call(this,se.labelPressed,{class:"label--pressed"})),_e.appendChild(we.createLabel.call(this,se.label,{class:"label--not-pressed"}))):(_e.appendChild(we.createIcon.call(this,se.icon)),_e.appendChild(we.createLabel.call(this,se.label))),j(G,W(this.config.selectors.buttons[B],G)),z(_e,G),B==="play"?(n.array(this.elements.buttons[B])||(this.elements.buttons[B]=[]),this.elements.buttons[B].push(_e)):this.elements.buttons[B]=_e,_e},createRange(O,ae){let G=ee("input",j(W(this.config.selectors.inputs[O]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":Te.get(O,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},ae));return this.elements.inputs[O]=G,we.updateRangeFill.call(this,G),C.setup(G),G},createProgress(O,ae){let G=ee("progress",j(W(this.config.selectors.display[O]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},ae));if(O!=="volume"){G.appendChild(ee("span",null,"0"));let B={played:"played",buffer:"buffered"}[O],se=B?Te.get(B,this.config):"";G.innerText=`% ${se.toLowerCase()}`}return this.elements.display[O]=G,G},createTime(O,ae){let G=W(this.config.selectors.display[O],ae),B=ee("div",j(G,{class:`${G.class?G.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":Te.get(O,this.config),role:"timer"}),"00:00");return this.elements.display[O]=B,B},bindMenuItemShortcuts(O,ae){Q.call(this,O,"keydown keyup",G=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(G.key)||(G.preventDefault(),G.stopPropagation(),G.type==="keydown"))return;let B=fe(O,'[role="menuitemradio"]');if(!B&&[" ","ArrowRight"].includes(G.key))we.showMenuPanel.call(this,ae,!0);else{let se;G.key!==" "&&(G.key==="ArrowDown"||B&&G.key==="ArrowRight"?(se=O.nextElementSibling,n.element(se)||(se=O.parentNode.firstElementChild)):(se=O.previousElementSibling,n.element(se)||(se=O.parentNode.lastElementChild)),pe.call(this,se,!0))}},!1),Q.call(this,O,"keyup",G=>{G.key==="Return"&&we.focusFirstMenuItem.call(this,null,!0)})},createMenuItem({value:O,list:ae,type:G,title:B,badge:se=null,checked:_e=!1}){let me=W(this.config.selectors.inputs[G]),Se=ee("button",j(me,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${me.class?me.class:""}`.trim(),"aria-checked":_e,value:O})),Pe=ee("span");Pe.innerHTML=B,n.element(se)&&Pe.appendChild(se),Se.appendChild(Pe),Object.defineProperty(Se,"checked",{enumerable:!0,get:()=>Se.getAttribute("aria-checked")==="true",set(ke){ke&&Array.from(Se.parentNode.children).filter(De=>fe(De,'[role="menuitemradio"]')).forEach(De=>De.setAttribute("aria-checked","false")),Se.setAttribute("aria-checked",ke?"true":"false")}}),this.listeners.bind(Se,"click keyup",ke=>{if(!n.keyboardEvent(ke)||ke.key===" "){switch(ke.preventDefault(),ke.stopPropagation(),Se.checked=!0,G){case"language":this.currentTrack=Number(O);break;case"quality":this.quality=O;break;case"speed":this.speed=parseFloat(O)}we.showMenuPanel.call(this,"home",n.keyboardEvent(ke))}},G,!1),we.bindMenuItemShortcuts.call(this,Se,G),ae.appendChild(Se)},formatTime(O=0,ae=!1){return n.number(O)?xe(O,at(this.duration)>0,ae):O},updateTimeDisplay(O=null,ae=0,G=!1){n.element(O)&&n.number(ae)&&(O.innerText=we.formatTime(ae,G))},updateVolume(){this.supported.ui&&(n.element(this.elements.inputs.volume)&&we.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),n.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||this.volume===0))},setRange(O,ae=0){n.element(O)&&(O.value=ae,we.updateRangeFill.call(this,O))},updateProgress(O){if(!this.supported.ui||!n.event(O))return;let ae=0,G=(_e,me)=>{let Se=n.number(me)?me:0,Pe=n.element(_e)?_e:this.elements.display.buffer;if(n.element(Pe)){Pe.value=Se;let ke=Pe.getElementsByTagName("span")[0];n.element(ke)&&(ke.childNodes[0].nodeValue=Se)}};if(O)switch(O.type){case"timeupdate":case"seeking":case"seeked":B=this.currentTime,se=this.duration,ae=B===0||se===0||Number.isNaN(B)||Number.isNaN(se)?0:(B/se*100).toFixed(2),O.type==="timeupdate"&&we.setRange.call(this,this.elements.inputs.seek,ae);break;case"playing":case"progress":G(this.elements.display.buffer,100*this.buffered)}var B,se},updateRangeFill(O){let ae=n.event(O)?O.target:O;if(n.element(ae)&&ae.getAttribute("type")==="range"){if(fe(ae,this.config.selectors.inputs.seek)){ae.setAttribute("aria-valuenow",this.currentTime);let G=we.formatTime(this.currentTime),B=we.formatTime(this.duration),se=Te.get("seekLabel",this.config);ae.setAttribute("aria-valuetext",se.replace("{currentTime}",G).replace("{duration}",B))}else if(fe(ae,this.config.selectors.inputs.volume)){let G=100*ae.value;ae.setAttribute("aria-valuenow",G),ae.setAttribute("aria-valuetext",`${G.toFixed(1)}%`)}else ae.setAttribute("aria-valuenow",ae.value);(A.isWebKit||A.isIPadOS)&&ae.style.setProperty("--value",ae.value/ae.max*100+"%")}},updateSeekTooltip(O){var ae,G;if(!this.config.tooltips.seek||!n.element(this.elements.inputs.seek)||!n.element(this.elements.display.seekTooltip)||this.duration===0)return;let B=this.elements.display.seekTooltip,se=`${this.config.classNames.tooltip}--visible`,_e=De=>X(B,se,De);if(this.touch)return void _e(!1);let me=0,Se=this.elements.progress.getBoundingClientRect();if(n.event(O))me=100/Se.width*(O.pageX-Se.left);else{if(!te(B,se))return;me=parseFloat(B.style.left,10)}me<0?me=0:me>100&&(me=100);let Pe=this.duration/100*me;B.innerText=we.formatTime(Pe);let ke=(ae=this.config.markers)===null||ae===void 0||(G=ae.points)===null||G===void 0?void 0:G.find(({time:De})=>De===Math.round(Pe));ke&&B.insertAdjacentHTML("afterbegin",`${ke.label}<br>`),B.style.left=`${me}%`,n.event(O)&&["mouseenter","mouseleave"].includes(O.type)&&_e(O.type==="mouseenter")},timeUpdate(O){let ae=!n.element(this.elements.display.duration)&&this.config.invertTime;we.updateTimeDisplay.call(this,this.elements.display.currentTime,ae?this.duration-this.currentTime:this.currentTime,ae),O&&O.type==="timeupdate"&&this.media.seeking||we.updateProgress.call(this,O)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return Z(this.elements.display.currentTime,!0),void Z(this.elements.progress,!0);n.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);let O=n.element(this.elements.display.duration);!O&&this.config.displayDuration&&this.paused&&we.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),O&&we.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&we.setMarkers.call(this),we.updateSeekTooltip.call(this)},toggleMenuButton(O,ae){Z(this.elements.settings.buttons[O],!ae)},updateSetting(O,ae,G){let B=this.elements.settings.panels[O],se=null,_e=ae;if(O==="captions")se=this.currentTrack;else{if(se=n.empty(G)?this[O]:G,n.empty(se)&&(se=this.config[O].default),!n.empty(this.options[O])&&!this.options[O].includes(se))return void this.debug.warn(`Unsupported value of '${se}' for ${O}`);if(!this.config[O].options.includes(se))return void this.debug.warn(`Disabled value of '${se}' for ${O}`)}if(n.element(_e)||(_e=B&&B.querySelector('[role="menu"]')),!n.element(_e))return;this.elements.settings.buttons[O].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=we.getLabel.call(this,O,se);let me=_e&&_e.querySelector(`[value="${se}"]`);n.element(me)&&(me.checked=!0)},getLabel(O,ae){switch(O){case"speed":return ae===1?Te.get("normal",this.config):`${ae}&times;`;case"quality":if(n.number(ae)){let G=Te.get(`qualityLabel.${ae}`,this.config);return G.length?G:`${ae}p`}return He(ae);case"captions":return qe.getLabel.call(this);default:return null}},setQualityMenu(O){if(!n.element(this.elements.settings.panels.quality))return;let ae="quality",G=this.elements.settings.panels.quality.querySelector('[role="menu"]');n.array(O)&&(this.options.quality=x(O).filter(_e=>this.config.quality.options.includes(_e)));let B=!n.empty(this.options.quality)&&this.options.quality.length>1;if(we.toggleMenuButton.call(this,ae,B),N(G),we.checkMenu.call(this),!B)return;let se=_e=>{let me=Te.get(`qualityBadge.${_e}`,this.config);return me.length?we.createBadge.call(this,me):null};this.options.quality.sort((_e,me)=>{let Se=this.config.quality.options;return Se.indexOf(_e)>Se.indexOf(me)?1:-1}).forEach(_e=>{we.createMenuItem.call(this,{value:_e,list:G,type:ae,title:we.getLabel.call(this,"quality",_e),badge:se(_e)})}),we.updateSetting.call(this,ae,G)},setCaptionsMenu(){if(!n.element(this.elements.settings.panels.captions))return;let O="captions",ae=this.elements.settings.panels.captions.querySelector('[role="menu"]'),G=qe.getTracks.call(this),B=Boolean(G.length);if(we.toggleMenuButton.call(this,O,B),N(ae),we.checkMenu.call(this),!B)return;let se=G.map((_e,me)=>({value:me,checked:this.captions.toggled&&this.currentTrack===me,title:qe.getLabel.call(this,_e),badge:_e.language&&we.createBadge.call(this,_e.language.toUpperCase()),list:ae,type:"language"}));se.unshift({value:-1,checked:!this.captions.toggled,title:Te.get("disabled",this.config),list:ae,type:"language"}),se.forEach(we.createMenuItem.bind(this)),we.updateSetting.call(this,O,ae)},setSpeedMenu(){if(!n.element(this.elements.settings.panels.speed))return;let O="speed",ae=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter(B=>B>=this.minimumSpeed&&B<=this.maximumSpeed);let G=!n.empty(this.options.speed)&&this.options.speed.length>1;we.toggleMenuButton.call(this,O,G),N(ae),we.checkMenu.call(this),G&&(this.options.speed.forEach(B=>{we.createMenuItem.call(this,{value:B,list:ae,type:O,title:we.getLabel.call(this,"speed",B)})}),we.updateSetting.call(this,O,ae))},checkMenu(){let{buttons:O}=this.elements.settings,ae=!n.empty(O)&&Object.values(O).some(G=>!G.hidden);Z(this.elements.settings.menu,!ae)},focusFirstMenuItem(O,ae=!1){if(this.elements.settings.popup.hidden)return;let G=O;n.element(G)||(G=Object.values(this.elements.settings.panels).find(se=>!se.hidden));let B=G.querySelector('[role^="menuitem"]');pe.call(this,B,ae)},toggleMenu(O){let{popup:ae}=this.elements.settings,G=this.elements.buttons.settings;if(!n.element(ae)||!n.element(G))return;let{hidden:B}=ae,se=B;if(n.boolean(O))se=O;else if(n.keyboardEvent(O)&&O.key==="Escape")se=!1;else if(n.event(O)){let _e=n.function(O.composedPath)?O.composedPath()[0]:O.target,me=ae.contains(_e);if(me||!me&&O.target!==G&&se)return}G.setAttribute("aria-expanded",se),Z(ae,!se),X(this.elements.container,this.config.classNames.menu.open,se),se&&n.keyboardEvent(O)?we.focusFirstMenuItem.call(this,null,!0):se||B||pe.call(this,G,n.keyboardEvent(O))},getMenuSize(O){let ae=O.cloneNode(!0);ae.style.position="absolute",ae.style.opacity=0,ae.removeAttribute("hidden"),O.parentNode.appendChild(ae);let G=ae.scrollWidth,B=ae.scrollHeight;return w(ae),{width:G,height:B}},showMenuPanel(O="",ae=!1){let G=this.elements.container.querySelector(`#plyr-settings-${this.id}-${O}`);if(!n.element(G))return;let B=G.parentNode,se=Array.from(B.children).find(_e=>!_e.hidden);if(ve.transitions&&!ve.reducedMotion){B.style.width=`${se.scrollWidth}px`,B.style.height=`${se.scrollHeight}px`;let _e=we.getMenuSize.call(this,G),me=Se=>{Se.target===B&&["width","height"].includes(Se.propertyName)&&(B.style.width="",B.style.height="",le.call(this,B,_,me))};Q.call(this,B,_,me),B.style.width=`${_e.width}px`,B.style.height=`${_e.height}px`}Z(se,!0),Z(G,!1),we.focusFirstMenuItem.call(this,G,ae)},setDownloadUrl(){let O=this.elements.buttons.download;n.element(O)&&O.setAttribute("href",this.download)},create(O){let{bindMenuItemShortcuts:ae,createButton:G,createProgress:B,createRange:se,createTime:_e,setQualityMenu:me,setSpeedMenu:Se,showMenuPanel:Pe}=we;this.elements.controls=null,n.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(G.call(this,"play-large"));let ke=ee("div",W(this.config.selectors.controls.wrapper));this.elements.controls=ke;let De={class:"plyr__controls__item"};return x(n.array(this.config.controls)?this.config.controls:[]).forEach(Oe=>{if(Oe==="restart"&&ke.appendChild(G.call(this,"restart",De)),Oe==="rewind"&&ke.appendChild(G.call(this,"rewind",De)),Oe==="play"&&ke.appendChild(G.call(this,"play",De)),Oe==="fast-forward"&&ke.appendChild(G.call(this,"fast-forward",De)),Oe==="progress"){let Ne=ee("div",{class:`${De.class} plyr__progress__container`}),tt=ee("div",W(this.config.selectors.progress));if(tt.appendChild(se.call(this,"seek",{id:`plyr-seek-${O.id}`})),tt.appendChild(B.call(this,"buffer")),this.config.tooltips.seek){let gt=ee("span",{class:this.config.classNames.tooltip},"00:00");tt.appendChild(gt),this.elements.display.seekTooltip=gt}this.elements.progress=tt,Ne.appendChild(this.elements.progress),ke.appendChild(Ne)}if(Oe==="current-time"&&ke.appendChild(_e.call(this,"currentTime",De)),Oe==="duration"&&ke.appendChild(_e.call(this,"duration",De)),Oe==="mute"||Oe==="volume"){let{volume:Ne}=this.elements;if(n.element(Ne)&&ke.contains(Ne)||(Ne=ee("div",j({},De,{class:`${De.class} plyr__volume`.trim()})),this.elements.volume=Ne,ke.appendChild(Ne)),Oe==="mute"&&Ne.appendChild(G.call(this,"mute")),Oe==="volume"&&!A.isIos&&!A.isIPadOS){let tt={max:1,step:.05,value:this.config.volume};Ne.appendChild(se.call(this,"volume",j(tt,{id:`plyr-volume-${O.id}`})))}}if(Oe==="captions"&&ke.appendChild(G.call(this,"captions",De)),Oe==="settings"&&!n.empty(this.config.settings)){let Ne=ee("div",j({},De,{class:`${De.class} plyr__menu`.trim(),hidden:""}));Ne.appendChild(G.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${O.id}`,"aria-expanded":!1}));let tt=ee("div",{class:"plyr__menu__container",id:`plyr-settings-${O.id}`,hidden:""}),gt=ee("div"),ct=ee("div",{id:`plyr-settings-${O.id}-home`}),Ct=ee("div",{role:"menu"});ct.appendChild(Ct),gt.appendChild(ct),this.elements.settings.panels.home=ct,this.config.settings.forEach(Ke=>{let ut=ee("button",j(W(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));ae.call(this,ut,Ke),Q.call(this,ut,"click",()=>{Pe.call(this,Ke,!1)});let nt=ee("span",null,Te.get(Ke,this.config)),Rt=ee("span",{class:this.config.classNames.menu.value});Rt.innerHTML=O[Ke],nt.appendChild(Rt),ut.appendChild(nt),Ct.appendChild(ut);let It=ee("div",{id:`plyr-settings-${O.id}-${Ke}`,hidden:""}),Ut=ee("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});Ut.appendChild(ee("span",{"aria-hidden":!0},Te.get(Ke,this.config))),Ut.appendChild(ee("span",{class:this.config.classNames.hidden},Te.get("menuBack",this.config))),Q.call(this,It,"keydown",Nt=>{Nt.key==="ArrowLeft"&&(Nt.preventDefault(),Nt.stopPropagation(),Pe.call(this,"home",!0))},!1),Q.call(this,Ut,"click",()=>{Pe.call(this,"home",!1)}),It.appendChild(Ut),It.appendChild(ee("div",{role:"menu"})),gt.appendChild(It),this.elements.settings.buttons[Ke]=ut,this.elements.settings.panels[Ke]=It}),tt.appendChild(gt),Ne.appendChild(tt),ke.appendChild(Ne),this.elements.settings.popup=tt,this.elements.settings.menu=Ne}if(Oe==="pip"&&ve.pip&&ke.appendChild(G.call(this,"pip",De)),Oe==="airplay"&&ve.airplay&&ke.appendChild(G.call(this,"airplay",De)),Oe==="download"){let Ne=j({},De,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(Ne.download="");let{download:tt}=this.config.urls;!n.url(tt)&&this.isEmbed&&j(Ne,{icon:`logo-${this.provider}`,label:this.provider}),ke.appendChild(G.call(this,"download",Ne))}Oe==="fullscreen"&&ke.appendChild(G.call(this,"fullscreen",De))}),this.isHTML5&&me.call(this,de.getQualityOptions.call(this)),Se.call(this),ke},inject(){if(this.config.loadSprite){let se=we.getIconUrl.call(this);se.cors&&st(se.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let O=null;this.elements.controls=null;let ae={id:this.id,seektime:this.config.seekTime,title:this.config.title},G=!0;n.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,ae)),this.config.controls||(this.config.controls=[]),n.element(this.config.controls)||n.string(this.config.controls)?O=this.config.controls:(O=we.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:qe.getLabel.call(this)}),G=!1);let B;if(G&&n.string(this.config.controls)&&(O=(se=>{let _e=se;return Object.entries(ae).forEach(([me,Se])=>{_e=Ie(_e,`{${me}}`,Se)}),_e})(O)),n.string(this.config.selectors.controls.container)&&(B=document.querySelector(this.config.selectors.controls.container)),n.element(B)||(B=this.elements.container),B[n.element(O)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",O),n.element(this.elements.controls)||we.findElements.call(this),!n.empty(this.elements.buttons)){let se=_e=>{let me=this.config.classNames.controlPressed;_e.setAttribute("aria-pressed","false"),Object.defineProperty(_e,"pressed",{configurable:!0,enumerable:!0,get:()=>te(_e,me),set(Se=!1){X(_e,me,Se),_e.setAttribute("aria-pressed",Se?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach(_e=>{n.array(_e)||n.nodeList(_e)?Array.from(_e).filter(Boolean).forEach(se):se(_e)})}if(A.isEdge&&u(B),this.config.tooltips.controls){let{classNames:se,selectors:_e}=this.config,me=`${_e.controls.wrapper} ${_e.labels} .${se.hidden}`,Se=J.call(this,me);Array.from(Se).forEach(Pe=>{X(Pe,this.config.classNames.hidden,!1),X(Pe,this.config.classNames.tooltip,!0)})}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch{}},setMarkers(){var O,ae;if(!this.duration||this.elements.markers)return;let G=(O=this.config.markers)===null||O===void 0||(ae=O.points)===null||ae===void 0?void 0:ae.filter(({time:Pe})=>Pe>0&&Pe<this.duration);if(G==null||!G.length)return;let B=document.createDocumentFragment(),se=document.createDocumentFragment(),_e=null,me=`${this.config.classNames.tooltip}--visible`,Se=Pe=>X(_e,me,Pe);G.forEach(Pe=>{let ke=ee("span",{class:this.config.classNames.marker},""),De=Pe.time/this.duration*100+"%";_e&&(ke.addEventListener("mouseenter",()=>{Pe.label||(_e.style.left=De,_e.innerHTML=Pe.label,Se(!0))}),ke.addEventListener("mouseleave",()=>{Se(!1)})),ke.addEventListener("click",()=>{this.currentTime=Pe.time}),ke.style.left=De,se.appendChild(ke)}),B.appendChild(se),this.config.tooltips.seek||(_e=ee("span",{class:this.config.classNames.tooltip},""),B.appendChild(_e)),this.elements.markers={points:se,tip:_e},this.elements.progress.appendChild(B)}};function $e(O,ae=!0){let G=O;if(ae){let B=document.createElement("a");B.href=G,G=B.href}try{return new URL(G)}catch{return null}}function et(O){let ae=new URLSearchParams;return n.object(O)&&Object.entries(O).forEach(([G,B])=>{ae.set(G,B)}),ae}let qe={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!ve.textTracks)return void(n.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&we.setCaptionsMenu.call(this));var O,ae;if(n.element(this.elements.captions)||(this.elements.captions=ee("div",W(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),O=this.elements.captions,ae=this.elements.wrapper,n.element(O)&&n.element(ae)&&ae.parentNode.insertBefore(O,ae.nextSibling)),A.isIE&&window.URL){let _e=this.media.querySelectorAll("track");Array.from(_e).forEach(me=>{let Se=me.getAttribute("src"),Pe=$e(Se);Pe!==null&&Pe.hostname!==window.location.href.hostname&&["http:","https:"].includes(Pe.protocol)&&ot(Se,"blob").then(ke=>{me.setAttribute("src",window.URL.createObjectURL(ke))}).catch(()=>{w(me)})})}let G=x((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map(_e=>_e.split("-")[0])),B=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();B==="auto"&&([B]=G);let se=this.storage.get("captions");if(n.boolean(se)||({active:se}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:se,language:B,languages:G}),this.isHTML5){let _e=this.config.captions.update?"addtrack removetrack":"removetrack";Q.call(this,this.media.textTracks,_e,qe.update.bind(this))}setTimeout(qe.update.bind(this),0)},update(){let O=qe.getTracks.call(this,!0),{active:ae,language:G,meta:B,currentTrackNode:se}=this.captions,_e=Boolean(O.find(me=>me.language===G));this.isHTML5&&this.isVideo&&O.filter(me=>!B.get(me)).forEach(me=>{this.debug.log("Track added",me),B.set(me,{default:me.mode==="showing"}),me.mode==="showing"&&(me.mode="hidden"),Q.call(this,me,"cuechange",()=>qe.updateCues.call(this))}),(_e&&this.language!==G||!O.includes(se))&&(qe.setLanguage.call(this,G),qe.toggle.call(this,ae&&_e)),this.elements&&X(this.elements.container,this.config.classNames.captions.enabled,!n.empty(O)),n.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&we.setCaptionsMenu.call(this)},toggle(O,ae=!0){if(!this.supported.ui)return;let{toggled:G}=this.captions,B=this.config.classNames.captions.active,se=n.nullOrUndefined(O)?!G:O;if(se!==G){if(ae||(this.captions.active=se,this.storage.set({captions:se})),!this.language&&se&&!ae){let _e=qe.getTracks.call(this),me=qe.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=me.language,void qe.set.call(this,_e.indexOf(me))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=se),X(this.elements.container,B,se),this.captions.toggled=se,we.updateSetting.call(this,"captions"),I.call(this,this.media,se?"captionsenabled":"captionsdisabled")}setTimeout(()=>{se&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")})},set(O,ae=!0){let G=qe.getTracks.call(this);if(O!==-1)if(n.number(O))if(O in G){if(this.captions.currentTrack!==O){this.captions.currentTrack=O;let B=G[O],{language:se}=B||{};this.captions.currentTrackNode=B,we.updateSetting.call(this,"captions"),ae||(this.captions.language=se,this.storage.set({language:se})),this.isVimeo&&this.embed.enableTextTrack(se),I.call(this,this.media,"languagechange")}qe.toggle.call(this,!0,ae),this.isHTML5&&this.isVideo&&qe.updateCues.call(this)}else this.debug.warn("Track not found",O);else this.debug.warn("Invalid caption argument",O);else qe.toggle.call(this,!1,ae)},setLanguage(O,ae=!0){if(!n.string(O))return void this.debug.warn("Invalid language argument",O);let G=O.toLowerCase();this.captions.language=G;let B=qe.getTracks.call(this),se=qe.findTrack.call(this,[G]);qe.set.call(this,B.indexOf(se),ae)},getTracks(O=!1){return Array.from((this.media||{}).textTracks||[]).filter(ae=>!this.isHTML5||O||this.captions.meta.has(ae)).filter(ae=>["captions","subtitles"].includes(ae.kind))},findTrack(O,ae=!1){let G=qe.getTracks.call(this),B=me=>Number((this.captions.meta.get(me)||{}).default),se=Array.from(G).sort((me,Se)=>B(Se)-B(me)),_e;return O.every(me=>(_e=se.find(Se=>Se.language===me),!_e)),_e||(ae?se[0]:void 0)},getCurrentTrack(){return qe.getTracks.call(this)[this.currentTrack]},getLabel(O){let ae=O;return!n.track(ae)&&ve.textTracks&&this.captions.toggled&&(ae=qe.getCurrentTrack.call(this)),n.track(ae)?n.empty(ae.label)?n.empty(ae.language)?Te.get("enabled",this.config):O.language.toUpperCase():ae.label:Te.get("disabled",this.config)},updateCues(O){if(!this.supported.ui)return;if(!n.element(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!n.nullOrUndefined(O)&&!Array.isArray(O))return void this.debug.warn("updateCues: Invalid input",O);let ae=O;if(!ae){let B=qe.getCurrentTrack.call(this);ae=Array.from((B||{}).activeCues||[]).map(se=>se.getCueAsHTML()).map(ze)}let G=ae.map(B=>B.trim()).join(`
`);if(G!==this.elements.captions.innerHTML){N(this.elements.captions);let B=ee("span",W(this.config.selectors.caption));B.innerHTML=G,this.elements.captions.appendChild(B),I.call(this,this.media,"cuechange")}}},_t={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},Xe="picture-in-picture",Re="inline",ye={html5:"html5",youtube:"youtube",vimeo:"vimeo"},be="audio",We="video",Qe=()=>{};class Ve{constructor(ae=!1){this.enabled=window.console&&ae,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):Qe}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):Qe}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):Qe}}class rt{constructor(ae){ne(this,"onChange",()=>{if(!this.supported)return;let G=this.player.elements.buttons.fullscreen;n.element(G)&&(G.pressed=this.active);let B=this.target===this.player.media?this.target:this.player.elements.container;I.call(this.player,B,this.active?"enterfullscreen":"exitfullscreen",!0)}),ne(this,"toggleFallback",(G=!1)=>{if(G?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=G?"hidden":"",X(this.target,this.player.config.classNames.fullscreen.fallback,G),A.isIos){let B=document.head.querySelector('meta[name="viewport"]'),se="viewport-fit=cover";B||(B=document.createElement("meta"),B.setAttribute("name","viewport"));let _e=n.string(B.content)&&B.content.includes(se);G?(this.cleanupViewport=!_e,_e||(B.content+=`,${se}`)):this.cleanupViewport&&(B.content=B.content.split(",").filter(me=>me.trim()!==se).join(","))}this.onChange()}),ne(this,"trapFocus",G=>{if(A.isIos||A.isIPadOS||!this.active||G.key!=="Tab")return;let B=document.activeElement,se=J.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[_e]=se,me=se[se.length-1];B!==me||G.shiftKey?B===_e&&G.shiftKey&&(me.focus(),G.preventDefault()):(_e.focus(),G.preventDefault())}),ne(this,"update",()=>{if(this.supported){let G;G=this.forceFallback?"Fallback (forced)":rt.nativeSupported?"Native":"Fallback",this.player.debug.log(`${G} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");X(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)}),ne(this,"enter",()=>{this.supported&&(A.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!rt.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?n.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))}),ne(this,"exit",()=>{if(this.supported)if(A.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),U(this.player.play());else if(!rt.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!n.empty(this.prefix)){let G=this.prefix==="moz"?"Cancel":"Exit";document[`${this.prefix}${G}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)}),ne(this,"toggle",()=>{this.active?this.exit():this.enter()}),this.player=ae,this.prefix=rt.prefix,this.property=rt.property,this.scrollPosition={x:0,y:0},this.forceFallback=ae.config.fullscreen.fallback==="force",this.player.elements.fullscreen=ae.config.fullscreen.container&&function(G,B){let{prototype:se}=Element;return(se.closest||function(){let _e=this;do{if(fe.matches(_e,B))return _e;_e=_e.parentElement||_e.parentNode}while(_e!==null&&_e.nodeType===1);return null}).call(G,B)}(this.player.elements.container,ae.config.fullscreen.container),Q.call(this.player,document,this.prefix==="ms"?"MSFullscreenChange":`${this.prefix}fullscreenchange`,()=>{this.onChange()}),Q.call(this.player,this.player.elements.container,"dblclick",G=>{n.element(this.player.elements.controls)&&this.player.elements.controls.contains(G.target)||this.player.listeners.proxy(G,this.toggle,"fullscreen")}),Q.call(this,this.player.elements.container,"keydown",G=>this.trapFocus(G)),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return rt.nativeSupported&&!this.forceFallback}static get prefix(){if(n.function(document.exitFullscreen))return"";let ae="";return["webkit","moz","ms"].some(G=>!(!n.function(document[`${G}ExitFullscreen`])&&!n.function(document[`${G}CancelFullScreen`]))&&(ae=G,!0)),ae}static get property(){return this.prefix==="moz"?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,rt.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||rt.nativeSupported||!A.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!rt.nativeSupported||this.forceFallback)return te(this.target,this.player.config.classNames.fullscreen.fallback);let ae=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return ae&&ae.shadowRoot?ae===this.target.getRootNode().host:ae===this.target}get target(){return A.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function ft(O,ae=1){return new Promise((G,B)=>{let se=new Image,_e=()=>{delete se.onload,delete se.onerror,(se.naturalWidth>=ae?G:B)(se)};Object.assign(se,{onload:_e,onerror:_e,src:O})})}let Je={addStyleHook(){X(this.elements.container,this.config.selectors.container.replace(".",""),!0),X(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(O=!1){O&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void Je.toggleNativeControls.call(this,!0);n.element(this.elements.controls)||(we.inject.call(this),this.listeners.controls()),Je.toggleNativeControls.call(this),this.isHTML5&&qe.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,we.updateVolume.call(this),we.timeUpdate.call(this),we.durationUpdate.call(this),Je.checkPlaying.call(this),X(this.elements.container,this.config.classNames.pip.supported,ve.pip&&this.isHTML5&&this.isVideo),X(this.elements.container,this.config.classNames.airplay.supported,ve.airplay&&this.isHTML5),X(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout(()=>{I.call(this,this.media,"ready")},0),Je.setTitle.call(this),this.poster&&Je.setPoster.call(this,this.poster,!1).catch(()=>{}),this.config.duration&&we.durationUpdate.call(this),this.config.mediaMetadata&&we.setMediaMetadata.call(this)},setTitle(){let O=Te.get("play",this.config);if(n.string(this.config.title)&&!n.empty(this.config.title)&&(O+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach(ae=>{ae.setAttribute("aria-label",O)}),this.isEmbed){let ae=ue.call(this,"iframe");if(!n.element(ae))return;let G=n.empty(this.config.title)?"video":this.config.title,B=Te.get("frameTitle",this.config);ae.setAttribute("title",B.replace("{title}",G))}},togglePoster(O){X(this.elements.container,this.config.classNames.posterEnabled,O)},setPoster(O,ae=!0){return ae&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",O),this.elements.poster.removeAttribute("hidden"),K.call(this).then(()=>ft(O)).catch(G=>{throw O===this.poster&&Je.togglePoster.call(this,!1),G}).then(()=>{if(O!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")}).then(()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${O}')`,backgroundSize:""}),Je.togglePoster.call(this,!0),O)))},checkPlaying(O){X(this.elements.container,this.config.classNames.playing,this.playing),X(this.elements.container,this.config.classNames.paused,this.paused),X(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach(ae=>{Object.assign(ae,{pressed:this.playing}),ae.setAttribute("aria-label",Te.get(this.playing?"pause":"play",this.config))}),n.event(O)&&O.type==="timeupdate"||Je.toggleControls.call(this)},checkLoading(O){this.loading=["stalled","waiting"].includes(O.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout(()=>{X(this.elements.container,this.config.classNames.loading,this.loading),Je.toggleControls.call(this)},this.loading?250:0)},toggleControls(O){let{controls:ae}=this.elements;if(ae&&this.config.hideControls){let G=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(O||this.loading||this.paused||ae.pressed||ae.hover||G))}},migrateStyles(){Object.values({...this.media.style}).filter(O=>!n.empty(O)&&n.string(O)&&O.startsWith("--plyr")).forEach(O=>{this.elements.container.style.setProperty(O,this.media.style.getPropertyValue(O)),this.media.style.removeProperty(O)}),n.empty(this.media.style)&&this.media.removeAttribute("style")}};class yt{constructor(ae){ne(this,"firstTouch",()=>{let{player:G}=this,{elements:B}=G;G.touch=!0,X(B.container,G.config.classNames.isTouch,!0)}),ne(this,"global",(G=!0)=>{let{player:B}=this;B.config.keyboard.global&&ge.call(B,window,"keydown keyup",this.handleKey,G,!1),ge.call(B,document.body,"click",this.toggleMenu,G),Y.call(B,document.body,"touchstart",this.firstTouch)}),ne(this,"container",()=>{let{player:G}=this,{config:B,elements:se,timers:_e}=G;!B.keyboard.global&&B.keyboard.focused&&Q.call(G,se.container,"keydown keyup",this.handleKey,!1),Q.call(G,se.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",Pe=>{let{controls:ke}=se;ke&&Pe.type==="enterfullscreen"&&(ke.pressed=!1,ke.hover=!1);let De=0;["touchstart","touchmove","mousemove"].includes(Pe.type)&&(Je.toggleControls.call(G,!0),De=G.touch?3e3:2e3),clearTimeout(_e.controls),_e.controls=setTimeout(()=>Je.toggleControls.call(G,!1),De)});let me=()=>{if(!G.isVimeo||G.config.vimeo.premium)return;let Pe=se.wrapper,{active:ke}=G.fullscreen,[De,Oe]=ie.call(G),Ne=S(`aspect-ratio: ${De} / ${Oe}`);if(!ke)return void(Ne?(Pe.style.width=null,Pe.style.height=null):(Pe.style.maxWidth=null,Pe.style.margin=null));let[tt,gt]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],ct=tt/gt>De/Oe;Ne?(Pe.style.width=ct?"auto":"100%",Pe.style.height=ct?"100%":"auto"):(Pe.style.maxWidth=ct?gt/Oe*De+"px":null,Pe.style.margin=ct?"0 auto":null)},Se=()=>{clearTimeout(_e.resized),_e.resized=setTimeout(me,50)};Q.call(G,se.container,"enterfullscreen exitfullscreen",Pe=>{let{target:ke}=G.fullscreen;ke===se.container&&(!G.isEmbed&&n.empty(G.config.ratio)||(me(),(Pe.type==="enterfullscreen"?Q:le).call(G,window,"resize",Se)))})}),ne(this,"media",()=>{let{player:G}=this,{elements:B}=G;if(Q.call(G,G.media,"timeupdate seeking seeked",_e=>we.timeUpdate.call(G,_e)),Q.call(G,G.media,"durationchange loadeddata loadedmetadata",_e=>we.durationUpdate.call(G,_e)),Q.call(G,G.media,"ended",()=>{G.isHTML5&&G.isVideo&&G.config.resetOnEnd&&(G.restart(),G.pause())}),Q.call(G,G.media,"progress playing seeking seeked",_e=>we.updateProgress.call(G,_e)),Q.call(G,G.media,"volumechange",_e=>we.updateVolume.call(G,_e)),Q.call(G,G.media,"playing play pause ended emptied timeupdate",_e=>Je.checkPlaying.call(G,_e)),Q.call(G,G.media,"waiting canplay seeked playing",_e=>Je.checkLoading.call(G,_e)),G.supported.ui&&G.config.clickToPlay&&!G.isAudio){let _e=ue.call(G,`.${G.config.classNames.video}`);if(!n.element(_e))return;Q.call(G,B.container,"click",me=>{([B.container,_e].includes(me.target)||_e.contains(me.target))&&(G.touch&&G.config.hideControls||(G.ended?(this.proxy(me,G.restart,"restart"),this.proxy(me,()=>{U(G.play())},"play")):this.proxy(me,()=>{U(G.togglePlay())},"play")))})}G.supported.ui&&G.config.disableContextMenu&&Q.call(G,B.wrapper,"contextmenu",_e=>{_e.preventDefault()},!1),Q.call(G,G.media,"volumechange",()=>{G.storage.set({volume:G.volume,muted:G.muted})}),Q.call(G,G.media,"ratechange",()=>{we.updateSetting.call(G,"speed"),G.storage.set({speed:G.speed})}),Q.call(G,G.media,"qualitychange",_e=>{we.updateSetting.call(G,"quality",null,_e.detail.quality)}),Q.call(G,G.media,"ready qualitychange",()=>{we.setDownloadUrl.call(G)});let se=G.config.events.concat(["keyup","keydown"]).join(" ");Q.call(G,G.media,se,_e=>{let{detail:me={}}=_e;_e.type==="error"&&(me=G.media.error),I.call(G,B.container,_e.type,!0,me)})}),ne(this,"proxy",(G,B,se)=>{let{player:_e}=this,me=_e.config.listeners[se],Se=!0;n.function(me)&&(Se=me.call(_e,G)),Se!==!1&&n.function(B)&&B.call(_e,G)}),ne(this,"bind",(G,B,se,_e,me=!0)=>{let{player:Se}=this,Pe=Se.config.listeners[_e],ke=n.function(Pe);Q.call(Se,G,B,De=>this.proxy(De,se,_e),me&&!ke)}),ne(this,"controls",()=>{let{player:G}=this,{elements:B}=G,se=A.isIE?"change":"input";if(B.buttons.play&&Array.from(B.buttons.play).forEach(_e=>{this.bind(_e,"click",()=>{U(G.togglePlay())},"play")}),this.bind(B.buttons.restart,"click",G.restart,"restart"),this.bind(B.buttons.rewind,"click",()=>{G.lastSeekTime=Date.now(),G.rewind()},"rewind"),this.bind(B.buttons.fastForward,"click",()=>{G.lastSeekTime=Date.now(),G.forward()},"fastForward"),this.bind(B.buttons.mute,"click",()=>{G.muted=!G.muted},"mute"),this.bind(B.buttons.captions,"click",()=>G.toggleCaptions()),this.bind(B.buttons.download,"click",()=>{I.call(G,G.media,"download")},"download"),this.bind(B.buttons.fullscreen,"click",()=>{G.fullscreen.toggle()},"fullscreen"),this.bind(B.buttons.pip,"click",()=>{G.pip="toggle"},"pip"),this.bind(B.buttons.airplay,"click",G.airplay,"airplay"),this.bind(B.buttons.settings,"click",_e=>{_e.stopPropagation(),_e.preventDefault(),we.toggleMenu.call(G,_e)},null,!1),this.bind(B.buttons.settings,"keyup",_e=>{[" ","Enter"].includes(_e.key)&&(_e.key!=="Enter"?(_e.preventDefault(),_e.stopPropagation(),we.toggleMenu.call(G,_e)):we.focusFirstMenuItem.call(G,null,!0))},null,!1),this.bind(B.settings.menu,"keydown",_e=>{_e.key==="Escape"&&we.toggleMenu.call(G,_e)}),this.bind(B.inputs.seek,"mousedown mousemove",_e=>{let me=B.progress.getBoundingClientRect(),Se=100/me.width*(_e.pageX-me.left);_e.currentTarget.setAttribute("seek-value",Se)}),this.bind(B.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",_e=>{let me=_e.currentTarget,Se="play-on-seeked";if(n.keyboardEvent(_e)&&!["ArrowLeft","ArrowRight"].includes(_e.key))return;G.lastSeekTime=Date.now();let Pe=me.hasAttribute(Se),ke=["mouseup","touchend","keyup"].includes(_e.type);Pe&&ke?(me.removeAttribute(Se),U(G.play())):!ke&&G.playing&&(me.setAttribute(Se,""),G.pause())}),A.isIos){let _e=J.call(G,'input[type="range"]');Array.from(_e).forEach(me=>this.bind(me,se,Se=>u(Se.target)))}this.bind(B.inputs.seek,se,_e=>{let me=_e.currentTarget,Se=me.getAttribute("seek-value");n.empty(Se)&&(Se=me.value),me.removeAttribute("seek-value"),G.currentTime=Se/me.max*G.duration},"seek"),this.bind(B.progress,"mouseenter mouseleave mousemove",_e=>we.updateSeekTooltip.call(G,_e)),this.bind(B.progress,"mousemove touchmove",_e=>{let{previewThumbnails:me}=G;me&&me.loaded&&me.startMove(_e)}),this.bind(B.progress,"mouseleave touchend click",()=>{let{previewThumbnails:_e}=G;_e&&_e.loaded&&_e.endMove(!1,!0)}),this.bind(B.progress,"mousedown touchstart",_e=>{let{previewThumbnails:me}=G;me&&me.loaded&&me.startScrubbing(_e)}),this.bind(B.progress,"mouseup touchend",_e=>{let{previewThumbnails:me}=G;me&&me.loaded&&me.endScrubbing(_e)}),A.isWebKit&&Array.from(J.call(G,'input[type="range"]')).forEach(_e=>{this.bind(_e,"input",me=>we.updateRangeFill.call(G,me.target))}),G.config.toggleInvert&&!n.element(B.display.duration)&&this.bind(B.display.currentTime,"click",()=>{G.currentTime!==0&&(G.config.invertTime=!G.config.invertTime,we.timeUpdate.call(G))}),this.bind(B.inputs.volume,se,_e=>{G.volume=_e.target.value},"volume"),this.bind(B.controls,"mouseenter mouseleave",_e=>{B.controls.hover=!G.touch&&_e.type==="mouseenter"}),B.fullscreen&&Array.from(B.fullscreen.children).filter(_e=>!_e.contains(B.container)).forEach(_e=>{this.bind(_e,"mouseenter mouseleave",me=>{B.controls&&(B.controls.hover=!G.touch&&me.type==="mouseenter")})}),this.bind(B.controls,"mousedown mouseup touchstart touchend touchcancel",_e=>{B.controls.pressed=["mousedown","touchstart"].includes(_e.type)}),this.bind(B.controls,"focusin",()=>{let{config:_e,timers:me}=G;X(B.controls,_e.classNames.noTransition,!0),Je.toggleControls.call(G,!0),setTimeout(()=>{X(B.controls,_e.classNames.noTransition,!1)},0);let Se=this.touch?3e3:4e3;clearTimeout(me.controls),me.controls=setTimeout(()=>Je.toggleControls.call(G,!1),Se)}),this.bind(B.inputs.volume,"wheel",_e=>{let me=_e.webkitDirectionInvertedFromDevice,[Se,Pe]=[_e.deltaX,-_e.deltaY].map(Oe=>me?-Oe:Oe),ke=Math.sign(Math.abs(Se)>Math.abs(Pe)?Se:Pe);G.increaseVolume(ke/50);let{volume:De}=G.media;(ke===1&&De<1||ke===-1&&De>0)&&_e.preventDefault()},"volume",!1)}),this.player=ae,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(ae){let{player:G}=this,{elements:B}=G,{key:se,type:_e,altKey:me,ctrlKey:Se,metaKey:Pe,shiftKey:ke}=ae,De=_e==="keydown",Oe=De&&se===this.lastKey;if(!(me||Se||Pe||ke)&&se){if(De){let tt=document.activeElement;if(n.element(tt)){let{editable:gt}=G.config.selectors,{seek:ct}=B.inputs;if(tt!==ct&&fe(tt,gt)||ae.key===" "&&fe(tt,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(se)&&(ae.preventDefault(),ae.stopPropagation()),se){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":Oe||(Ne=parseInt(se,10),G.currentTime=G.duration/10*Ne);break;case" ":case"k":Oe||U(G.togglePlay());break;case"ArrowUp":G.increaseVolume(.1);break;case"ArrowDown":G.decreaseVolume(.1);break;case"m":Oe||(G.muted=!G.muted);break;case"ArrowRight":G.forward();break;case"ArrowLeft":G.rewind();break;case"f":G.fullscreen.toggle();break;case"c":Oe||G.toggleCaptions();break;case"l":G.loop=!G.loop}se==="Escape"&&!G.fullscreen.usingNative&&G.fullscreen.active&&G.fullscreen.toggle(),this.lastKey=se}else this.lastKey=null;var Ne}}toggleMenu(ae){we.toggleMenu.call(this.player,ae)}}typeof globalThis<"u"||typeof window<"u"||(typeof global<"u"?global:typeof self<"u");var At=function(O,ae){return O(ae={exports:{}},ae.exports),ae.exports}(function(O,ae){O.exports=function(){var G=function(){},B={},se={},_e={};function me(Ne,tt){Ne=Ne.push?Ne:[Ne];var gt,ct,Ct,Ke=[],ut=Ne.length,nt=ut;for(gt=function(Rt,It){It.length&&Ke.push(Rt),--nt||tt(Ke)};ut--;)ct=Ne[ut],(Ct=se[ct])?gt(ct,Ct):(_e[ct]=_e[ct]||[]).push(gt)}function Se(Ne,tt){if(Ne){var gt=_e[Ne];if(se[Ne]=tt,gt)for(;gt.length;)gt[0](Ne,tt),gt.splice(0,1)}}function Pe(Ne,tt){Ne.call&&(Ne={success:Ne}),tt.length?(Ne.error||G)(tt):(Ne.success||G)(Ne)}function ke(Ne,tt,gt,ct){var Ct,Ke,ut=document,nt=gt.async,Rt=(gt.numRetries||0)+1,It=gt.before||G,Ut=Ne.replace(/[\?|#].*$/,""),Nt=Ne.replace(/^(css|img)!/,"");ct=ct||0,/(^css!|\.css$)/.test(Ut)?((Ke=ut.createElement("link")).rel="stylesheet",Ke.href=Nt,(Ct="hideFocus"in Ke)&&Ke.relList&&(Ct=0,Ke.rel="preload",Ke.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(Ut)?(Ke=ut.createElement("img")).src=Nt:((Ke=ut.createElement("script")).src=Ne,Ke.async=nt===void 0||nt),Ke.onload=Ke.onerror=Ke.onbeforeload=function(jt){var Xt=jt.type[0];if(Ct)try{Ke.sheet.cssText.length||(Xt="e")}catch($t){$t.code!=18&&(Xt="e")}if(Xt=="e"){if((ct+=1)<Rt)return ke(Ne,tt,gt,ct)}else if(Ke.rel=="preload"&&Ke.as=="style")return Ke.rel="stylesheet";tt(Ne,Xt,jt.defaultPrevented)},It(Ne,Ke)!==!1&&ut.head.appendChild(Ke)}function De(Ne,tt,gt){var ct,Ct,Ke=(Ne=Ne.push?Ne:[Ne]).length,ut=Ke,nt=[];for(ct=function(Rt,It,Ut){if(It=="e"&&nt.push(Rt),It=="b"){if(!Ut)return;nt.push(Rt)}--Ke||tt(nt)},Ct=0;Ct<ut;Ct++)ke(Ne[Ct],ct,gt)}function Oe(Ne,tt,gt){var ct,Ct;if(tt&&tt.trim&&(ct=tt),Ct=(ct?gt:tt)||{},ct){if(ct in B)throw"LoadJS";B[ct]=!0}function Ke(ut,nt){De(Ne,function(Rt){Pe(Ct,Rt),ut&&Pe({success:ut,error:nt},Rt),Se(ct,Rt)},Ct)}if(Ct.returnPromise)return new Promise(Ke);Ke()}return Oe.ready=function(Ne,tt){return me(Ne,function(gt){Pe(tt,gt)}),Oe},Oe.done=function(Ne){Se(Ne,[])},Oe.reset=function(){B={},se={},_e={}},Oe.isDefined=function(Ne){return Ne in B},Oe}()});function Le(O){return new Promise((ae,G)=>{At(O,{success:ae,error:G})})}function Ue(O){O&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===O&&(this.media.paused=!O,I.call(this,this.media,O?"play":"pause"))}let Ze={setup(){let O=this;X(O.elements.wrapper,O.config.classNames.embed,!0),O.options.speed=O.config.speed.options,q.call(O),n.object(window.Vimeo)?Ze.ready.call(O):Le(O.config.urls.vimeo.sdk).then(()=>{Ze.ready.call(O)}).catch(ae=>{O.debug.warn("Vimeo SDK (player.js) failed to load",ae)})},ready(){let O=this,ae=O.config.vimeo,{premium:G,referrerPolicy:B,...se}=ae,_e=O.media.getAttribute("src"),me="";n.empty(_e)?(_e=O.media.getAttribute(O.config.attributes.embed.id),me=O.media.getAttribute(O.config.attributes.embed.hash)):me=function(nt){let Rt=nt.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return Rt&&Rt.length===5?Rt[4]:null}(_e);let Se=me?{h:me}:{};G&&Object.assign(se,{controls:!1,sidedock:!1});let Pe=et({loop:O.config.loop.active,autoplay:O.autoplay,muted:O.muted,gesture:"media",playsinline:O.config.playsinline,...Se,...se}),ke=(De=_e,n.empty(De)?null:n.number(Number(De))?De:De.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:De);var De;let Oe=ee("iframe"),Ne=Me(O.config.urls.vimeo.iframe,ke,Pe);if(Oe.setAttribute("src",Ne),Oe.setAttribute("allowfullscreen",""),Oe.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),n.empty(B)||Oe.setAttribute("referrerPolicy",B),G||!ae.customControls)Oe.setAttribute("data-poster",O.poster),O.media=H(Oe,O.media);else{let nt=ee("div",{class:O.config.classNames.embedContainer,"data-poster":O.poster});nt.appendChild(Oe),O.media=H(nt,O.media)}ae.customControls||ot(Me(O.config.urls.vimeo.api,Ne)).then(nt=>{!n.empty(nt)&&nt.thumbnail_url&&Je.setPoster.call(O,nt.thumbnail_url).catch(()=>{})}),O.embed=new window.Vimeo.Player(Oe,{autopause:O.config.autopause,muted:O.muted}),O.media.paused=!0,O.media.currentTime=0,O.supported.ui&&O.embed.disableTextTrack(),O.media.play=()=>(Ue.call(O,!0),O.embed.play()),O.media.pause=()=>(Ue.call(O,!1),O.embed.pause()),O.media.stop=()=>{O.pause(),O.currentTime=0};let{currentTime:tt}=O.media;Object.defineProperty(O.media,"currentTime",{get:()=>tt,set(nt){let{embed:Rt,media:It,paused:Ut,volume:Nt}=O,jt=Ut&&!Rt.hasPlayed;It.seeking=!0,I.call(O,It,"seeking"),Promise.resolve(jt&&Rt.setVolume(0)).then(()=>Rt.setCurrentTime(nt)).then(()=>jt&&Rt.pause()).then(()=>jt&&Rt.setVolume(Nt)).catch(()=>{})}});let gt=O.config.speed.selected;Object.defineProperty(O.media,"playbackRate",{get:()=>gt,set(nt){O.embed.setPlaybackRate(nt).then(()=>{gt=nt,I.call(O,O.media,"ratechange")}).catch(()=>{O.options.speed=[1]})}});let{volume:ct}=O.config;Object.defineProperty(O.media,"volume",{get:()=>ct,set(nt){O.embed.setVolume(nt).then(()=>{ct=nt,I.call(O,O.media,"volumechange")})}});let{muted:Ct}=O.config;Object.defineProperty(O.media,"muted",{get:()=>Ct,set(nt){let Rt=!!n.boolean(nt)&&nt;O.embed.setMuted(!!Rt||O.config.muted).then(()=>{Ct=Rt,I.call(O,O.media,"volumechange")})}});let Ke,{loop:ut}=O.config;Object.defineProperty(O.media,"loop",{get:()=>ut,set(nt){let Rt=n.boolean(nt)?nt:O.config.loop.active;O.embed.setLoop(Rt).then(()=>{ut=Rt})}}),O.embed.getVideoUrl().then(nt=>{Ke=nt,we.setDownloadUrl.call(O)}).catch(nt=>{this.debug.warn(nt)}),Object.defineProperty(O.media,"currentSrc",{get:()=>Ke}),Object.defineProperty(O.media,"ended",{get:()=>O.currentTime===O.duration}),Promise.all([O.embed.getVideoWidth(),O.embed.getVideoHeight()]).then(nt=>{let[Rt,It]=nt;O.embed.ratio=Ae(Rt,It),q.call(this)}),O.embed.setAutopause(O.config.autopause).then(nt=>{O.config.autopause=nt}),O.embed.getVideoTitle().then(nt=>{O.config.title=nt,Je.setTitle.call(this)}),O.embed.getCurrentTime().then(nt=>{tt=nt,I.call(O,O.media,"timeupdate")}),O.embed.getDuration().then(nt=>{O.media.duration=nt,I.call(O,O.media,"durationchange")}),O.embed.getTextTracks().then(nt=>{O.media.textTracks=nt,qe.setup.call(O)}),O.embed.on("cuechange",({cues:nt=[]})=>{let Rt=nt.map(It=>function(Ut){let Nt=document.createDocumentFragment(),jt=document.createElement("div");return Nt.appendChild(jt),jt.innerHTML=Ut,Nt.firstChild.innerText}(It.text));qe.updateCues.call(O,Rt)}),O.embed.on("loaded",()=>{O.embed.getPaused().then(nt=>{Ue.call(O,!nt),nt||I.call(O,O.media,"playing")}),n.element(O.embed.element)&&O.supported.ui&&O.embed.element.setAttribute("tabindex",-1)}),O.embed.on("bufferstart",()=>{I.call(O,O.media,"waiting")}),O.embed.on("bufferend",()=>{I.call(O,O.media,"playing")}),O.embed.on("play",()=>{Ue.call(O,!0),I.call(O,O.media,"playing")}),O.embed.on("pause",()=>{Ue.call(O,!1)}),O.embed.on("timeupdate",nt=>{O.media.seeking=!1,tt=nt.seconds,I.call(O,O.media,"timeupdate")}),O.embed.on("progress",nt=>{O.media.buffered=nt.percent,I.call(O,O.media,"progress"),parseInt(nt.percent,10)===1&&I.call(O,O.media,"canplaythrough"),O.embed.getDuration().then(Rt=>{Rt!==O.media.duration&&(O.media.duration=Rt,I.call(O,O.media,"durationchange"))})}),O.embed.on("seeked",()=>{O.media.seeking=!1,I.call(O,O.media,"seeked")}),O.embed.on("ended",()=>{O.media.paused=!0,I.call(O,O.media,"ended")}),O.embed.on("error",nt=>{O.media.error=nt,I.call(O,O.media,"error")}),ae.customControls&&setTimeout(()=>Je.build.call(O),0)}};function dt(O){O&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===O&&(this.media.paused=!O,I.call(this,this.media,O?"play":"pause"))}function vt(O){return O.noCookie?"https://www.youtube-nocookie.com":window.location.protocol==="http:"?"http://www.youtube.com":void 0}let mt={setup(){if(X(this.elements.wrapper,this.config.classNames.embed,!0),n.object(window.YT)&&n.function(window.YT.Player))mt.ready.call(this);else{let O=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{n.function(O)&&O(),mt.ready.call(this)},Le(this.config.urls.youtube.sdk).catch(ae=>{this.debug.warn("YouTube API failed to load",ae)})}},getTitle(O){ot(Me(this.config.urls.youtube.api,O)).then(ae=>{if(n.object(ae)){let{title:G,height:B,width:se}=ae;this.config.title=G,Je.setTitle.call(this),this.embed.ratio=Ae(se,B)}q.call(this)}).catch(()=>{q.call(this)})},ready(){let O=this,ae=O.config.youtube,G=O.media&&O.media.getAttribute("id");if(!n.empty(G)&&G.startsWith("youtube-"))return;let B=O.media.getAttribute("src");n.empty(B)&&(B=O.media.getAttribute(this.config.attributes.embed.id));let se=(_e=B,n.empty(_e)?null:_e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:_e);var _e;let me=ee("div",{id:`${O.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":ae.customControls?O.poster:void 0});if(O.media=H(me,O.media),ae.customControls){let Se=Pe=>`https://i.ytimg.com/vi/${se}/${Pe}default.jpg`;ft(Se("maxres"),121).catch(()=>ft(Se("sd"),121)).catch(()=>ft(Se("hq"))).then(Pe=>Je.setPoster.call(O,Pe.src)).then(Pe=>{Pe.includes("maxres")||(O.elements.poster.style.backgroundSize="cover")}).catch(()=>{})}O.embed=new window.YT.Player(O.media,{videoId:se,host:vt(ae),playerVars:j({},{autoplay:O.config.autoplay?1:0,hl:O.config.hl,controls:O.supported.ui&&ae.customControls?0:1,disablekb:1,playsinline:O.config.playsinline&&!O.config.fullscreen.iosNative?1:0,cc_load_policy:O.captions.active?1:0,cc_lang_pref:O.config.captions.language,widget_referrer:window?window.location.href:null},ae),events:{onError(Se){if(!O.media.error){let Pe=Se.data,ke={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[Pe]||"An unknown error occurred";O.media.error={code:Pe,message:ke},I.call(O,O.media,"error")}},onPlaybackRateChange(Se){let Pe=Se.target;O.media.playbackRate=Pe.getPlaybackRate(),I.call(O,O.media,"ratechange")},onReady(Se){if(n.function(O.media.play))return;let Pe=Se.target;mt.getTitle.call(O,se),O.media.play=()=>{dt.call(O,!0),Pe.playVideo()},O.media.pause=()=>{dt.call(O,!1),Pe.pauseVideo()},O.media.stop=()=>{Pe.stopVideo()},O.media.duration=Pe.getDuration(),O.media.paused=!0,O.media.currentTime=0,Object.defineProperty(O.media,"currentTime",{get:()=>Number(Pe.getCurrentTime()),set(Ne){O.paused&&!O.embed.hasPlayed&&O.embed.mute(),O.media.seeking=!0,I.call(O,O.media,"seeking"),Pe.seekTo(Ne)}}),Object.defineProperty(O.media,"playbackRate",{get:()=>Pe.getPlaybackRate(),set(Ne){Pe.setPlaybackRate(Ne)}});let{volume:ke}=O.config;Object.defineProperty(O.media,"volume",{get:()=>ke,set(Ne){ke=Ne,Pe.setVolume(100*ke),I.call(O,O.media,"volumechange")}});let{muted:De}=O.config;Object.defineProperty(O.media,"muted",{get:()=>De,set(Ne){let tt=n.boolean(Ne)?Ne:De;De=tt,Pe[tt?"mute":"unMute"](),Pe.setVolume(100*ke),I.call(O,O.media,"volumechange")}}),Object.defineProperty(O.media,"currentSrc",{get:()=>Pe.getVideoUrl()}),Object.defineProperty(O.media,"ended",{get:()=>O.currentTime===O.duration});let Oe=Pe.getAvailablePlaybackRates();O.options.speed=Oe.filter(Ne=>O.config.speed.options.includes(Ne)),O.supported.ui&&ae.customControls&&O.media.setAttribute("tabindex",-1),I.call(O,O.media,"timeupdate"),I.call(O,O.media,"durationchange"),clearInterval(O.timers.buffering),O.timers.buffering=setInterval(()=>{O.media.buffered=Pe.getVideoLoadedFraction(),(O.media.lastBuffered===null||O.media.lastBuffered<O.media.buffered)&&I.call(O,O.media,"progress"),O.media.lastBuffered=O.media.buffered,O.media.buffered===1&&(clearInterval(O.timers.buffering),I.call(O,O.media,"canplaythrough"))},200),ae.customControls&&setTimeout(()=>Je.build.call(O),50)},onStateChange(Se){let Pe=Se.target;switch(clearInterval(O.timers.playing),O.media.seeking&&[1,2].includes(Se.data)&&(O.media.seeking=!1,I.call(O,O.media,"seeked")),Se.data){case-1:I.call(O,O.media,"timeupdate"),O.media.buffered=Pe.getVideoLoadedFraction(),I.call(O,O.media,"progress");break;case 0:dt.call(O,!1),O.media.loop?(Pe.stopVideo(),Pe.playVideo()):I.call(O,O.media,"ended");break;case 1:ae.customControls&&!O.config.autoplay&&O.media.paused&&!O.embed.hasPlayed?O.media.pause():(dt.call(O,!0),I.call(O,O.media,"playing"),O.timers.playing=setInterval(()=>{I.call(O,O.media,"timeupdate")},50),O.media.duration!==Pe.getDuration()&&(O.media.duration=Pe.getDuration(),I.call(O,O.media,"durationchange")));break;case 2:O.muted||O.embed.unMute(),dt.call(O,!1);break;case 3:I.call(O,O.media,"waiting")}I.call(O,O.elements.container,"statechange",!1,{code:Se.data})}}})}},Pt={setup(){this.media?(X(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),X(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&X(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=ee("div",{class:this.config.classNames.video}),$(this.media,this.elements.wrapper),this.elements.poster=ee("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?de.setup.call(this):this.isYouTube?mt.setup.call(this):this.isVimeo&&Ze.setup.call(this)):this.debug.warn("No media element found!")}};class Ft{constructor(ae){ne(this,"load",()=>{this.enabled&&(n.object(window.google)&&n.object(window.google.ima)?this.ready():Le(this.player.config.urls.googleIMA.sdk).then(()=>{this.ready()}).catch(()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))}))}),ne(this,"ready",()=>{var G;this.enabled||((G=this).manager&&G.manager.destroy(),G.elements.displayContainer&&G.elements.displayContainer.destroy(),G.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then(()=>{this.clearSafetyTimer("onAdsManagerLoaded()")}),this.listeners(),this.setupIMA()}),ne(this,"setupIMA",()=>{this.elements.container=ee("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,G=>this.onAdsManagerLoaded(G),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,G=>this.onAdError(G),!1),this.requestAds()}),ne(this,"requestAds",()=>{let{container:G}=this.player.elements;try{let B=new google.ima.AdsRequest;B.adTagUrl=this.tagUrl,B.linearAdSlotWidth=G.offsetWidth,B.linearAdSlotHeight=G.offsetHeight,B.nonLinearAdSlotWidth=G.offsetWidth,B.nonLinearAdSlotHeight=G.offsetHeight,B.forceNonLinearFullSlot=!1,B.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(B)}catch(B){this.onAdError(B)}}),ne(this,"pollCountdown",(G=!1)=>{if(!G)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval(()=>{let B=xe(Math.max(this.manager.getRemainingTime(),0)),se=`${Te.get("advertisement",this.player.config)} - ${B}`;this.elements.container.setAttribute("data-badge-text",se)},100)}),ne(this,"onAdsManagerLoaded",G=>{if(!this.enabled)return;let B=new google.ima.AdsRenderingSettings;B.restoreCustomPlaybackStateOnAdBreakComplete=!0,B.enablePreloading=!0,this.manager=G.getAdsManager(this.player,B),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,se=>this.onAdError(se)),Object.keys(google.ima.AdEvent.Type).forEach(se=>{this.manager.addEventListener(google.ima.AdEvent.Type[se],_e=>this.onAdEvent(_e))}),this.trigger("loaded")}),ne(this,"addCuePoints",()=>{n.empty(this.cuePoints)||this.cuePoints.forEach(G=>{if(G!==0&&G!==-1&&G<this.player.duration){let B=this.player.elements.progress;if(n.element(B)){let se=100/this.player.duration*G,_e=ee("span",{class:this.player.config.classNames.cues});_e.style.left=`${se.toString()}%`,B.appendChild(_e)}}})}),ne(this,"onAdEvent",G=>{let{container:B}=this.player.elements,se=G.getAd(),_e=G.getAdData();switch((me=>{I.call(this.player,this.player.media,`ads${me.replace(/_/g,"").toLowerCase()}`)})(G.type),G.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),se.isLinear()||(se.width=B.offsetWidth,se.height=B.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:_e.adError&&this.player.debug.warn(`Non-fatal ad error: ${_e.adError.getMessage()}`)}}),ne(this,"onAdError",G=>{this.cancel(),this.player.debug.warn("Ads error",G)}),ne(this,"listeners",()=>{let{container:G}=this.player.elements,B;this.player.on("canplay",()=>{this.addCuePoints()}),this.player.on("ended",()=>{this.loader.contentComplete()}),this.player.on("timeupdate",()=>{B=this.player.currentTime}),this.player.on("seeked",()=>{let se=this.player.currentTime;n.empty(this.cuePoints)||this.cuePoints.forEach((_e,me)=>{B<_e&&_e<se&&(this.manager.discardAdBreak(),this.cuePoints.splice(me,1))})}),window.addEventListener("resize",()=>{this.manager&&this.manager.resize(G.offsetWidth,G.offsetHeight,google.ima.ViewMode.NORMAL)})}),ne(this,"play",()=>{let{container:G}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then(()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(G.offsetWidth,G.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(B){this.onAdError(B)}}).catch(()=>{})}),ne(this,"resumeContent",()=>{this.elements.container.style.zIndex="",this.playing=!1,U(this.player.media.play())}),ne(this,"pauseContent",()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()}),ne(this,"cancel",()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()}),ne(this,"loadAds",()=>{this.managerPromise.then(()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise(G=>{this.on("loaded",G),this.player.debug.log(this.manager)}),this.initialized=!1,this.requestAds()}).catch(()=>{})}),ne(this,"trigger",(G,...B)=>{let se=this.events[G];n.array(se)&&se.forEach(_e=>{n.function(_e)&&_e.apply(this,B)})}),ne(this,"on",(G,B)=>(n.array(this.events[G])||(this.events[G]=[]),this.events[G].push(B),this)),ne(this,"startSafetyTimer",(G,B)=>{this.player.debug.log(`Safety timer invoked from: ${B}`),this.safetyTimer=setTimeout(()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")},G)}),ne(this,"clearSafetyTimer",G=>{n.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${G}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)}),this.player=ae,this.config=ae.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise((G,B)=>{this.on("loaded",G),this.on("error",B)}),this.load()}get enabled(){let{config:ae}=this;return this.player.isHTML5&&this.player.isVideo&&ae.enabled&&(!n.empty(ae.publisherId)||n.url(ae.tagUrl))}get tagUrl(){let{config:ae}=this;return n.url(ae.tagUrl)?ae.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${et({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:ae.publisherId})}`}}function bt(O=0,ae=0,G=255){return Math.min(Math.max(O,ae),G)}let kt=O=>{let ae=[];return O.split(/\r\n\r\n|\n\n|\r\r/).forEach(G=>{let B={};G.split(/\r\n|\n|\r/).forEach(se=>{if(n.number(B.startTime)){if(!n.empty(se.trim())&&n.empty(B.text)){let _e=se.trim().split("#xywh=");[B.text]=_e,_e[1]&&([B.x,B.y,B.w,B.h]=_e[1].split(","))}}else{let _e=se.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);_e&&(B.startTime=60*Number(_e[1]||0)*60+60*Number(_e[2])+Number(_e[3])+Number(`0.${_e[4]}`),B.endTime=60*Number(_e[6]||0)*60+60*Number(_e[7])+Number(_e[8])+Number(`0.${_e[9]}`))}}),B.text&&ae.push(B)}),ae},Wt=(O,ae)=>{let G={};return O>ae.width/ae.height?(G.width=ae.width,G.height=1/O*ae.width):(G.height=ae.height,G.width=O*ae.height),G};class Vt{constructor(ae){ne(this,"load",()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then(()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)})}),ne(this,"getThumbnails",()=>new Promise(G=>{let{src:B}=this.player.config.previewThumbnails;if(n.empty(B))throw new Error("Missing previewThumbnails.src config attribute");let se=()=>{this.thumbnails.sort((_e,me)=>_e.height-me.height),this.player.debug.log("Preview thumbnails",this.thumbnails),G()};if(n.function(B))B(_e=>{this.thumbnails=_e,se()});else{let _e=(n.string(B)?[B]:B).map(me=>this.getThumbnail(me));Promise.all(_e).then(se)}})),ne(this,"getThumbnail",G=>new Promise(B=>{ot(G).then(se=>{let _e={frames:kt(se),height:null,urlPrefix:""};_e.frames[0].text.startsWith("/")||_e.frames[0].text.startsWith("http://")||_e.frames[0].text.startsWith("https://")||(_e.urlPrefix=G.substring(0,G.lastIndexOf("/")+1));let me=new Image;me.onload=()=>{_e.height=me.naturalHeight,_e.width=me.naturalWidth,this.thumbnails.push(_e),B()},me.src=_e.urlPrefix+_e.frames[0].text})})),ne(this,"startMove",G=>{if(this.loaded&&n.event(G)&&["touchmove","mousemove"].includes(G.type)&&this.player.media.duration){if(G.type==="touchmove")this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var B,se;let _e=this.player.elements.progress.getBoundingClientRect(),me=100/_e.width*(G.pageX-_e.left);this.seekTime=this.player.media.duration*(me/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=G.pageX,this.elements.thumb.time.innerText=xe(this.seekTime);let Se=(B=this.player.config.markers)===null||B===void 0||(se=B.points)===null||se===void 0?void 0:se.find(({time:Pe})=>Pe===Math.round(this.seekTime));Se&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${Se.label}<br>`)}this.showImageAtCurrentTime()}}),ne(this,"endMove",()=>{this.toggleThumbContainer(!1,!0)}),ne(this,"startScrubbing",G=>{(n.nullOrUndefined(G.button)||G.button===!1||G.button===0)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))}),ne(this,"endScrubbing",()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):Y.call(this.player,this.player.media,"timeupdate",()=>{this.mouseDown||this.toggleScrubbingContainer(!1)})}),ne(this,"listeners",()=>{this.player.on("play",()=>{this.toggleThumbContainer(!1,!0)}),this.player.on("seeked",()=>{this.toggleThumbContainer(!1)}),this.player.on("timeupdate",()=>{this.lastTime=this.player.media.currentTime})}),ne(this,"render",()=>{this.elements.thumb.container=ee("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=ee("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);let G=ee("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=ee("span",{},"00:00"),G.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(G),n.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=ee("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)}),ne(this,"destroy",()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()}),ne(this,"showImageAtCurrentTime",()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();let G=this.thumbnails[0].frames.findIndex(_e=>this.seekTime>=_e.startTime&&this.seekTime<=_e.endTime),B=G>=0,se=0;this.mouseDown||this.toggleThumbContainer(B),B&&(this.thumbnails.forEach((_e,me)=>{this.loadedImages.includes(_e.frames[G].text)&&(se=me)}),G!==this.showingThumb&&(this.showingThumb=G,this.loadImage(se)))}),ne(this,"loadImage",(G=0)=>{let B=this.showingThumb,se=this.thumbnails[G],{urlPrefix:_e}=se,me=se.frames[B],Se=se.frames[B].text,Pe=_e+Se;if(this.currentImageElement&&this.currentImageElement.dataset.filename===Se)this.showImage(this.currentImageElement,me,G,B,Se,!1),this.currentImageElement.dataset.index=B,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);let ke=new Image;ke.src=Pe,ke.dataset.index=B,ke.dataset.filename=Se,this.showingThumbFilename=Se,this.player.debug.log(`Loading image: ${Pe}`),ke.onload=()=>this.showImage(ke,me,G,B,Se,!0),this.loadingImage=ke,this.removeOldImages(ke)}}),ne(this,"showImage",(G,B,se,_e,me,Se=!0)=>{this.player.debug.log(`Showing thumb: ${me}. num: ${_e}. qual: ${se}. newimg: ${Se}`),this.setImageSizeAndOffset(G,B),Se&&(this.currentImageContainer.appendChild(G),this.currentImageElement=G,this.loadedImages.includes(me)||this.loadedImages.push(me)),this.preloadNearby(_e,!0).then(this.preloadNearby(_e,!1)).then(this.getHigherQuality(se,G,B,me))}),ne(this,"removeOldImages",G=>{Array.from(this.currentImageContainer.children).forEach(B=>{if(B.tagName.toLowerCase()!=="img")return;let se=this.usingSprites?500:1e3;if(B.dataset.index!==G.dataset.index&&!B.dataset.deleting){B.dataset.deleting=!0;let{currentImageContainer:_e}=this;setTimeout(()=>{_e.removeChild(B),this.player.debug.log(`Removing thumb: ${B.dataset.filename}`)},se)}})}),ne(this,"preloadNearby",(G,B=!0)=>new Promise(se=>{setTimeout(()=>{let _e=this.thumbnails[0].frames[G].text;if(this.showingThumbFilename===_e){let me;me=B?this.thumbnails[0].frames.slice(G):this.thumbnails[0].frames.slice(0,G).reverse();let Se=!1;me.forEach(Pe=>{let ke=Pe.text;if(ke!==_e&&!this.loadedImages.includes(ke)){Se=!0,this.player.debug.log(`Preloading thumb filename: ${ke}`);let{urlPrefix:De}=this.thumbnails[0],Oe=De+ke,Ne=new Image;Ne.src=Oe,Ne.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${ke}`),this.loadedImages.includes(ke)||this.loadedImages.push(ke),se()}}}),Se||se()}},300)})),ne(this,"getHigherQuality",(G,B,se,_e)=>{if(G<this.thumbnails.length-1){let me=B.naturalHeight;this.usingSprites&&(me=se.h),me<this.thumbContainerHeight&&setTimeout(()=>{this.showingThumbFilename===_e&&(this.player.debug.log(`Showing higher quality thumb for: ${_e}`),this.loadImage(G+1))},300)}}),ne(this,"toggleThumbContainer",(G=!1,B=!1)=>{let se=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(se,G),!G&&B&&(this.showingThumb=null,this.showingThumbFilename=null)}),ne(this,"toggleScrubbingContainer",(G=!1)=>{let B=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(B,G),G||(this.showingThumb=null,this.showingThumbFilename=null)}),ne(this,"determineContainerAutoSizing",()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)}),ne(this,"setThumbContainerSizeAndPos",()=>{let{imageContainer:G}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(G.clientHeight>20&&G.clientWidth<20){let B=Math.floor(G.clientHeight*this.thumbAspectRatio);G.style.width=`${B}px`}else if(G.clientHeight<20&&G.clientWidth>20){let B=Math.floor(G.clientWidth/this.thumbAspectRatio);G.style.height=`${B}px`}}else{let B=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);G.style.height=`${this.thumbContainerHeight}px`,G.style.width=`${B}px`}this.setThumbContainerPos()}),ne(this,"setThumbContainerPos",()=>{let G=this.player.elements.progress.getBoundingClientRect(),B=this.player.elements.container.getBoundingClientRect(),{container:se}=this.elements.thumb,_e=B.left-G.left+10,me=B.right-G.left-se.clientWidth-10,Se=this.mousePosX-G.left-se.clientWidth/2,Pe=bt(Se,_e,me);se.style.left=`${Pe}px`,se.style.setProperty("--preview-arrow-offset",Se-Pe+"px")}),ne(this,"setScrubbingContainerSize",()=>{let{width:G,height:B}=Wt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${G}px`,this.elements.scrubbing.container.style.height=`${B}px`}),ne(this,"setImageSizeAndOffset",(G,B)=>{if(!this.usingSprites)return;let se=this.thumbContainerHeight/B.h;G.style.height=G.naturalHeight*se+"px",G.style.width=G.naturalWidth*se+"px",G.style.left=`-${B.x*se}px`,G.style.top=`-${B.y*se}px`}),this.player=ae,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){let{height:ae}=Wt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return ae}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(ae){this.mouseDown?this.currentScrubbingImageElement=ae:this.currentThumbnailImageElement=ae}}let lt={insertElements(O,ae){n.string(ae)?k(O,this.media,{src:ae}):n.array(ae)&&ae.forEach(G=>{k(O,this.media,G)})},change(O){D(O,"sources.length")?(de.cancelRequests.call(this),this.destroy.call(this,()=>{this.options.quality=[],w(this.media),this.media=null,n.element(this.elements.container)&&this.elements.container.removeAttribute("class");let{sources:ae,type:G}=O,[{provider:B=ye.html5,src:se}]=ae,_e=B==="html5"?G:"div",me=B==="html5"?{}:{src:se};Object.assign(this,{provider:B,type:G,supported:ve.check(G,B,this.config.playsinline),media:ee(_e,me)}),this.elements.container.appendChild(this.media),n.boolean(O.autoplay)&&(this.config.autoplay=O.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),n.empty(O.poster)||(this.poster=O.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),Je.addStyleHook.call(this),this.isHTML5&&lt.insertElements.call(this,"source",ae),this.config.title=O.title,Pt.setup.call(this),this.isHTML5&&Object.keys(O).includes("tracks")&&lt.insertElements.call(this,"track",O.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Je.build.call(this),this.isHTML5&&this.media.load(),n.empty(O.previewThumbnails)||(Object.assign(this.config.previewThumbnails,O.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Vt(this))),this.fullscreen.update()},!0)):this.debug.warn("Invalid source format")}};class St{constructor(ae,G){if(ne(this,"play",()=>n.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then(()=>this.ads.play()).catch(()=>U(this.media.play())),this.media.play()):null),ne(this,"pause",()=>this.playing&&n.function(this.media.pause)?this.media.pause():null),ne(this,"togglePlay",Se=>(n.boolean(Se)?Se:!this.playing)?this.play():this.pause()),ne(this,"stop",()=>{this.isHTML5?(this.pause(),this.restart()):n.function(this.media.stop)&&this.media.stop()}),ne(this,"restart",()=>{this.currentTime=0}),ne(this,"rewind",Se=>{this.currentTime-=n.number(Se)?Se:this.config.seekTime}),ne(this,"forward",Se=>{this.currentTime+=n.number(Se)?Se:this.config.seekTime}),ne(this,"increaseVolume",Se=>{let Pe=this.media.muted?0:this.volume;this.volume=Pe+(n.number(Se)?Se:0)}),ne(this,"decreaseVolume",Se=>{this.increaseVolume(-Se)}),ne(this,"airplay",()=>{ve.airplay&&this.media.webkitShowPlaybackTargetPicker()}),ne(this,"toggleControls",Se=>{if(this.supported.ui&&!this.isAudio){let Pe=te(this.elements.container,this.config.classNames.hideControls),ke=Se===void 0?void 0:!Se,De=X(this.elements.container,this.config.classNames.hideControls,ke);if(De&&n.array(this.config.controls)&&this.config.controls.includes("settings")&&!n.empty(this.config.settings)&&we.toggleMenu.call(this,!1),De!==Pe){let Oe=De?"controlshidden":"controlsshown";I.call(this,this.media,Oe)}return!De}return!1}),ne(this,"on",(Se,Pe)=>{Q.call(this,this.elements.container,Se,Pe)}),ne(this,"once",(Se,Pe)=>{Y.call(this,this.elements.container,Se,Pe)}),ne(this,"off",(Se,Pe)=>{le(this.elements.container,Se,Pe)}),ne(this,"destroy",(Se,Pe=!1)=>{if(!this.ready)return;let ke=()=>{document.body.style.overflow="",this.embed=null,Pe?(Object.keys(this.elements).length&&(w(this.elements.buttons.play),w(this.elements.captions),w(this.elements.controls),w(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),n.function(Se)&&Se()):(L.call(this),de.cancelRequests.call(this),H(this.elements.original,this.elements.container),I.call(this,this.elements.original,"destroyed",!0),n.function(Se)&&Se.call(this.elements.original),this.ready=!1,setTimeout(()=>{this.elements=null,this.media=null},200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(Je.toggleNativeControls.call(this,!0),ke()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),this.embed!==null&&n.function(this.embed.destroy)&&this.embed.destroy(),ke()):this.isVimeo&&(this.embed!==null&&this.embed.unload().then(ke),setTimeout(ke,200))}),ne(this,"supports",Se=>ve.mime.call(this,Se)),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=ve.touch,this.media=ae,n.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||n.nodeList(this.media)||n.array(this.media))&&(this.media=this.media[0]),this.config=j({},_t,St.defaults,G||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch{return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Ve(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",ve),n.nullOrUndefined(this.media)||!n.element(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!ve.check().api)return void this.debug.error("Setup failed: no support");let B=this.media.cloneNode(!0);B.autoplay=!1,this.elements.original=B;let se=this.media.tagName.toLowerCase(),_e=null,me=null;switch(se){case"div":if(_e=this.media.querySelector("iframe"),n.element(_e)){if(me=$e(_e.getAttribute("src")),this.provider=function(Se){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(Se)?ye.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(Se)?ye.vimeo:null}(me.toString()),this.elements.container=this.media,this.media=_e,this.elements.container.className="",me.search.length){let Se=["1","true"];Se.includes(me.searchParams.get("autoplay"))&&(this.config.autoplay=!0),Se.includes(me.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=Se.includes(me.searchParams.get("playsinline")),this.config.youtube.hl=me.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(n.empty(this.provider)||!Object.values(ye).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=We;break;case"video":case"audio":this.type=se,this.provider=ye.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=ve.check(this.type,this.provider),this.supported.api?(this.eventListeners=[],this.listeners=new yt(this),this.storage=new Fe(this),this.media.plyr=this,n.element(this.elements.container)||(this.elements.container=ee("div"),$(this.media,this.elements.container)),Je.migrateStyles.call(this),Je.addStyleHook.call(this),Pt.setup.call(this),this.config.debug&&Q.call(this,this.elements.container,this.config.events.join(" "),Se=>{this.debug.log(`event: ${Se.type}`)}),this.fullscreen=new rt(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Je.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new Ft(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",()=>U(this.play())),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Vt(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===ye.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===ye.youtube}get isVimeo(){return this.provider===ye.vimeo}get isVideo(){return this.type===We}get isAudio(){return this.type===be}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&this.currentTime===0)}get ended(){return Boolean(this.media.ended)}set currentTime(ae){if(!this.duration)return;let G=n.number(ae)&&ae>0;this.media.currentTime=G?Math.min(ae,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){let{buffered:ae}=this.media;return n.number(ae)?ae:ae&&ae.length&&this.duration>0?ae.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){let ae=parseFloat(this.config.duration),G=(this.media||{}).duration,B=n.number(G)&&G!==1/0?G:0;return ae||B}set volume(ae){let G=ae;n.string(G)&&(G=Number(G)),n.number(G)||(G=this.storage.get("volume")),n.number(G)||({volume:G}=this.config),G>1&&(G=1),G<0&&(G=0),this.config.volume=G,this.media.volume=G,!n.empty(ae)&&this.muted&&G>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(ae){let G=ae;n.boolean(G)||(G=this.storage.get("muted")),n.boolean(G)||(G=this.config.muted),this.config.muted=G,this.media.muted=G}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(ae){let G=null;n.number(ae)&&(G=ae),n.number(G)||(G=this.storage.get("speed")),n.number(G)||(G=this.config.speed.selected);let{minimumSpeed:B,maximumSpeed:se}=this;G=bt(G,B,se),this.config.speed.selected=G,setTimeout(()=>{this.media&&(this.media.playbackRate=G)},0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(ae){let G=this.config.quality,B=this.options.quality;if(!B.length)return;let se=[!n.empty(ae)&&Number(ae),this.storage.get("quality"),G.selected,G.default].find(n.number),_e=!0;if(!B.includes(se)){let me=y(B,se);this.debug.warn(`Unsupported quality option: ${se}, using ${me} instead`),se=me,_e=!1}G.selected=se,this.media.quality=se,_e&&this.storage.set({quality:se})}get quality(){return this.media.quality}set loop(ae){let G=n.boolean(ae)?ae:this.config.loop.active;this.config.loop.active=G,this.media.loop=G}get loop(){return Boolean(this.media.loop)}set source(ae){lt.change.call(this,ae)}get source(){return this.media.currentSrc}get download(){let{download:ae}=this.config.urls;return n.url(ae)?ae:this.source}set download(ae){n.url(ae)&&(this.config.urls.download=ae,we.setDownloadUrl.call(this))}set poster(ae){this.isVideo?Je.setPoster.call(this,ae,!1).catch(()=>{}):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;let ae=oe(ie.call(this));return n.array(ae)?ae.join(":"):ae}set ratio(ae){this.isVideo?n.string(ae)&&F(ae)?(this.config.ratio=oe(ae),q.call(this)):this.debug.error(`Invalid aspect ratio specified (${ae})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(ae){this.config.autoplay=n.boolean(ae)?ae:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(ae){qe.toggle.call(this,ae,!1)}set currentTrack(ae){qe.set.call(this,ae,!1),qe.setup.call(this)}get currentTrack(){let{toggled:ae,currentTrack:G}=this.captions;return ae?G:-1}set language(ae){qe.setLanguage.call(this,ae,!1)}get language(){return(qe.getCurrentTrack.call(this)||{}).language}set pip(ae){if(!ve.pip)return;let G=n.boolean(ae)?ae:!this.pip;n.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(G?Xe:Re),n.function(this.media.requestPictureInPicture)&&(!this.pip&&G?this.media.requestPictureInPicture():this.pip&&!G&&document.exitPictureInPicture())}get pip(){return ve.pip?n.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===Xe:null}setPreviewThumbnails(ae){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,ae),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Vt(this))}static supported(ae,G){return ve.check(ae,G)}static loadSprite(ae,G){return st(ae,G)}static setup(ae,G={}){let B=null;return n.string(ae)?B=Array.from(document.querySelectorAll(ae)):n.nodeList(ae)?B=Array.from(ae):n.array(ae)&&(B=ae.filter(n.element)),n.empty(B)?null:B.map(se=>new St(se,G))}}var Mt;return St.defaults=(Mt=_t,JSON.parse(JSON.stringify(Mt))),St})});var ai=rr((kl,ni)=>{ni.exports=function ne(he,re,ce){return re===void 0?function(V,v){return ne(he,V,v)}:(ce===void 0&&(ce="0"),he-=re.toString().length,he>0?new Array(he+(/\./.test(re)?2:1)).join(ce)+re:re+"")}});var xn=rr((Wl,li)=>{"use strict";li.exports={fromMs:si,fromS:qs,toMs:oi,toS:eo};var cn=ai(),Bn=36e5,Un=6e4,Gr=1e3,ii="Time format error";function si(ne,he="mm:ss"){if(typeof ne!="number"||Number.isNaN(ne))throw new Error("NaN error");let re=Math.abs(ne),ce=ne<0,V=Math.floor(re/Bn),v=Math.floor(re%Bn/Un),e=Math.floor(re%Un/Gr),p=Math.floor(re%Gr);return to({negative:ce,hours:V,minutes:v,seconds:e,miliseconds:p},he)}function qs(ne,he="mm:ss"){if(typeof ne!="number"||Number.isNaN(ne))throw new Error("NaN error");let re=ne*Gr;return si(re,he)}function oi(ne,he="mm:ss"){let re;if(["mm:ss","mm:ss.sss","hh:mm:ss","hh:mm:ss.sss"].includes(he))re=/^(-)?(?:(\d\d+):)?(\d\d):(\d\d)(\.\d+)?$/;else if(he==="hh:mm")re=/^(-)?(\d\d):(\d\d)(?::(\d\d)(?:(\.\d+))?)?$/;else throw new Error(ii);let ce=re.exec(ne);if(!ce)throw new Error;let V=ce[1]==="-",v=ce[2]|0,e=ce[3]|0,p=ce[4]|0,l=Math.floor(1e3*ce[5]|0);if(e>60||p>60)throw new Error;return(V?-1:1)*(v*Bn+e*Un+p*Gr+l)}function eo(ne,he="mm:ss"){let re=oi(ne,he);return Math.floor(re/Gr)}function to(ne,he){let re,ce,V;switch(he.toLowerCase()){case"hh:mm:ss.sss":re=!0,ce=!0,V=!0;break;case"hh:mm:ss":re=!!ne.miliseconds,ce=!0,V=!0;break;case"hh:mm":re=!!ne.miliseconds,ce=re||!!ne.seconds,V=!0;break;case"mm:ss":re=!!ne.miliseconds,ce=!0,V=!!ne.hours;break;case"mm:ss.sss":re=!0,ce=!0,V=!!ne.hours;break;default:throw new Error(ii)}let v=cn(2,ne.hours),e=cn(2,ne.minutes),p=cn(2,ne.seconds),l=cn(3,ne.miliseconds);return(ne.negative?"-":"")+(V?re?`${v}:${e}:${p}.${l}`:ce?`${v}:${e}:${p}`:`${v}:${e}`:re?`${e}:${p}.${l}`:`${e}:${p}`)}});var ro={};fs(ro,{default:()=>mn});module.exports=cs(ro);var _i=ir(jr()),vi=require("obsidian");var ds="(v[h|w|min|max]|p[c|t|x]|[re|e|c|m]m|[l|c]h|%|in|Q|ex)",Jn=new RegExp(ds);var ms=["auto","revert","unset","inherit","initial","max-content","min-content","fit-content","-webkit-fill-available"];function yr(ne){return Jn.test(Zn(ne)[1])}function Zn(ne,he={}){let{onlyValue:re=!1,onlyUnit:ce=!1}=he;if(typeof ne=="number")return re?ne:ce?"":[ne,""];let V=[0,""];if(ms.includes(ne))return[ne,""];ne=String(ne);let v=parseFloat(ne),e=ne.match(/[\d.\-\+]*\s*(.*)/)[1];return V=[v,e],re?v:ce?e:V}var qn=Zn;var ea=qn;var ta=require("obsidian");var Jr=ne=>ne.hash?ne.href.slice(0,-ne.hash.length):ne.href,kr=(ne,he,re)=>{let[ce,V]=ea(he);ne.style.setProperty("--max-ratio-width",ce*re+V)},Zr=(ne,he)=>{let{editor:re,app:ce}=he;he.getMode()!="source"&&(he.toggleMode(),re.exec("goEnd"));let V=re.getCursor("to");re.replaceRange(ne,V,V),ce.isMobile&&re.setCursor(re.offsetToPos(re.posToOffset(V)+ne.length))},ra=ne=>new Promise((he,re)=>{if(ta.Platform.isDesktopApp){let ce=require("https").request({hostname:"b23.tv",port:443,path:"/"+ne,method:"GET"},V=>V.headers.location?he(V.headers.location):re(new Error("No redirect location found")));ce.on("error",V=>re(V)),ce.end()}else re(new TypeError("Calling node https in non-electron environment"))});var fr=ne=>ne.plugins.plugins["mx-bili-plugin"]!==void 0,na=ne=>{let he=ne.plugins.plugins["mx-bili-plugin"];if(fr(ne))return he.settings.port;throw new Error("bili plugin not available")},aa=ne=>{let he=ne.plugins.plugins["mx-bili-plugin"];if(fr(ne))return he.portSetting;throw new Error("bili plugin not available")},ia=ne=>{let he=ne.plugins.plugins["mx-bili-plugin"];if(fr(ne))return he.fetchPoster;throw new Error("bili plugin not available")};var sa=ne=>createEl("iframe",{cls:"bili-iframe",attr:{src:ne.iframe.toString(),scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:!1,sandbox:"allow-forms allow-presentation allow-same-origin allow-scripts allow-modals"}});var mr=require("obsidian"),Mn=ir(qr()),Ga=ir(Ua());var ws={aa:{name:"Afar",nativeName:"Afaraf"},ab:{name:"Abkhaz",nativeName:"\u0430\u04A7\u0441\u0443\u0430 \u0431\u044B\u0437\u0448\u04D9\u0430"},ae:{name:"Avestan",nativeName:"avesta"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},am:{name:"Amharic",nativeName:"\u12A0\u121B\u122D\u129B"},an:{name:"Aragonese",nativeName:"aragon\xE9s"},ar:{name:"Arabic",nativeName:"\u0627\u064E\u0644\u0652\u0639\u064E\u0631\u064E\u0628\u0650\u064A\u064E\u0651\u0629\u064F"},as:{name:"Assamese",nativeName:"\u0985\u09B8\u09AE\u09C0\u09AF\u09BC\u09BE"},av:{name:"Avaric",nativeName:"\u0430\u0432\u0430\u0440 \u043C\u0430\u0446\u04C0"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"az\u0259rbaycan dili"},ba:{name:"Bashkir",nativeName:"\u0431\u0430\u0448\u04A1\u043E\u0440\u0442 \u0442\u0435\u043B\u0435"},be:{name:"Belarusian",nativeName:"\u0431\u0435\u043B\u0430\u0440\u0443\u0441\u043A\u0430\u044F \u043C\u043E\u0432\u0430"},bg:{name:"Bulgarian",nativeName:"\u0431\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438 \u0435\u0437\u0438\u043A"},bi:{name:"Bislama",nativeName:"Bislama"},bm:{name:"Bambara",nativeName:"bamanankan"},bn:{name:"Bengali",nativeName:"\u09AC\u09BE\u0982\u09B2\u09BE"},bo:{name:"Tibetan",nativeName:"\u0F56\u0F7C\u0F51\u0F0B\u0F61\u0F72\u0F42"},br:{name:"Breton",nativeName:"brezhoneg"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},ca:{name:"Catalan",nativeName:"Catal\xE0"},ce:{name:"Chechen",nativeName:"\u043D\u043E\u0445\u0447\u0438\u0439\u043D \u043C\u043E\u0442\u0442"},ch:{name:"Chamorro",nativeName:"Chamoru"},co:{name:"Corsican",nativeName:"corsu"},cr:{name:"Cree",nativeName:"\u14C0\u1426\u1403\u152D\u140D\u140F\u1423"},cs:{name:"Czech",nativeName:"\u010De\u0161tina"},cu:{name:"Old Church Slavonic",nativeName:"\u0469\u0437\u044B\u043A\u044A \u0441\u043B\u043E\u0432\u0463\u043D\u044C\u0441\u043A\u044A"},cv:{name:"Chuvash",nativeName:"\u0447\u04D1\u0432\u0430\u0448 \u0447\u04D7\u043B\u0445\u0438"},cy:{name:"Welsh",nativeName:"Cymraeg"},da:{name:"Danish",nativeName:"dansk"},de:{name:"German",nativeName:"Deutsch"},dv:{name:"Divehi",nativeName:"\u078B\u07A8\u0788\u07AC\u0780\u07A8"},dz:{name:"Dzongkha",nativeName:"\u0F62\u0FAB\u0F7C\u0F44\u0F0B\u0F41"},ee:{name:"Ewe",nativeName:"E\u028Begbe"},el:{name:"Greek",nativeName:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},es:{name:"Spanish",nativeName:"Espa\xF1ol"},et:{name:"Estonian",nativeName:"eesti"},eu:{name:"Basque",nativeName:"euskara"},fa:{name:"Persian",nativeName:"\u0641\u0627\u0631\u0633\u06CC"},ff:{name:"Fula",nativeName:"Fulfulde"},fi:{name:"Finnish",nativeName:"suomi"},fj:{name:"Fijian",nativeName:"vosa Vakaviti"},fo:{name:"Faroese",nativeName:"f\xF8royskt"},fr:{name:"French",nativeName:"Fran\xE7ais"},fy:{name:"Western Frisian",nativeName:"Frysk"},ga:{name:"Irish",nativeName:"Gaeilge"},gd:{name:"Scottish Gaelic",nativeName:"G\xE0idhlig"},gl:{name:"Galician",nativeName:"galego"},gn:{name:"Guaran\xED",nativeName:"Ava\xF1e'\u1EBD"},gu:{name:"Gujarati",nativeName:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0"},gv:{name:"Manx",nativeName:"Gaelg"},ha:{name:"Hausa",nativeName:"\u0647\u064E\u0648\u064F\u0633\u064E"},he:{name:"Hebrew",nativeName:"\u05E2\u05D1\u05E8\u05D9\u05EA"},hi:{name:"Hindi",nativeName:"\u0939\u093F\u0928\u094D\u0926\u0940"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hr:{name:"Croatian",nativeName:"Hrvatski"},ht:{name:"Haitian",nativeName:"Krey\xF2l ayisyen"},hu:{name:"Hungarian",nativeName:"magyar"},hy:{name:"Armenian",nativeName:"\u0540\u0561\u0575\u0565\u0580\u0565\u0576"},hz:{name:"Herero",nativeName:"Otjiherero"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Interlingue"},ig:{name:"Igbo",nativeName:"As\u1EE5s\u1EE5 Igbo"},ii:{name:"Nuosu",nativeName:"\uA188\uA320\uA4BF Nuosuhxop"},ik:{name:"Inupiaq",nativeName:"I\xF1upiaq"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"\xCDslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"\u1403\u14C4\u1483\u144E\u1450\u1466"},ja:{name:"Japanese",nativeName:"\u65E5\u672C\u8A9E"},jv:{name:"Javanese",nativeName:"basa Jawa"},ka:{name:"Georgian",nativeName:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8"},kg:{name:"Kongo",nativeName:"Kikongo"},ki:{name:"Kikuyu",nativeName:"G\u0129k\u0169y\u0169"},kj:{name:"Kwanyama",nativeName:"Kuanyama"},kk:{name:"Kazakh",nativeName:"\u049B\u0430\u0437\u0430\u049B \u0442\u0456\u043B\u0456"},kl:{name:"Kalaallisut",nativeName:"kalaallisut"},km:{name:"Khmer",nativeName:"\u1781\u17C1\u1798\u179A\u1797\u17B6\u179F\u17B6"},kn:{name:"Kannada",nativeName:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1"},ko:{name:"Korean",nativeName:"\uD55C\uAD6D\uC5B4"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"\u0915\u0936\u094D\u092E\u0940\u0930\u0940"},ku:{name:"Kurdish",nativeName:"Kurd\xEE"},kv:{name:"Komi",nativeName:"\u043A\u043E\u043C\u0438 \u043A\u044B\u0432"},kw:{name:"Cornish",nativeName:"Kernewek"},ky:{name:"Kyrgyz",nativeName:"\u041A\u044B\u0440\u0433\u044B\u0437\u0447\u0430"},la:{name:"Latin",nativeName:"latine"},lb:{name:"Luxembourgish",nativeName:"L\xEBtzebuergesch"},lg:{name:"Ganda",nativeName:"Luganda"},li:{name:"Limburgish",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Ling\xE1la"},lo:{name:"Lao",nativeName:"\u0E9E\u0EB2\u0EAA\u0EB2\u0EA5\u0EB2\u0EA7"},lt:{name:"Lithuanian",nativeName:"lietuvi\u0173 kalba"},lu:{name:"Luba-Katanga",nativeName:"Kiluba"},lv:{name:"Latvian",nativeName:"latvie\u0161u valoda"},mg:{name:"Malagasy",nativeName:"fiteny malagasy"},mh:{name:"Marshallese",nativeName:"Kajin M\u0327aje\u013C"},mi:{name:"M\u0101ori",nativeName:"te reo M\u0101ori"},mk:{name:"Macedonian",nativeName:"\u043C\u0430\u043A\u0435\u0434\u043E\u043D\u0441\u043A\u0438 \u0458\u0430\u0437\u0438\u043A"},ml:{name:"Malayalam",nativeName:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02"},mn:{name:"Mongolian",nativeName:"\u041C\u043E\u043D\u0433\u043E\u043B \u0445\u044D\u043B"},mr:{name:"Marathi",nativeName:"\u092E\u0930\u093E\u0920\u0940"},ms:{name:"Malay",nativeName:"Bahasa Melayu"},mt:{name:"Maltese",nativeName:"Malti"},my:{name:"Burmese",nativeName:"\u1017\u1019\u102C\u1005\u102C"},na:{name:"Nauru",nativeName:"Dorerin Naoero"},nb:{name:"Norwegian Bokm\xE5l",nativeName:"Norsk bokm\xE5l"},nd:{name:"Northern Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"\u0928\u0947\u092A\u093E\u0932\u0940"},ng:{name:"Ndonga",nativeName:"Owambo"},nl:{name:"Dutch",nativeName:"Nederlands"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},nr:{name:"Southern Ndebele",nativeName:"isiNdebele"},nv:{name:"Navajo",nativeName:"Din\xE9 bizaad"},ny:{name:"Chichewa",nativeName:"chiChe\u0175a"},oc:{name:"Occitan",nativeName:"occitan"},oj:{name:"Ojibwe",nativeName:"\u140A\u14C2\u1511\u14C8\u142F\u14A7\u140E\u14D0"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"\u0B13\u0B21\u0B3C\u0B3F\u0B06"},os:{name:"Ossetian",nativeName:"\u0438\u0440\u043E\u043D \xE6\u0432\u0437\u0430\u0433"},pa:{name:"Panjabi",nativeName:"\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40"},pi:{name:"P\u0101li",nativeName:"\u092A\u093E\u0934\u093F"},pl:{name:"Polish",nativeName:"Polski"},ps:{name:"Pashto",nativeName:"\u067E\u069A\u062A\u0648"},pt:{name:"Portuguese",nativeName:"Portugu\xEAs"},qu:{name:"Quechua",nativeName:"Runa Simi"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"Ikirundi"},ro:{name:"Romanian",nativeName:"Rom\xE2n\u0103"},ru:{name:"Russian",nativeName:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},sa:{name:"Sanskrit",nativeName:"\u0938\u0902\u0938\u094D\u0915\u0943\u0924\u092E\u094D"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"\u0938\u093F\u0928\u094D\u0927\u0940"},se:{name:"Northern Sami",nativeName:"Davvis\xE1megiella"},sg:{name:"Sango",nativeName:"y\xE2ng\xE2 t\xEE s\xE4ng\xF6"},si:{name:"Sinhala",nativeName:"\u0DC3\u0DD2\u0D82\u0DC4\u0DBD"},sk:{name:"Slovak",nativeName:"sloven\u010Dina"},sl:{name:"Slovenian",nativeName:"sloven\u0161\u010Dina"},sm:{name:"Samoan",nativeName:"gagana fa'a Samoa"},sn:{name:"Shona",nativeName:"chiShona"},so:{name:"Somali",nativeName:"Soomaaliga"},sq:{name:"Albanian",nativeName:"Shqip"},sr:{name:"Serbian",nativeName:"\u0441\u0440\u043F\u0441\u043A\u0438 \u0458\u0435\u0437\u0438\u043A"},ss:{name:"Swati",nativeName:"SiSwati"},st:{name:"Southern Sotho",nativeName:"Sesotho"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sv:{name:"Swedish",nativeName:"Svenska"},sw:{name:"Swahili",nativeName:"Kiswahili"},ta:{name:"Tamil",nativeName:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD"},te:{name:"Telugu",nativeName:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41"},tg:{name:"Tajik",nativeName:"\u0442\u043E\u04B7\u0438\u043A\u04E3"},th:{name:"Thai",nativeName:"\u0E44\u0E17\u0E22"},ti:{name:"Tigrinya",nativeName:"\u1275\u130D\u122D\u129B"},tk:{name:"Turkmen",nativeName:"T\xFCrkmen\xE7e"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"T\xFCrk\xE7e"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"\u0442\u0430\u0442\u0430\u0440 \u0442\u0435\u043B\u0435"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uyghur",nativeName:"\u0626\u06C7\u064A\u063A\u06C7\u0631\u0686\u06D5\u200E"},uk:{name:"Ukrainian",nativeName:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430"},ur:{name:"Urdu",nativeName:"\u0627\u0631\u062F\u0648"},uz:{name:"Uzbek",nativeName:"\u040E\u0437\u0431\u0435\u043A"},ve:{name:"Venda",nativeName:"Tshiven\u1E13a"},vi:{name:"Vietnamese",nativeName:"Ti\u1EBFng Vi\u1EC7t"},vo:{name:"Volap\xFCk",nativeName:"Volap\xFCk"},wa:{name:"Walloon",nativeName:"walon"},wo:{name:"Wolof",nativeName:"Wollof"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"\u05D9\u05D9\u05B4\u05D3\u05D9\u05E9"},yo:{name:"Yoruba",nativeName:"Yor\xF9b\xE1"},za:{name:"Zhuang",nativeName:"Sa\u026F cue\u014B\u0185"},zh:{name:"Chinese",nativeName:"\u4E2D\u6587"},zu:{name:"Zulu",nativeName:"isiZulu"}},_r=ws;var or=class{static getLanguages(he=[]){return he.map(re=>({code:re,name:or.getName(re),nativeName:or.getNativeName(re)}))}static getName(he){return or.validate(he)?_r[he].name:""}static getAllNames(){return Object.values(_r).map(he=>he.name)}static getNativeName(he){return or.validate(he)?_r[he].nativeName:""}static getAllNativeNames(){return Object.values(_r).map(he=>he.nativeName)}static getCode(he){return Object.keys(_r).find(ce=>{let V=_r[ce];return V.name.toLowerCase()===he.toLowerCase()||V.nativeName.toLowerCase()===he.toLowerCase()})||""}static getAllCodes(){return Object.keys(_r)}static validate(he){return _r.hasOwnProperty(he)}};var Wr=require("obsidian"),ka=ir(ja());var Wa=ne=>{let{basename:he,parent:re}=ne,ce=re.children.filter(V=>{if(!(V instanceof Wr.TFile))return!1;let v=V.extension==="srt"||V.extension==="vtt",e=V.basename.startsWith(he);return v&&e});if(ce.length>1&&(ce=ce.filter(V=>{let v=V.basename.slice(he.length);return v.startsWith(".")&&or.validate(v.substring(1))})),ce.length===0)return null;{let V=ce.filter(v=>v.extension==="vtt").map(v=>v.basename);for(let v=ce.length-1;v>=0;v--){let e=ce[v];e.extension===".srt"&&V.includes(e.basename)&&ce.splice(v,1)}return console.log("found subtitle(s): %o",ce.map(v=>v.name)),ce}},Ks=(ne,he)=>wt(void 0,null,function*(){let re=yield he.read(ne);return new ka.default(new Blob([re])).getURL()}),js=(ne,he)=>wt(void 0,null,function*(){let re=new Blob([yield he.read(ne)],{type:"text/vtt"});return URL.createObjectURL(re)}),Ha=(ne,he)=>wt(void 0,null,function*(){let re=new Map;for(let v of ne){let e,p;if(typeof v=="string")if((p=he.getAbstractFileByPath(v))&&p instanceof Wr.TFile)e=p;else{console.warn("no subFile found for path: %s",v);continue}else e=v;e.extension==="srt"?re.set(e,yield Ks(e,he)):re.set(e,yield js(e,he))}let ce=[],V=[];for(let v of re.keys()){let e=v.basename.split(".").pop(),p=null,l=null;if(re.size>1){if(!e||!or.validate(e))throw new Error("languageCode unable to parse, problem with getSubtitles()? ");p=or.getNativeName(e),l=e}let o={kind:"captions",label:p!=null?p:"default",srcLang:l!=null?l:void 0,src:re.get(v)},i=createEl("track",{attr:{kind:"captions",label:p,srclang:l,src:re.get(v)}},E=>{navigator.language.substring(0,2)===e&&E.setAttr("default","")});V.push(i),ce.push(o)}return{objUrls:[...re.values()],trackEls:V,tracks:ce}}),tn=class extends Wr.MarkdownRenderChild{constructor(re,ce,V){super(re);this.objectUrls=V!=null?V:[],this.player=ce}unload(){this.objectUrls&&this.objectUrls.forEach(re=>URL.revokeObjectURL(re)),this.player.destroy()}};var Tr=(ce=>(ce[ce.youtube=0]="youtube",ce[ce.bili=1]="bili",ce[ce.vimeo=2]="vimeo",ce))(Tr||{}),rn=new Map([["audio",["mp3","wav","m4a","ogg","3gp","flac"]],["video",["mp4","ogv"]],["media",["webm"]]]),ks=ne=>{let he=/\.[^/]+?$/,re,ce;if(ne instanceof URL)re=ne.pathname,ce=(0,Mn.parse)(ne.search);else{let V=(0,Ga.default)(ne,!1);re=V.pathname,ce=(0,Mn.parse)(V.query)}return he.test(re)?re:re==="/api"&&ce.raw==="true"&&typeof ce.path=="string"&&he.test(ce.path)?ce.path:null},Pn=ne=>{let he=null;if(ne instanceof mr.TFile)he=ne.extension;else{let ce=ks(ne);ce&&(he=ce.split(".").pop())}if(!he)return null;let re=null;for(let[ce,V]of rn)V.includes(he)&&(re=ce);return re},Zt=ne=>Array.isArray(ne.subtitles),Ar=ne=>!Zt(ne)&&!qt(ne),qt=ne=>ne.host!==void 0&&ne.id!==void 0,hr=(...ne)=>wt(void 0,null,function*(){var V;let[he,re]=ne;if(typeof he=="string")try{he=new URL(he)}catch(v){return null}let ce=Pn(he);if(ce){if(he instanceof mr.TFile){re?re.startsWith("#")||(re="#"+re):re="";let e=Wa(he);return{type:ce,filename:he.name,src:he.path,subtitles:e?e.map(p=>p.path):[],hash:re,updateTrackInfo:Dn,getSrcFile:In}}let v=(V=decodeURI(he.pathname).split("/").pop())!=null?V:"";return{type:ce,filename:decodeURI(v),src:he,hash:he.hash}}else if(he instanceof mr.TFile)return null;switch(he.hostname){case"b23.tv":try{if(!mr.Platform.isDesktopApp)return null;let p=yield ra(he.pathname.split("/")[1]);he=new URL(p)}catch(p){return console.error(p),null}case"www.bilibili.com":if(he.pathname.startsWith("/video")){let p=he.pathname.replace("/video/",""),l;if(/^bv/i.test(p))l=`?bvid=${p}`;else if(/^av/i.test(p))p=p.substring(2),l=`?aid=${p}`;else return console.log(`invaild video id: ${p}`),null;let o=he.searchParams.get("p");return o&&(l+=`&page=${o}`),{host:1,id:p,src:he,iframe:new URL(`https://player.bilibili.com/player.html${l}&high_quality=1&danmaku=0`),hash:he.hash}}else return console.log("bilibili video url not supported or invalid"),null;break;case"youtube.com":case"www.youtube.com":case"youtu.be":if(he.pathname==="/watch"){let p=he.searchParams.get("v");return p?{host:0,id:p,iframe:new URL(`https://www.youtube.com/embed/${p}`),src:he,hash:he.hash}:(console.log(`invalid video id: ${he.toString()}`),null)}else if(he.host==="youtu.be")if(/^\/[^\/]+$/.test(he.pathname)){let p=he.pathname.substring(1);return{host:0,id:p,iframe:new URL(`https://www.youtube.com/embed/${p}`),src:he,hash:he.hash}}else return console.log(`invalid video id: ${he.toString()}`),null;else return console.log("youtube video url not supported or invalid"),null;break;case"vimeo.com":let v=he.pathname,e;if(e=v.match(/^\/(\d+)$/)){let p=e[1];return{host:2,id:p,iframe:new URL(`https://player.vimeo.com/video/${p}`),src:he,hash:he.hash}}else return console.log("vimeo video url not supported or invalid"),null;default:return null}}),Or=(...ne)=>{let[he,re]=ne;if(Zt(he)){if(!re)throw new Error("vault not provided");let{src:ce,hash:V}=he,v=re.getAbstractFileByPath(ce);if(v&&v instanceof mr.TFile){let e=re.getResourcePath(v);return new URL(e+V)}else throw new Error("no file found for path: "+ce)}else{let{src:ce}=he;return ce.protocol==="file:"?new URL(ce.href.replace(/^file:\/\/\//,"app://local/")):ce}},nn=(ne,he,re,ce)=>wt(void 0,null,function*(){if(he==="internal"){let V=ne instanceof HTMLAnchorElement?ne.dataset.href:ne.getAttr("src");if(!V)return console.error("no linktext in internal embed: %o, escaping",ne),null;let{subpath:v,path:e}=(0,mr.parseLinktext)(V),p=re.metadataCache.getFirstLinkpathDest(e,ce.sourcePath);return p?hr(p,v):null}else{let V=ne instanceof HTMLAnchorElement?ne.href:ne.getAttr("src");return V?hr(V):(console.info("fail to get embed src: %o, escaping",ne),null)}});function Dn(ne){return wt(this,null,function*(){if(this.subtitles.length>0){let he=yield Ha(this.subtitles,ne);return this.trackInfo=he,he}else return null})}function In(ne){let he=ne.getAbstractFileByPath(this.src);if(he&&he instanceof mr.TFile)return he;throw new Error("src file not found for path: "+this.src)}var Va=ir(jr());var Ws='<svg aria-hidden="true" focusable="false"> <svg id="plyr-play" viewBox="0 0 18 18"><path d="M15.562 8.1L3.87.225c-.818-.562-1.87 0-1.87.9v15.75c0 .9 1.052 1.462 1.87.9L15.563 9.9c.584-.45.584-1.35 0-1.8z"></path></svg></svg ><span class="plyr__sr-only">Play</span>',Ya=(ne,he,re)=>wt(void 0,null,function*(){let ce=yield Hs(ne),V=createDiv({cls:["placeholder","plyr plyr--full-ui plyr--video"]});return ce&&(V.style.backgroundImage=`url("${ce}")`),kr(V,he,16/9),V.createEl("button",{cls:"plyr__control plyr__control--overlaid",attr:{type:"button","data-plyr":"play","aria-label":"Play"}},v=>{v.innerHTML=Ws,v.onClickEvent(()=>wt(void 0,null,function*(){return V.replaceWith(yield re())}))}),V}),Hs=ne=>wt(void 0,null,function*(){let{id:he}=ne;switch(ne.host){case 0:return`https://i.ytimg.com/vi/${he}/maxresdefault.jpg`;case 1:return null;case 2:return yield Gs(ne.src);default:(0,Va.default)(ne.host)}}),Gs=ne=>wt(void 0,null,function*(){let he=new URL("https://vimeo.com/api/oembed.json");return typeof ne=="string"?he.searchParams.append("url",ne):he.searchParams.append("url",ne.href),fetch(he.href).then(re=>{if(re.ok)return re.json();throw new Error(re.statusText)}).then(re=>{var ce;return(ce=re.thumbnail_url)!=null?ce:null}).catch(re=>(console.error(re),null))});var yl=ir(za()),ei=ir(jr());function br(ne,he){let re=Object.keys(he).map(ce=>Vs(ne,ce,he[ce]));return re.length===1?re[0]:function(){re.forEach(ce=>ce())}}function Vs(ne,he,re){let ce=ne[he],V=ne.hasOwnProperty(he),v=re(ce);return ce&&Object.setPrototypeOf(v,ce),Object.setPrototypeOf(e,v),ne[he]=e,p;function e(...l){return v===ce&&ne[he]===e&&p(),v.apply(this,l)}function p(){ne[he]===e&&(V?ne[he]=ce:delete ne[he]),v!==ce&&(v=ce,Object.setPrototypeOf(e,ce||Function))}}var ti=ir(Xa()),ri=ir(qr());var er=require("obsidian");var Qa=new Map([["restart",['<svg aria-hidden="true" focusable="false" id="plyr-restart" viewBox="0 0 18 18"><path d="M9.7 1.2l.7 6.4 2.1-2.1c1.9 1.9 1.9 5.1 0 7-.9 1-2.2 1.5-3.5 1.5-1.3 0-2.6-.5-3.5-1.5-1.9-1.9-1.9-5.1 0-7 .6-.6 1.4-1.1 2.3-1.3l-.6-1.9C6 2.6 4.9 3.2 4 4.1 1.3 6.8 1.3 11.2 4 14c1.3 1.3 3.1 2 4.9 2 1.9 0 3.6-.7 4.9-2 2.7-2.7 2.7-7.1 0-9.9L16 1.9l-6.3-.7z"></path></svg>',"Restart"]],["rewind",['<svg aria-hidden="true" focusable="false" id="plyr-rewind" viewBox="0 0 18 18"><path d="M10.125 1L0 9l10.125 8v-6.171L18 17V1l-7.875 6.171z"></path></svg>',"Rewind"]],["play",['<svg aria-hidden="true" focusable="false" id="plyr-play" viewBox="0 0 18 18"><path d="M15.562 8.1L3.87.225c-.818-.562-1.87 0-1.87.9v15.75c0 .9 1.052 1.462 1.87.9L15.563 9.9c.584-.45.584-1.35 0-1.8z"></path></svg>',"Play/Pause"]],["fast-forward",['<svg aria-hidden="true" focusable="false" id="plyr-fast-forward" viewBox="0 0 18 18"><path d="M7.875 7.171L0 1v16l7.875-6.171V17L18 9 7.875 1z"></path></svg>',"Fast forward"]],["mute",['<svg aria-hidden="true" focusable="false" id="plyr-muted" viewBox="0 0 18 18"><path d="M12.4 12.5l2.1-2.1 2.1 2.1 1.4-1.4L15.9 9 18 6.9l-1.4-1.4-2.1 2.1-2.1-2.1L11 6.9 13.1 9 11 11.1zM3.786 6.008H.714C.286 6.008 0 6.31 0 6.76v4.512c0 .452.286.752.714.752h3.072l4.071 3.858c.5.3 1.143 0 1.143-.602V2.752c0-.601-.643-.977-1.143-.601L3.786 6.008z"></path></svg>',"Mute"]],["volume",['<svg aria-hidden="true" focusable="false" id="plyr-volume" viewBox="0 0 18 18"><path d="M15.6 3.3c-.4-.4-1-.4-1.4 0-.4.4-.4 1 0 1.4C15.4 5.9 16 7.4 16 9c0 1.6-.6 3.1-1.8 4.3-.4.4-.4 1 0 1.4.2.2.5.3.7.3.3 0 .5-.1.7-.3C17.1 13.2 18 11.2 18 9s-.9-4.2-2.4-5.7z"></path><path d="M11.282 5.282a.909.909 0 000 1.316c.735.735.995 1.458.995 2.402 0 .936-.425 1.917-.995 2.487a.909.909 0 000 1.316c.145.145.636.262 1.018.156a.725.725 0 00.298-.156C13.773 11.733 14.13 10.16 14.13 9c0-.17-.002-.34-.011-.51-.053-.992-.319-2.005-1.522-3.208a.909.909 0 00-1.316 0zm-7.496.726H.714C.286 6.008 0 6.31 0 6.76v4.512c0 .452.286.752.714.752h3.072l4.071 3.858c.5.3 1.143 0 1.143-.602V2.752c0-.601-.643-.977-1.143-.601L3.786 6.008z"></path></svg>',"Volume bar"]],["captions",['<svg aria-hidden="true" focusable="false" id="plyr-captions-on" viewBox="0 0 18 18"><path d="M1 1c-.6 0-1 .4-1 1v11c0 .6.4 1 1 1h4.6l2.7 2.7c.2.2.4.3.7.3.3 0 .5-.1.7-.3l2.7-2.7H17c.6 0 1-.4 1-1V2c0-.6-.4-1-1-1H1zm4.52 10.15c1.99 0 3.01-1.32 3.28-2.41l-1.29-.39c-.19.66-.78 1.45-1.99 1.45-1.14 0-2.2-.83-2.2-2.34 0-1.61 1.12-2.37 2.18-2.37 1.23 0 1.78.75 1.95 1.43l1.3-.41C8.47 4.96 7.46 3.76 5.5 3.76c-1.9 0-3.61 1.44-3.61 3.7 0 2.26 1.65 3.69 3.63 3.69zm7.57 0c1.99 0 3.01-1.32 3.28-2.41l-1.29-.39c-.19.66-.78 1.45-1.99 1.45-1.14 0-2.2-.83-2.2-2.34 0-1.61 1.12-2.37 2.18-2.37 1.23 0 1.78.75 1.95 1.43l1.3-.41c-.28-1.15-1.29-2.35-3.25-2.35-1.9 0-3.61 1.44-3.61 3.7 0 2.26 1.65 3.69 3.63 3.69z" fill-rule="evenodd"></path></svg>',"Caption"]],["settings",['<svg aria-hidden="true" focusable="false" id="plyr-settings" viewBox="0 0 18 18"><path d="M16.135 7.784a2 2 0 01-1.23-2.969c.322-.536.225-.998-.094-1.316l-.31-.31c-.318-.318-.78-.415-1.316-.094a2 2 0 01-2.969-1.23C10.065 1.258 9.669 1 9.219 1h-.438c-.45 0-.845.258-.997.865a2 2 0 01-2.969 1.23c-.536-.322-.999-.225-1.317.093l-.31.31c-.318.318-.415.781-.093 1.317a2 2 0 01-1.23 2.969C1.26 7.935 1 8.33 1 8.781v.438c0 .45.258.845.865.997a2 2 0 011.23 2.969c-.322.536-.225.998.094 1.316l.31.31c.319.319.782.415 1.316.094a2 2 0 012.969 1.23c.151.607.547.865.997.865h.438c.45 0 .845-.258.997-.865a2 2 0 012.969-1.23c.535.321.997.225 1.316-.094l.31-.31c.318-.318.415-.781.094-1.316a2 2 0 011.23-2.969c.607-.151.865-.547.865-.997v-.438c0-.451-.26-.846-.865-.997zM9 12a3 3 0 110-6 3 3 0 010 6z"></path></svg>',"Control speed/ select captions..."]],["pip",['<svg aria-hidden="true" focusable="false" id="plyr-settings" viewBox="0 0 18 18"><path d="M16.135 7.784a2 2 0 01-1.23-2.969c.322-.536.225-.998-.094-1.316l-.31-.31c-.318-.318-.78-.415-1.316-.094a2 2 0 01-2.969-1.23C10.065 1.258 9.669 1 9.219 1h-.438c-.45 0-.845.258-.997.865a2 2 0 01-2.969 1.23c-.536-.322-.999-.225-1.317.093l-.31.31c-.318.318-.415.781-.093 1.317a2 2 0 01-1.23 2.969C1.26 7.935 1 8.33 1 8.781v.438c0 .45.258.845.865.997a2 2 0 011.23 2.969c-.322.536-.225.998.094 1.316l.31.31c.319.319.782.415 1.316.094a2 2 0 012.969 1.23c.151.607.547.865.997.865h.438c.45 0 .845-.258.997-.865a2 2 0 012.969-1.23c.535.321.997.225 1.316-.094l.31-.31c.318-.318.415-.781.094-1.316a2 2 0 011.23-2.969c.607-.151.865-.547.865-.997v-.438c0-.451-.26-.846-.865-.997zM9 12a3 3 0 110-6 3 3 0 010 6z"></path></svg>',"Picture-in-Picture"]],["fullscreen",['<svg aria-hidden="true" focusable="false" id="plyr-enter-fullscreen" viewBox="0 0 18 18"><path d="M10 3h3.6l-4 4L11 8.4l4-4V8h2V1h-7zM7 9.6l-4 4V10H1v7h7v-2H4.4l4-4z"></path></svg>',"Fullscreen"]],["current-time",["current-time","Current time"]],["duration",["duration","Duration"]]]),Nn=(ne,he,re)=>createEl("button",Jt({cls:["plyr__control"],type:"button",attr:{"aria-label":ne}},he),re),Ys=(ne,he,re,ce)=>{let V=Qa.get(ne);if(!V)throw new Error("Invaild id");return Nn(he,re,v=>{v.insertAdjacentHTML("beforeend",V[0]),ce&&ce(v)})},sn=class{constructor(he,re){this.buttonMap=new WeakMap;this.plugin=re,this.containerEl=he,this.regularContainer=this.containerEl.createDiv({cls:"plyr-controls-settings plyr__controls"}),this.progressContainer=this.containerEl.createDiv({cls:"plyr-controls-settings plyr__controls plyr-progress-setting"},ce=>ce.createEl("input",{type:"range",attr:{disabled:!0}})),this.addControls(),this.containerEl.on("click","button",ce=>{let V,v=ce.target;if(V=this.buttonMap.get(v)){let e=!this.plyrControls[V];this.plyrControls[V]=e,this.plugin.saveSettings(),v.toggleClass("checked",e)}else console.error("unknown click target: %o",ce.target)})}get plyrControls(){return this.plugin.sizeSettings.plyrControls}addControls(){let he=(re,ce)=>re.toggleClass("checked",this.plyrControls[ce]);Qa.forEach(([,re],ce)=>{ce==="current-time"?this.buttonMap.set(this.progressContainer.appendChild(Nn(re,{cls:"plyr__controls__item plyr__time--current plyr__time",text:"05:00"},V=>he(V,ce))),"current-time"):ce==="duration"?this.buttonMap.set(this.progressContainer.appendChild(Nn(re,{cls:"plyr__controls__item plyr__time--duration plyr__time",text:"10:00"},V=>he(V,ce))),ce):this.buttonMap.set(this.regularContainer.appendChild(Ys(ce,re,{},V=>he(V,ce))),ce)})}};var wn="alx-hide-ytb-recomm",$a={mediaFragmentsEmbed:!0,timestampLink:!0,extendedImageEmbedSyntax:!0,thumbnailPlaceholder:!1,useYoutubeControls:!1,interalBiliPlayback:!0,hideYtbRecomm:!1,embedMaxHeight:"30vh",embedMinWidth:"400px",plyrControls:{restart:!1,rewind:!1,play:!0,"fast-forward":!1,progress:!0,"current-time":!0,duration:!0,mute:!1,volume:!0,captions:!0,settings:!0,pip:!1,fullscreen:!0},embedMaxHeightMobile:"20vh",embedMinWidthMobile:"200px",plyrControlsMobile:{restart:!1,rewind:!1,play:!0,"fast-forward":!1,progress:!0,"current-time":!1,duration:!1,mute:!1,volume:!0,captions:!0,settings:!0,pip:!1,fullscreen:!0},timestampTemplate:`
{{TIMESTAMP}}
`,timestampOffset:0,hideEmbedControls:!1},Ja=ne=>[...Object.entries(ne)].filter(he=>he[1]).map(he=>he[0]),on=class extends er.PluginSettingTab{constructor(re,ce){super(re,ce);this.setToggle=({k:re,name:ce,desc:V},v)=>{let{settings:e}=this.plugin;new er.Setting(this.containerEl).setName(ce).setDesc(typeof V=="string"?V:createFragment(V)).addToggle(p=>{let l=e[re];if(typeof l=="boolean")p.setValue(l).onChange(o=>wt(this,null,function*(){v&&v(o),e[re]=o,this.plugin.saveData(e),this.display()}));else throw new TypeError("toggle not boolean")})};this.plugin=ce}display(){let{containerEl:re}=this;re.empty(),this.general(),this.noteTaking(),this.player(),this.ytb(),this.bili()}general(){let{containerEl:re}=this,{setToggle:ce}=this;re.createEl("h2",{text:"General"}),ce({k:"mediaFragmentsEmbed",name:"Embed Media Fragments",desc:V=>{V.appendText("If enabled, you can write ![[demo.mp4#t=10]] to embed the specific fragment of video/audio. "),V.createEl("br"),V.appendText("Loop is also available by appending #loop or #t=...&loop to filename"),V.createEl("br"),V.appendText("Restart the app to take effects")}}),ce({k:"timestampLink",name:"Timestamps for Media",desc:V=>{V.appendText("If enabled, you can write [[demo.mp4#t=10]] to create timestamp link to the video/audio. Click on the link would open the media file if it's not opened yet. "),V.createEl("br"),V.appendText("PS: Only works in preview mode, hover preview on link is not available"),V.createEl("br"),V.appendText("Restart the app to take effects")}}),ce({k:"extendedImageEmbedSyntax",name:"Extended Image Embed Syntax",desc:V=>{V.appendText("If enabled, you can write ![](link/to/demo.mp4) to embed video and audio."),V.createEl("br"),V.appendText("Timestamps and fragments are also available"),V.createEl("br"),V.appendText("Support direct file links (local/remote) and videos from video hosts (Youtube, bilibili...)"),V.createEl("br"),V.appendText("Restart the app to take effects")}})}player(){let{containerEl:re}=this,{setToggle:ce}=this;re.createEl("h2",{text:"Player"}),ce({k:"thumbnailPlaceholder",name:"Placeholder in favor of full player",desc:v=>{v.appendText("If enabled, thumbnail placeholder will be used in favor of full player when page loads"),v.createEl("br"),v.appendText("Works with for Youtube/Vimeo/bilibili embeds"),v.createEl("br"),v.appendText("Helpful when numerous video from Youtube/Vimeo/... is embeded in one single file"),v.createEl("br"),v.appendText("Restart the app to take effects")}}),ce({k:"hideEmbedControls",name:"Hide Embed Controls By Default",desc:v=>{v.appendText("If enabled, embeds are rendered similar to images with all controls hidden, click on embeds to play/pause"),v.createEl("br"),v.appendText("You can still enable controls manually by append #controls to link"),v.createEl("br"),v.appendText("Restart the app to take effects")}});let V=new er.Setting(re).setName("Plyr Controls").setDesc(createFragment(v=>{v.appendText("Show or hide certain plyr controls"),v.createEl("br"),v.appendText("Restart the app to take effects")}));new sn(V.settingEl.createDiv({cls:"plyr-ctrls-container"}),this.plugin),new er.Setting(re).setName("Maximum Player Height for Embeds").setDesc("Reload app to take effects").addText(v=>{let e=(0,er.debounce)(p=>wt(this,null,function*(){return yield this.plugin.setSizeSettings({embedMaxHeight:p})}),500,!0);v.setValue(this.plugin.sizeSettings.embedMaxHeight).onChange(p=>wt(this,null,function*(){v.inputEl.toggleClass("incorrect",!yr(p)),yr(p)&&e(p)}))}),new er.Setting(re).setName("Minimum Player Width for Embeds").addText(v=>{let e=(0,er.debounce)(p=>wt(this,null,function*(){this.plugin.setEmbedMinWidth(p),yield this.plugin.setSizeSettings({embedMinWidth:p})}),500,!0);v.setValue(this.plugin.sizeSettings.embedMinWidth).onChange(p=>wt(this,null,function*(){v.inputEl.toggleClass("incorrect",!yr(p)),yr(p)&&e(p)}))})}noteTaking(){let{containerEl:re}=this;re.createEl("h2",{text:"Note Taking"}),new er.Setting(re).setName("Timestamp Template").setDesc(createFragment(ce=>{ce.appendText("The template used to insert timestamps."),ce.createEl("br"),ce.appendText("Supported placeholders: {{TIMESTAMP}}")})).addTextArea(ce=>{let V=v=>wt(this,null,function*(){this.plugin.settings.timestampTemplate=v,yield this.plugin.saveSettings()});ce.setValue(this.plugin.settings.timestampTemplate).onChange((0,er.debounce)(V,500,!0)),ce.inputEl.rows=5,ce.inputEl.cols=20}),new er.Setting(re).setName("Timestamp Offset").setDesc(createFragment(ce=>{ce.appendText("Amount of seconds to offset timestamps."),ce.createEl("br"),ce.appendText("Set postive value to offset time backward, vice versa")})).addText(ce=>{let V=(0,er.debounce)(v=>wt(this,null,function*(){this.plugin.settings.timestampOffset=Number(v),yield this.plugin.saveSettings()}),500,!0);ce.setValue(String(this.plugin.settings.timestampOffset)).onChange(v=>wt(this,null,function*(){ce.inputEl.toggleClass("incorrect",isNaN(Number(v))),isNaN(Number(v))||V(v)}))})}ytb(){let{containerEl:re}=this,{setToggle:ce}=this;re.createEl("h2",{text:"Youtube"}),ce({k:"useYoutubeControls",name:"Use Youtube Built-in Controls",desc:V=>{V.appendText("If enabled, Youtube's built-in Controls will be used in favor of Plyr controls"),V.createEl("br"),V.appendText("Useful when need access to CC (Closed Captioning) and chapters progress bar"),V.createEl("br"),V.appendText("Restart the app to take effects")}}),this.plugin.settings.useYoutubeControls||ce({k:"hideYtbRecomm",name:"Hide Recommend Videos",desc:"Blur on pause to hide annoying recommend videos, ignored when Youtube Built-in Controls enabled"},V=>document.body.toggleClass(wn,V))}bili(){let{containerEl:re}=this;re.createEl("h2",{text:"bilibili"});let ce=new er.Setting(re).setName("\u9AD8\u7EA7bilibili\u652F\u6301").setDesc(createFragment(V=>{V.appendText("\u66FF\u4EE3\u5D4C\u5165\u5F0Fiframe\u64AD\u653E\u5668\uFF0C\u652F\u6301\u65F6\u95F4\u6233\u3001\u64AD\u653E1080p\u89C6\u9891\u7B49"),V.createEl("br"),this.app.isMobile?V.appendText("\u79FB\u52A8\u7248\u5C1A\u4E0D\u652F\u6301"):fr(this.app)||(V.appendText("BiliBili Plugin\u5C1A\u672A\u542F\u7528\uFF0C"),V.createEl("a",{href:"https://github.com/aidenlx/mx-bili-plugin",text:"\u70B9\u6B64\u4E0B\u8F7D"}))}));!this.app.isMobile&&fr(this.app)&&(ce.addToggle(V=>{let{settings:v}=this.plugin;V.setValue(v.interalBiliPlayback).onChange(e=>wt(this,null,function*(){v.interalBiliPlayback=e,this.plugin.saveData(v),this.display()}))}),aa(this.app)(re))}};var Za=ir(qr());var un={tFrag:new RegExp("^(?<start>[\\w:\\.]*?)(?:,(?<end>[\\w:\\.]+?))?$"),npt_sec:/^\d+(?:\.\d+)?$/,npt_mmss:new RegExp("^(?<mm>[0-5]\\d):(?<ss>[0-5]\\d(?:\\.\\d+)?)$"),npt_hhmmss:new RegExp("^(?<hh>\\d+):(?<mm>[0-5]\\d):(?<ss>[0-5]\\d(?:\\.\\d+)?)$")},qa=ne=>{if(ne){let re=(0,Za.parse)(ne).t,ce;if(re&&typeof re=="string"&&(ce=un.tFrag.exec(re))!==null){if(!ce.groups)throw new Error("tFragRegex match error");let{start:V,end:v}=ce.groups,e=zs(V,v);if(e)return Kr(Jt({},e),{raw:re})}}return null},zs=(ne,he)=>{let re=ne||null,ce=he!=null?he:null,V,v;if(re&&ce)V=ln(re),v=ln(ce);else if(re)V=ln(re),v=1/0;else if(ce)V=0,v=ln(ce);else throw console.error(ne,he),new Error("Missing startTime and endTime");return V===null||v===null?null:{start:V,end:v}},ln=ne=>{let he=/^(?:npt:)?([\d\.:]+)$/;if(he.test(ne)){let re=ne.match(he)[1],ce;if((ce=un.npt_sec.exec(re))!==null)return+ce[0];if((ce=un.npt_mmss.exec(re))!==null){if(!ce.groups)throw new Error("npt_mmss match error");let{mm:V,ss:v}=ce.groups;return+V*60+ +v}else if((ce=un.npt_hhmmss.exec(re))!==null){if(!ce.groups)throw new Error("npt_hhmmss match error");let{hh:V,mm:v,ss:e}=ce.groups;return+V*60*60+ +v*60+ +e}else return null}else return null};var Hr=ne=>{let he=ne?qa(ne):null,re=ne?(0,ri.parse)(ne):null,ce=v=>re?re[v]===null:!1,V=new Map([["loop","loop"],["mute","muted"],["play","autoplay"],["controls","controls"]]);return{timeSpan:he,is:v=>{if(!ne)return!1;for(let[e,p]of V)if(v===p&&ce(e))return!0;return!1},setPlayerTF:v=>{Xs(v,he)},setHashOpt:v=>V.forEach((e,p)=>{e==="controls"?v instanceof HTMLMediaElement&&ce(p)&&(v[e]=!0):ce(p)&&(v[e]=!0)})}},Xs=(ne,he)=>{let re=ne,ce=v=>{if(!re.timeSpan)return;let{timeSpan:{start:e,end:p},currentTime:l}=re;(l>p||l<e)&&(re.currentTime=e)},V=v=>{if(!re.timeSpan)return;let{timeSpan:{start:e,end:p},currentTime:l}=re;l>p&&(re.loop?(re.currentTime=e,re.paused&&re.play()):re.pause())};re.setTimeSpan=v=>{var e;re.timeSpan=v,v?(re instanceof HTMLMediaElement&&!re.onplaying?(re.onplaying=ce,re.ontimeupdate=V):(re.on("playing",ce),re.on("timeupdate",V)),re.currentTime=(e=v.start)!=null?e:0):(re instanceof HTMLMediaElement?(re.onplaying=null,re.ontimeupdate=null):(re.off("playing",ce),re.off("timeupdate",V)),re.currentTime=0)},re.setTimeSpan(he!=null?he:null)},Qs=(ne,he)=>{let re={};return ne&&ne.start!==0&&(re.youtube||(re.youtube={}),re.youtube.start=ne.start),he&&(re.youtube||(re.youtube={}),re.controls=["play-large"],re.youtube.controls=!0),re},fn=(ne,he,re)=>{let{is:ce,setHashOpt:V,setPlayerTF:v,timeSpan:e}=Hr(ne.hash),{app:p}=he,{useYoutubeControls:l}=he.settings,o=qt(ne)&&ne.host===0,i=o?Qs(e,l):null,E={invertTime:!1,controls:Ja(he.sizeSettings.plyrControls)},h=Jt(Jt({},E),i);re&&re(h),h.autoplay=ce("autoplay");let t=createDiv().appendChild(createEl("video")),g=new ti.default(t,h);if(qt(ne)&&ne.host===1){let T=ne.iframe.searchParams.has("aid")?"av"+ne.id:ne.id,P=ne.src.searchParams.get("p"),R=dashjs.MediaPlayer().create(),m=new URL("http://localhost/geturl/"+T);m.port=na(p).toString(),P&&m.searchParams.append("page",P),R.initialize(t,m.toString(),!1),br(g,{destroy(d){return function(){R.destroy(),d.call(this)}}});let f=ia(p);(()=>wt(void 0,null,function*(){let d=ne.iframe.searchParams.has("aid")?yield f(+ne.id):yield f(ne.id);d?g.poster=d:console.error("unable to fetch poster")}))()}else{let T=Js(ne,p.vault);g.source=T,g.sourceBak=T}if(V(g),v(g),Zt(ne)&&ne.subtitles.length>0){let T=g.elements.poster;T?T.addClass("visuallyhidden"):console.error("unable to find posterEl from",g.elements),g.once("ready",()=>g.toggleCaptions())}$s(ne,g);let C=Sr(g);return l&&C.classList.add("yt-controls"),o&&l&&g.on("ready",()=>wt(void 0,null,function*(){yield g.play(),g.pause()})),g},$s=(ne,he)=>{if(!qt(ne)&&ne.type==="media"&&he.isHTML5){let re=0,ce=()=>{let V=he.media;if(V&&V instanceof HTMLVideoElement)if(re===0)V.videoHeight!==0||V.videoWidth!==0?(he.off("loadedmetadata",ce),he.sourceBak.type="video"):re++;else if(he.off("loadedmetadata",ce),V.videoHeight===0&&V.videoWidth===0){he.sourceBak.type="audio",console.log("media is audio, switching...");let v=he.playing;he.source=he.sourceBak,v&&he.once("canplay",()=>he.play()),Sr(he).style.height=null}else he.sourceBak.type="video"};he.on("loadedmetadata",ce)}},Js=(ne,he)=>{if(qt(ne)){if(ne.host===1)throw new Error("Bilibili not supported in Plyr");return{type:"video",sources:[{src:ne.id,provider:Tr[ne.host]}]}}else{let re=ne.type==="media"?"video":ne.type;if(Ar(ne))return{type:re,sources:[{src:Or(ne).href}]};if(Zt(ne)){if(ne.subtitles.length>0&&ne.trackInfo===void 0)throw new Error("trackInfo not updated");return{type:re,sources:[{src:Or(ne,he).href}],tracks:ne.trackInfo?ne.trackInfo.tracks:void 0}}else(0,ei.default)(ne)}},Sr=ne=>{let he=ne.elements.container;if(he)return he;throw new Error("Plyr container null")};var Fn=(ne,he)=>{let re=he==="internal"?"span.internal-embed, div.internal-embed":"img[referrerpolicy]";return(ce,V)=>{ce.querySelectorAll(re).forEach(v=>wt(void 0,null,function*(){let e=yield nn(v,he,ne.app,V);if(!e)return;let{is:p}=Hr(e.hash),l=null,o=ne.sizeSettings.embedMaxHeight,i=h=>Zs(h,o),E=(h=!1)=>wt(void 0,null,function*(){let t;if(Zt(e)){let T=yield e.updateTrackInfo(ne.app.vault);T&&(t=T.objUrls)}let g=fn(e,ne,T=>{ne.settings.hideEmbedControls&&!p("controls")&&(T.controls=["play-large"])});i(g),h&&g.once("ready",function(T){this.play()});let C=Sr(g);return V.addChild(new tn(C,g,t)),C});if(qt(e)){let{thumbnailPlaceholder:h,interalBiliPlayback:t}=ne.settings,g=e.host===1&&(!fr(ne.app)||!t),C=h&&e.host!==1,T=()=>wt(void 0,null,function*(){return g?sa(e):yield E(C)});C&&!g?l=yield Ya(e,o,T):l=yield T()}else l=yield E();if(l){let h=v.getAttr("width");h&&(l.style.width=h+"px",l.style.minWidth="0px");let t=v.getAttr("height");t&&(l.style.height=t+"px",l.style.minHeight="0px"),v.replaceWith(l)}}))}},Zs=(ne,he)=>{if(!yr(he))throw new TypeError("maxHeight not css value");let re=Sr(ne);if(!ne.isVideo)return;let ce="mx-default-height";re.style.setProperty("--"+ce,he),ne.isHTML5?(re.addClass(ce),ne.once("canplay",()=>{let V=e=>{let[p,l]=e.split(":");if(!Number.isInteger(+p)||!Number.isInteger(+l)){console.error("invaild ratio",e);return}re.removeClass(ce),kr(re,he,+p/+l)},v=(e,p,l)=>{let o=0,i=window.setInterval(()=>{ne.isVideo?ne.ratio?(window.clearInterval(i),V(ne.ratio)):o>e?(l(),window.clearInterval(i)):o++:window.clearInterval(i)},p)};v(10,100,()=>{console.log("fail to get ratio within 1s, fallback to 16:9"),V("16:9"),v(4,1e3,()=>console.warn("no ratio for video: ",ne.source))})})):ne.once("ready",()=>{kr(re,he,16/9)})};var dn=require("obsidian");var ui=ir(jr()),fi=ir(xn());var tr=require("obsidian");var Nr="media-view",vr=class extends tr.FileView{constructor(re,ce,V){super(re);this.allowNoFile=!0;this.core=null;this.togglePip=()=>{if(!this.player)throw new Error("no media");this.player.pip=!this.player.pip};this.addToDoc=()=>{if(this.leaf.group){let re=this.app.workspace.getGroupLeaves(this.leaf.group);for(let ce of re)if(ce.view instanceof tr.MarkdownView){this.addTimeStampToMDView(ce.view);return}}else console.error("no group for leaf: %o",this.leaf)};this.addTimeStampToMDView=re=>{let ce=this.getTimeStamp();if(!ce)return;let{timestampTemplate:V}=this.plugin.settings;Zr(V.replace(/{{TIMESTAMP}}/g,ce),re)};this.plugin=ce,this.emptyEl=this.setEmpty(),this.playerEl=this.contentEl.createDiv({cls:"media-view-player"}),this.app.isMobile&&this.addAction("cross","Close",()=>this.leaf.detach()),this.controls=this.getControls();let v=br(re,{open(e){return function(p){if(this.group){if(p instanceof vr)return e.call(this,p);p instanceof tr.MarkdownView&&this.containerEl.childNodes.length==3&&this.containerEl.removeChild(this.containerEl.lastChild)}else return e.call(this,p)}}});this.register(v),this.setInfo(V!=null?V:null)}get player(){var re,ce;return(ce=(re=this.core)==null?void 0:re.player)!=null?ce:null}onLoadFile(re){return wt(this,null,function*(){let ce=yield hr(re,"");ce?this.setInfo(ce):new tr.Notice("Fail to open file")})}onRename(re){return wt(this,null,function*(){if(this.file&&this.file===re&&this.core){let{info:ce}=this.core,{currentTime:V}=this.core.player;yield this.setInfo(yield hr(re,ce.hash)),this.player&&this.player.once("canplay",function(){window.setTimeout(()=>this.currentTime=V,200)})}yn(vr.prototype,this,"onRename").call(this,re)})}onDelete(re){super.onDelete(re),this.file&&this.file===re&&this.leaf.detach()}get info(){var re,ce;return(ce=(re=this.core)==null?void 0:re.info)!=null?ce:null}setInfo(re){return wt(this,null,function*(){if(re===null)this.showEmpty(),re&&this.unloadCore(),this.file=null;else if(this.isEqual(re))this.hash=re.hash;else{this.showEmpty(!0),re&&this.unloadCore(),Zt(re)&&(this.file=re.getSrcFile(this.app.vault),yield re.updateTrackInfo(this.app.vault));let ce=fn(re,this.plugin);if(this.playerEl.appendChild(Sr(ce)),ce.isHTML5?this.showControl("pip"):this.hideControl("pip"),this.core={info:re,player:ce},this.load(),ce.isYouTube){let V=v=>{v.detail.code===1&&(this.load(),ce.off("statechange",V))};ce.on("statechange",V)}}})}showEmpty(re=!1){this.emptyEl.style.display=re?"none":null,this.playerEl.style.display=re?null:"none",re?this.showControls():this.hideControls()}getState(){let re=super.getState();return re.info=Kr(Jt({},this.info),{trackInfo:void 0}),re.currentTime=this.core?this.core.player.currentTime:0,re}setState(re,ce){return wt(this,null,function*(){let V=re.info,v=re.currentTime,e=()=>{v&&window.setTimeout(()=>{if(this.core){let{player:p}=this.core;p.once("playing",()=>{p.currentTime=v,p.pause()}),p.play()}else console.error("fail to set currentTime: media view empty")},1e3)};try{V?qt(V)?(V.src=new URL(V.src),V.iframe=new URL(V.iframe),yield this.setInfo(V),e()):Ar(V)?(V.src=new URL(V.src),yield this.setInfo(V),e()):Zt(V)?(yield this.setInfo(Kr(Jt({},V),{updateTrackInfo:Dn,getSrcFile:In})),e()):(0,ui.default)(V):V===null&&(yield this.setInfo(V))}catch(p){console.error(p),yield this.setInfo(null)}yield yn(vr.prototype,this,"setState").call(this,re,ce)})}onMoreOptionsMenu(re){let ce=V=>{let v=new Map([["0.5\xD7","0.5"],["0.75\xD7","0.75"],["Normal","1"],["1.25\xD7","1.25"],["1.5\xD7","1.5"],["1.75\xD7","1.75"],["2\xD7","2"]]),e=new tr.Menu(V);for(let[p,l]of v)e.addItem(o=>o.setTitle(p).setActive(Boolean(this.player&&this.player.speed===+l)).onClick(()=>{this.player&&(this.player.speed=+l)}));return e};re.addItem(V=>V.setTitle("Speed Control").onClick(v=>ce(this.app).showAtMouseEvent(v))),re.addSeparator(),super.onMoreOptionsMenu(re)}getControls(){return new Map([["get-timestamp",this.addAction("star","Get current Timestamp",this.addToDoc)],["pip",this.addAction("popup-open","Toggle Picture-in-Picture",this.togglePip)],["open-link",this.addAction("go-to-file","Open Media from link",()=>new Lr(this.plugin,this).open())]])}setEmpty(){let{contentEl:re}=this,ce=re.createDiv({cls:"empty-state"});return ce.createDiv({cls:"empty-state-container"},V=>{V.createDiv({cls:"empty-state-title",text:"No Media"}),V.createDiv({cls:"empty-state-action-list"},v=>{((p,l)=>{v.createDiv({cls:"empty-state-action",text:p},o=>o.onClickEvent(l))})("Open Media from Link",()=>{let p=new Lr(this.plugin,this).open()})})}),ce}get timeSpan(){var re,ce;return(ce=(re=this.player)==null?void 0:re.timeSpan)!=null?ce:null}set timeSpan(re){if(this.player)this.player.setTimeSpan(re);else throw new Error("trying to set timeSpan on empty media view")}set hash(re){if(!this.player)throw new Error("trying to set timeSpan on empty media view");let{timeSpan:ce,is:V}=Hr(re);this.player.setTimeSpan(ce),this.player.autoplay=V("autoplay"),this.player.loop=V("loop"),this.player.muted=V("muted")}unloadCore(){if(this.core){let{info:re,player:ce}=this.core;Zt(re)&&re.trackInfo&&re.trackInfo.objUrls.forEach(V=>URL.revokeObjectURL(V)),ce.pip&&(ce.pip=!1),ce.destroy(),this.updatePlayerEl(),this.core=null}else console.warn("core already destoryed")}updatePlayerEl(){let re=createDiv({cls:"media-view-player"});this.playerEl.replaceWith(re),this.playerEl=re}unload(){this.unloadCore()}getViewType(){return Nr}getDisplayText(){let re=ce=>{let V=ce.split(".");return V.pop(),V.join(".")};if(this.core){let{info:ce,player:V}=this.core;if(Zt(ce)||Ar(ce))return re(ce.filename);if(ce.host===0||ce.host===2){let v=()=>{var p;return(p=V==null?void 0:V.config)==null?void 0:p.title},e;if(e=v())return e;{let p=0,l=window.setInterval(()=>{let o=v();o&&this.load(),(o||p>10)&&window.clearInterval(l),p++},200)}}return Tr[ce.host]+": "+ce.id}else return""}isEqual(re){return this.info===null?!1:Zt(re)&&Zt(this.info)?re.src===this.info.src:Ar(re)&&Ar(this.info)?Jr(Or(re))===Jr(Or(this.info)):qt(re)&&qt(this.info)?re.host===this.info.host&&re.id===this.info.id&&!(re.host===1&&re.src.searchParams.get("p")!==this.info.src.searchParams.get("p")):!1}getTimeStamp(re){if(!this.info)return null;if(!this.player)throw new Error("no media");let ce=this.player.currentTime,{timestampOffset:V}=this.plugin.settings,v=ce-V;ce-V<0?v=0:ce-V>this.player.duration&&(v=this.player.duration);let e=fi.default.fromS(v,"hh:mm:ss").replace(/^00:/g,"");return Zt(this.info)?`[[${this.app.metadataCache.fileToLinktext(this.info.getSrcFile(this.app.vault),re!=null?re:"",!0)}#t=${e}]]`:`[${e.replace(/\.\d+$/,"")}](${Jr(this.info.src)}#t=${v})`}showControls(){this.controls.forEach(re=>{re.style.display==="none"&&(re.style.display=null)})}showControl(re){let ce=this.controls.get(re);ce?ce.style.display==="none"&&(ce.style.display=""):console.error(`control named ${re} not found in %o`,this.controls)}hideControls(){this.controls.forEach(re=>re.style.display="none")}hideControl(re){let ce=this.controls.get(re);ce?ce.style.display="none":console.error(`control named ${re} not found in %o`,this.controls)}},Lr=class extends tr.Modal{constructor(re,ce){super(re.app);this.view=ce,this.plugin=re}onOpen(){let{contentEl:re,titleEl:ce,modalEl:V}=this;ce.setText("Enter Link to Media");let v=re.createEl("input",{type:"text"},e=>e.style.width="100%");V.createDiv({cls:"modal-button-container"},e=>{e.createEl("button",{cls:"mod-cta",text:"Open"},p=>p.onClickEvent(()=>wt(this,null,function*(){var o;let l=yield hr(v.value);l?this.view?(yield this.view.setInfo(l),(o=this.view.player)==null||o.once("ready",function(){this.play()}),this.close()):this.app.workspace.activeLeaf?(Kn(l,this.app.workspace.activeLeaf,this.plugin),this.close()):new tr.Notice("No activeLeaf found"):new tr.Notice("Link not supported")}))),e.createEl("button",{text:"Cancel"},p=>p.onClickEvent(()=>this.close()))})}onClose(){let{contentEl:re}=this;re.empty()}},Kn=(ne,he,re)=>{let{workspace:ce}=re.app;if(!(he.view instanceof tr.MarkdownView)){new tr.Notice("No MarkdownView active, open new markdown file or click on opened md file");return}let V=()=>{var o,i;let p=(o=ce.rootSplit.containerEl)==null?void 0:o.clientWidth,l=(i=ce.rootSplit.containerEl)==null?void 0:i.clientHeight;return l&&p?l<p?"vertical":"horizontal":(console.error("no containerEl for rootSplit, fallback to horizontal",ce.rootSplit),"horizontal")},v=ce.createLeafBySplit(he,V());he.setGroupMember(v);let e=new vr(v,re,ne);if(v.open(e),e.core){let{player:p}=e.core;p.once("ready",function(){this.play()})}};var ci=(ne,he)=>{let{workspace:re}=he.app;return ce=>{if(qt(ne)&&ne.host===1&&(!fr(he.app)||!he.settings.interalBiliPlayback))return;if(ce.stopPropagation(),ce.preventDefault(),!re.activeLeaf){console.error("no active leaf");return}let V=re.activeLeaf.group,v=null;if(V){let e=re.getLeavesOfType(Nr).filter(p=>p.group===V);e.length>0&&(v=e[0]);for(let p=1;p<e.length;p++)e[p].detach()}if(v){let e=v.view,p=e.isEqual(ne);e.setInfo(ne).then(()=>{if(!e.core)return;let{player:l}=e.core;p?l.play():!qt(ne)&&ne.type==="media"&&l.isHTML5?l.once("ready",function(){let o=this.play(),i=0;o&&o.catch(E=>{var t;let h="The play() request was interrupted by a new load request";i===0&&((t=E.message)!=null&&t.includes(h))?(console.warn(E),i++):console.error(E)})}):l.once("ready",function(){this.play()})})}else re.activeLeaf&&Kn(ne,re.activeLeaf,he)}},jn=(ne,he)=>{let re=he==="internal"?"a.internal-link":"a.external-link";return(ce,V)=>{ce.querySelectorAll(re).forEach(v=>wt(void 0,null,function*(){let e=v,p=yield nn(e,he,ne.app,V);p&&ne.registerDomEvent(e,"click",ci(p,ne))}))}},di=ne=>{let{workspace:he,metadataCache:re,vault:ce}=ne.app;return(V,v)=>wt(void 0,null,function*(){let e=v.innerText;if(/Macintosh|iPhone/.test(navigator.userAgent)?V.metaKey:V.ctrlKey){let o;if(v.hasClass("cm-hmd-internal-link")){let{path:i,subpath:E}=(0,dn.parseLinktext)(e);if(Pn(i))V.stopPropagation();else return;let h=he.getActiveViewOfType(dn.MarkdownView);if(!h){console.error("no MarkdownView activeLeaf found");return}let t=re.getFirstLinkpathDest(i,h.file.path);if(!t)return;o=yield hr(t,E)}else if(v.hasClass("cm-formatting")&&v.hasClass("cm-formatting-link-string")){let i;if(e==="("?i=v.nextElementSibling:e===")"?i=v.previousElementSibling:i=null,i===null||!(i instanceof HTMLElement)){console.error("unable to get url from: %o",v);return}o=yield hr(i.innerText)}else o=yield hr(e);try{o&&ci(o,ne)(V)}catch(i){console.error(i)}}})};var mi=ir(xn());var Vr=require("obsidian");function hi(){let{vault:ne,fileManager:he,workspace:re}=this.app,ce=this,V=this.app.internalPlugins.plugins["audio-recorder"];if(!V)return;let v=p=>{let l=ce.recStartTime;ce.recStartTime=null;let o=i=>wt(this,null,function*(){let E=yield ne.read(i);return ne.modify(i,E.replace(new RegExp(`%%REC_${l}#t=([\\d.]+?)%%`,"g"),(h,t)=>{let g=mi.default.fromS(+t,"hh:mm:ss").replace(/^00:/g,""),C=he.generateMarkdownLink(p,i.path,"#t="+t,g).substring(1);return C.startsWith("[]")?C.replace(/^\[\]/,`[${g}]`):C}))});re.getLeavesOfType("markdown").forEach(i=>{i.view instanceof Vr.MarkdownView&&(i!==re.activeLeaf?o(i.view.file):window.setTimeout(()=>{i.view instanceof Vr.MarkdownView&&o(i.view.file)},500))})};this.addCommand({id:"take-rec-timestamp",name:"Get Current Timestamp of Recording",editorCheckCallback:(p,l,o)=>{if(p)return typeof this.recStartTime=="number";{let i=this.recStartTime;if(i){let{timestampTemplate:E}=this.settings,h=`%%REC_${this.recStartTime}#t=${(Date.now()-i)/1e3}%%`;Zr(E.replace(/{{TIMESTAMP}}/g,h),o)}}}});let e=br(V.instance,{saveRecording(p){return function(...l){let o=p.apply(this,l),i=()=>ne.off("create",h),E=window.setTimeout(i,3e5),h=t=>{t instanceof Vr.TFile?v(t):console.error("unexpected folder"),i(),window.clearTimeout(E)};return ne.on("create",h),o}},startRecording(p){return function(...l){let o=p.apply(this,l),i=this.recorder;return ce.recStartTime=Date.now(),i&&i instanceof MediaRecorder&&i.addEventListener("start",()=>{ce.recStartTime=Date.now()}),o}}});this.register(e)}var gi="span.cm-url, span.cm-hmd-internal-link",mn=class extends vi.Plugin{constructor(){super(...arguments);this.settings=$a;this.recStartTime=null;this.cmLinkHandler=di(this);this.setEmbedMinWidth=re=>document.documentElement.style.setProperty("--plyr-min-width",re!=null?re:this.sizeSettings.embedMinWidth);this.setSizeSettings=re=>wt(this,null,function*(){let ce;this.app.isMobile?ce={embedMaxHeightMobile:re.embedMaxHeight,embedMinWidthMobile:re.embedMinWidth,plyrControlsMobile:re.plyrControls}:ce=re;let V=(v,e)=>{let p={};return Object.keys(Jt(Jt({},v),e)).map(l=>{p[l]=e[l]||v[l]}),p};this.settings=V(this.settings,ce),yield this.saveSettings()})}loadSettings(){return wt(this,null,function*(){this.settings=Jt(Jt({},this.settings),yield this.loadData())})}saveSettings(){return wt(this,null,function*(){yield this.saveData(this.settings)})}get sizeSettings(){return{embedMaxHeight:this.app.isMobile?this.settings.embedMaxHeightMobile:this.settings.embedMaxHeight,embedMinWidth:this.app.isMobile?this.settings.embedMinWidthMobile:this.settings.embedMinWidth,plyrControls:this.app.isMobile?this.settings.plyrControlsMobile:this.settings.plyrControls}}onload(){return wt(this,null,function*(){console.log("loading media-extended"),yield this.loadSettings(),hi.call(this),document.body.toggleClass(wn,this.settings.hideYtbRecomm),this.setEmbedMinWidth(),this.addSettingTab(new on(this.app,this)),this.settings.mediaFragmentsEmbed&&this.registerMarkdownPostProcessor(Fn(this,"internal")),this.settings.timestampLink&&this.registerMarkdownPostProcessor(jn(this,"internal")),this.settings.extendedImageEmbedSyntax&&this.registerMarkdownPostProcessor(Fn(this,"external")),this.registerMarkdownPostProcessor(jn(this,"external")),this.app.isMobile||this.registerCodeMirror(re=>{let ce=re.getWrapperElement();ce.on("mousedown",gi,this.cmLinkHandler),this.register(()=>ce.off("mousedown",gi,this.cmLinkHandler))}),this.registerExtensions(),this.addCommand({id:"get-timestamp",name:"Get timestamp from player",editorCheckCallback:(re,ce,V)=>{var p;let v=l=>{var o;return(o=this.app.workspace.getGroupLeaves(l).find(i=>i.view.getTimeStamp!==void 0))==null?void 0:o.view},e=V.leaf.group;if(re){if(e){let l=v(e);if(l&&l.getTimeStamp())return!0}return!1}else e&&((p=v(e))==null||p.addTimeStampToMDView(V))}}),this.addCommand({id:"open-media-link",name:"Open Media from Link",callback:()=>{new Lr(this).open()}})})}registerExtensions(){let re=Ei();this.app.viewRegistry.unregisterExtensions(re),this.registerView(Nr,ce=>new vr(ce,this)),this.app.viewRegistry.registerExtensions(re,Nr)}unregisterExtensions(){this.app.viewRegistry.unregisterExtensions(Ei());for(let[re,ce]of rn)switch(re){case"audio":case"video":this.app.viewRegistry.registerExtensions(ce,re);break;case"media":this.app.viewRegistry.registerExtensions(ce,"video");break;default:(0,_i.default)(re)}}onunload(){console.log("unloading media-extended"),this.unregisterExtensions()}},Ei=()=>[...rn.values()].reduce((ne,he)=>ne.concat(he),[]);
/*! Bundled license information:

dashjs/dist/dash.all.debug.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  (*! codem-isoboxer v0.3.9 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt *)
  (*!
   * @overview es6-promise - a tiny implementation of Promises/A+.
   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
   * @license   Licensed under MIT license
   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
   * @version   v4.2.8+1e68dce6
   *)
  (*! http://mths.be/fromcodepoint v0.1.0 by @mathias *)
  (*!******************!*\
    !*** ./index.js ***!
    \******************)

zero-fill/index.js:
  (*! zero-fill. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
